<!DOCTYPE html>
<html class="dark"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie-edge">
        <link rel="stylesheet" href="18_files/template.css">
        <link rel="shortcut icon" href="https://maldevacademy.com/maldev-icon.png">
        <!-- fontawesome for icons -->
        <link rel="stylesheet" href="18_files/font-awesome.min.css">
        <!-- google fonts -->
        <link rel="preconnect" href="https://fonts.gstatic.com/">
        <link href="18_files/css2.css" rel="stylesheet">
        <link href="18_files/css2_002.css" rel="stylesheet">
        <title>Payload Encryption - RC4</title>
        <!-- Custom css files, order matters -->
        <link rel="preload" as="style" href="18_files/app.6a881bc1.css"><link rel="stylesheet" href="18_files/app.6a881bc1.css"><link href="18_files/prism-coldark-dark.css" rel="stylesheet">
<link rel="stylesheet" href="18_files/viewer.css">
    <style>.base-arrow-GfAHTK {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAyCAYAAACtd6CrAAAACXBIWXMAAC4jAAAuIwF4pT92AAAC9ElEQVR4nL2YSWtUQRSFS23nhRsXgmsFE/+AmwRFURQnRMURdSMSp2iCnXQwA3ZMSIKJRMRNHFDEefaXqP/An2Ack/Yc320pz+skPdx44TSv3ynq49Z7r+pWZerr1qwLIdyFVkA3oPYPHz8VwixEBroDrbL/WWjZ2vq6ptkAErZS7p2CJgE84w0k7BZ0Qe43QQUAz3oCCWuFlkNHxTsNTQDY7AXMoCMO2Qlcz4GOiH8OIqjZBcYfAJnBcVzOgw5Km/PwJtCmxQUWATmUzPCAtLsIr4A2rS4wAc6F9kvbFssw6wIz4C90ejgkGe4T+5Jl2OYCi4CHQvIM94idhTeJNjkXWATks3sE7Ra73TLscIEZ8Cc65bN7DO0SO2fPsNMFJsAn0A6xL9uQdrvADPgDne7F5VNou9hdNqQ9LjABPoO2id1tQ5p3gRnwOzrl2/kc2ir2Fcuw1wUmwBfQFrHzlmG/C8yA39ApP4eX0Gax+ww46AIT4Ctok9gDNqRDLjADfkWnO3H5Gtoo9qBlOOwCE+AbaIPY1yzDEReYAcfRKb+/t9D6EkBmOOoCE+A7qDGyuHpchzfuBjPgF3TKD/491CDAq66wmcIVhqyWhmQYG8Ri0dTmBgNoSUjeyEaxCGL9OeYCi0D6JjJYd47yomYYQItDMovoN1YEjRT/1ASLQDp7MFri2aMmGECLQjLz67zIaNV5sWpYBNIZn5EtNeNXBQNoYUhWa13LGLmp1rKKYRFIV2lGx3SrdEUwgBaEpMLS+oPROVP9UTYsAmllxegqp7IqCwbQ/JBUxVozMnrKrRlnhEUgrYYZ+Uqq4WlhANF7GNJ1PqO30jp/SpiBHoT0DobRV80OpiTMQPdDem/G6K92b5aCAcT92L2Q3nUyBmvZdf4Di0C6n2YM1bqf/gsz0O2QPilgDHucFPyBAcTN+lhIn4EwuBbp6U/1MGggpE93GFxd3U53irCTJe7zKND13KoI+wytju7dhNxP5IqwY+E/HW7+BpJoVXj80aQPAAAAAElFTkSuQmCC);
  width: 16px;
  height: 16px;
  position: absolute;
  top: 16px;
  left: 16px;
  cursor: pointer;
  background-size: contain;
  background-repeat: no-repeat;
}
.base-navigation-tab-Ahvn3N {
  width: 24px;
  height: 24px;
  background-position: center;
  background-repeat: no-repeat;
  background-size: contain;
}
.base-navigation-label-vUENtU {
  font-family: 'Inter', sans-serif;
  font-size: 13px;
  line-height: 18px;
  color: rgba(0, 0, 0, 0.87);
}
.shoop-de-tooltip-rXf0XP {
  position: relative;
}
.shoop-de-tooltip__text-block-VXptk_ {
  height: 136px;
  background: #e35144;
  position: absolute;
  top: -148px;
  width: 302px;
  padding: 16px;
  border-radius: 8px;
  font-family: 'Inter', sans-serif;
  font-style: normal;
  font-size: 15px;
  line-height: 21px;
  font-weight: normal;
  letter-spacing: -0.24px;
  color: #FFF;
  display: flex;
  align-items: flex-end;
}
.shoop-de-tooltip__polygon-a7JmmB {
  position: absolute;
  width: 15px;
  height: 15px;
  top: -20px;
  left: 17px;
  border-radius: 2px;
  transform: rotate(45deg);
  background: #e35144;
}
</style><style>.shoop-de-serp-beA_vX {
  z-index: 999999999999;
  width: max-content;
  font-size: 15px;
  line-height: 21px;
  font-weight: bold;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  cursor: pointer;
}
.shoop-de-serp-beA_vX:hover .shoop-de-serp__tooltip-jznGdA {
  opacity: 1;
}
.shoop-de-serp__logo-VNEyj1 {
  width: 30px;
  height: 20px;
  background: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yOC42NTg4IDYuNjUwMjFDMjMuODkxIDYuNjUwMjEgMTkuODUyMyA5Ljc3MTY0IDE4LjQ3NDggMTQuMDgyNEMxNi41NjQ4IDEyLjI5OSAxNC4wMDA0IDExLjIwNzUgMTEuMTgxMSAxMS4yMDc1QzUuMjc3NSAxMS4yMDc1IDAuNDkxNzkgMTUuOTkzMiAwLjQ5MTc5IDIxLjg5NjhDMC40OTE3OSAyNy44MDA0IDUuMjc3NSAzMi41ODYxIDExLjE4MTEgMzIuNTg2MUMxNS45NDg5IDMyLjU4NjEgMTkuOTg3NiAyOS40NjQ2IDIxLjM2NTEgMjUuMTUzOEMyMy4yNzUgMjYuOTM3MyAyNS44Mzk0IDI4LjAyODggMjguNjU4OCAyOC4wMjg4QzM0LjU2MjQgMjguMDI4OCAzOS4zNDgxIDIzLjI0MzEgMzkuMzQ4MSAxNy4zMzk1QzM5LjM0ODEgMTEuNDM1OSAzNC41NjI0IDYuNjUwMjEgMjguNjU4OCA2LjY1MDIxWk0yOC42NTg4IDIyLjI5NTJDMjUuOTIxNyAyMi4yOTUyIDIzLjcwMzEgMjAuMDc2NiAyMy43MDMxIDE3LjMzOTVDMjMuNzAzMSAxNC42MDI0IDI1LjkyMTcgMTIuMzgzOCAyOC42NTg4IDEyLjM4MzhDMzEuMzk1OSAxMi4zODM4IDMzLjYxNDUgMTQuNjAyNCAzMy42MTQ1IDE3LjMzOTVDMzMuNjE0NSAyMC4wNzY2IDMxLjM5NTkgMjIuMjk1MiAyOC42NTg4IDIyLjI5NTJaTTExLjE4MTEgMjYuODUyNUM4LjQ0MzkzIDI2Ljg1MjUgNi4yMjUzNiAyNC42MzM5IDYuMjI1MzYgMjEuODk2OEM2LjIyNTM2IDE5LjE1OTYgOC40NDM5MyAxNi45NDExIDExLjE4MTEgMTYuOTQxMUMxMy45MTgyIDE2Ljk0MTEgMTYuMTM2OCAxOS4xNTk2IDE2LjEzNjggMjEuODk2OEMxNi4xMzY4IDI0LjYzMzkgMTMuOTE4MiAyNi44NTI1IDExLjE4MTEgMjYuODUyNVoiIGZpbGw9IiMxRDdCQ0UiLz4KPC9zdmc+Cg==) no-repeat;
  background-size: contain;
}
.shoop-de-serp__premium-ZDFq9y {
  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMC42NjY2NTZDNy4wNjAyNyAwLjY2NjY1NiA2LjI4NTcxIDEuNDU3MzUgNi4yODU3MSAyLjQxNjY2QzYuMjg1NzEgMy4wNzI5MSA2LjY0NzMyIDMuNjQ5NCA3LjE3ODU3IDMuOTQ3OTFMNS41IDcuMzc0OTlMMi44NzUgNS40NjA5M0MzLjIxODc1IDUuMTM5NjQgMy40Mjg1NyA0LjY3NDc5IDMuNDI4NTcgNC4xNjY2NkMzLjQyODU3IDMuMjA3MzUgMi42NTQwMiAyLjQxNjY2IDEuNzE0MjkgMi40MTY2NkMwLjc3NDU1NCAyLjQxNjY2IDAgMy4yMDczNSAwIDQuMTY2NjZDMCA0Ljk1Mjc5IDAuNTI5MDE4IDUuNjA2NzYgMS4yMzIxNCA1LjgyNTUxTDIuMjg1NzEgMTEuNzVWMTQuNjY2N0gxMy43MTQzVjExLjc1TDE0Ljc2NzkgNS44MjU1MUMxNS40NzEgNS42MDY3NiAxNiA0Ljk1Mjc5IDE2IDQuMTY2NjZDMTYgMy4yMDczNSAxNS4yMjU0IDIuNDE2NjYgMTQuMjg1NyAyLjQxNjY2QzEzLjM0NiAyLjQxNjY2IDEyLjU3MTQgMy4yMDczNSAxMi41NzE0IDQuMTY2NjZDMTIuNTcxNCA0LjY3NDc5IDEyLjc4MTMgNS4xMzk2NCAxMy4xMjUgNS40NjA5M0wxMC41IDcuMzc0OTlMOC44MjE0MyAzLjk0NzkxQzkuMzUyNjggMy42NDk0IDkuNzE0MjkgMy4wNzI5MSA5LjcxNDI5IDIuNDE2NjZDOS43MTQyOSAxLjQ1NzM1IDguOTM5NzMgMC42NjY2NTYgOCAwLjY2NjY1NlpNOCAxLjgzMzMyQzguMzIxNDMgMS44MzMzMiA4LjU3MTQzIDIuMDg4NTMgOC41NzE0MyAyLjQxNjY2QzguNTcxNDMgMi43NDQ3OCA4LjMyMTQzIDIuOTk5OTkgOCAyLjk5OTk5QzcuNjc4NTcgMi45OTk5OSA3LjQyODU3IDIuNzQ0NzggNy40Mjg1NyAyLjQxNjY2QzcuNDI4NTcgMi4wODg1MyA3LjY3ODU3IDEuODMzMzIgOCAxLjgzMzMyWk0xLjcxNDI5IDMuNTgzMzJDMi4wMzU3MSAzLjU4MzMyIDIuMjg1NzEgMy44Mzg1MyAyLjI4NTcxIDQuMTY2NjZDMi4yODU3MSA0LjQ5NDc4IDIuMDM1NzEgNC43NDk5OSAxLjcxNDI5IDQuNzQ5OTlDMS4zOTI4NiA0Ljc0OTk5IDEuMTQyODYgNC40OTQ3OCAxLjE0Mjg2IDQuMTY2NjZDMS4xNDI4NiAzLjgzODUzIDEuMzkyODYgMy41ODMzMiAxLjcxNDI5IDMuNTgzMzJaTTE0LjI4NTcgMy41ODMzMkMxNC42MDcxIDMuNTgzMzIgMTQuODU3MSAzLjgzODUzIDE0Ljg1NzEgNC4xNjY2NkMxNC44NTcxIDQuNDk0NzggMTQuNjA3MSA0Ljc0OTk5IDE0LjI4NTcgNC43NDk5OUMxMy45NjQzIDQuNzQ5OTkgMTMuNzE0MyA0LjQ5NDc4IDEzLjcxNDMgNC4xNjY2NkMxMy43MTQzIDMuODM4NTMgMTMuOTY0MyAzLjU4MzMyIDE0LjI4NTcgMy41ODMzMlpNOCA0Ljg5NTgyTDkuNzY3ODYgOC41MDUyTDEwLjYyNSA4LjcyMzk1TDEzLjQ4MjEgNi42NDU4MkwxMi42Nzg2IDExLjE2NjdIMy4zMjE0M0wyLjUxNzg2IDYuNjQ1ODJMNS4zNzUgOC43MjM5NUw2LjIzMjE0IDguNTA1Mkw4IDQuODk1ODJaTTMuNDI4NTcgMTIuMzMzM0gxMi41NzE0VjEzLjVIMy40Mjg1N1YxMi4zMzMzWiIgZmlsbD0iIzYwNDVFMiIvPgo8L3N2Zz4K);
  width: 16px;
  height: 16px;
  margin-right: 10px;
}
.shoop-de-serp__description-pzXVxP {
  color: #1D7BCE;
  font-weight: 600;
}
.shoop-de-serp__container-HDQc_M {
  display: flex;
  width: 100%;
}
</style><meta name="shoop-toolbar" version="3.2.17.2"></head>
    <body>
        <nav id="navbar" class="px-2 sm:px-0 py-2.5 bg-gray-900 sticky hidden">
    <div class="container flex flex-wrap md:flex-nowrap justify-between mx-auto">
      <a data-target="_self" href="https://maldevacademy.com/" class="flex items-center">
        <div class="main-logo flex flex-row items-center block sm:block md:hidden lg:block">
            <img class="w-[150px]" src="18_files/maldev-navbar-logo.svg" alt="Logo">   
        </div>
      </a>
      <button data-collapse-toggle="navbar-default" id="navbar-phone-btn" type="button" class="inline-flex items-center p-2 ml-3 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false">
        <span class="sr-only">Open main menu</span>
        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
      </button>
      <div class="hidden w-full md:block md:w-auto" id="navbar-default">
        <ul class="flex flex-col items-center p-4 mt-4 bg-gray-50 rounded-lg border border-gray-100 md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700">
          <li>
            <a data-target="_self" href="https://maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Home</a>
          </li>

          <li>
            <a data-target="_self" href="https://maldevacademy.com/tools" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Public Tools</a>
          </li>

          <li>
            <a data-target="_self" target="_blank" href="https://search.maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Code Database</a>
          </li>

          
                              <div class="group relative">
            <button id="profileNavBar" onclick="toggleProfileDropdown()" class="flex items-center justify-between w-full py-2 pl-3 pr-4 rounded md:border-0 md:p-0 md:w-auto text-gray-400">
              Account
              <svg class="w-2.5 h-2.5 ml-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4"></path>
              </svg>
            </button>
            <div id="profileDropdown" class="md:absolute hidden md:left-0 md:font-normal md:bg-white md:divide-y md:divide-gray-100 md:rounded-lg md:shadow md:w-44 md:dark:bg-gray-800 border-[1px] dark:border-gray-700">
              <ul class="py-2 text-sm text-gray-700 dark:text-gray-400">
                <li>
                  <a href="https://maldevacademy.com/profile" class="block px-4 py-2  hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" target="_blank">Profile</a>
                </li>
                <li>
                <form action="https://maldevacademy.com/logout" method="POST" class="">
                </form>
                </li>
              </ul>
            </div>
          </div>
                              <li class="mt-4 md:mt-0">
            <a data-target="_self" href="https://maldevacademy.com/dashboard" class="text-white bg-blue-700 hover:bg-blue-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center md:mr-3 mr-0 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">Dashboard</a>
          </li>
                  </ul>
      </div>
    </div>
  </nav>        <div class="fixed bottom-4 right-5 bg-gray-900 text-white text-sm font-bold rounded-xl px-2 py-2 shadow-lg cursor-pointer" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">
    <img src="18_files/module-up.svg" width="20px" alt="">
</div>


<div class="bg-gray-900 p-4">
    <div class="flex">
        <input type="hidden" value="17077">
        <div class="md:flex-row flex-col flex md:items-center w-1/2 bg-gray-700 border-l border-t border-gray-600 pl-4 pt-2 pb-2 rounded-tl">
            <div>
                Module 18 - Payload Encryption - RC4
            </div>
            <div class="ml-2 w-4 h-4 bg-green-800 rounded-full"></div>
        </div>
        <div class="flex justify-end items-center w-1/2 bg-gray-700 pr-4 pt-2 pb-2 rounded-tr border-t border-r border-gray-600">
            <div class="progress-container pr-4">
                <img src="18_files#.svg" onclick="toggleProgress()" class="hover:bg-gray-600 rounded-sm cursor-pointer" id="progressToggle" width="20px" alt="Progress Toggle">
            </div>
            <div class="enlarge-container pr-4">
                <img src="18_files/enlarge.svg" onclick="toggleScreenWidth()" class="hover:bg-gray-600 rounded-sm cursor-pointer" id="enlargeToggle" width="20px" alt="Screen Width">
            </div>
            <div class="objectives-container pr-4">
                <img src="18_files/objectives.svg" onclick="toggleObjectives()" class="hover:bg-gray-600 cursor-pointer" id="objectivesToggle" width="20px" alt="Objectives">
            </div>
            <div class="terminal-container  pr-4 ">
                <img src="18_files/ide.svg" onclick="toggleIde()" class="hover:bg-gray-600 rounded-sm cursor-pointer" id="terminalToggle" width="22px" alt="Terminal">
            </div>
                                    <div class="dl-container">
                <a href="https://maldevacademy.com/download/file/Rc4" target="_blank">
                    <img src="18_files/dl.svg" class="hover:bg-gray-600 rounded-full cursor-pointer" width="20px" alt="Download">
                </a>
            </div>
                                </div>
    </div>
    <div id="height-container" class="flex h-full min-h-[800px]">
        <div class="flex max-w-full min-w-full">
            <div id="description-container" class="viewer code-description h-full bg-gray-800 p-4 border-r border-l border-b border-gray-600 px-5 md:px-10 lg:px-20 w-full"><div class="toastui-editor-contents" style="overflow-wrap: break-word;">
                
                            
                <h2>Payload Encryption - RC4</h2>
<h3>Introduction</h3>
<p>RC4 is a fast and efficient stream cipher that is also a 
bidirectional encryption algorithm that allows the same function to be 
used for both encryption and decryption. There are several C 
implementations of RC4 publicly available but this module will 
demonstrate three ways of performing RC4 encryption.</p>
<p>Note that diving into how the RC4 algorithm works is not the goal of 
this module and it's not required to fully understand it in depth. 
Rather the goal is encrypting the payload to evade detection.</p>
<h3>RC4 Encryption - Method 1</h3>
<p>This method uses the RC4 implementation found <a href="https://www.oryx-embedded.com/doc/rc4_8c_source.html" target="_blank">here</a> due to its stability and well-written code. There are two functions <code>rc4Init</code> and <code>rc4Cipher</code> which are used to initialize a <code>rc4context</code> structure and perform the RC4 encryption, respectively.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> j<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> s<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span> Rc4Context<span class="token punctuation">;</span>


<span class="token keyword">void</span> <span class="token function">rc4Init</span><span class="token punctuation">(</span>Rc4Context<span class="token operator">*</span> context<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> key<span class="token punctuation">,</span> <span class="token class-name">size_t</span> length<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> j<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> temp<span class="token punctuation">;</span>

	<span class="token comment">// Check parameters</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>context <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> key <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> ERROR_INVALID_PARAMETER<span class="token punctuation">;</span>

	<span class="token comment">// Clear context</span>
	context<span class="token operator">-&gt;</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	context<span class="token operator">-&gt;</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token comment">// Initialize the S array with identity permutation</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		context<span class="token operator">-&gt;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// S is then processed for 256 iterations</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token comment">//Randomize the permutations using the supplied key</span>
		j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> context<span class="token operator">-&gt;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> length<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>

		<span class="token comment">//Swap the values of S[i] and S[j]</span>
		temp <span class="token operator">=</span> context<span class="token operator">-&gt;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		context<span class="token operator">-&gt;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> context<span class="token operator">-&gt;</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
		context<span class="token operator">-&gt;</span>s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">rc4Cipher</span><span class="token punctuation">(</span>Rc4Context<span class="token operator">*</span> context<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> input<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> output<span class="token punctuation">,</span> <span class="token class-name">size_t</span> length<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> temp<span class="token punctuation">;</span>

	<span class="token comment">// Restore context</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> i <span class="token operator">=</span> context<span class="token operator">-&gt;</span>i<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> j <span class="token operator">=</span> context<span class="token operator">-&gt;</span>j<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> s <span class="token operator">=</span> context<span class="token operator">-&gt;</span>s<span class="token punctuation">;</span>

	<span class="token comment">// Encryption loop</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token comment">// Adjust indices</span>
		i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>
		j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span>

		<span class="token comment">// Swap the values of S[i] and S[j]</span>
		temp <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
		s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>

		<span class="token comment">// Valid input and output?</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>input <span class="token operator">!=</span> <span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> output <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token comment">//XOR the input data with the RC4 stream</span>
			<span class="token operator">*</span>output <span class="token operator">=</span> <span class="token operator">*</span>input <span class="token operator">^</span> s<span class="token punctuation">[</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

			<span class="token comment">//Increment data pointers</span>
			input<span class="token operator">++</span><span class="token punctuation">;</span>
			output<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// Remaining bytes to process</span>
		length<span class="token operator">--</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Save context</span>
	context<span class="token operator">-&gt;</span>i <span class="token operator">=</span> i<span class="token punctuation">;</span>
	context<span class="token operator">-&gt;</span>j <span class="token operator">=</span> j<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4>RC4 Encryption</h4>
<p>The code below shows how the <code>rc4Init</code> and <code>rc4Cipher</code> functions are used to encrypt a payload.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">	<span class="token comment">// Initialization</span>
	Rc4Context ctx <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">// Key used for encryption</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token string">"maldev123"</span><span class="token punctuation">;</span>
	<span class="token function">rc4Init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Encryption //</span>
	<span class="token comment">// plaintext - The payload to be encrypted</span>
	<span class="token comment">// ciphertext - A buffer that is used to store the outputted encrypted data</span>
	<span class="token function">rc4Cipher</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ctx<span class="token punctuation">,</span> plaintext<span class="token punctuation">,</span> ciphertext<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4>RC4 Decryption</h4>
<p>The code below shows how the <code>rc4Init</code> and <code>rc4Cipher</code> functions are used to decrypt a payload.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">	<span class="token comment">// Initialization</span>
	Rc4Context ctx <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">// Key used to decrypt</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token string">"maldev123"</span><span class="token punctuation">;</span>
	<span class="token function">rc4Init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ctx<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Decryption //</span>
	<span class="token comment">// ciphertext - Encrypted payload to be decrypted</span>
	<span class="token comment">// plaintext - A buffer that is used to store the outputted plaintext data</span>
	<span class="token function">rc4Cipher</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ctx<span class="token punctuation">,</span> ciphertext<span class="token punctuation">,</span> plaintext<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3>RC4 Encryption - Method 2</h3>
<p>The undocumented Windows NTAPI <code>SystemFunction032</code> offers a faster and smaller implementation of the RC4 algorithm. Additional information about this API can be found on <a href="https://doxygen.reactos.org/df/d13/sysfunc_8c.html#a66d55017b8625d505bd6c5707bdb9725" target="_blank">here</a>.</p>
<h4>SystemFunction032</h4>
<p>The documentation page states that the function <code>SystemFunction032</code> accepts two parameters of type <code>USTRING</code>.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"> NTSTATUS <span class="token function">SystemFunction032</span>
 <span class="token punctuation">(</span>
  <span class="token keyword">struct</span> <span class="token class-name">ustring</span><span class="token operator">*</span>       data<span class="token punctuation">,</span>
  <span class="token keyword">const</span> <span class="token keyword">struct</span> <span class="token class-name">ustring</span><span class="token operator">*</span> key
 <span class="token punctuation">)</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4>USTRING Structure</h4>
<p>Unfortunately, since this is an undocumented API the structure of <code>USTRING</code> is unknown. But through additional research, it's possible to locate the <code>USTRING</code> structure definition in <a href="https://github.com/wine-mirror/wine/blob/master/dlls/advapi32/crypt.h#L94" target="_blank">wine/crypt.h</a>. The structure is shown below. More in-depth information about this structure can be found at <a href="https://www.geoffchappell.com/studies/windows/km/ntoskrnl/inc/shared/ntdef/unicode_string.htm" target="_blank">Geoff Chappell</a>.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{</span>
	DWORD	Length<span class="token punctuation">;</span>         <span class="token comment">// Size of the data to encrypt/decrypt</span>
	DWORD	MaximumLength<span class="token punctuation">;</span>  <span class="token comment">// Max size of the data to encrypt/decrypt, although often its the same as Length (USTRING.Length = USTRING.MaximumLength = X)</span>
	PVOID	Buffer<span class="token punctuation">;</span>         <span class="token comment">// The base address of the data to encrypt/decrypt</span>

<span class="token punctuation">}</span> USTRING<span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Now that the <code>USTRING</code> struct is known, the <code>SystemFunction032</code> function can be used.</p>
<h4>Retrieving SystemFunction032's Address</h4>
<p>To use <code>SystemFunction032</code>, its address must first be retrieved. Since <code>SystemFunction032</code> is exported from <code>advapi32.dll</code>, the DLL must be loaded into the process using <code>LoadLibrary</code>. The return value of the function call can be used directly in <code>GetProcAddress</code>.</p>
<p>Once the address of <code>SystemFunction032</code> has been 
successfully retrieved, it should be type-casted to a function pointer 
matching the definition found on the previously referenced <a href="https://source.winehq.org/WineAPI/SystemFunction032.html" target="_blank">Wine API page</a>. However, the returned address can be casted directly from <code>GetProcAddress</code>. This is all demonstrated in the snippet below.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">fnSystemFunction032 SystemFunction032 <span class="token operator">=</span> <span class="token punctuation">(</span>fnSystemFunction032<span class="token punctuation">)</span> <span class="token function">GetProcAddress</span><span class="token punctuation">(</span><span class="token function">LoadLibraryA</span><span class="token punctuation">(</span><span class="token string">"Advapi32"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"SystemFunction032"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>The function pointer of <code>SystemFunction032</code> is defined as the <code>fnSystemFunction032</code> data type which is shown below.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">typedef</span> <span class="token function">NTSTATUS</span><span class="token punctuation">(</span>NTAPI<span class="token operator">*</span> fnSystemFunction032<span class="token punctuation">)</span><span class="token punctuation">(</span>
	<span class="token keyword">struct</span> <span class="token class-name">USTRING</span><span class="token operator">*</span> Data<span class="token punctuation">,</span>   <span class="token comment">// Structure of type USTRING that holds information about the buffer to encrypt / decrypt </span>
	<span class="token keyword">struct</span> <span class="token class-name">USTRING</span><span class="token operator">*</span> Key     <span class="token comment">// Structure of type USTRING that holds information about the key used while encryption / decryption</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4>SystemFunction032 Usage</h4>
<p>The snippet below provides a working code sample that utilizes the <code>SystemFunction032</code> function to perform RC4 encryption and decryption.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{</span>
	DWORD	Length<span class="token punctuation">;</span>
	DWORD	MaximumLength<span class="token punctuation">;</span>
	PVOID	Buffer<span class="token punctuation">;</span>

<span class="token punctuation">}</span> USTRING<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token function">NTSTATUS</span><span class="token punctuation">(</span>NTAPI<span class="token operator">*</span> fnSystemFunction032<span class="token punctuation">)</span><span class="token punctuation">(</span>
	<span class="token keyword">struct</span> <span class="token class-name">USTRING</span><span class="token operator">*</span> Data<span class="token punctuation">,</span>
	<span class="token keyword">struct</span> <span class="token class-name">USTRING</span><span class="token operator">*</span> Key
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
Helper function that calls SystemFunction032
* pRc4Key - The RC4 key use to encrypt/decrypt
* pPayloadData - The base address of the buffer to encrypt/decrypt
* dwRc4KeySize - Size of pRc4key (Param 1)
* sPayloadSize - Size of pPayloadData (Param 2)
*/</span>
BOOL <span class="token function">Rc4EncryptionViaSystemFunc032</span><span class="token punctuation">(</span>IN PBYTE pRc4Key<span class="token punctuation">,</span> IN PBYTE pPayloadData<span class="token punctuation">,</span> IN DWORD dwRc4KeySize<span class="token punctuation">,</span> IN DWORD sPayloadSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	NTSTATUS STATUS	<span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	
	USTRING Data <span class="token operator">=</span> <span class="token punctuation">{</span> 
		<span class="token punctuation">.</span>Buffer         <span class="token operator">=</span> pPayloadData<span class="token punctuation">,</span>
		<span class="token punctuation">.</span>Length         <span class="token operator">=</span> sPayloadSize<span class="token punctuation">,</span>
		<span class="token punctuation">.</span>MaximumLength  <span class="token operator">=</span> sPayloadSize
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	USTRING	Key <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token punctuation">.</span>Buffer         <span class="token operator">=</span> pRc4Key<span class="token punctuation">,</span>
		<span class="token punctuation">.</span>Length         <span class="token operator">=</span> dwRc4KeySize<span class="token punctuation">,</span>
		<span class="token punctuation">.</span>MaximumLength  <span class="token operator">=</span> dwRc4KeySize
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	fnSystemFunction032 SystemFunction032 <span class="token operator">=</span> <span class="token punctuation">(</span>fnSystemFunction032<span class="token punctuation">)</span><span class="token function">GetProcAddress</span><span class="token punctuation">(</span><span class="token function">LoadLibraryA</span><span class="token punctuation">(</span><span class="token string">"Advapi32"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"SystemFunction032"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>STATUS <span class="token operator">=</span> <span class="token function">SystemFunction032</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Data<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0x0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] SystemFunction032 FAILED With Error: 0x%0.8X \n"</span><span class="token punctuation">,</span> STATUS<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3>RC4 Encryption - Method 3</h3>
<p>Another way to implement the RC4 algorithm is using the <code>SystemFunction033</code> which takes the same parameters as the previously shown <code>SystemFunction032</code> function.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">
<span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">{</span>
	DWORD	Length<span class="token punctuation">;</span>
	DWORD	MaximumLength<span class="token punctuation">;</span>
	PVOID	Buffer<span class="token punctuation">;</span>

<span class="token punctuation">}</span> USTRING<span class="token punctuation">;</span>


<span class="token keyword">typedef</span> <span class="token function">NTSTATUS</span><span class="token punctuation">(</span>NTAPI<span class="token operator">*</span> fnSystemFunction033<span class="token punctuation">)</span><span class="token punctuation">(</span>
	<span class="token keyword">struct</span> <span class="token class-name">USTRING</span><span class="token operator">*</span> Data<span class="token punctuation">,</span>
	<span class="token keyword">struct</span> <span class="token class-name">USTRING</span><span class="token operator">*</span> Key
	<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">/*
Helper function that calls SystemFunction033
* pRc4Key - The RC4 key use to encrypt/decrypt
* pPayloadData - The base address of the buffer to encrypt/decrypt
* dwRc4KeySize - Size of pRc4key (Param 1)
* sPayloadSize - Size of pPayloadData (Param 2)
*/</span>
BOOL <span class="token function">Rc4EncryptionViSystemFunc033</span><span class="token punctuation">(</span>IN PBYTE pRc4Key<span class="token punctuation">,</span> IN PBYTE pPayloadData<span class="token punctuation">,</span> IN DWORD dwRc4KeySize<span class="token punctuation">,</span> IN DWORD sPayloadSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	NTSTATUS	STATUS <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	USTRING		Key <span class="token operator">=</span> <span class="token punctuation">{</span> 
			<span class="token punctuation">.</span>Buffer        <span class="token operator">=</span> pRc4Key<span class="token punctuation">,</span> 
			<span class="token punctuation">.</span>Length        <span class="token operator">=</span> dwRc4KeySize<span class="token punctuation">,</span>
			<span class="token punctuation">.</span>MaximumLength <span class="token operator">=</span> dwRc4KeySize 
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
		
	USTRING 	Data <span class="token operator">=</span> <span class="token punctuation">{</span>
			<span class="token punctuation">.</span>Buffer         <span class="token operator">=</span> pPayloadData<span class="token punctuation">,</span> 	
			<span class="token punctuation">.</span>Length         <span class="token operator">=</span> sPayloadSize<span class="token punctuation">,</span>		
			<span class="token punctuation">.</span>MaximumLength  <span class="token operator">=</span> sPayloadSize 
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	fnSystemFunction033 SystemFunction033 <span class="token operator">=</span> <span class="token punctuation">(</span>fnSystemFunction033<span class="token punctuation">)</span><span class="token function">GetProcAddress</span><span class="token punctuation">(</span><span class="token function">LoadLibraryA</span><span class="token punctuation">(</span><span class="token string">"Advapi32"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"SystemFunction033"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>STATUS <span class="token operator">=</span> <span class="token function">SystemFunction033</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Data<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0x0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] SystemFunction033 FAILED With Error: 0x%0.8X \n"</span><span class="token punctuation">,</span> STATUS<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4>Encryption/Decryption Key Format</h4>
<p>The code snippets in this module and other encryption modules use one
 valid way of representing the encryption/decryption key. However, it's 
important to be aware that the key can be represented using several 
different ways.</p>
<p>Be aware that hardcoding the plaintext key into the binary is 
considered bad practice and can be easily pulled when the malware is 
analyzed. Future modules will provide solutions to ensure the key cannot
 be easily retrieved.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token comment">// Method 1</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token string">"maldev123"</span><span class="token punctuation">;</span>

<span class="token comment">// Method 2</span>
<span class="token comment">// This is 'maldev123' represented as an array of hexadecimal bytes</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token number">0x6D</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x33</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Method 3</span>
<span class="token comment">// This is 'maldev123' represented in a hex/string form (hexadecimal escape sequence)</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token string">"\x6D\x61\x6C\x64\x65\x76\x31\x32\x33"</span><span class="token punctuation">;</span>

<span class="token comment">// Method 4 - better approach (via stack strings)</span>
<span class="token comment">// This is 'maldev123' represented in an array of chars</span>
<span class="token keyword">unsigned</span> <span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token char">'m'</span><span class="token punctuation">,</span> <span class="token char">'a'</span><span class="token punctuation">,</span> <span class="token char">'l'</span><span class="token punctuation">,</span> <span class="token char">'d'</span><span class="token punctuation">,</span> <span class="token char">'e'</span><span class="token punctuation">,</span> <span class="token char">'v'</span><span class="token punctuation">,</span> <span class="token char">'1'</span><span class="token punctuation">,</span> <span class="token char">'2'</span><span class="token punctuation">,</span> <span class="token char">'3'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>

            
                
                                

            </div></div>
            <div id="accessory-container" class="hidden flex flex-col w-1/4 min-w-1/4 h-full">
                <div id="objectives" class="hidden p-4 border-r border-b bg-gray-900 border-gray-600 font-code w-full h-1/2">
                    <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Objectives</div>
                                                                        
                                                                        
            <div class="flex items-center mb-2 font-sans">
                                <input type="checkbox" id="objective-0" data-objective-id="0" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                                <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Understand how RC4 encryption works</label>
                            </div>
                                                                        
                                                                        
                    <div class="flex items-center mb-2 font-sans">
                                <input type="checkbox" id="objective-1" data-objective-id="1" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                                <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Review the code for the three RC4 methods</label>
                            </div>
                                                                        
                                                                        
                    <div class="flex items-center mb-2 font-sans">
                                <input type="checkbox" id="objective-2" data-objective-id="2" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                                <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Compile and run the code to encrypt and decrypt your shellcode</label>
                            </div>
                                                                        
                                                                        
                    <div class="flex items-center mb-2 font-sans">
                                <input type="checkbox" id="objective-3" data-objective-id="3" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                                <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Implement RC4 encryption using SystemFunction032 or SystemFunction033</label>
                            </div>
                                                                                  
                </div>
                <div id="ide" class="hidden p-4 border-r border-b border-gray-600 font-code w-full h-1/2">
                    <textarea class="bg-gray-900 outline-0 w-full h-full resize-none font-sans" placeholder="Write temporary notes or code here"></textarea>
                </div>
            </div>
            <div id="progress-container" class="hidden flex flex-col w-1/4 min-w-1/4">
                <div id="progress" class="p-4 border-r overflow-auto border-b border-gray-600 font-code w-full min-h-full">
                <div class="max-h-[300px]">
                                        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Modules Progress</div>
                                                                                    <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-1" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                            <a data-target="_self" href="./1.html">
                                <div for="module-1" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 1 - Welcome Module
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-2" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./2.html">
                                <div for="module-2" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 2 - Introduction To Malware Development
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-3" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./3.html">
                                <div for="module-3" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 3 - Required Tools
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-4" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./4.html">
                                <div for="module-4" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 4 - Coding Basics
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-5" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./5.html">
                                <div for="module-5" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 5 - Windows Architecture
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-6" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./6.html">
                                <div for="module-6" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 6 - Windows Memory Management
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-7" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./7.html">
                                <div for="module-7" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 7 - Introduction To The Windows API
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-8" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./8.html">
                                <div for="module-8" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 8 - Portable Executable Format
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-9" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./9.html">
                                <div for="module-9" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 9 - Dynamic-Link Library
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-10" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./10.html">
                                <div for="module-10" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 10 - Detection Mechanisms
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-11" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./11.html">
                                <div for="module-11" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 11 - Windows Processes
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-12" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./12.html">
                                <div for="module-12" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 12 - Undocumented Structures
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-13" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./13.html">
                                <div for="module-13" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 13 - Payload Placement - .data &amp; .rdata Sections
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-14" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./14.html">
                                <div for="module-14" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 14 - Payload Placement - .text Section
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-15" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./15.html">
                                <div for="module-15" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 15 - Payload Placement - .rsrc Section
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-16" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./16.html">
                                <div for="module-16" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 16 - Introduction To Payload Encryption
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-17" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./17.html">
                                <div for="module-17" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 17 - Payload Encryption - XOR
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-18" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./18.html">
                                <div for="module-18" class="ml-2 text-sm font-medium 
                                            bg-blue-700 font-bold rounded-sm">
                                    Module 18 - Payload Encryption - RC4
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-19" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./19.html">
                                <div for="module-19" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 19 - Payload Encryption - AES Encryption
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-20" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./20.html">
                                <div for="module-20" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 20 - Evading Microsoft Defender Static Analysis
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-21" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./21.html">
                                <div for="module-21" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 21 - Payload Obfuscation - IPv4/IPv6Fuscation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-22" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./22.html">
                                <div for="module-22" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 22 - Payload Obfuscation - MACFuscation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-23" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./23.html">
                                <div for="module-23" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 23 - Payload Obfuscation - UUIDFuscation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-24" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./24.html">
                                <div for="module-24" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 24 - Maldev Academy Tool - HellShell
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-25" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./25.html">
                                <div for="module-25" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 25 - Maldev Academy Tool - MiniShell
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-26" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./26.html">
                                <div for="module-26" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 26 - Local Payload Execution - DLL
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-27" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./27.html">
                                <div for="module-27" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 27 - Local Payload Execution - Shellcode
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-28" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./28.html">
                                <div for="module-28" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 28 - Process Injection - DLL Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-29" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./29.html">
                                <div for="module-29" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 29 - Process Injection - Shellcode Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-30" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./30.html">
                                <div for="module-30" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 30 - Payload Staging - Web Server
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-31" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./31.html">
                                <div for="module-31" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 31 - Payload Staging - Windows Registry
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-32" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./32.html">
                                <div for="module-32" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 32 - Malware Binary Signing
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-33" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./33.html">
                                <div for="module-33" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 33 - Process Enumeration - EnumProcesses
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-34" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./34.html">
                                <div for="module-34" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 34 - Process Enumeration - NtQuerySystemInformation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-35" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./35.html">
                                <div for="module-35" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 35 - Thread Hijacking - Local Thread Creation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-36" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./36.html">
                                <div for="module-36" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 36 - Thread Hijacking - Remote Thread Creation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-37" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./37.html">
                                <div for="module-37" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 37 - Thread Hijacking - Local Thread Enumeration
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-38" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./38.html">
                                <div for="module-38" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 38 - Thread Hijacking - Remote Thread Enumeration
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-39" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./39.html">
                                <div for="module-39" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 39 - APC Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-40" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./40.html">
                                <div for="module-40" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 40 - Early Bird APC Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-41" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./41.html">
                                <div for="module-41" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 41 - Callback Code Execution
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-42" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./42.html">
                                <div for="module-42" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 42 - Local Mapping Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-43" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./43.html">
                                <div for="module-43" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 43 - Remote Mapping Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-44" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./44.html">
                                <div for="module-44" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 44 - Local Function Stomping Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-45" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./45.html">
                                <div for="module-45" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 45 - Remote Function Stomping Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-46" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./46.html">
                                <div for="module-46" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 46 - Payload Execution Control
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-47" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./47.html">
                                <div for="module-47" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 47 - Spoofing PPID
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-48" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./48.html">
                                <div for="module-48" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 48 - Process Argument Spoofing (1)
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-49" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./49.html">
                                <div for="module-49" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 49 - Process Argument Spoofing (2)
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-50" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./50.html">
                                <div for="module-50" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 50 - Parsing PE Headers
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-51" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./51.html">
                                <div for="module-51" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 51 - String Hashing
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-52" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./52.html">
                                <div for="module-52" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 52 - IAT Hiding &amp; Obfuscation - Introduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-53" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./53.html">
                                <div for="module-53" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 53 - IAT Hiding &amp; Obfuscation - Custom GetProcAddress
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-54" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./54.html">
                                <div for="module-54" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 54 - IAT Hiding &amp; Obfuscation - Custom GetModuleHandle
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-55" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./55.html">
                                <div for="module-55" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 55 - IAT Hiding &amp; Obfuscation - API Hashing
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-56" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./56.html">
                                <div for="module-56" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 56 - IAT Hiding &amp; Obfuscation - Custom Pseudo Handles
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-57" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./57.html">
                                <div for="module-57" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 57 - IAT Hiding &amp; Obfuscation - Compile Time API Hashing
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-58" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./58.html">
                                <div for="module-58" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 58 - API Hooking - Introduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-59" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./59.html">
                                <div for="module-59" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 59 - API Hooking - Detours Library
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-60" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./60.html">
                                <div for="module-60" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 60 - API Hooking - Minhook Library
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-61" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./61.html">
                                <div for="module-61" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 61 - API Hooking - Custom Code
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-62" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./62.html">
                                <div for="module-62" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 62 - API Hooking - Using Windows APIs
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-63" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./63.html">
                                <div for="module-63" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 63 - Syscalls - Introduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-64" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./64.html">
                                <div for="module-64" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 64 - Syscalls - Userland Hooking
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-65" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./65.html">
                                <div for="module-65" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 65 - Syscalls - SysWhispers
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-66" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./66.html">
                                <div for="module-66" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 66 - Syscalls - Hell's Gate
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-67" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./67.html">
                                <div for="module-67" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 67 - Syscalls - Reimplementing Classic Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-68" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./68.html">
                                <div for="module-68" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 68 - Syscalls - Reimplementing Mapping Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-69" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./69.html">
                                <div for="module-69" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 69 - Syscalls - Reimplementing APC Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-70" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./70.html">
                                <div for="module-70" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 70 - Anti-Analysis - Introduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-71" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./71.html">
                                <div for="module-71" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 71 - Anti-Debugging - Multiple Techniques
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-72" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./72.html">
                                <div for="module-72" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 72 - Anti-Debugging - Self-Deletion
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-73" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./73.html">
                                <div for="module-73" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 73 - Anti-Virtual Environments - Multiple Techniques
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-74" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./74.html">
                                <div for="module-74" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 74 - Anti-Virtual Environments - Multiple Delay Execution Techniques
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-75" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./75.html">
                                <div for="module-75" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 75 - Anti-Virtual Environments - API Hammering
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-76" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./76.html">
                                <div for="module-76" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 76 - Binary Entropy Reduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-77" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./77.html">
                                <div for="module-77" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 77 - Brute Force Decryption
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-78" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./78.html">
                                <div for="module-78" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 78 - MalDev Academy Tool - KeyGuard
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-79" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./79.html">
                                <div for="module-79" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 79 - CRT Library Removal &amp; Malware Compiling
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-80" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./80.html">
                                <div for="module-80" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 80 - IAT Camouflage
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-81" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./81.html">
                                <div for="module-81" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 81 - Bypassing AVs
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-82" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./82.html">
                                <div for="module-82" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 82 - Introduction To EDRs
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-83" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./83.html">
                                <div for="module-83" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 83 - NTDLL Unhooking - Introduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-84" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./84.html">
                                <div for="module-84" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 84 - NTDLL Unhooking - From Disk
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-85" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./85.html">
                                <div for="module-85" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 85 - NTDLL Unhooking - From KnownDlls Directory
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-86" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./86.html">
                                <div for="module-86" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 86 - NTDLL Unhooking - From a Suspended Process
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-87" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./87.html">
                                <div for="module-87" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 87 - NTDLL Unhooking - From a Web Server
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-88" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./88.html">
                                <div for="module-88" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 88 - Updating Hell's Gate
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-89" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./89.html">
                                <div for="module-89" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 89 - Indirect Syscalls - HellsHall
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-90" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./90.html">
                                <div for="module-90" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 90 - Block DLL Policy
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-91" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./91.html">
                                <div for="module-91" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 91 - Diving Into NtCreateUserProcess
                                </div>
                            </a>
                        </div>
                                                    </div>
                </div>
            </div>
        </div>
      </div>
      <div class="flex">
        <div class="flex flex-row flex-wrap justify-center items-center w-full bg-gray-700 border-r border-l border-gray-600 pl-4 pt-2 pb-2 rounded-bl rounded-br">
                        <div class="mr-2">
                <a data-target="_self" href="./17.html">
                    <button class="w-[100px] h-10 px-5 text-sm duration-150 text-white bg-blue-700 hover:bg-blue-800 rounded-lg focus:shadow-outline">Previous</button>
                </a>           
            </div>
                        <div class="mr-2">
                <a data-target="_self" href="../All Modules.html">
                    <button class="w-[100px] h-10 px-5 text-sm duration-150 text-white bg-blue-700 hover:bg-blue-800 rounded-lg focus:shadow-outline">Modules</button>
                </a>           
            </div>
                     
            <div class="my-2 mr-2">
            <form id="complete-module" action="./18/complete" method="POST">
            </form>
            <form id="uncomplete-module" action="./18#" method="POST">
            </form>
            </div>
           
                            <div class="mr-2">
                    <a data-target="_self" href="./19.html">
                        <button class="w-[100px] h-10 px-5 text-sm duration-150 text-white bg-blue-700 hover:bg-blue-800 rounded-lg focus:shadow-outline">Next</button>
                    </a>
                </div>
                    </div>
    </div>
    <input type="hidden" id="objectives-completed" value="17077">
</div>

<footer id="footer" class="text-gray-400 border-t-[1px] border-gray-700 bg-gray-900 body-font hidden">
    <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
      <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-gray-800 sm:py-2 sm:mt-0 mt-4"> 2025 Maldev Academy Inc.</p>
        <a href="https://twitter.com/maldevacademy" target="_blank" class="text-gray-500 hover:text-white ml-2">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 1200 1227" xmlns="http://www.w3.org/2000/svg">
            <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"></path>
          </svg>            
        </a>
      <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
        <a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
          Terms and Conditions
      </a></span><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
    </a></div><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
  </a></footer><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">        

        <script src="18_files/jquery-3.6.0.min.js"></script>
        <script src="18_files/bootstrap.min.js"></script>
        <script src="18_files/navbar.js"></script>
        <link rel="preload" as="style" href="18_files/app.12640c20.css"><link rel="modulepreload" href="18_files/app.2a52064d.js"><link rel="stylesheet" href="18_files/app.12640c20.css"><script type="module" src="18_files/app.2a52064d.js"></script>
<script src="18_files/moduleviewer.js"></script>


 
 
    
</a></body></html>