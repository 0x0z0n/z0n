<!DOCTYPE html>
<html class="dark" data-darkreader-mode="dynamic" data-darkreader-scheme="dark"><script type="text/javascript" src="9_files/inject.js"></script><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--user-agent" media="screen">@layer {
html {
    background-color: var(--darkreader-background-ffffff, #181a1b) !important;
}
html {
    color-scheme: dark !important;
}
iframe {
    color-scheme: dark !important;
}
html, body {
    background-color: var(--darkreader-background-ffffff, #181a1b);
}
html, body {
    border-color: var(--darkreader-border-4c4c4c, #736b5e);
    color: var(--darkreader-text-000000, #e8e6e3);
}
a {
    color: var(--darkreader-text-0040ff, #3391ff);
}
table {
    border-color: var(--darkreader-border-808080, #545b5e);
}
mark {
    color: var(--darkreader-text-000000, #e8e6e3);
}
::placeholder {
    color: var(--darkreader-text-a9a9a9, #b2aba1);
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: var(--darkreader-background-faffbd, #404400) !important;
    color: var(--darkreader-text-000000, #e8e6e3) !important;
}
* {
    scrollbar-color: var(--darkreader-background-b0b0b0, #454a4d) var(--darkreader-background-f1f1f1, #202324);
}
::selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
::-moz-selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
}</style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen">.jfk-bubble.gtx-bubble, .captcheck_answer_label > input + img, span#closed_text > img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] > #icon, img.Wirisformula, a[data-testid="headerMediumLogo"]>svg, .d2l-navigation-link-image-container, .d2l-iframe-loading-container {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-border-short] {
  border: var(--darkreader-inline-border-short) !important;
}
[data-darkreader-inline-border-bottom-short] {
  border-bottom: var(--darkreader-inline-border-bottom-short) !important;
}
[data-darkreader-inline-border-left-short] {
  border-left: var(--darkreader-inline-border-left-short) !important;
}
[data-darkreader-inline-border-right-short] {
  border-right: var(--darkreader-inline-border-right-short) !important;
}
[data-darkreader-inline-border-top-short] {
  border-top: var(--darkreader-inline-border-top-short) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--variables" media="screen">:root {
   --darkreader-neutral-background: var(--darkreader-background-ffffff, #181a1b);
   --darkreader-neutral-text: var(--darkreader-text-000000, #e8e6e3);
   --darkreader-selection-background: var(--darkreader-background-0060d4, #004daa);
   --darkreader-selection-text: var(--darkreader-text-ffffff, #e8e6e3);
}</style><style class="darkreader darkreader--root-vars" media="screen"></style>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie-edge">
        <link rel="stylesheet" href="9_files/template.css"><style class="darkreader darkreader--sync" media="screen"></style>
        <link rel="shortcut icon" href="https://maldevacademy.com/maldev-icon.png">
        <!-- fontawesome for icons -->
        <link rel="stylesheet" href="9_files/font-awesome.min.css"><style class="darkreader darkreader--cors" media="screen">.fa{display:inline-block;font:normal normal normal 14px/1 FontAwesome;font-size:inherit;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.fa-lg{font-size:1.33333333em;line-height:.75em;vertical-align:-15%}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-fw{width:1.28571429em;text-align:center}.fa-ul{padding-left:0;margin-left:2.14285714em;list-style-type:none}.fa-ul>li{position:relative}.fa-li{position:absolute;left:-2.14285714em;width:2.14285714em;top:.14285714em;text-align:center}.fa-li.fa-lg{left:-1.85714286em}.fa-border{padding:.2em .25em .15em;border:solid .08em #eee;border-radius:.1em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left{margin-right:.3em}.fa.fa-pull-right{margin-left:.3em}.pull-right{float:right}.pull-left{float:left}.fa.pull-left{margin-right:.3em}.fa.pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}.fa-pulse{-webkit-animation:fa-spin 1s infinite steps(8);animation:fa-spin 1s infinite steps(8)}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.fa-rotate-90{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";-webkit-transform:rotate(270deg);-ms-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";-webkit-transform:scale(-1, 1);-ms-transform:scale(-1, 1);transform:scale(-1, 1)}.fa-flip-vertical{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";-webkit-transform:scale(1, -1);-ms-transform:scale(1, -1);transform:scale(1, -1)}:root .fa-rotate-90,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-flip-horizontal,:root .fa-flip-vertical{filter:none}.fa-stack{position:relative;display:inline-block;width:2em;height:2em;line-height:2em;vertical-align:middle}.fa-stack-1x,.fa-stack-2x{position:absolute;left:0;width:100%;text-align:center}.fa-stack-1x{line-height:inherit}.fa-stack-2x{font-size:2em}.fa-inverse{color:#fff}.fa-glass:before{content:"\f000"}.fa-music:before{content:"\f001"}.fa-search:before{content:"\f002"}.fa-envelope-o:before{content:"\f003"}.fa-heart:before{content:"\f004"}.fa-star:before{content:"\f005"}.fa-star-o:before{content:"\f006"}.fa-user:before{content:"\f007"}.fa-film:before{content:"\f008"}.fa-th-large:before{content:"\f009"}.fa-th:before{content:"\f00a"}.fa-th-list:before{content:"\f00b"}.fa-check:before{content:"\f00c"}.fa-remove:before,.fa-close:before,.fa-times:before{content:"\f00d"}.fa-search-plus:before{content:"\f00e"}.fa-search-minus:before{content:"\f010"}.fa-power-off:before{content:"\f011"}.fa-signal:before{content:"\f012"}.fa-gear:before,.fa-cog:before{content:"\f013"}.fa-trash-o:before{content:"\f014"}.fa-home:before{content:"\f015"}.fa-file-o:before{content:"\f016"}.fa-clock-o:before{content:"\f017"}.fa-road:before{content:"\f018"}.fa-download:before{content:"\f019"}.fa-arrow-circle-o-down:before{content:"\f01a"}.fa-arrow-circle-o-up:before{content:"\f01b"}.fa-inbox:before{content:"\f01c"}.fa-play-circle-o:before{content:"\f01d"}.fa-rotate-right:before,.fa-repeat:before{content:"\f01e"}.fa-refresh:before{content:"\f021"}.fa-list-alt:before{content:"\f022"}.fa-lock:before{content:"\f023"}.fa-flag:before{content:"\f024"}.fa-headphones:before{content:"\f025"}.fa-volume-off:before{content:"\f026"}.fa-volume-down:before{content:"\f027"}.fa-volume-up:before{content:"\f028"}.fa-qrcode:before{content:"\f029"}.fa-barcode:before{content:"\f02a"}.fa-tag:before{content:"\f02b"}.fa-tags:before{content:"\f02c"}.fa-book:before{content:"\f02d"}.fa-bookmark:before{content:"\f02e"}.fa-print:before{content:"\f02f"}.fa-camera:before{content:"\f030"}.fa-font:before{content:"\f031"}.fa-bold:before{content:"\f032"}.fa-italic:before{content:"\f033"}.fa-text-height:before{content:"\f034"}.fa-text-width:before{content:"\f035"}.fa-align-left:before{content:"\f036"}.fa-align-center:before{content:"\f037"}.fa-align-right:before{content:"\f038"}.fa-align-justify:before{content:"\f039"}.fa-list:before{content:"\f03a"}.fa-dedent:before,.fa-outdent:before{content:"\f03b"}.fa-indent:before{content:"\f03c"}.fa-video-camera:before{content:"\f03d"}.fa-photo:before,.fa-image:before,.fa-picture-o:before{content:"\f03e"}.fa-pencil:before{content:"\f040"}.fa-map-marker:before{content:"\f041"}.fa-adjust:before{content:"\f042"}.fa-tint:before{content:"\f043"}.fa-edit:before,.fa-pencil-square-o:before{content:"\f044"}.fa-share-square-o:before{content:"\f045"}.fa-check-square-o:before{content:"\f046"}.fa-arrows:before{content:"\f047"}.fa-step-backward:before{content:"\f048"}.fa-fast-backward:before{content:"\f049"}.fa-backward:before{content:"\f04a"}.fa-play:before{content:"\f04b"}.fa-pause:before{content:"\f04c"}.fa-stop:before{content:"\f04d"}.fa-forward:before{content:"\f04e"}.fa-fast-forward:before{content:"\f050"}.fa-step-forward:before{content:"\f051"}.fa-eject:before{content:"\f052"}.fa-chevron-left:before{content:"\f053"}.fa-chevron-right:before{content:"\f054"}.fa-plus-circle:before{content:"\f055"}.fa-minus-circle:before{content:"\f056"}.fa-times-circle:before{content:"\f057"}.fa-check-circle:before{content:"\f058"}.fa-question-circle:before{content:"\f059"}.fa-info-circle:before{content:"\f05a"}.fa-crosshairs:before{content:"\f05b"}.fa-times-circle-o:before{content:"\f05c"}.fa-check-circle-o:before{content:"\f05d"}.fa-ban:before{content:"\f05e"}.fa-arrow-left:before{content:"\f060"}.fa-arrow-right:before{content:"\f061"}.fa-arrow-up:before{content:"\f062"}.fa-arrow-down:before{content:"\f063"}.fa-mail-forward:before,.fa-share:before{content:"\f064"}.fa-expand:before{content:"\f065"}.fa-compress:before{content:"\f066"}.fa-plus:before{content:"\f067"}.fa-minus:before{content:"\f068"}.fa-asterisk:before{content:"\f069"}.fa-exclamation-circle:before{content:"\f06a"}.fa-gift:before{content:"\f06b"}.fa-leaf:before{content:"\f06c"}.fa-fire:before{content:"\f06d"}.fa-eye:before{content:"\f06e"}.fa-eye-slash:before{content:"\f070"}.fa-warning:before,.fa-exclamation-triangle:before{content:"\f071"}.fa-plane:before{content:"\f072"}.fa-calendar:before{content:"\f073"}.fa-random:before{content:"\f074"}.fa-comment:before{content:"\f075"}.fa-magnet:before{content:"\f076"}.fa-chevron-up:before{content:"\f077"}.fa-chevron-down:before{content:"\f078"}.fa-retweet:before{content:"\f079"}.fa-shopping-cart:before{content:"\f07a"}.fa-folder:before{content:"\f07b"}.fa-folder-open:before{content:"\f07c"}.fa-arrows-v:before{content:"\f07d"}.fa-arrows-h:before{content:"\f07e"}.fa-bar-chart-o:before,.fa-bar-chart:before{content:"\f080"}.fa-twitter-square:before{content:"\f081"}.fa-facebook-square:before{content:"\f082"}.fa-camera-retro:before{content:"\f083"}.fa-key:before{content:"\f084"}.fa-gears:before,.fa-cogs:before{content:"\f085"}.fa-comments:before{content:"\f086"}.fa-thumbs-o-up:before{content:"\f087"}.fa-thumbs-o-down:before{content:"\f088"}.fa-star-half:before{content:"\f089"}.fa-heart-o:before{content:"\f08a"}.fa-sign-out:before{content:"\f08b"}.fa-linkedin-square:before{content:"\f08c"}.fa-thumb-tack:before{content:"\f08d"}.fa-external-link:before{content:"\f08e"}.fa-sign-in:before{content:"\f090"}.fa-trophy:before{content:"\f091"}.fa-github-square:before{content:"\f092"}.fa-upload:before{content:"\f093"}.fa-lemon-o:before{content:"\f094"}.fa-phone:before{content:"\f095"}.fa-square-o:before{content:"\f096"}.fa-bookmark-o:before{content:"\f097"}.fa-phone-square:before{content:"\f098"}.fa-twitter:before{content:"\f099"}.fa-facebook-f:before,.fa-facebook:before{content:"\f09a"}.fa-github:before{content:"\f09b"}.fa-unlock:before{content:"\f09c"}.fa-credit-card:before{content:"\f09d"}.fa-feed:before,.fa-rss:before{content:"\f09e"}.fa-hdd-o:before{content:"\f0a0"}.fa-bullhorn:before{content:"\f0a1"}.fa-bell:before{content:"\f0f3"}.fa-certificate:before{content:"\f0a3"}.fa-hand-o-right:before{content:"\f0a4"}.fa-hand-o-left:before{content:"\f0a5"}.fa-hand-o-up:before{content:"\f0a6"}.fa-hand-o-down:before{content:"\f0a7"}.fa-arrow-circle-left:before{content:"\f0a8"}.fa-arrow-circle-right:before{content:"\f0a9"}.fa-arrow-circle-up:before{content:"\f0aa"}.fa-arrow-circle-down:before{content:"\f0ab"}.fa-globe:before{content:"\f0ac"}.fa-wrench:before{content:"\f0ad"}.fa-tasks:before{content:"\f0ae"}.fa-filter:before{content:"\f0b0"}.fa-briefcase:before{content:"\f0b1"}.fa-arrows-alt:before{content:"\f0b2"}.fa-group:before,.fa-users:before{content:"\f0c0"}.fa-chain:before,.fa-link:before{content:"\f0c1"}.fa-cloud:before{content:"\f0c2"}.fa-flask:before{content:"\f0c3"}.fa-cut:before,.fa-scissors:before{content:"\f0c4"}.fa-copy:before,.fa-files-o:before{content:"\f0c5"}.fa-paperclip:before{content:"\f0c6"}.fa-save:before,.fa-floppy-o:before{content:"\f0c7"}.fa-square:before{content:"\f0c8"}.fa-navicon:before,.fa-reorder:before,.fa-bars:before{content:"\f0c9"}.fa-list-ul:before{content:"\f0ca"}.fa-list-ol:before{content:"\f0cb"}.fa-strikethrough:before{content:"\f0cc"}.fa-underline:before{content:"\f0cd"}.fa-table:before{content:"\f0ce"}.fa-magic:before{content:"\f0d0"}.fa-truck:before{content:"\f0d1"}.fa-pinterest:before{content:"\f0d2"}.fa-pinterest-square:before{content:"\f0d3"}.fa-google-plus-square:before{content:"\f0d4"}.fa-google-plus:before{content:"\f0d5"}.fa-money:before{content:"\f0d6"}.fa-caret-down:before{content:"\f0d7"}.fa-caret-up:before{content:"\f0d8"}.fa-caret-left:before{content:"\f0d9"}.fa-caret-right:before{content:"\f0da"}.fa-columns:before{content:"\f0db"}.fa-unsorted:before,.fa-sort:before{content:"\f0dc"}.fa-sort-down:before,.fa-sort-desc:before{content:"\f0dd"}.fa-sort-up:before,.fa-sort-asc:before{content:"\f0de"}.fa-envelope:before{content:"\f0e0"}.fa-linkedin:before{content:"\f0e1"}.fa-rotate-left:before,.fa-undo:before{content:"\f0e2"}.fa-legal:before,.fa-gavel:before{content:"\f0e3"}.fa-dashboard:before,.fa-tachometer:before{content:"\f0e4"}.fa-comment-o:before{content:"\f0e5"}.fa-comments-o:before{content:"\f0e6"}.fa-flash:before,.fa-bolt:before{content:"\f0e7"}.fa-sitemap:before{content:"\f0e8"}.fa-umbrella:before{content:"\f0e9"}.fa-paste:before,.fa-clipboard:before{content:"\f0ea"}.fa-lightbulb-o:before{content:"\f0eb"}.fa-exchange:before{content:"\f0ec"}.fa-cloud-download:before{content:"\f0ed"}.fa-cloud-upload:before{content:"\f0ee"}.fa-user-md:before{content:"\f0f0"}.fa-stethoscope:before{content:"\f0f1"}.fa-suitcase:before{content:"\f0f2"}.fa-bell-o:before{content:"\f0a2"}.fa-coffee:before{content:"\f0f4"}.fa-cutlery:before{content:"\f0f5"}.fa-file-text-o:before{content:"\f0f6"}.fa-building-o:before{content:"\f0f7"}.fa-hospital-o:before{content:"\f0f8"}.fa-ambulance:before{content:"\f0f9"}.fa-medkit:before{content:"\f0fa"}.fa-fighter-jet:before{content:"\f0fb"}.fa-beer:before{content:"\f0fc"}.fa-h-square:before{content:"\f0fd"}.fa-plus-square:before{content:"\f0fe"}.fa-angle-double-left:before{content:"\f100"}.fa-angle-double-right:before{content:"\f101"}.fa-angle-double-up:before{content:"\f102"}.fa-angle-double-down:before{content:"\f103"}.fa-angle-left:before{content:"\f104"}.fa-angle-right:before{content:"\f105"}.fa-angle-up:before{content:"\f106"}.fa-angle-down:before{content:"\f107"}.fa-desktop:before{content:"\f108"}.fa-laptop:before{content:"\f109"}.fa-tablet:before{content:"\f10a"}.fa-mobile-phone:before,.fa-mobile:before{content:"\f10b"}.fa-circle-o:before{content:"\f10c"}.fa-quote-left:before{content:"\f10d"}.fa-quote-right:before{content:"\f10e"}.fa-spinner:before{content:"\f110"}.fa-circle:before{content:"\f111"}.fa-mail-reply:before,.fa-reply:before{content:"\f112"}.fa-github-alt:before{content:"\f113"}.fa-folder-o:before{content:"\f114"}.fa-folder-open-o:before{content:"\f115"}.fa-smile-o:before{content:"\f118"}.fa-frown-o:before{content:"\f119"}.fa-meh-o:before{content:"\f11a"}.fa-gamepad:before{content:"\f11b"}.fa-keyboard-o:before{content:"\f11c"}.fa-flag-o:before{content:"\f11d"}.fa-flag-checkered:before{content:"\f11e"}.fa-terminal:before{content:"\f120"}.fa-code:before{content:"\f121"}.fa-mail-reply-all:before,.fa-reply-all:before{content:"\f122"}.fa-star-half-empty:before,.fa-star-half-full:before,.fa-star-half-o:before{content:"\f123"}.fa-location-arrow:before{content:"\f124"}.fa-crop:before{content:"\f125"}.fa-code-fork:before{content:"\f126"}.fa-unlink:before,.fa-chain-broken:before{content:"\f127"}.fa-question:before{content:"\f128"}.fa-info:before{content:"\f129"}.fa-exclamation:before{content:"\f12a"}.fa-superscript:before{content:"\f12b"}.fa-subscript:before{content:"\f12c"}.fa-eraser:before{content:"\f12d"}.fa-puzzle-piece:before{content:"\f12e"}.fa-microphone:before{content:"\f130"}.fa-microphone-slash:before{content:"\f131"}.fa-shield:before{content:"\f132"}.fa-calendar-o:before{content:"\f133"}.fa-fire-extinguisher:before{content:"\f134"}.fa-rocket:before{content:"\f135"}.fa-maxcdn:before{content:"\f136"}.fa-chevron-circle-left:before{content:"\f137"}.fa-chevron-circle-right:before{content:"\f138"}.fa-chevron-circle-up:before{content:"\f139"}.fa-chevron-circle-down:before{content:"\f13a"}.fa-html5:before{content:"\f13b"}.fa-css3:before{content:"\f13c"}.fa-anchor:before{content:"\f13d"}.fa-unlock-alt:before{content:"\f13e"}.fa-bullseye:before{content:"\f140"}.fa-ellipsis-h:before{content:"\f141"}.fa-ellipsis-v:before{content:"\f142"}.fa-rss-square:before{content:"\f143"}.fa-play-circle:before{content:"\f144"}.fa-ticket:before{content:"\f145"}.fa-minus-square:before{content:"\f146"}.fa-minus-square-o:before{content:"\f147"}.fa-level-up:before{content:"\f148"}.fa-level-down:before{content:"\f149"}.fa-check-square:before{content:"\f14a"}.fa-pencil-square:before{content:"\f14b"}.fa-external-link-square:before{content:"\f14c"}.fa-share-square:before{content:"\f14d"}.fa-compass:before{content:"\f14e"}.fa-toggle-down:before,.fa-caret-square-o-down:before{content:"\f150"}.fa-toggle-up:before,.fa-caret-square-o-up:before{content:"\f151"}.fa-toggle-right:before,.fa-caret-square-o-right:before{content:"\f152"}.fa-euro:before,.fa-eur:before{content:"\f153"}.fa-gbp:before{content:"\f154"}.fa-dollar:before,.fa-usd:before{content:"\f155"}.fa-rupee:before,.fa-inr:before{content:"\f156"}.fa-cny:before,.fa-rmb:before,.fa-yen:before,.fa-jpy:before{content:"\f157"}.fa-ruble:before,.fa-rouble:before,.fa-rub:before{content:"\f158"}.fa-won:before,.fa-krw:before{content:"\f159"}.fa-bitcoin:before,.fa-btc:before{content:"\f15a"}.fa-file:before{content:"\f15b"}.fa-file-text:before{content:"\f15c"}.fa-sort-alpha-asc:before{content:"\f15d"}.fa-sort-alpha-desc:before{content:"\f15e"}.fa-sort-amount-asc:before{content:"\f160"}.fa-sort-amount-desc:before{content:"\f161"}.fa-sort-numeric-asc:before{content:"\f162"}.fa-sort-numeric-desc:before{content:"\f163"}.fa-thumbs-up:before{content:"\f164"}.fa-thumbs-down:before{content:"\f165"}.fa-youtube-square:before{content:"\f166"}.fa-youtube:before{content:"\f167"}.fa-xing:before{content:"\f168"}.fa-xing-square:before{content:"\f169"}.fa-youtube-play:before{content:"\f16a"}.fa-dropbox:before{content:"\f16b"}.fa-stack-overflow:before{content:"\f16c"}.fa-instagram:before{content:"\f16d"}.fa-flickr:before{content:"\f16e"}.fa-adn:before{content:"\f170"}.fa-bitbucket:before{content:"\f171"}.fa-bitbucket-square:before{content:"\f172"}.fa-tumblr:before{content:"\f173"}.fa-tumblr-square:before{content:"\f174"}.fa-long-arrow-down:before{content:"\f175"}.fa-long-arrow-up:before{content:"\f176"}.fa-long-arrow-left:before{content:"\f177"}.fa-long-arrow-right:before{content:"\f178"}.fa-apple:before{content:"\f179"}.fa-windows:before{content:"\f17a"}.fa-android:before{content:"\f17b"}.fa-linux:before{content:"\f17c"}.fa-dribbble:before{content:"\f17d"}.fa-skype:before{content:"\f17e"}.fa-foursquare:before{content:"\f180"}.fa-trello:before{content:"\f181"}.fa-female:before{content:"\f182"}.fa-male:before{content:"\f183"}.fa-gittip:before,.fa-gratipay:before{content:"\f184"}.fa-sun-o:before{content:"\f185"}.fa-moon-o:before{content:"\f186"}.fa-archive:before{content:"\f187"}.fa-bug:before{content:"\f188"}.fa-vk:before{content:"\f189"}.fa-weibo:before{content:"\f18a"}.fa-renren:before{content:"\f18b"}.fa-pagelines:before{content:"\f18c"}.fa-stack-exchange:before{content:"\f18d"}.fa-arrow-circle-o-right:before{content:"\f18e"}.fa-arrow-circle-o-left:before{content:"\f190"}.fa-toggle-left:before,.fa-caret-square-o-left:before{content:"\f191"}.fa-dot-circle-o:before{content:"\f192"}.fa-wheelchair:before{content:"\f193"}.fa-vimeo-square:before{content:"\f194"}.fa-turkish-lira:before,.fa-try:before{content:"\f195"}.fa-plus-square-o:before{content:"\f196"}.fa-space-shuttle:before{content:"\f197"}.fa-slack:before{content:"\f198"}.fa-envelope-square:before{content:"\f199"}.fa-wordpress:before{content:"\f19a"}.fa-openid:before{content:"\f19b"}.fa-institution:before,.fa-bank:before,.fa-university:before{content:"\f19c"}.fa-mortar-board:before,.fa-graduation-cap:before{content:"\f19d"}.fa-yahoo:before{content:"\f19e"}.fa-google:before{content:"\f1a0"}.fa-reddit:before{content:"\f1a1"}.fa-reddit-square:before{content:"\f1a2"}.fa-stumbleupon-circle:before{content:"\f1a3"}.fa-stumbleupon:before{content:"\f1a4"}.fa-delicious:before{content:"\f1a5"}.fa-digg:before{content:"\f1a6"}.fa-pied-piper-pp:before{content:"\f1a7"}.fa-pied-piper-alt:before{content:"\f1a8"}.fa-drupal:before{content:"\f1a9"}.fa-joomla:before{content:"\f1aa"}.fa-language:before{content:"\f1ab"}.fa-fax:before{content:"\f1ac"}.fa-building:before{content:"\f1ad"}.fa-child:before{content:"\f1ae"}.fa-paw:before{content:"\f1b0"}.fa-spoon:before{content:"\f1b1"}.fa-cube:before{content:"\f1b2"}.fa-cubes:before{content:"\f1b3"}.fa-behance:before{content:"\f1b4"}.fa-behance-square:before{content:"\f1b5"}.fa-steam:before{content:"\f1b6"}.fa-steam-square:before{content:"\f1b7"}.fa-recycle:before{content:"\f1b8"}.fa-automobile:before,.fa-car:before{content:"\f1b9"}.fa-cab:before,.fa-taxi:before{content:"\f1ba"}.fa-tree:before{content:"\f1bb"}.fa-spotify:before{content:"\f1bc"}.fa-deviantart:before{content:"\f1bd"}.fa-soundcloud:before{content:"\f1be"}.fa-database:before{content:"\f1c0"}.fa-file-pdf-o:before{content:"\f1c1"}.fa-file-word-o:before{content:"\f1c2"}.fa-file-excel-o:before{content:"\f1c3"}.fa-file-powerpoint-o:before{content:"\f1c4"}.fa-file-photo-o:before,.fa-file-picture-o:before,.fa-file-image-o:before{content:"\f1c5"}.fa-file-zip-o:before,.fa-file-archive-o:before{content:"\f1c6"}.fa-file-sound-o:before,.fa-file-audio-o:before{content:"\f1c7"}.fa-file-movie-o:before,.fa-file-video-o:before{content:"\f1c8"}.fa-file-code-o:before{content:"\f1c9"}.fa-vine:before{content:"\f1ca"}.fa-codepen:before{content:"\f1cb"}.fa-jsfiddle:before{content:"\f1cc"}.fa-life-bouy:before,.fa-life-buoy:before,.fa-life-saver:before,.fa-support:before,.fa-life-ring:before{content:"\f1cd"}.fa-circle-o-notch:before{content:"\f1ce"}.fa-ra:before,.fa-resistance:before,.fa-rebel:before{content:"\f1d0"}.fa-ge:before,.fa-empire:before{content:"\f1d1"}.fa-git-square:before{content:"\f1d2"}.fa-git:before{content:"\f1d3"}.fa-y-combinator-square:before,.fa-yc-square:before,.fa-hacker-news:before{content:"\f1d4"}.fa-tencent-weibo:before{content:"\f1d5"}.fa-qq:before{content:"\f1d6"}.fa-wechat:before,.fa-weixin:before{content:"\f1d7"}.fa-send:before,.fa-paper-plane:before{content:"\f1d8"}.fa-send-o:before,.fa-paper-plane-o:before{content:"\f1d9"}.fa-history:before{content:"\f1da"}.fa-circle-thin:before{content:"\f1db"}.fa-header:before{content:"\f1dc"}.fa-paragraph:before{content:"\f1dd"}.fa-sliders:before{content:"\f1de"}.fa-share-alt:before{content:"\f1e0"}.fa-share-alt-square:before{content:"\f1e1"}.fa-bomb:before{content:"\f1e2"}.fa-soccer-ball-o:before,.fa-futbol-o:before{content:"\f1e3"}.fa-tty:before{content:"\f1e4"}.fa-binoculars:before{content:"\f1e5"}.fa-plug:before{content:"\f1e6"}.fa-slideshare:before{content:"\f1e7"}.fa-twitch:before{content:"\f1e8"}.fa-yelp:before{content:"\f1e9"}.fa-newspaper-o:before{content:"\f1ea"}.fa-wifi:before{content:"\f1eb"}.fa-calculator:before{content:"\f1ec"}.fa-paypal:before{content:"\f1ed"}.fa-google-wallet:before{content:"\f1ee"}.fa-cc-visa:before{content:"\f1f0"}.fa-cc-mastercard:before{content:"\f1f1"}.fa-cc-discover:before{content:"\f1f2"}.fa-cc-amex:before{content:"\f1f3"}.fa-cc-paypal:before{content:"\f1f4"}.fa-cc-stripe:before{content:"\f1f5"}.fa-bell-slash:before{content:"\f1f6"}.fa-bell-slash-o:before{content:"\f1f7"}.fa-trash:before{content:"\f1f8"}.fa-copyright:before{content:"\f1f9"}.fa-at:before{content:"\f1fa"}.fa-eyedropper:before{content:"\f1fb"}.fa-paint-brush:before{content:"\f1fc"}.fa-birthday-cake:before{content:"\f1fd"}.fa-area-chart:before{content:"\f1fe"}.fa-pie-chart:before{content:"\f200"}.fa-line-chart:before{content:"\f201"}.fa-lastfm:before{content:"\f202"}.fa-lastfm-square:before{content:"\f203"}.fa-toggle-off:before{content:"\f204"}.fa-toggle-on:before{content:"\f205"}.fa-bicycle:before{content:"\f206"}.fa-bus:before{content:"\f207"}.fa-ioxhost:before{content:"\f208"}.fa-angellist:before{content:"\f209"}.fa-cc:before{content:"\f20a"}.fa-shekel:before,.fa-sheqel:before,.fa-ils:before{content:"\f20b"}.fa-meanpath:before{content:"\f20c"}.fa-buysellads:before{content:"\f20d"}.fa-connectdevelop:before{content:"\f20e"}.fa-dashcube:before{content:"\f210"}.fa-forumbee:before{content:"\f211"}.fa-leanpub:before{content:"\f212"}.fa-sellsy:before{content:"\f213"}.fa-shirtsinbulk:before{content:"\f214"}.fa-simplybuilt:before{content:"\f215"}.fa-skyatlas:before{content:"\f216"}.fa-cart-plus:before{content:"\f217"}.fa-cart-arrow-down:before{content:"\f218"}.fa-diamond:before{content:"\f219"}.fa-ship:before{content:"\f21a"}.fa-user-secret:before{content:"\f21b"}.fa-motorcycle:before{content:"\f21c"}.fa-street-view:before{content:"\f21d"}.fa-heartbeat:before{content:"\f21e"}.fa-venus:before{content:"\f221"}.fa-mars:before{content:"\f222"}.fa-mercury:before{content:"\f223"}.fa-intersex:before,.fa-transgender:before{content:"\f224"}.fa-transgender-alt:before{content:"\f225"}.fa-venus-double:before{content:"\f226"}.fa-mars-double:before{content:"\f227"}.fa-venus-mars:before{content:"\f228"}.fa-mars-stroke:before{content:"\f229"}.fa-mars-stroke-v:before{content:"\f22a"}.fa-mars-stroke-h:before{content:"\f22b"}.fa-neuter:before{content:"\f22c"}.fa-genderless:before{content:"\f22d"}.fa-facebook-official:before{content:"\f230"}.fa-pinterest-p:before{content:"\f231"}.fa-whatsapp:before{content:"\f232"}.fa-server:before{content:"\f233"}.fa-user-plus:before{content:"\f234"}.fa-user-times:before{content:"\f235"}.fa-hotel:before,.fa-bed:before{content:"\f236"}.fa-viacoin:before{content:"\f237"}.fa-train:before{content:"\f238"}.fa-subway:before{content:"\f239"}.fa-medium:before{content:"\f23a"}.fa-yc:before,.fa-y-combinator:before{content:"\f23b"}.fa-optin-monster:before{content:"\f23c"}.fa-opencart:before{content:"\f23d"}.fa-expeditedssl:before{content:"\f23e"}.fa-battery-4:before,.fa-battery:before,.fa-battery-full:before{content:"\f240"}.fa-battery-3:before,.fa-battery-three-quarters:before{content:"\f241"}.fa-battery-2:before,.fa-battery-half:before{content:"\f242"}.fa-battery-1:before,.fa-battery-quarter:before{content:"\f243"}.fa-battery-0:before,.fa-battery-empty:before{content:"\f244"}.fa-mouse-pointer:before{content:"\f245"}.fa-i-cursor:before{content:"\f246"}.fa-object-group:before{content:"\f247"}.fa-object-ungroup:before{content:"\f248"}.fa-sticky-note:before{content:"\f249"}.fa-sticky-note-o:before{content:"\f24a"}.fa-cc-jcb:before{content:"\f24b"}.fa-cc-diners-club:before{content:"\f24c"}.fa-clone:before{content:"\f24d"}.fa-balance-scale:before{content:"\f24e"}.fa-hourglass-o:before{content:"\f250"}.fa-hourglass-1:before,.fa-hourglass-start:before{content:"\f251"}.fa-hourglass-2:before,.fa-hourglass-half:before{content:"\f252"}.fa-hourglass-3:before,.fa-hourglass-end:before{content:"\f253"}.fa-hourglass:before{content:"\f254"}.fa-hand-grab-o:before,.fa-hand-rock-o:before{content:"\f255"}.fa-hand-stop-o:before,.fa-hand-paper-o:before{content:"\f256"}.fa-hand-scissors-o:before{content:"\f257"}.fa-hand-lizard-o:before{content:"\f258"}.fa-hand-spock-o:before{content:"\f259"}.fa-hand-pointer-o:before{content:"\f25a"}.fa-hand-peace-o:before{content:"\f25b"}.fa-trademark:before{content:"\f25c"}.fa-registered:before{content:"\f25d"}.fa-creative-commons:before{content:"\f25e"}.fa-gg:before{content:"\f260"}.fa-gg-circle:before{content:"\f261"}.fa-tripadvisor:before{content:"\f262"}.fa-odnoklassniki:before{content:"\f263"}.fa-odnoklassniki-square:before{content:"\f264"}.fa-get-pocket:before{content:"\f265"}.fa-wikipedia-w:before{content:"\f266"}.fa-safari:before{content:"\f267"}.fa-chrome:before{content:"\f268"}.fa-firefox:before{content:"\f269"}.fa-opera:before{content:"\f26a"}.fa-internet-explorer:before{content:"\f26b"}.fa-tv:before,.fa-television:before{content:"\f26c"}.fa-contao:before{content:"\f26d"}.fa-500px:before{content:"\f26e"}.fa-amazon:before{content:"\f270"}.fa-calendar-plus-o:before{content:"\f271"}.fa-calendar-minus-o:before{content:"\f272"}.fa-calendar-times-o:before{content:"\f273"}.fa-calendar-check-o:before{content:"\f274"}.fa-industry:before{content:"\f275"}.fa-map-pin:before{content:"\f276"}.fa-map-signs:before{content:"\f277"}.fa-map-o:before{content:"\f278"}.fa-map:before{content:"\f279"}.fa-commenting:before{content:"\f27a"}.fa-commenting-o:before{content:"\f27b"}.fa-houzz:before{content:"\f27c"}.fa-vimeo:before{content:"\f27d"}.fa-black-tie:before{content:"\f27e"}.fa-fonticons:before{content:"\f280"}.fa-reddit-alien:before{content:"\f281"}.fa-edge:before{content:"\f282"}.fa-credit-card-alt:before{content:"\f283"}.fa-codiepie:before{content:"\f284"}.fa-modx:before{content:"\f285"}.fa-fort-awesome:before{content:"\f286"}.fa-usb:before{content:"\f287"}.fa-product-hunt:before{content:"\f288"}.fa-mixcloud:before{content:"\f289"}.fa-scribd:before{content:"\f28a"}.fa-pause-circle:before{content:"\f28b"}.fa-pause-circle-o:before{content:"\f28c"}.fa-stop-circle:before{content:"\f28d"}.fa-stop-circle-o:before{content:"\f28e"}.fa-shopping-bag:before{content:"\f290"}.fa-shopping-basket:before{content:"\f291"}.fa-hashtag:before{content:"\f292"}.fa-bluetooth:before{content:"\f293"}.fa-bluetooth-b:before{content:"\f294"}.fa-percent:before{content:"\f295"}.fa-gitlab:before{content:"\f296"}.fa-wpbeginner:before{content:"\f297"}.fa-wpforms:before{content:"\f298"}.fa-envira:before{content:"\f299"}.fa-universal-access:before{content:"\f29a"}.fa-wheelchair-alt:before{content:"\f29b"}.fa-question-circle-o:before{content:"\f29c"}.fa-blind:before{content:"\f29d"}.fa-audio-description:before{content:"\f29e"}.fa-volume-control-phone:before{content:"\f2a0"}.fa-braille:before{content:"\f2a1"}.fa-assistive-listening-systems:before{content:"\f2a2"}.fa-asl-interpreting:before,.fa-american-sign-language-interpreting:before{content:"\f2a3"}.fa-deafness:before,.fa-hard-of-hearing:before,.fa-deaf:before{content:"\f2a4"}.fa-glide:before{content:"\f2a5"}.fa-glide-g:before{content:"\f2a6"}.fa-signing:before,.fa-sign-language:before{content:"\f2a7"}.fa-low-vision:before{content:"\f2a8"}.fa-viadeo:before{content:"\f2a9"}.fa-viadeo-square:before{content:"\f2aa"}.fa-snapchat:before{content:"\f2ab"}.fa-snapchat-ghost:before{content:"\f2ac"}.fa-snapchat-square:before{content:"\f2ad"}.fa-pied-piper:before{content:"\f2ae"}.fa-first-order:before{content:"\f2b0"}.fa-yoast:before{content:"\f2b1"}.fa-themeisle:before{content:"\f2b2"}.fa-google-plus-circle:before,.fa-google-plus-official:before{content:"\f2b3"}.fa-fa:before,.fa-font-awesome:before{content:"\f2b4"}.fa-handshake-o:before{content:"\f2b5"}.fa-envelope-open:before{content:"\f2b6"}.fa-envelope-open-o:before{content:"\f2b7"}.fa-linode:before{content:"\f2b8"}.fa-address-book:before{content:"\f2b9"}.fa-address-book-o:before{content:"\f2ba"}.fa-vcard:before,.fa-address-card:before{content:"\f2bb"}.fa-vcard-o:before,.fa-address-card-o:before{content:"\f2bc"}.fa-user-circle:before{content:"\f2bd"}.fa-user-circle-o:before{content:"\f2be"}.fa-user-o:before{content:"\f2c0"}.fa-id-badge:before{content:"\f2c1"}.fa-drivers-license:before,.fa-id-card:before{content:"\f2c2"}.fa-drivers-license-o:before,.fa-id-card-o:before{content:"\f2c3"}.fa-quora:before{content:"\f2c4"}.fa-free-code-camp:before{content:"\f2c5"}.fa-telegram:before{content:"\f2c6"}.fa-thermometer-4:before,.fa-thermometer:before,.fa-thermometer-full:before{content:"\f2c7"}.fa-thermometer-3:before,.fa-thermometer-three-quarters:before{content:"\f2c8"}.fa-thermometer-2:before,.fa-thermometer-half:before{content:"\f2c9"}.fa-thermometer-1:before,.fa-thermometer-quarter:before{content:"\f2ca"}.fa-thermometer-0:before,.fa-thermometer-empty:before{content:"\f2cb"}.fa-shower:before{content:"\f2cc"}.fa-bathtub:before,.fa-s15:before,.fa-bath:before{content:"\f2cd"}.fa-podcast:before{content:"\f2ce"}.fa-window-maximize:before{content:"\f2d0"}.fa-window-minimize:before{content:"\f2d1"}.fa-window-restore:before{content:"\f2d2"}.fa-times-rectangle:before,.fa-window-close:before{content:"\f2d3"}.fa-times-rectangle-o:before,.fa-window-close-o:before{content:"\f2d4"}.fa-bandcamp:before{content:"\f2d5"}.fa-grav:before{content:"\f2d6"}.fa-etsy:before{content:"\f2d7"}.fa-imdb:before{content:"\f2d8"}.fa-ravelry:before{content:"\f2d9"}.fa-eercast:before{content:"\f2da"}.fa-microchip:before{content:"\f2db"}.fa-snowflake-o:before{content:"\f2dc"}.fa-superpowers:before{content:"\f2dd"}.fa-wpexplorer:before{content:"\f2de"}.fa-meetup:before{content:"\f2e0"}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.sr-only-focusable:active,.sr-only-focusable:focus{position:static;width:auto;height:auto;margin:0;overflow:visible;clip:auto}</style><style class="darkreader darkreader--sync" media="screen"></style>
        <!-- google fonts -->
        <link rel="preconnect" href="https://fonts.gstatic.com/">
        <link href="9_files/css2.css" rel="stylesheet">
        <link href="9_files/css2_002.css" rel="stylesheet">
        <title>Utilizing Hardware Breakpoints For Hooking (1)</title>
        <!-- Custom css files, order matters -->
        <link rel="preload" as="style" href="9_files/app-CuOUn2oZ.css"><link rel="stylesheet" href="9_files/app-CuOUn2oZ.css"><style class="darkreader darkreader--sync" media="screen"></style><link href="9_files/prism-coldark-dark.css" rel="stylesheet"><style class="darkreader darkreader--sync" media="screen"></style>

<link rel="stylesheet" href="9_files/viewer.css"><style class="darkreader darkreader--sync" media="screen"></style>
    <meta name="darkreader" content="6fd2f9bf1c62446a993a6e8539e7153f"><style class="darkreader darkreader--override" media="screen">.vimvixen-hint {
    background-color: var(--darkreader-background-ffd76e, #684b00) !important;
    border-color: var(--darkreader-background-c59d00, #9e7e00) !important;
    color: var(--darkreader-text-302505, #d7d4cf) !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: var(--darkreader-background-add8e6, #1b4958) !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: var(--darkreader-background-cfecf5, #0f3a47) !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: var(--darkreader-background-f5f5f5, #1e2021) !important;
}
.tou-uknfeu {
    background-color: var(--darkreader-background-faedda, #432c09) !important;
}
.tou-6i3zyv {
    background-color: var(--darkreader-background-85c3d8, #245d70) !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
mitid-authenticators-code-app > .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
select {
    --darkreader-bg--form-control-background-color: rgba(22, 22, 22, 0) !important;
}
select * {
    background-color: var(--darkreader-neutral-background) !important;
}
body#tumblr {
    --darkreader-bg--secondary-accent: 31, 32, 34 !important;
    --darkreader-bg--white: 23, 23, 23 !important;
    --darkreader-text--black: 228, 224, 218 !important;
}
:host {
    --d2l-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-button-icon-background-color-hover: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-color-ferrite: var(--darkreader-neutral-text) !important;
    --d2l-color-sylvite: var(--darkreader-bg--d2l-color-sylvite) !important;
    --d2l-dropdown-background-color: var(--darkreader-neutral-background) !important;
    --d2l-dropdown-border-color: var(--darkreader-border--d2l-color-mica) !important;
    --d2l-input-backgroud-color: var(--darkreader-neutral-background) !important;
    --d2l-menu-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-tooltip-background-color: var(--darkreader-neutral-background) !important;
    --d2l-tooltip-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
:host([_floating]) .d2l-floating-buttons-container {
    background-color: var(--darkreader-neutral-background) !important;
    border-top-color: var(--darkreader-border--d2l-color-mica) !important;
    opacity: 0.88 !important;
}
d2l-card {
    background: var(--darkreader-neutral-background) !important;
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
d2l-dropdown-content > div,
d2l-menu-item {
    background-color: var(--darkreader-neutral-background) !important;
    border-radius: 10px !important;
}
d2l-empty-state-simple {
    border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-button-filter > ul > li > a.vui-button {
    border-color: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-label-text:has(.d2l-button-subtle-content):hover,
.d2l-label-text:has(.d2l-button-subtle-content):focus,
.d2l-label-text:has(.d2l-button-subtle-content):active {
    background-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-navigation-centerer {
    color: inherit !important;
}
.d2l-tabs-layout {
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
.d2l-input,
.d2l-calendar-date,
.d2l-htmleditor-container {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-collapsible-panel {
    border: 1px solid var(--darkreader-border--d2l-color-mica) !important;
    border-radius: 0.4rem !important;
}
.d2l-collapsible-panel-divider {
    border-bottom: 1px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-w2d-flex {
    border-bottom: 2px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-collapsible-panel scrolled,
.d2l-collapsible-panel-header,
.d2l-w2d-collection-fixed {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-loading-spinner-bg {
    fill: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-loading-spinner-bg-stroke {
    stroke: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-loading-spinner-wrapper svg path,
.d2l-loading-spinner-wrapper svg circle {
    fill: var(--darkreader-neutral-background) !important;
}
embed[type="application/pdf"] { filter: invert(100%) contrast(90%); }</style><style>.base-arrow-GfAHTK {
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAyCAYAAACtd6CrAAAACXBIWXMAAC4jAAAuIwF4pT92AAAC9ElEQVR4nL2YSWtUQRSFS23nhRsXgmsFE/+AmwRFURQnRMURdSMSp2iCnXQwA3ZMSIKJRMRNHFDEefaXqP/An2Ack/Yc320pz+skPdx44TSv3ynq49Z7r+pWZerr1qwLIdyFVkA3oPYPHz8VwixEBroDrbL/WWjZ2vq6ptkAErZS7p2CJgE84w0k7BZ0Qe43QQUAz3oCCWuFlkNHxTsNTQDY7AXMoCMO2Qlcz4GOiH8OIqjZBcYfAJnBcVzOgw5Km/PwJtCmxQUWATmUzPCAtLsIr4A2rS4wAc6F9kvbFssw6wIz4C90ejgkGe4T+5Jl2OYCi4CHQvIM94idhTeJNjkXWATks3sE7Ra73TLscIEZ8Cc65bN7DO0SO2fPsNMFJsAn0A6xL9uQdrvADPgDne7F5VNou9hdNqQ9LjABPoO2id1tQ5p3gRnwOzrl2/kc2ir2Fcuw1wUmwBfQFrHzlmG/C8yA39ApP4eX0Gax+ww46AIT4Ctok9gDNqRDLjADfkWnO3H5Gtoo9qBlOOwCE+AbaIPY1yzDEReYAcfRKb+/t9D6EkBmOOoCE+A7qDGyuHpchzfuBjPgF3TKD/491CDAq66wmcIVhqyWhmQYG8Ri0dTmBgNoSUjeyEaxCGL9OeYCi0D6JjJYd47yomYYQItDMovoN1YEjRT/1ASLQDp7MFri2aMmGECLQjLz67zIaNV5sWpYBNIZn5EtNeNXBQNoYUhWa13LGLmp1rKKYRFIV2lGx3SrdEUwgBaEpMLS+oPROVP9UTYsAmllxegqp7IqCwbQ/JBUxVozMnrKrRlnhEUgrYYZ+Uqq4WlhANF7GNJ1PqO30jp/SpiBHoT0DobRV80OpiTMQPdDem/G6K92b5aCAcT92L2Q3nUyBmvZdf4Di0C6n2YM1bqf/gsz0O2QPilgDHucFPyBAcTN+lhIn4EwuBbp6U/1MGggpE93GFxd3U53irCTJe7zKND13KoI+wytju7dhNxP5IqwY+E/HW7+BpJoVXj80aQPAAAAAElFTkSuQmCC);
  width: 16px;
  height: 16px;
  position: absolute;
  top: 16px;
  left: 16px;
  cursor: pointer;
  background-size: contain;
  background-repeat: no-repeat;
}
.base-navigation-tab-Ahvn3N {
  width: 24px;
  height: 24px;
  background-position: center;
  background-repeat: no-repeat;
  background-size: contain;
}
.base-navigation-label-vUENtU {
  font-family: 'Inter', sans-serif;
  font-size: 13px;
  line-height: 18px;
  color: rgba(0, 0, 0, 0.87);
}
.shoop-de-tooltip-rXf0XP {
  position: relative;
}
.shoop-de-tooltip__text-block-VXptk_ {
  height: 136px;
  background: #e35144;
  position: absolute;
  top: -148px;
  width: 302px;
  padding: 16px;
  border-radius: 8px;
  font-family: 'Inter', sans-serif;
  font-style: normal;
  font-size: 15px;
  line-height: 21px;
  font-weight: normal;
  letter-spacing: -0.24px;
  color: #FFF;
  display: flex;
  align-items: flex-end;
}
.shoop-de-tooltip__polygon-a7JmmB {
  position: absolute;
  width: 15px;
  height: 15px;
  top: -20px;
  left: 17px;
  border-radius: 2px;
  transform: rotate(45deg);
  background: #e35144;
}
</style><style class="darkreader darkreader--sync" media="screen"></style><style>.shoop-de-serp-beA_vX {
  z-index: 999999999999;
  width: max-content;
  font-size: 15px;
  line-height: 21px;
  font-weight: bold;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  cursor: pointer;
}
.shoop-de-serp-beA_vX:hover .shoop-de-serp__tooltip-jznGdA {
  opacity: 1;
}
.shoop-de-serp__logo-VNEyj1 {
  width: 30px;
  height: 20px;
  background: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yOC42NTg4IDYuNjUwMjFDMjMuODkxIDYuNjUwMjEgMTkuODUyMyA5Ljc3MTY0IDE4LjQ3NDggMTQuMDgyNEMxNi41NjQ4IDEyLjI5OSAxNC4wMDA0IDExLjIwNzUgMTEuMTgxMSAxMS4yMDc1QzUuMjc3NSAxMS4yMDc1IDAuNDkxNzkgMTUuOTkzMiAwLjQ5MTc5IDIxLjg5NjhDMC40OTE3OSAyNy44MDA0IDUuMjc3NSAzMi41ODYxIDExLjE4MTEgMzIuNTg2MUMxNS45NDg5IDMyLjU4NjEgMTkuOTg3NiAyOS40NjQ2IDIxLjM2NTEgMjUuMTUzOEMyMy4yNzUgMjYuOTM3MyAyNS44Mzk0IDI4LjAyODggMjguNjU4OCAyOC4wMjg4QzM0LjU2MjQgMjguMDI4OCAzOS4zNDgxIDIzLjI0MzEgMzkuMzQ4MSAxNy4zMzk1QzM5LjM0ODEgMTEuNDM1OSAzNC41NjI0IDYuNjUwMjEgMjguNjU4OCA2LjY1MDIxWk0yOC42NTg4IDIyLjI5NTJDMjUuOTIxNyAyMi4yOTUyIDIzLjcwMzEgMjAuMDc2NiAyMy43MDMxIDE3LjMzOTVDMjMuNzAzMSAxNC42MDI0IDI1LjkyMTcgMTIuMzgzOCAyOC42NTg4IDEyLjM4MzhDMzEuMzk1OSAxMi4zODM4IDMzLjYxNDUgMTQuNjAyNCAzMy42MTQ1IDE3LjMzOTVDMzMuNjE0NSAyMC4wNzY2IDMxLjM5NTkgMjIuMjk1MiAyOC42NTg4IDIyLjI5NTJaTTExLjE4MTEgMjYuODUyNUM4LjQ0MzkzIDI2Ljg1MjUgNi4yMjUzNiAyNC42MzM5IDYuMjI1MzYgMjEuODk2OEM2LjIyNTM2IDE5LjE1OTYgOC40NDM5MyAxNi45NDExIDExLjE4MTEgMTYuOTQxMUMxMy45MTgyIDE2Ljk0MTEgMTYuMTM2OCAxOS4xNTk2IDE2LjEzNjggMjEuODk2OEMxNi4xMzY4IDI0LjYzMzkgMTMuOTE4MiAyNi44NTI1IDExLjE4MTEgMjYuODUyNVoiIGZpbGw9IiMxRDdCQ0UiLz4KPC9zdmc+Cg==) no-repeat;
  background-size: contain;
}
.shoop-de-serp__premium-ZDFq9y {
  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTggMC42NjY2NTZDNy4wNjAyNyAwLjY2NjY1NiA2LjI4NTcxIDEuNDU3MzUgNi4yODU3MSAyLjQxNjY2QzYuMjg1NzEgMy4wNzI5MSA2LjY0NzMyIDMuNjQ5NCA3LjE3ODU3IDMuOTQ3OTFMNS41IDcuMzc0OTlMMi44NzUgNS40NjA5M0MzLjIxODc1IDUuMTM5NjQgMy40Mjg1NyA0LjY3NDc5IDMuNDI4NTcgNC4xNjY2NkMzLjQyODU3IDMuMjA3MzUgMi42NTQwMiAyLjQxNjY2IDEuNzE0MjkgMi40MTY2NkMwLjc3NDU1NCAyLjQxNjY2IDAgMy4yMDczNSAwIDQuMTY2NjZDMCA0Ljk1Mjc5IDAuNTI5MDE4IDUuNjA2NzYgMS4yMzIxNCA1LjgyNTUxTDIuMjg1NzEgMTEuNzVWMTQuNjY2N0gxMy43MTQzVjExLjc1TDE0Ljc2NzkgNS44MjU1MUMxNS40NzEgNS42MDY3NiAxNiA0Ljk1Mjc5IDE2IDQuMTY2NjZDMTYgMy4yMDczNSAxNS4yMjU0IDIuNDE2NjYgMTQuMjg1NyAyLjQxNjY2QzEzLjM0NiAyLjQxNjY2IDEyLjU3MTQgMy4yMDczNSAxMi41NzE0IDQuMTY2NjZDMTIuNTcxNCA0LjY3NDc5IDEyLjc4MTMgNS4xMzk2NCAxMy4xMjUgNS40NjA5M0wxMC41IDcuMzc0OTlMOC44MjE0MyAzLjk0NzkxQzkuMzUyNjggMy42NDk0IDkuNzE0MjkgMy4wNzI5MSA5LjcxNDI5IDIuNDE2NjZDOS43MTQyOSAxLjQ1NzM1IDguOTM5NzMgMC42NjY2NTYgOCAwLjY2NjY1NlpNOCAxLjgzMzMyQzguMzIxNDMgMS44MzMzMiA4LjU3MTQzIDIuMDg4NTMgOC41NzE0MyAyLjQxNjY2QzguNTcxNDMgMi43NDQ3OCA4LjMyMTQzIDIuOTk5OTkgOCAyLjk5OTk5QzcuNjc4NTcgMi45OTk5OSA3LjQyODU3IDIuNzQ0NzggNy40Mjg1NyAyLjQxNjY2QzcuNDI4NTcgMi4wODg1MyA3LjY3ODU3IDEuODMzMzIgOCAxLjgzMzMyWk0xLjcxNDI5IDMuNTgzMzJDMi4wMzU3MSAzLjU4MzMyIDIuMjg1NzEgMy44Mzg1MyAyLjI4NTcxIDQuMTY2NjZDMi4yODU3MSA0LjQ5NDc4IDIuMDM1NzEgNC43NDk5OSAxLjcxNDI5IDQuNzQ5OTlDMS4zOTI4NiA0Ljc0OTk5IDEuMTQyODYgNC40OTQ3OCAxLjE0Mjg2IDQuMTY2NjZDMS4xNDI4NiAzLjgzODUzIDEuMzkyODYgMy41ODMzMiAxLjcxNDI5IDMuNTgzMzJaTTE0LjI4NTcgMy41ODMzMkMxNC42MDcxIDMuNTgzMzIgMTQuODU3MSAzLjgzODUzIDE0Ljg1NzEgNC4xNjY2NkMxNC44NTcxIDQuNDk0NzggMTQuNjA3MSA0Ljc0OTk5IDE0LjI4NTcgNC43NDk5OUMxMy45NjQzIDQuNzQ5OTkgMTMuNzE0MyA0LjQ5NDc4IDEzLjcxNDMgNC4xNjY2NkMxMy43MTQzIDMuODM4NTMgMTMuOTY0MyAzLjU4MzMyIDE0LjI4NTcgMy41ODMzMlpNOCA0Ljg5NTgyTDkuNzY3ODYgOC41MDUyTDEwLjYyNSA4LjcyMzk1TDEzLjQ4MjEgNi42NDU4MkwxMi42Nzg2IDExLjE2NjdIMy4zMjE0M0wyLjUxNzg2IDYuNjQ1ODJMNS4zNzUgOC43MjM5NUw2LjIzMjE0IDguNTA1Mkw4IDQuODk1ODJaTTMuNDI4NTcgMTIuMzMzM0gxMi41NzE0VjEzLjVIMy40Mjg1N1YxMi4zMzMzWiIgZmlsbD0iIzYwNDVFMiIvPgo8L3N2Zz4K);
  width: 16px;
  height: 16px;
  margin-right: 10px;
}
.shoop-de-serp__description-pzXVxP {
  color: #1D7BCE;
  font-weight: 600;
}
.shoop-de-serp__container-HDQc_M {
  display: flex;
  width: 100%;
}
</style><style class="darkreader darkreader--sync" media="screen"></style><meta name="shoop-toolbar" version="3.2.17.2"></head>
    <body>
        <nav id="navbar" class="w-full px-2 sm:px-0 z-40
    bg-[#101926] backdrop-blur-md sticky backdrop-saturate-150 border-b border-gray-700/50
     hidden">

    <div class="container flex flex-wrap md:flex-nowrap justify-between mx-auto">
      <a data-target="_self" href="https://maldevacademy.com/" class="flex items-center">
        <div class="main-logo flex flex-row items-center block sm:block md:hidden lg:block">
            <img class="w-[100px] h-[60px]" src="9_files/maldev-navbar-logo.svg" alt="Logo">   
        </div>
      </a>
      <button data-collapse-toggle="navbar-default" id="navbar-phone-btn" type="button" class="inline-flex items-center p-2 ml-3 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false">
        <span class="sr-only">Open main menu</span>
        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill=""><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
      </button>
      <div class="hidden w-full md:block md:w-auto items-center" id="navbar-default">
        <ul class="flex flex-col items-center p-4 mt-4 rounded-lg border md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium md:border-0 dark:border-gray-900">
          <li>
            <a data-target="_self" href="https://maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Home</a>
          </li>

          <li>
            <a data-target="_self" href="https://maldevacademy.com/tools" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Public Tools</a>
          </li>

          <li>
            <a data-target="_self" href="https://maldevacademy.com/faq" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">FAQ</a>
          </li>

          <li>
            <a data-target="_self" target="_blank" href="https://search.maldevacademy.com/" class="block py-2 pr-4 pl-3 text-gray-400 md:p-0">Maldev Database</a>
          </li>
                              <div class="group relative">
            <button id="profileNavBar" onclick="toggleProfileDropdown()" class="flex items-center justify-between w-full py-2 pl-3 pr-4 rounded md:border-0 md:p-0 md:w-auto text-gray-400">
              Account
              <svg class="w-2.5 h-2.5 ml-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4" style="--darkreader-inline-stroke: currentColor;" data-darkreader-inline-stroke=""></path>
              </svg>
            </button>
            <div id="profileDropdown" class="md:absolute hidden md:left-0 md:font-normal md:bg-white md:divide-y md:divide-gray-100 md:rounded-lg md:shadow md:w-44 md:dark:bg-gray-800 border-[1px] dark:border-gray-700 z-20">
              <ul class="py-2 text-sm text-gray-700 dark:text-gray-400">
                <li>
                  <a href="https://maldevacademy.com/profile" class="block px-4 py-2  hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" target="_blank">Profile</a>
                </li>
                <li>
                <form action="https://maldevacademy.com/logout" method="POST" class="">
                </form>
                </li>
              </ul>
            </div>
          </div>
                                        <li class="mt-4 md:mt-0">
            <a data-target="_self" href="https://maldevacademy.com/dashboard" class="text-white bg-blue-600/90 hover:bg-blue-500/80 border border-blue-400/40 shadow-md font-medium rounded-lg text-sm px-5 py-2.5 text-center md:mr-3 mr-0 transition-all duration-200 backdrop-blur-sm backdrop-saturate-150">
              Dashboard
            </a>
          </li>
                  </ul>
      </div>
    </div>
      </nav>        <template id="app-template">
  
  <div class="fixed bottom-4 right-5 bg-gray-900 text-white text-sm font-bold rounded-xl px-2 py-2 shadow-lg cursor-pointer z-20" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">
      <img src="9_files/module-up.svg" width="20px" alt="">
  </div>

  <div class="bg-[#101926] p-4">
      
      <div class="flex relative z-10">
    <input type="hidden" value="20973">
    <div class="md:flex-row flex-col flex md:items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-l border-t border-gray-600/60 pl-4 pt-2 pb-2 rounded-tl-xl">
        <div>
            Module 9 - Utilizing Hardware Breakpoints For Hooking (1)
        </div>
        <div class="ml-2 w-4 h-4 rounded-full shadow-inner bg-rose-500/90 ring-1 ring-rose-400/50"></div>

    </div>
    <div class="flex justify-end items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 pr-4 pt-2 pb-2 rounded-tr-xl border-t border-r border-gray-600/60">
        <div class="progress-container pr-4">
        <img src="9_file#.svg" onclick="toggleProgress()" id="progressToggle" width="20" alt="Progress Toggle" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="enlarge-container pr-4">
        <img src="9_files/enlarge.svg" onclick="toggleScreenWidth()" id="enlargeToggle" width="20" alt="Screen Width" class="hover:bg-gray-600 rounded-sm cursor-pointer">
        </div>

        <div class="objectives-container pr-4">
        <img src="9_files/objectives.svg" onclick="toggleObjectives()" id="objectivesToggle" width="20" alt="Objectives" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="toc-container pr-4">
        <img src="9_files/toc.svg" onclick="toggleToC()" id="tocToggle" width="20" alt="ToC" class="hover:bg-gray-600 rounded-sm cursor-pointer bg-gray-600">
        </div>

        <div class="terminal-container  pr-4 ">
        <img src="9_files/ide.svg" onclick="toggleIde()" id="terminalToggle" width="22" alt="Terminal" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>
                                    <div class="dl-container">
                <a href="https://maldevacademy.com/new/download/file/HardwareBPsHook" target="_blank">
                    <img src="9_files/dl.svg" class="hover:bg-gray-600 rounded-full cursor-pointer" width="20" alt="Download">
                </a>
                </div>
            
                            </div>
</div>
      <div id="height-container" class="flex h-full min-h-[800px]">
          <div class="flex max-w-full min-w-full">
              <div class="flex-1 min-w-0">
                  
                  <div id="description-container" class="viewer code-description h-full w-full bg-gray-800/70 backdrop-blur-md backdrop-saturate-150 p-4 px-5 md:px-10 lg:px-20 border border-t-0 border-gray-600/60 shadow-inner">

    
    <div id="module-skeleton" role="status" aria-live="polite" class="absolute inset-0 z-20 overflow-hidden bg-slate-900/70 ring-1 ring-white/10">
    <div class="h-full w-full max-w-5xl mx-auto py-8 animate-pulse motion-reduce:animate-none flex flex-col">

        
        <div class="flex flex-col items-center gap-3">
        <div class="h-7 w-72 rounded-xl bg-white/15"></div>
        <div class="h-px w-full bg-white/10"></div>
        </div>

        
        <div class="h-6 w-40 rounded-lg bg-white/12"></div>

        
        <div class="space-y-3 mb-6">
        <div class="h-4 w-full rounded-lg bg-white/10"></div>
        <div class="h-4 w-11/12 rounded-lg bg-white/10"></div>
        <div class="h-4 w-10/12 rounded-lg bg-white/10"></div>
        <div class="h-4 w-9/12  rounded-lg bg-white/10"></div>
        </div>

        
        <div class="h-56 md:h-72 lg:h-80 rounded-xl bg-white/5 ring-1 ring-white/10 flex items-center justify-center">
        <svg viewBox="0 0 64 64" aria-hidden="true" class="w-12 h-12 text-white/30" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="8" y="14" width="48" height="36" rx="3" class="opacity-30"></rect>
            <circle cx="26" cy="28" r="5"></circle>
            <path d="M16 46l12-14 8 10 8-8 12 12"></path>
        </svg>
        </div>

        
        <div class="mt-6 flex-1 relative rounded-xl overflow-hidden">
        <div class="absolute inset-0 rounded-xl" style="
            background:
                linear-gradient(to right, transparent 0, transparent 8px, rgba(255,255,255,0.00) 8px, rgba(255,255,255,0.00) calc(100% - 8px), transparent 100%),
                repeating-linear-gradient(
                to bottom,
                rgba(255,255,255,0.10),                 /* line color */
                rgba(255,255,255,0.10) 12px,            /* line thickness */
                rgba(255,255,255,0.00) 12px,            /* gap start */
                rgba(255,255,255,0.00) 22px             /* gap height */
                );
            ">
        </div>
        </div>

    </div>
    </div>


    
    

    
    <div id="module-content" class="opacity-0 transition-opacity duration-300">
        <h2>Utilizing Hardware Breakpoints For Hooking (1)</h2>
<h3>Introduction</h3>
<p>In previous modules, hooks were implemented using trampolines by 
patching the original execution flow with unconditional jump shellcodes.
 The unconditional jump causes the execution flow to be redirected to a 
detour function, where it executes alternate code logic instead of the 
intended code of the original function.</p>
<p>Despite this method's effectiveness and seamless functionality, it can be easily detected by searching for the <code>jmp</code>
 instruction opcode. Additionally, hooks can be detected by comparing a 
function's binary representation in memory to that on disk which can 
expose runtime patches and thus detect any installed trampolines. Using 
trampolines also requires changing the memory permissions of the hooked 
function to allow writing the trampoline shellcode, which in itself can 
be an IoC.</p>
<p>A solution would be to utilize <a href="https://stackoverflow.com/questions/8878716/what-is-the-difference-between-hardware-and-software-breakpoints">hardware breakpoints</a> alongside a <a href="https://learn.microsoft.com/en-us/windows/win32/debug/vectored-exception-handling">Vectored Exception Handler</a> (VEH), which will be the main focus of this module.</p>
<h3>Understanding Hardware Breakpoints</h3>
<p>To understand hardware breakpoints, one must first understand 
software breakpoints. When installing a software breakpoint on an 
address  (e.g. when debugging on Visual Studio), an <code>int 3</code> instruction is injected into that address. This instruction is equivalent to the <code>0xCC</code> opcode on both 32-bit and 64-bit systems and is often referred to as a <a href="https://en.wikipedia.org/wiki/INT_(x86_instruction)#">software interrupt instruction</a>. This instruction raises a specific type of exception when executed which is handled by a pre-initialized <a href="https://learn.microsoft.com/en-us/windows/win32/debug/exception-handling">exception handler</a> that will be responsible for handling the triggered exception, and therefore control execution at the target address.</p>
<p>Hardware breakpoints work in the same manner by setting up an 
exception handler that will handle the exception raised at the target 
address. The main difference is how this exception is raised. For 
example, when setting a hardware breakpoint at address <code>X</code>, that address will be saved into one of four debug registers, <code>Dr0</code>, <code>Dr1</code>, <code>Dr2</code> or <code>Dr3</code>.
 These registers are used to store memory addresses where hardware 
breakpoints are set. When one of these registers is populated with an 
address, an <code>EXCEPTION_SINGLE_STEP</code> exception will be raised whenever execution reaches address <code>X</code>.</p>
<h3>EFLAGS Register</h3>
<p>As previously explained, four debug registers are used to store the target address <code>Dr0</code>, <code>Dr1</code>, <code>Dr2</code> or <code>Dr3</code>. In addition to that, hardware breakpoints use the <code>EFLAGS</code> register and the <code>Dr7</code> debug register.</p>
<p>The <code>EFLAGS</code> register has several flags, but the main focus is the Resume Flag (<code>RF</code>) which is bit 16 of the <code>EFLAGS</code>
 register. Setting this flag to 1 resumes code execution when execution 
is paused at a breakpoint. The following image shows the <code>EFLAGS</code> register and the Resume Flag within.</p>
<p><img src="9_files/hbp1-138849875-0e788a56-f6bd-447a-b89f-3cea372986b9.png" alt="image"></p>
<h3>Dr7 Register</h3>
<p>The <code>Dr7</code> register, also called the <em>debug control register</em>, enables or disables breakpoints. An image of the <code>Dr7</code> register is shown below which is taken from <a href="https://www.intel.com/content/dam/support/us/en/documents/processors/pentium4/sb/253669.pdf">Intel's Software Developers Manual</a>. The flags of interest for this module will be <code>G0-3</code> which have been highlighted in the image below.</p>
<p><img src="9_files/hbp1-239798257-e3d28618-6602-4e9a-b4e7-7058044214ed.png" alt="image"></p>
<h3>The Global Breakpoint Enable Flags</h3>
<p>The <code>G0-3</code> and <code>L0-3</code> flags are meant to enable
 and disable hardware breakpoints. As previously mentioned, this module 
will exclusively focus on the Global Breakpoint Enable Flags (<code>G0-3</code>) as they provide more control over the state of the breakpoint than the local flags do (<code>L0-3</code>).</p>
<p>As per the image of the <code>Dr7</code> register, the Global Breakpoint Enable Flags are at the following bit positions:</p>
<ul>
<li>
<p><code>G0</code> - Bit 1</p>
</li>
<li>
<p><code>G1</code> - Bit 3</p>
</li>
<li>
<p><code>G2</code> - Bit 5</p>
</li>
<li>
<p><code>G3</code> - Bit 7</p>
</li>
</ul>
<p>Depending on the breakpoint's position in the <code>Dr0-3</code> registers, the <code>G0-3</code> flags will be set to 1 to enable the breakpoint. For example, to enable a hardware breakpoint that's saved in the <code>Dr0</code> register, the <code>G0</code> flag should be set to 1. The same concept applies to the other <code>Dr</code> registers where enabling the breakpoint saved in <code>Dr1</code> is done via the <code>G1</code> flag, <code>Dr2</code> is enabled through <code>G2</code>, and <code>Dr3</code> is enabled through <code>G3</code>.</p>
<p>Disabling a hardware breakpoint follows the same concept as enabling hardware breakpoints with the difference being that the <code>G0-3</code> flags are set to 0 instead of 1.</p>
<h3>Hardware Breakpoints Algorithm</h3>
<p>Having acquired knowledge about how hardware breakpoints are set and 
removed, the second step will be establishing the groundwork for code 
implementation. Below are several key considerations to be aware of 
regarding implementing hardware breakpoints.</p>
<ul>
<li>
<p>Hardware breakpoints are not global breakpoints among all threads, 
instead, they only work for the thread that installs them. That is a 
thread with populated <code>Dr0-3</code> and <code>Dr7</code> registers.</p>
</li>
<li>
<p>Since hardware breakpoints must be saved in one of the <code>Dr0-3</code> registers, each thread can install a maximum of 4 hardware breakpoints at the same time.</p>
</li>
<li>
<p>Installing and uninstalling breakpoints will be done using the <code>GetThreadContext</code> and <code>SetThreadContext</code> WinAPIs. Where the <code>Dr0-3</code> and <code>Dr7</code> values of the calling thread can be altered.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/sync/critical-section-objects">Critical section objects</a>,
 although optional, will be utilized to ensure thread safety and 
synchronization when handling hardware breakpoints. The following 
WinAPIs functions are the ones used to work with critical object 
sections:</p>
<ul>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-initializecriticalsection">InitializeCriticalSection</a> - Initializes a critical section object by populating a <code>CRITICAL_SECTION</code> structure.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-entercriticalsection">EnterCriticalSection</a>
 - Enters a critical section, indicating that the calling thread wants 
to access a shared resource protected by the critical section.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-leavecriticalsection">LeaveCriticalSection</a> -Releases a critical section, indicating that the calling thread has finished accessing the shared resource.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-deletecriticalsection">DeleteCriticalSection</a> - Deletes a critical section object, freeing the associated resources.</p>
</li>
</ul>
</li>
<li>
<p>As mentioned earlier when code execution reaches a hardware breakpoint, an <code>EXCEPTION_SINGLE_STEP</code> exception is raised. This exception will be handled using a <a href="https://learn.microsoft.com/en-us/windows/win32/debug/vectored-exception-handling">Vectored Exception Handler</a> which is set using the following WinAPIs:</p>
<ul>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/errhandlingapi/nf-errhandlingapi-addvectoredexceptionhandler">AddVectoredExceptionHandler</a>
 - Registers a Vectored Exception Handler, allowing the specified 
exception handler function to be called when an exception occurs in the 
process.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/errhandlingapi/nf-errhandlingapi-removevectoredexceptionhandler">RemoveVectoredExceptionHandler</a>
 - Removes a previously registered Vectored Exception Handler from the 
process, preventing the associated exception handler function from being
 called for future exceptions.</p>
</li>
</ul>
</li>
</ul>
<h3>How Hardware Breakpoint Hooks Work</h3>
<p>If a hardware breakpoint is set at the beginning of a function and 
that function is called, it will not execute immediately. Instead, an 
exception will be triggered and intercepted by our handler which then 
executes the detour function. Therefore, rather than the detour function
 being directly called when the hardware breakpoint is hit, the handler 
will be the one calling the detour function by simulating an 
exception-handling routine, as shown the image below.</p>
<p><img src="9_files/hbp1-344846744-a281884c-67db-413d-be5a-e010ddbf682e.png" alt="image"></p>
<p>The detour function takes on the responsibility of resuming execution by setting the Resume Flag (<code>RF</code>) in the <code>EFLAGS</code> register, thereby allowing the original code of the hooked function to be executed.</p>
<h3>Hooking Multiple Functions</h3>
<p>The VEH function executes detour functions by using their function 
pointers. As a result, it is necessary to have a function pointer for 
each detour function with the same data types and parameters. However, 
accomplishing this requires more complex code and can potentially lead 
to performance issues. This is because the VEH function needs to execute
 each detour function based on its predefined function pointer, which is
 stored somewhere in the implementation.</p>
<p>Therefore, the current module introduces a simple, yet effective 
solution, which consists of a single universal function pointer that can
 work with all functions. The detour function in this module will be 
designed to be flexible and adaptable, allowing it to intercept multiple
 functions without the need for predetermined function pointers.</p>
<h3>Code Implementation</h3>
<p>This module will demonstrate the installation of hardware breakpoint 
hooks on a single thread. The goal is to provide a straightforward 
implementation for improved understanding and clarity.</p>
<h4>Altering The Dr7 Register Value</h4>
<p>As mentioned earlier, the <code>Dr7</code> register will be responsible for enabling the installed hardware breakpoints via the <code>G0</code> through <code>G3</code> flags. Therefore the <code>SetDr7Bits</code> function, shown below, will be used to enable or disable an installed breakpoint.</p>
<p><code>SetDr7Bits</code> takes the following parameters:</p>
<ul>
<li>
<p><code>CurrentDr7Register</code> - The current <code>Dr7</code> register value.</p>
</li>
<li>
<p><code>StartingBitPosition</code> - The starting bit position. In other words, the position at which the bit modification will start.</p>
</li>
<li>
<p><code>NmbrOfBitsToModify</code> - The number of bits in <code>CurrentDr7Register</code> starting from <code>StartingBitPosition</code> position to modify.</p>
</li>
<li>
<p><code>NewBitValue</code> - The new value of the specified bit/s to be set.</p>
</li>
</ul>
<p><code>SetDr7Bits</code> returns the new value of the <code>Dr7</code> register after the bit modification.</p>
<pre><code class="language-C">unsigned long long SetDr7Bits(unsigned 
long long CurrentDr7Register, int StartingBitPosition, int 
NmbrOfBitsToModify, unsigned long long NewBitValue) {
	unsigned long long mask           = (1UL &lt;&lt; NmbrOfBitsToModify) -
 1UL;
	unsigned long long NewDr7Register = (CurrentDr7Register &amp; ~(mask 
&lt;&lt; StartingBitPosition)) | (NewBitValue &lt;&lt; 
StartingBitPosition);

	return NewDr7Register;
}
</code></pre>
<h4>Initializing The Address of The Breakpoint</h4>
<p>To set up a breakpoint, one should initialize one of the <code>Dr0-3</code> registers with the address of the breakpoint, and populate one of the <code>G0-3</code> flags accordingly. The <code>DRX</code> enumeration will be used to determine which register or flag position is to be populated.</p>
<pre><code class="language-C">typedef enum _DRX{

	Dr0,
	Dr1,
	Dr2,
	Dr3

} DRX, * PDRX;
</code></pre>
<p>The next step is to construct two functions, one that installs and 
enables the breakpoint and the other removes it. These functions are 
called <code>SetHardwareBreakingPnt</code> and <code>RemoveHardwareBreakingPnt</code> respectively.</p>
<h4>Installing The Breakpoint</h4>
<p>The <code>SetHardwareBreakingPnt</code> function performs the task of assigning the value of <code>pAddress</code> to one of the local thread's <code>Dr0-3</code> registers based on the provided <code>Drx</code> parameter. This is accomplished by utilizing the WinAPI functions <code>GetThreadContext</code> and <code>SetThreadContext</code> with the pseudo handle (<code>-2</code>) representing the local thread.</p>
<p>The function <code>SetHardwareBreakingPnt</code> accepts three parameters:</p>
<ul>
<li>
<p><code>PVOID pAddress</code> - A pointer where the hardware breakpoint should be set.</p>
</li>
<li>
<p><code>PVOID fnHookFunc</code> - A pointer to the detour function.</p>
</li>
<li>
<p><code>DRX Drx</code> - An enumeration of type <code>DRX</code>, this value determines what register to populate.</p>
</li>
</ul>
<pre><code class="language-C">BOOL SetHardwareBreakingPnt(IN PVOID pAddress, IN PVOID fnHookFunc, IN enum DRX Drx) {

	if (!pAddress || !fnHookFunc)
		return FALSE;

	CONTEXT ThreadCtx = { .ContextFlags = CONTEXT_DEBUG_REGISTERS };

	// Get local thread context
	if (!GetThreadContext((HANDLE)-2, &amp;ThreadCtx))
		return ReportError(TEXT("GetThreadContext"), NULL);

	// Sets the value of the Dr0-3 registers 
	switch (Drx) {
		case Dr0: {
			if (!ThreadCtx.Dr0)
				ThreadCtx.Dr0 = pAddress;
			break;
		}
		case Dr1: {
			if (!ThreadCtx.Dr1)
				ThreadCtx.Dr1 = pAddress;
			break;
		}
		case Dr2: {
			if (!ThreadCtx.Dr2)
				ThreadCtx.Dr2 = pAddress;
			break;
		}
		case Dr3: {
			if (!ThreadCtx.Dr3)
				ThreadCtx.Dr3 = pAddress;
			break;
		}
		default:
			return FALSE;
	}

	// Set the thread context
	if (!SetThreadContext((HANDLE)-2, &amp;ThreadCtx))
		return ReportError(TEXT("SetThreadContext"), NULL);

	return TRUE;
}
</code></pre>
<h4>Enabling The Breakpoint</h4>
<p>Remember, the <code>SetHardwareBreakingPnt</code> function simply installs the hardware breakpoint but does not enable it on the determined register. To do so, the <code>SetDr7Bits</code> will be used.</p>
<pre><code class="language-C">// For reference
// SetDr7Bits(unsigned long long CurrentDr7Register, int 
StartingBitPosition, int NmbrOfBitsToModify, unsigned long long 
NewBitValue);

ThreadCtx.Dr7 = SetDr7Bits(ThreadCtx.Dr7, (Drx * 2), 1, 1);
</code></pre>
<p>The line of code above does the following:</p>
<ul>
<li>
<p>If <code>Drx</code> is <code>0</code>, the starting bit position will be <code>(0 * 2) = 0</code>. Thus, the first bit from the significant bit (bit position 1 - <code>G0</code>) of <code>DR7</code> will be modified (set to 1).</p>
</li>
<li>
<p>If <code>Drx</code> is <code>1</code>, the starting bit position will be <code>(1 * 2) = 2</code>. Thus, the third bit from the least significant bit (bit position 3 - <code>G1</code>) of <code>DR7</code> will be modified (set to 1).</p>
</li>
<li>
<p>If <code>Drx</code> is <code>2</code>, the starting bit position will be <code>(2 * 2) = 4</code>. Thus, the fifth bit from the least significant bit (bit position 5 - <code>G2</code>) of <code>DR7</code> will be modified (set to 1).</p>
</li>
<li>
<p>If <code>Drx</code> is <code>3</code>, the starting bit position will be <code>(3 * 2) = 6</code>. Thus, the seventh bit from the least significant bit (bit position 7 - <code>G3</code>) of <code>DR7</code> will be modified (set to 1).</p>
</li>
</ul>
<h4>Detour Function Pointer</h4>
<p>Although the detour function pointer (<code>fnHookFunc</code>) will not be executed here, <code>fnHookFunc</code> must be saved in accordance with the position of the hooked function pointer (<code>pAddress</code>) in the <code>Dr0-3</code> registers. To handle this, a global array named <code>g_DetourFuncs</code>
 will be defined. This array can accommodate a maximum of four function 
pointers, which corresponds to the highest number of hardware 
breakpoints that can be installed in a thread. These pointers will be 
retrieved from the VEH at a later stage and executed there.</p>
<p>The <code>SetHardwareBreakingPnt</code> function is now complete, and the following is its complete version</p>
<pre><code class="language-C">// Array of detour function pointers
PVOID		g_DetourFuncs[4]	= { 0 }; // Maximum 4 hardware breakpoints 


BOOL SetHardwareBreakingPnt(IN PVOID pAddress, IN PVOID fnHookFunc, IN enum DRX Drx) {

	if (!pAddress || !fnHookFunc)
		return FALSE;

	CONTEXT ThreadCtx = { .ContextFlags = CONTEXT_DEBUG_REGISTERS };

	// Get local thread context
	if (!GetThreadContext((HANDLE)-2, &amp;ThreadCtx))
		return ReportError(TEXT("GetThreadContext"), NULL);

	// Sets the value of the Dr0-3 registers 
	switch (Drx) {
		case Dr0: {
			if (!ThreadCtx.Dr0)
				ThreadCtx.Dr0 = pAddress;
			break;
		}
		case Dr1: {
			if (!ThreadCtx.Dr1)
				ThreadCtx.Dr1 = pAddress;
			break;
		}
		case Dr2: {
			if (!ThreadCtx.Dr2)
				ThreadCtx.Dr2 = pAddress;
			break;
		}
		case Dr3: {
			if (!ThreadCtx.Dr3)
				ThreadCtx.Dr3 = pAddress;
			break;
		}
		default:
			return FALSE;
	}

	// Saves the address of the detour function at index 'Drx' in 'g_DetourFuncs'
	g_DetourFuncs[Drx] = fnHookFunc;

	// Enable the breakpoint: Populate the G0-3 flags depending on the saved breakpoint position in the Dr0-3 registers
	ThreadCtx.Dr7 = SetDr7Bits(ThreadCtx.Dr7, (Drx * 2), 1, 1);

	// Set the thread context after editing it
	if (!SetThreadContext((HANDLE)-2, &amp;ThreadCtx))
		return ReportError(TEXT("SetThreadContext"), NULL);

	return TRUE;
}
</code></pre>
<h4>RemoveHardwareBreakingPnt Function</h4>
<p>Finally, the <code>RemoveHardwareBreakingPnt</code> function removes the specified breakpoint by eliminating it from the context of the local thread, specifically from the <code>Dr0-3</code> registers, and disabling its corresponding flag. As done previously when installing the hardware breakpoint, <code>RemoveHardwareBreakingPnt</code> uses the <code>GetThreadContext</code> and the <code>SetThreadContext</code> WinAPIs, in addition to the helper function <code>SetDr7Bits</code> to nullify the target Global Breakpoint Enable Flag.</p>
<p>The <code>RemoveHardwareBreakingPnt</code> requires one parameter which is the <code>Drx</code> enumeration which determines what register to unset.</p>
<pre><code class="language-C">BOOL RemoveHardwareBreakingPnt(IN enum DRX Drx) {

	CONTEXT ThreadCtx = { .ContextFlags = CONTEXT_DEBUG_REGISTERS };

	if (!GetThreadContext((HANDLE)-2, &amp;ThreadCtx))
		return ReportError(TEXT("GetThreadContext"), NULL);

	// Remove the address of the hooked function from the thread context
	switch (Drx) {
		case Dr0: {
			ThreadCtx.Dr0 = 0x00;
			break;
		}
		case Dr1: {
			ThreadCtx.Dr1 = 0x00;
			break;
		}
		case Dr2: {
			ThreadCtx.Dr2 = 0x00;
			break;
		}
		case Dr3: {
			ThreadCtx.Dr3 = 0x00;
			break;
		}
		default:
			return FALSE;
	}

	// Disabling the hardware breakpoint by setting the target G0-3 flag to zero 
	ThreadCtx.Dr7 = SetDr7Bits(ThreadCtx.Dr7, (Drx * 2), 1, 0);

	if (!SetThreadContext((HANDLE)-2, &amp;ThreadCtx))
		return ReportError(TEXT("SetThreadContext"), NULL);

	return TRUE;
}
</code></pre>
<h3>Setting Up The VEH Function</h3>
<p>As previously mentioned, it is necessary to construct a VEH function to handle the <code>EXCEPTION_SINGLE_STEP</code>
 exception raised and redirect execution to the detour function. 
Furthermore, to create a universal function that works with all hooked 
functions, it is possible to define a single function pointer with one 
parameter of type <code>PCONTEXT</code>. This allows the detour function
 to retrieve and manipulate the parameters of the hooked function by 
utilizing thread context registers.</p>
<h4>Initializing The Exception Handler</h4>
<p>Setting a hardware breakpoint using the <code>SetHardwareBreakingPnt</code>
 function without an initialized exception handler will cause the 
program to crash shortly after the execution reaches the breakpoint. 
This program would crash because an unhandled exception was raised. To 
solve this problem, one must first set up a VEH, which is registered via
 the <code>AddVectoredExceptionHandler</code> WinAPI.</p>
<p>If <code>AddVectoredExceptionHandler</code> succeeds, it returns a handle to the exception handler.</p>
<pre><code class="language-C">PVOID AddVectoredExceptionHandler(
  ULONG                       First,		// The order in which the handler 
should be called. Should be set to '1' so that the handler will be the 
first handler to be called.
  PVECTORED_EXCEPTION_HANDLER Handler		// A pointer to the handler to be
 called (pointer to the handler function).
);
</code></pre>
<h4>PVECTORED_EXCEPTION_HANDLER Structure</h4>
<p>According to <a href="https://learn.microsoft.com/en-us/windows/win32/api/winnt/nc-winnt-pvectored_exception_handler">Microsoft's documentation</a>, the <code>Handler</code> parameter is of type <code>PVECTORED_EXCEPTION_HANDLER</code>
 which defines how the handler function will look like. The handler 
function is a callback function that will get executed whenever an 
exception is raised. Where <code>PVECTORED_EXCEPTION_HANDLER</code> is a function pointer that is shown below.</p>
<pre><code class="language-C">typedef LONG (NTAPI *PVECTORED_EXCEPTION_HANDLER)(
    struct _EXCEPTION_POINTERS *ExceptionInfo
    );
</code></pre>
<h4>EXCEPTION_POINTERS Structure</h4>
<p>The VEH function will receive a pointer to an <code>EXCEPTION_POINTERS</code>
 structure. This structure is intended to assist the handler in 
evaluating the situation and taking appropriate actions to resolve the 
raised exception, allowing the program's execution to continue. The <code>EXCEPTION_POINTERS</code> structure is defined as the following</p>
<pre><code class="language-C">typedef struct _EXCEPTION_POINTERS {
    PEXCEPTION_RECORD ExceptionRecord;			
    PCONTEXT ContextRecord;			// The thread context of the thread that raised the exception
} EXCEPTION_POINTERS, *PEXCEPTION_POINTERS;
</code></pre>
<p>When the detour function is executed, it must receive the <code>PEXCEPTION_POINTERS-&gt;ContextRecord</code> element as an argument.</p>
<h4>EXCEPTION_RECORD Structure</h4>
<p>The <code>EXCEPTION_RECORD</code> structure located within <code>EXCEPTION_POINTERS</code> contains information about the raised exception. Inside <code>EXCEPTION_RECORD</code>, the only elements of interest are <code>ExceptionCode</code> and <code>ExceptionAddress</code> which contain the exception code raised, and the address of where the exception occurred, respectively.</p>
<pre><code class="language-C">typedef struct _EXCEPTION_RECORD {
   DWORD       ExceptionCode;		// Code that identifies the specific type of exception raised.
   DWORD       ExceptionFlags;
   struct      _EXCEPTION_RECORD *ExceptionRecord;
   PVOID       ExceptionAddress;	// Address where the exception occurred
   DWORD       NumberParameters;
   ULONG_PTR   ExceptionInformation[EXCEPTION_MAXIMUM_PARAMETERS];
} EXCEPTION_RECORD;
</code></pre>
<h3>Handling The Hardware Breakpoint Exception</h3>
<p>Upon reaching a hardware breakpoint, the exception code raised is <code>EXCEPTION_SINGLE_STEP</code>, represented as <code>0x80000004</code> in hexadecimal. In the VEH function, it is crucial to note that <code>PEXCEPTION_POINTERS-&gt;PEXCEPTION_RECORD-&gt;ExceptionCode</code> should always be <code>EXCEPTION_SINGLE_STEP</code>.
 This determination allows us to know whether the exception originated 
from our installed breakpoints, as opposed to handling other exceptions 
such as <code>EXCEPTION_DIVIDED_BY_ZERO</code> and <code>EXCEPTION_STACK_OVERFLOW</code>, that can be caused by code bugs in the program.</p>
<p>Furthermore, the <code>PEXCEPTION_POINTERS-&gt;PEXCEPTION_RECORD-&gt;ExceptionAddress</code> element should always be equal to one of the <code>Dr0-3</code> debug registers. This is because <code>ExceptionAddress</code>
 is the address where the exception occurred, and the exception will 
come from our breakpoint which was previously set to one of the <code>Dr0-3</code> registers (recall the <code>SetHardwareBreakingPnt</code> function). With all of this in mind, two checks must be done:</p>
<ol>
<li>
<p>Ensure that the exception is indeed raised from a breakpoint by checking the exception's code.</p>
</li>
<li>
<p>Ensure that the exception's address is a hardware breakpoint by checking if it's equal to one of the <code>Dr0-3</code> debug registers.</p>
</li>
</ol>
<h4>VectorHandler Function</h4>
<p>The <code>VectorHandler</code> function shown below, performs the necessary checks mentioned.</p>
<pre><code class="language-C">LONG WINAPI VectorHandler(PEXCEPTION_POINTERS pExceptionInfo) {

	// If the exception is 'EXCEPTION_SINGLE_STEP' then its caused by a breakpoint and we should handle it
	if (pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionCode == EXCEPTION_SINGLE_STEP) {

		// Verify if the breakpoint is a hardware breakpoint we installed
		if (pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr0 ||
			pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr1 ||
			pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr2 ||
			pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr3) {

			/*
				The Hook Implementation
			*/
			
			// Continue the execution - The exception is handled
			return EXCEPTION_CONTINUE_EXECUTION;
		}
	}

	// The exception is not handled:                                             \
	- Not from the hardware breakpoints	!(Dr0-3)                     \
	- The exception code is not 'EXCEPTION_SINGLE_STEP'

	return EXCEPTION_CONTINUE_SEARCH;
}
</code></pre>
<h3>The Hook Implementation</h3>
<p>In order to create an API hooking scenario from the VEH using the populated <code>g_DetourFuncs</code> array, one can cast each pointer within the array to a function pointer definition that only accepts a <code>PCONTEXT</code>
 parameter. Subsequently, execution can proceed by invoking these 
function pointers. The challenging aspect lies in retrieving the correct
 pointer from the array.</p>
<p>Back to the <code>SetHardwareBreakingPnt</code> function, each detour function pointer was saved into the <code>g_DetourFuncs</code> array according to the <code>Drx</code> enumeration parameter. For example, if <code>Drx</code> was <code>Dr1</code>,
 which is 1, the index of where the detour function pointer will be 
saved is then 1. The same logic can be used in the VEH, if the detected 
exception address was equal to that of the <code>Dr1</code> register, then the correct function pointer to fetch from the <code>g_DetourFuncs</code> array is index 1.</p>
<h4>Infinite Loop &amp; Workaround</h4>
<p>An important scenario to consider is the hooked function being called
 from within its detour version. This would result in an infinite loop 
(recall the <em>API Hooking - Detours Library</em> module). This 
situation arises because the hooked function will invoke its detour 
version, and the detour function, in turn, calls the original hooked 
function, resulting in an infinite loop.</p>
<p>To avoid this issue, one can disable the hardware breakpoint before 
executing the detour function pointer and then re-enable it when the 
detour function is executed. To do so, <code>RemoveHardwareBreakingPnt</code> and <code>SetHardwareBreakingPnt</code>
 will be called respectively in the VEH, and the detour function 
execution will occur in between, as shown in the following updated 
version of the <code>VectorHandler</code> function.</p>
<pre><code class="language-C">LONG WINAPI VectorHandler(PEXCEPTION_POINTERS pExceptionInfo) {

	// If the exception is 'EXCEPTION_SINGLE_STEP'; then its caused by a breakpoint and we should handle it
	if (pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionCode == EXCEPTION_SINGLE_STEP) {

		// Verify if the breakpoint is a hardware breakpoint we installed
		if (pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr0 ||
			pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr1 ||
			pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr2 ||
			pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr3) {

			enum DRX dwDrx = -1;
			// Defining a function pointer that accepts one parameter of type 'PCONTEXT'
			VOID (*fnHookFunc)(PCONTEXT) = NULL;

			// Detect the hw bp register (Dr0-3)
			if (pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr0)
				dwDrx = Dr0;
			if (pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr1)
				dwDrx = Dr1;
			if (pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr2)
				dwDrx = Dr2;
			if (pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress == pExceptionInfo-&gt;ContextRecord-&gt;Dr3)
				dwDrx = Dr3;

			// Disable hw breakpoint to allow execution the hooked function from the detour function 
			RemoveHardwareBreakingPnt(dwDrx);

			// Execute the callback (detour function)
			fnHookFunc = g_DetourFuncs[dwDrx];
			fnHookFunc(pExceptionInfo-&gt;ContextRecord);

			// Enable the hw breakpoint again
			SetHardwareBreakingPnt(pExceptionInfo-&gt;ExceptionRecord-&gt;ExceptionAddress, g_DetourFuncs[dwDrx], dwDrx);

			// Continue the execution - The exception is handled
			return EXCEPTION_CONTINUE_EXECUTION;
		}
	}

	// The exception is not handled:					\
	- Not from the hardware breakpoints	!(Dr0-3)			\
	- The exception code is not 'EXCEPTION_SINGLE_STEP'

	return EXCEPTION_CONTINUE_SEARCH;
}
</code></pre>
<h3>Fetching And Modifying The Hooked Function's Parameters</h3>
<p>As mentioned earlier, all of the detour functions have the same function declaration, accepting one parameter, <code>PCONTEXT</code>, and are of type <code>VOID</code>. Using the <code>PCONTEXT</code> parameter on 64-bit systems, one can fetch and alter the first four parameters of the hooked function through the <code>Rcx</code>, <code>Rdx</code>, <code>r8</code>, and <code>r9</code> registers located in the context structure.</p>
<p>If the hooked function requires more than four parameters, the <code>Rsp</code> register can be utilized for altering the stack parameters since all additional parameters are pushed to the stack. Recall the <em>Introduction To MASM Assembly</em>
 module, where this matter was discussed in more detail. On the other 
hand, on 32-bit systems, all parameters are pushed on the stack, 
therefore utilizing the <code>Esp</code> register is enough to fetch all the hooked function's parameters.</p>
<p>Furthermore, modifying these parameters depends upon their type, 
whether they are register parameters or stack parameters (the first 
through fourth parameters are register parameters). Once the type of the
 parameter is determined, one can proceed to modify the parameter's 
value accordingly, either by editing the registers or stack.</p>
<h4>GetFunctionArgument Function</h4>
<p>The <code>GetFunctionArgument</code> is used to fetch a hooked function's arguments. The function takes two parameters:</p>
<ul>
<li>
<p><code>pThreadCtx</code> - The thread context pointer that's passed to the detour function from our VEH.</p>
</li>
<li>
<p><code>dwParmIndex</code> - The index of the parameter to fetch.</p>
</li>
</ul>
<p>The return value is a pointer to an argument of the hooked function.</p>
<pre><code class="language-C">PBYTE GetFunctionArgument(IN PCONTEXT pThreadCtx, IN DWORD dwParmIndex) {

#ifdef _WIN64
	// the first 4 arguments in x64 are in the "RCX - RDX - R8 - R9" registers
	switch (dwParmIndex) {
	case 0x01:
		return (ULONG_PTR)pThreadCtx-&gt;Rcx;
	case 0x02:
		return (ULONG_PTR)pThreadCtx-&gt;Rdx;
	case 0x03:
		return (ULONG_PTR)pThreadCtx-&gt;R8;
	case 0x04:
		return (ULONG_PTR)pThreadCtx-&gt;R9;
	default:
		break;
	}

	// else more arguments are pushed to the stack
	return *(ULONG_PTR*)(pThreadCtx-&gt;Rsp + (dwParmIndex * sizeof(PVOID)));
#else
	return *(DWORD_PTR*)(pThreadCtx-&gt;Esp + (dwParmIndex * sizeof(PVOID)));
#endif // _WIN64

}
</code></pre>
<p>Retrieving the stack parameters requires multiplying <code>dwParmIndex</code> by the size of the <code>PVOID</code> data type. On 64-bit systems, the <code>PVOID</code>
 data type occupies 8 bytes, while on 32-bit systems, it occupies 4 
bytes. This multiplication helps determine the offset of the parameter 
from the stack pointer register. Subsequently, the calculated offset is 
added to the <code>Rsp</code> register (in the case of x64 systems) or the <code>Esp</code> register (in the case of x32 systems).</p>
<h4>SetFunctionArgument Function</h4>
<p>The <code>SetFunctionArgument</code> function is used to set the hooked function's arguments. The function <code>SetFunctionArgument</code> takes the following parameters:</p>
<ul>
<li>
<p><code>pThreadCtx</code> - Thread context pointer, that's passed to the detour function from our VEH.</p>
</li>
<li>
<p><code>uValue</code> - The new parameter value to be set.</p>
</li>
<li>
<p><code>dwParmIndex</code> - The index of the parameter to edit.</p>
</li>
</ul>
<pre><code class="language-C">VOID SetFunctionArgument(IN PCONTEXT pThreadCtx, IN ULONG_PTR uValue, IN DWORD dwParmIndex) {

#ifdef _WIN64

	// the first 4 arguments in x64 are in the "RCX - RDX - R8 - R9" registers
	switch (dwParmIndex) {
	case 0x01:
		(ULONG_PTR)pThreadCtx-&gt;Rcx = uValue; return;
	case 0x02:
		(ULONG_PTR)pThreadCtx-&gt;Rdx = uValue; return;
	case 0x03:
		(ULONG_PTR)pThreadCtx-&gt;R8 = uValue; return;
	case 0x04:
		(ULONG_PTR)pThreadCtx-&gt;R9 = uValue; return;
	default:
		break;
	}

	// else more arguments are pushed to the stack
	*(ULONG_PTR*)(pThreadCtx-&gt;Rsp + (dwParmIndex * sizeof(PVOID))) = uValue;
#else
	*(DWORD_PTR*)(pThreadCtx-&gt;Esp + (dwParmIndex * sizeof(PVOID))) = uValue;
#endif // _WIN64

}
</code></pre>
<h4>Get &amp; Set Macros</h4>
<p>The functions <code>GetFunctionArgument</code> and <code>SetFunctionArgument</code>
 will exclusively be invoked from the detour function. Therefore, in 
order to simplify the retrieval and modification of the hooked 
function's parameters, both functions will be accessed via macros that 
enhance their efficiency and ease of use.</p>
<p>The <code>GetFunctionArgument</code> function will be called through the <code>GETPARM_X</code> macros, where <code>X</code> represents the index of the parameter to fetch. <code>GETPARM_X</code> takes one parameter, <code>CTX</code>, representing a pointer to the thread's context to pass to the <code>GetFunctionArgument</code> function.</p>
<pre><code class="language-C">#define GETPARM_1(CTX)(GetFunctionArgument(CTX, 0x1))	
#define GETPARM_2(CTX)(GetFunctionArgument(CTX, 0x2))
#define GETPARM_3(CTX)(GetFunctionArgument(CTX, 0x3))
#define GETPARM_4(CTX)(GetFunctionArgument(CTX, 0x4))
#define GETPARM_5(CTX)(GetFunctionArgument(CTX, 0x5))
#define GETPARM_6(CTX)(GetFunctionArgument(CTX, 0x6))
#define GETPARM_7(CTX)(GetFunctionArgument(CTX, 0x7))
#define GETPARM_8(CTX)(GetFunctionArgument(CTX, 0x8))
#define GETPARM_9(CTX)(GetFunctionArgument(CTX, 0x9))
#define GETPARM_A(CTX)(GetFunctionArgument(CTX, 0xA))
#define GETPARM_B(CTX)(GetFunctionArgument(CTX, 0xB))
</code></pre>
<p>On the other hand, the function <code>SetFunctionArgument</code> will be called through the macros <code>SETPARM_X</code>, where <code>X</code> represents the index of the parameter to modify. <code>SETPARM_1</code> takes two parameters, <code>CTX</code> and <code>VALUE</code>, representing a pointer to the thread's context, and the parameter's new value to set, respectively.</p>
<pre><code class="language-C">#define SETPARM_1(CTX, VALUE)(SetFunctionArgument(CTX, VALUE, 0x1))
#define SETPARM_2(CTX, VALUE)(SetFunctionArgument(CTX, VALUE, 0x2))
#define SETPARM_3(CTX, VALUE)(SetFunctionArgument(CTX, VALUE, 0x3))
#define SETPARM_4(CTX, VALUE)(SetFunctionArgument(CTX, VALUE, 0x4))
#define SETPARM_5(CTX, VALUE)(SetFunctionArgument(CTX, VALUE, 0x5))
#define SETPARM_6(CTX, VALUE)(SetFunctionArgument(CTX, VALUE, 0x6))
#define SETPARM_7(CTX, VALUE)(SetFunctionArgument(CTX, VALUE, 0x7))
#define SETPARM_8(CTX, VALUE)(SetFunctionArgument(CTX, VALUE, 0x8))
#define SETPARM_9(CTX, VALUE)(SetFunctionArgument(CTX, VALUE, 0x9))
#define SETPARM_A(CTX, VALUE)(SetFunctionArgument(CTX, VALUE, 0xA))
#define SETPARM_B(CTX, VALUE)(SetFunctionArgument(CTX, VALUE, 0xB))
</code></pre>
<h3>Critical Sections</h3>
<p>As previously mentioned, the use of critical sections is not 
mandatory but understanding this concept is important. Critical sections
 serve the purpose of preventing race conditions, which arise when 
multiple threads or processes simultaneously attempt to access and 
modify the same shared resource. In this module, the shared resource in 
question is the global array <code>g_DetourFuncs</code>. Consequently, any function that interacts with <code>g_DetourFuncs</code>
 should do so through critical sections. The following points explain 
the usage of the critical section WinAPIs. It has been broken up into 
points for simplification.</p>
<ul>
<li>
<p>The initialization of critical sections requires the usage of the <code>InitializeCriticalSection</code> WinAPI. This function is invoked once to populate the <code>CRITICAL_SECTION</code> structure, which is subsequently utilized by other WinAPIs.</p>
</li>
<li>
<p>The <code>CRITICAL_SECTION</code> structure remains unaltered after initialization and is used in the <code>EnterCriticalSection</code> and <code>LeaveCriticalSection</code> WinAPIs.</p>
</li>
<li>
<p>The purpose of the <code>EnterCriticalSection</code> function is to enter the critical section before accessing the shared resource, namely <code>g_DetourFuncs</code>. Conversely, the <code>LeaveCriticalSection</code> function is used to exit the critical section after accessing the shared resource.</p>
</li>
<li>
<p>Upon completion of using critical sections, a program can delete the initialized object by invoking the <code>DeleteCriticalSection</code> WinAPI.</p>
</li>
<li>
<p>All of the previously mentioned critical section WinAPIs accept a single parameter, <code>PCRITICAL_SECTION</code>, which represents a pointer to the previously initialized <code>CRITICAL_SECTION</code> structure.</p>
</li>
</ul>
<p>In the implementation, <code>g_DetourFuncs</code> was accessed twice, once in <code>SetHardwareBreakingPnt</code> and the other in the VEH function, <code>VectorHandler</code>. Therefore, these will be the only functions that will use the <code>EnterCriticalSection</code> and <code>LeaveCriticalSection</code> WinAPIs.</p>
<h3>Initialization And Cleanup</h3>
<p>In order to establish the VEH and the critical section object, it is 
necessary to create a new function that handles the creation and 
initialization of the required objects. Therefore, the <code>InitializeHardwareBPVariables</code> function, which is shown below, will be used to handle the creation and initialization of the previously mentioned objects.</p>
<pre><code class="language-C">PVOID			    g_VectorHandler         = NULL;		// VEH exception handle
CRITICAL_SECTION	    g_CriticalSection       = { 0 };	// Crtitcal section
PVOID			    g_DetourFuncs[4]        = { 0 }; 	// Array of detour function pointers

BOOL InitializeHardwareBPVariables() {

	RtlSecureZeroMemory(&amp;g_CriticalSection, sizeof(CRITICAL_SECTION));
	RtlSecureZeroMemory(&amp;g_DetourFuncs, sizeof(g_DetourFuncs));

	// If 'g_CriticalSection' is not yet initialized
	if (g_CriticalSection.DebugInfo == NULL) {
		InitializeCriticalSection(&amp;g_CriticalSection);
	}

	// If 'g_VectorHandler' is not yet initialized
	if (!g_VectorHandler) {
		// Add 'VectorHandler' as the VEH function
		if ((g_VectorHandler = AddVectoredExceptionHandler(1, (PVECTORED_EXCEPTION_HANDLER)&amp;VectorHandler)) == NULL) 
			return ReportError(TEXT("AddVectoredExceptionHandler"), NULL);
	}

	return (g_VectorHandler &amp;&amp; g_CriticalSection.DebugInfo);
}
</code></pre>
<p>On the other hand, it is recommended to have a dedicated function responsible for cleaning up the initialized objects. <code>UnintializeHardwareBPVariables</code> will invoke <code>DeleteCriticalSection</code> to delete the critical section object, and <code>RemoveVectoredExceptionHandler</code> to unregister the VEH. Additionally, the function will call <code>RemoveHardwareBreakingPnt</code> for all possible values of the <code>enum DRX</code>, to delete all installed breakpoints. The <code>UnintializeHardwareBPVariables</code> function is shown below.</p>
<pre><code class="language-C">VOID UnintializeHardwareBPVariables() {

	// Remove breakpoints
	for (int i = 0; i &lt; 4; i++)
		RemoveHardwareBreakingPnt(i);
	// If the critical section is initialized, delete it
	if (g_CriticalSection.DebugInfo)
		DeleteCriticalSection(&amp;g_CriticalSection);
	// If VEH is registered, remove it
	if (g_VectorHandler)
		RemoveVectoredExceptionHandler(g_VectorHandler);

	// Cleanup the global variables
	RtlSecureZeroMemory(&amp;g_CriticalSection, sizeof(CRITICAL_SECTION));
	RtlSecureZeroMemory(&amp;g_DetourFuncs, sizeof(g_DetourFuncs));
	g_VectorHandler = NULL;
}
</code></pre>
<h3>Constructing The Detour Function</h3>
<p>As previously stated, a single detour function's definition is 
designed to handle all hooked functions. This function accepts a single 
parameter of type <code>PCONTEXT</code>, which is fetched from the <code>EXCEPTION_POINTERS</code> structure within the handler function. For example, the detour function for both <code>CreateFileA</code> and <code>MessageBoxW</code> WinAPIs will have the same definition that's shown below.</p>
<pre><code class="language-C">VOID DetourFunctionName(IN PCONTEXT pThreadCtx){
	// Detour function logic
}
</code></pre>
<p>The detour functions must also share the same exit routine. The 
detour function's exit routine must include common logic that can be 
used with any function. This is discussed in the upcoming sections.</p>
<h4>Resuming Execution</h4>
<p>After redirecting the execution flow of the hooked function to the 
VEH function, the detour function is executed, but the original 
execution path is not resumed. To address this issue, it is necessary to
 set the "Resume Flag" located at bit 16 in the <code>EFLAGS</code> register. The provided <code>CONTINUE_EXECUTION</code> macro accepts a pointer to the thread context of the detour function and performs a bitwise OR operation on the <code>EFlags</code> element with a value generated by shifting <code>1</code> 16 bits to the left. This operation effectively sets the "Resume Flag" to 1, allowing the execution to continue.</p>
<pre><code class="language-C">#define CONTINUE_EXECUTION(CTX)(CTX-&gt;EFlags = CTX-&gt;EFlags | (1 &lt;&lt; 16))
</code></pre>
<p>The <code>CONTINUE_EXECUTION</code> macro must be called within every detour function constructed.</p>
<h4>Terminating The Original Function</h4>
<p>Once a detour function finishes executing, the program resumes 
execution at the hooked function. If the hooked function is called from 
within its detour version, it will be executed twice: once from the 
detour function and again upon resuming code execution, which is a 
problem that must be addressed.</p>
<p>To address this issue, one can modify the behavior by setting the <code>Rip</code> register, also known as the "next instruction pointer register" to point to a <code>ret</code> instruction. By doing so, instead of the <code>Rip</code> register pointing back to the hooked function for execution, it will be redirected to a <code>ret</code> instruction that effectively terminates the execution of the hooked function.</p>
<p>The <code>BLOCK_REAL</code> function is used when the hooked function
 is called from within its detour version. However, it can also be used 
in situations where the objective of hooking is to effectively terminate
 the execution of the hooked function, thereby preventing it from being 
executed. A more detailed explanation of this particular case will be 
provided in subsequent modules that dive into the topic of Event Tracing
 for Windows (ETW). Utilizing the <code>BLOCK_REAL</code> function will result in the following execution flow:</p>
<p><img src="9_files/hbp-1-block-exec-245032661-d65ed5ab-008d-41c5-9836-b86b1921d.png" alt="image"></p>
<p>The <code>BLOCK_REAL</code> function, shown below, takes a pointer to the thread context of the detour function and modifies the value of the <code>Rip</code> register (on 64-bit systems) or the <code>Eip</code> register (on 32-bit systems) to point to a <code>ret</code> instruction. The <code>ret</code> instruction is defined as a variable in the <code>.text</code> section of the implementation (recall the <em>Payload Placement - .text Section</em> module).</p>
<pre><code class="language-C">#pragma section(".text")
__declspec(allocate(".text")) const unsigned char ucRet[] = { 0xC3 };

// Called in the detour function to block the execution of the original hooked function
VOID BLOCK_REAL(IN PCONTEXT pThreadCtx) {
#ifdef _WIN64
	pThreadCtx-&gt;Rip = (ULONG_PTR)&amp;ucRet;
#elif _WIN32
	pThreadCtx-&gt;Eip = (DWORD)&amp;ucRet;
#endif // _WIN64
}
</code></pre>
<h4>Modifying The Return Value</h4>
<p>In certain hooking scenarios, there may be a requirement to modify 
the return value of the hooked function to a value different from its 
original value. This situation may occur when, for instance, hooking a 
memory scanning API and wanting to force its output to indicate a 
failure in detecting malicious code. This can be achieved by altering 
the value of the <code>Rax</code> register (on 64-bit systems) or the <code>Eax</code> register (on 32-bit systems).</p>
<p>Recall from the <em>Introduction To MASM Assembly</em> module, a function's return value is saved in the <code>Rax</code> or <code>Eax</code> register. Therefore, upon editing these registers, one can alter the return value of the hooked API. The <code>RETURN_VALUE</code> macro implements the same approach described.</p>
<p><code>RETURN_VALUE</code> takes two parameters, <code>CTX</code> and <code>VALUE</code>, representing a pointer to the thread's context, and the new return value to set, respectively.</p>
<pre><code class="language-C">#ifdef _WIN64
#define RETURN_VALUE(CTX, VALUE)((ULONG_PTR)CTX-&gt;Rax = (ULONG_PTR)VALUE)
#elif _WIN32
#define RETURN_VALUE(CTX, VALUE)((ULONG_PTR)CTX-&gt;Eax = (ULONG_PTR)VALUE)
#endif // _WIN64
</code></pre>
<h3>Hooking Example (1)</h3>
<p>Now that the hardware breakpoint implementation is finalized, let's consider an example of hooking the <code>MessageBoxA</code> WinAPI. In this case, the detour function of <code>MessageBox</code> will solely modify its original parameters utilizing the <code>SETPARM_X</code> macros. The <code>MessageBoxADetour</code> function below is <code>MessageBox</code>'s detour function.</p>
<pre><code class="language-C">VOID MessageBoxADetour(PCONTEXT pThreadCtx) {

	printf("[i] MessageBoxA's Old Parameters: \n");
	printf("\t&gt; %s \n", (char*)GETPARM_2(pThreadCtx));
	printf("\t&gt; %s \n", (char*)GETPARM_3(pThreadCtx));

	SETPARM_2(pThreadCtx, "This Is The Hook");
	SETPARM_3(pThreadCtx, "MessageBoxADetour");
	SETPARM_4(pThreadCtx, (MB_OK | MB_ICONEXCLAMATION));

	CONTINUE_EXECUTION(pThreadCtx);
}
</code></pre>
<p>After modifying the hooked function's parameters in the <code>MessageBoxADetour</code> function, the <code>CONTINUE_EXECUTION</code> macro is called to proceed with the execution past the breakpoint. Hooking the <code>MessageBox</code> WinAPI is done via the following main function.</p>
<pre><code class="language-C">int main() {

	// Initialize 
	if (!InitializeHardwareBPVariables())
		return -1;

	// [ NOT HOOKED ]
	MessageBoxA(NULL, "This Is A Normal MsgBoxA Call (0)", "Normal", MB_OK);

	printf("[i] Installing Hooks ... ");
	// Hook 'MessageBoxA' to call 'MessageBoxADetour' instead - using the Dr0 register
	if (!SetHardwareBreakingPnt(MessageBoxA, MessageBoxADetour, Dr0))
		return -1;
	printf("[+] DONE \n");

	// [ HOOKED ]
	MessageBoxA(NULL, "This Wont Execute", "Will it ?", MB_OK);

	// Unhooking the installed hook on 'Dr0'
	printf("[i] Uninstalling Hooks ... ");
	if (!RemoveHardwareBreakingPnt(Dr0)) 
		return -1;
	printf("[+] DONE \n");

	// [ NOT HOOKED ]
	MessageBoxA(NULL, "This Is A Normal MsgBoxA Call (1)", "Normal", MB_OK);

	// Clean up
	UnintializeHardwareBPVariables();
	printf("[#] Press &lt;Enter&gt; To Quit ... ");
	getchar();
	return 0;
}
</code></pre>
<p>Executing this example program will result in the following output:</p>
<p>1.The first <code>MessageBoxA</code> call, before installing the hook.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-441011385-4272feba-f1bd-4071-b6ab-685bd9555b3a.png">
<p>2.The second <code>MessageBoxA</code> call, where the <code>MessageBoxADetour</code> function is executed instead.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-541011482-32d80e10-37ca-4de1-8273-bdca89e5eae2.png">
<p>3.The third <code>MessageBoxA</code> call, after removing the hook.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-641011597-dcc87b89-ac64-4605-8ebc-d8c63f1e3a9c.png">
<h3>Hooking Example (2)</h3>
<p>In this example, an attempt will be made to hook two WinAPI functions while utilizing the <code>BLOCK_REAL</code> and <code>RETURN_VALUE</code> functions. The detour function <code>MessageBoxADetour</code> shown below serves as the detour function for <code>MessageBoxA</code>. Unlike the earlier implementation, this function does not modify the original function parameters. Instead, <code>MessageBoxADetour</code> directly invokes the <code>MessageBoxA</code> WinAPI with different parameters. The function also utilizes the <code>RETURN_VALUE</code> macro to return the value obtained from the new <code>MessageBoxA</code> call as the output of the original function. Furthermore, the <code>BLOCK_REAL</code> function is employed to terminate the execution of the original hooked <code>MessageBoxA</code> call, causing it to execute a <code>ret</code> instruction instead.</p>
<pre><code class="language-C">VOID MessageBoxADetour(PCONTEXT pThreadCtx) {

	printf("[i] MessageBoxA's Old Parameters: \n");
	printf("\t&gt; %s \n", (char*)GETPARM_2(pThreadCtx));
	printf("\t&gt; %s \n", (char*)GETPARM_3(pThreadCtx));

	
	RETURN_VALUE(pThreadCtx, MessageBoxA(NULL, "This is the hook", "MessageBoxADetour", MB_OK | MB_ICONEXCLAMATION));
	BLOCK_REAL(pThreadCtx);

	CONTINUE_EXECUTION(pThreadCtx);
}
</code></pre>
<p>This implementation will hook another function, <code>Sleep</code>, where its detour version, <code>SleepDetour</code>, is shown below. The function simply terminates the execution of the hooked <code>Sleep</code> function. As a result, the <code>Sleep</code> function will appear as if it was never called within the implementation.</p>
<pre><code class="language-C">VOID SleepDetour(PCONTEXT pThreadCtx) {

	printf("[i] Sleep's Old Parameters: \n");
	printf("\t&gt; %d \n", (DWORD)GETPARM_1(pThreadCtx));

	BLOCK_REAL(pThreadCtx);
	
	CONTINUE_EXECUTION(pThreadCtx);
}
</code></pre>
<p>The main function is shown below which incorporates both hooks, making use of the previously mentioned detour functions.</p>
<pre><code class="language-C">int main() {

	// Initialize 
	if (!InitializeHardwareBPVariables())
		return -1;


	// NOT HOOKED
	MessageBoxA(NULL, "This Is A Normal MsgBoxA Call (0)", "Normal", MB_OK);


	printf("[i] Installing Hooks ... ");
	// Hook 'MessageBoxA' to call 'MessageBoxADetour' instead - using the Dr0 register
	if (!SetHardwareBreakingPnt(MessageBoxA, MessageBoxADetour, Dr0))
		return -1;
	
	// Hook 'Sleep' to call 'SleepDetour' instead - using the Dr1 register
	if (!SetHardwareBreakingPnt(Sleep, SleepDetour, Dr1))
		return -1;
	printf("[+] DONE \n");


	// HOOKED
	MessageBoxA(NULL, "This Wont Execute", "Will it ?", MB_OK);
	// HOOKED
	Sleep(-1);

	
	// Unhooking the installed hook on 'Dr0'
	printf("[i] Uninstalling Hooks ... ");
	if (!RemoveHardwareBreakingPnt(Dr0)) 
		return -1;
	printf("[+] DONE \n");

	
	// NOT HOOKED
	MessageBoxA(NULL, "This Is A Normal MsgBoxA Call (1)", "Normal", MB_OK);
	// HOOKED
	Sleep(-1);


	// Clean up
	UnintializeHardwareBPVariables();
	printf("[#] Press &lt;Enter&gt; To Quit ... ");
	getchar();
	return 0;
}
</code></pre>
<p>The above program will result in the following output:</p>
<p>1.The first <code>MessageBoxA</code> call, before installing the hook.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-741029845-847a6885-829e-4610-8860-000dbf3dc7ba.png">
<p>2.The second <code>MessageBoxA</code> call, where the <code>MessageBoxADetour</code> function is executed instead.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-841030064-858e6001-8fdc-4690-972f-4c568ae475c4.png">
<p>3.The hooked <code>Sleep</code> function, where the infinite sleep call is terminated. In addition to that, the <code>Dr0</code> register (<code>MessageBoxA</code>) breakpoint is removed.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-941030317-492ef77a-814a-41c4-ad32-d48718468e0f.png">
<p>4.Another infinite sleep call while being terminated.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-141030512-10-4a41-4c90-8e89-2e959613e4c5.png">
<h3>Video Demo</h3>
<video style="margin:auto" width="1400" controls="controls">
  <source src="9_files/hbp1-demo.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>

    </div>

    
        
</div>              </div>
              
              <div id="accessory-container" class="flex flex-col h-full lg:min-w-[500px] w-[500px]">
    <div id="objectives" class="hidden p-4 border-r border-b bg-gray-900 border-gray-600 font-code w-full h-full">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Objectives</div>
                                                                                    <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-0" data-objective-id="0" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Familiarize yourself with the role of the debug registers Dr0-3 and Dr7</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-1" data-objective-id="1" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Understand the VEH's role in the implementation</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-2" data-objective-id="2" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Learn how to implement a detour function</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-3" data-objective-id="3" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Implement a detour function that calls the hooked function without using 'BLOCK_REAL', what happens?</label>
                </div>
                                              
    </div>
    <div id="toc-container" class=" p-4 border-r border-b border-gray-600 w-full h-full">
    <div class="sticky top-0 bg-gray-800 rounded-xl">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg rounded-t-xl">
        Table of Contents
        </div>

        
        <div id="toc-skeleton" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2 ml-8 animate-pulse space-y-2">
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        <div class="h-4 w-2/3 bg-white/10 rounded"></div>
        <div class="h-3 w-5/6 bg-white/10 rounded"></div>
        <div class="h-3 w-4/6 bg-white/10 rounded"></div>
        <div class="h-3 w-3/6 bg-white/10 rounded"></div>
        </div>

        
        <div id="toc-content" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2">
        
        </div>
    </div>
    </div>

        <script>
    // If ToC starts open, build it once the DOM is ready
    document.addEventListener('DOMContentLoaded', function () {
        var el = document.getElementById('toc-content');
        if (el && !el.innerHTML.trim() && typeof extractHeadings === 'function') {
        extractHeadings();
        }
    });
    </script>
    
    <div id="maldevDB" class="hidden p-4 border-r border-b border-gray-600 font-code w-full h-full">
        <img class="w-[500px] mb-4" src="9_files/maldev-db-logo.png">
        <form id="searchForm" class="flex flex-col items-center justify-center w-full font-mono">
            <div class="relative flex w-full border border-solid border-gray-700 rounded-3xl">
            <i class="absolute fa fa-search text-gray-400 top-[14px] left-4 z-20"></i>
            <input placeholder="Search Maldev Database" type="search" name="q" autocomplete="off" id="searchInput" maxlength="85" class="relative m-0 -mr-0.5 h-[46px] w-full rounded-l-3xl  bg-transparent px-10 py-[0.25rem] font-normal leading-[1.6] text-white outline-none focus:bg-gray-800 focus:border-r focus:border-gray-700" aria-label="Search">
                <button class=" w-[70px] bg-gray-800 flex items-center justify-center rounded-r-3xl px-6 py-2.5 text-white hover:bg-gray-700" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5">
                    <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div class="relative inline-block text-sm w-full md:w-fit">
                <select id="languageSelect" name="language" class="border rounded-md p-2.5 bg-gray-800 border-gray-600 placeholder-gray-400 text-white outline-none appearance-none w-full pr-8 my-4">
                    <option value="all" selected="selected">All languages</option>
                    <option value="c">C</option>
                    <option value="cpp">C++</option>
                    <option value="python">Python</option>
                    <option value="nim">Nim</option>
                    <option value="rust">Rust</option>
                    
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                    <svg class="h-4 w-4 text-gray-700" fill="#fff" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                        <path d="M5.516 7.548c.436-.446 1.045-.481 1.576 0L10 10.405l2.908-2.857c.531-.481 1.141-.446 1.576 0 .436.445.408 1.197 0 1.643l-3.564 3.642c-.214.223-.502.335-.92.335s-.707-.112-.92-.335l-3.564-3.642c-.408-.446-.436-1.198 0-1.643z"></path>
                    </svg>
                </div>
            </div>
        </form>
        <div class="resultsWrapper">
            <div id="noResults" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    No results found.
                </div>
            </div>
            <div id="rateLimited" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    HTTP 429 - You have been rate limited.
                </div>
            </div>

            <!-- Results here -->

            <div class="flex justify-center mt-6">
                <button id="loadMore" class="hidden bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-600 font-mono text-sm">
                    Load More
                </button>
            </div>
        </div>
    </div>
</div>
<div id="progress-container" class="hidden flex-col lg:min-w-[500px]">
    <div id="progress" class="p-4 border-r overflow-auto border-b border-gray-600 font-code w-full min-h-full">
    <div class="max-h-[300px]">
                <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">New Modules Progress</div>
                                    <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-1" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./1.html">
                    <div for="module-1" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 1 - Binary Metadata Modification
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-2" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./2.html">
                    <div for="module-2" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 2 - Thread Enumeration - NtQuerySystemInformation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-3" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./3.html">
                    <div for="module-3" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 3 - Custom WinAPI Functions
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-4" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./4.html">
                    <div for="module-4" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 4 - Exploiting EDRs For Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-5" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./5.html">
                    <div for="module-5" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 5 - Introduction To MASM Assembly
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-6" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./6.html">
                    <div for="module-6" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 6 - Evasion With File Bloating
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-7" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./7.html">
                    <div for="module-7" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 7 - Bring Your Own Protocol Handler
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-8" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./8.html">
                    <div for="module-8" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 8 - Bring Your Own File Extension
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-9" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./9.html">
                    <div for="module-9" class="ml-2 text-sm font-medium 
                                bg-blue-700 font-bold rounded-sm">
                        Module 9 - Utilizing Hardware Breakpoints For Hooking (1)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-10" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./10.html">
                    <div for="module-10" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 10 - Utilizing Hardware Breakpoints For Hooking (2)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-11" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./11.html">
                    <div for="module-11" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 11 - Utilizing Hardware Breakpoints For Credential Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-12" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./12.html">
                    <div for="module-12" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 12 - Event Tracing For Windows - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-13" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./13.html">
                    <div for="module-13" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 13 - Event Tracing For Windows - ETW Tools
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-14" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./14.html">
                    <div for="module-14" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 14 - Event Tracing For Windows - ETW Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-15" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./15.html">
                    <div for="module-15" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 15 - Event Tracing for Windows - Improved Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-16" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./16.html">
                    <div for="module-16" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 16 - Event Tracing for Windows - Patchless ETW Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-17" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./17.html">
                    <div for="module-17" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 17 - Event Tracing For Windows - ETW Provider Session Hijacking
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-18" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./18.html">
                    <div for="module-18" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 18 - Antimalware Scan Interface - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-19" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./19.html">
                    <div for="module-19" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 19 - Antimalware Scan Interface - AMSI Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-20" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./20.html">
                    <div for="module-20" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 20 - Antimalware Scan Interface - AMSI Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-21" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./21.html">
                    <div for="module-21" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 21 - Building a DRM-equipped Malware
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-22" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./22.html">
                    <div for="module-22" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 22 - Introduction to Havoc C&amp;C
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-23" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./23.html">
                    <div for="module-23" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 23 - Building An Evasive DLL Payload Loader
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-24" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./24.html">
                    <div for="module-24" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 24 - Introduction To DLL Sideloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-25" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./25.html">
                    <div for="module-25" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 25 - Practical DLL Sideloading Example
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-26" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./26.html">
                    <div for="module-26" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 26 - DLL Sideloading For EDR Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-27" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./27.html">
                    <div for="module-27" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 27 - Bring Your Own Vulnerable Driver
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-28" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./28.html">
                    <div for="module-28" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 28 - Local PE Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-29" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./29.html">
                    <div for="module-29" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 29 - Reflective DLL Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-30" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./30.html">
                    <div for="module-30" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 30 - PeFluctuation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-31" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./31.html">
                    <div for="module-31" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 31 - Building a PE Packer
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-32" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./32.html">
                    <div for="module-32" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 32 - Malware Directory Placement
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-33" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./33.html">
                    <div for="module-33" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 33 - Utilizing Fibers For Payload Execution
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-34" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./34.html">
                    <div for="module-34" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 34 - TLS Callbacks For Anti-Debugging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-35" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./35.html">
                    <div for="module-35" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 35 - Threadless Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-36" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./36.html">
                    <div for="module-36" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 36 - Module Stomping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-37" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./37.html">
                    <div for="module-37" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 37 - Module Overloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-38" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./38.html">
                    <div for="module-38" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 38 - Process Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-39" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./39.html">
                    <div for="module-39" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 39 - Ghost Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-40" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./40.html">
                    <div for="module-40" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 40 - Ghostly Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-41" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./41.html">
                    <div for="module-41" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 41 - Herpaderping Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-42" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./42.html">
                    <div for="module-42" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 42 - Herpaderply Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-43" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./43.html">
                    <div for="module-43" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 43 - Shellcode Reflective DLL Injection (sRDI)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-44" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./44.html">
                    <div for="module-44" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 44 - Patchless Threadless Injection Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-45" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./45.html">
                    <div for="module-45" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 45 - Tampered Syscalls Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-46" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./46.html">
                    <div for="module-46" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 46 - Exploiting EDRs For Evasion - Preventing EDR From Taking Action
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-47" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./47.html">
                    <div for="module-47" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 47 - Exploiting EDRs For Evasion - EDR LOLBINS
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-48" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./48.html">
                    <div for="module-48" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 48 - Process Hypnosis
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-49" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./49.html">
                    <div for="module-49" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 49 - Introduction To Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-50" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./50.html">
                    <div for="module-50" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 50 - Writing Beacon Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-51" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./51.html">
                    <div for="module-51" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 51 - Object File Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-52" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./52.html">
                    <div for="module-52" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 52 - Exploiting EDRs For Evasion - Finding Internal Exclusion List
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-53" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./53.html">
                    <div for="module-53" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 53 - Introduction To Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-54" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./54.html">
                    <div for="module-54" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 54 - Introduction to Ekko and Zilean Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-55" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./55.html">
                    <div for="module-55" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 55 - Introduction to Foliage Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-56" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./56.html">
                    <div for="module-56" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 56 - Implementing Ekko With Stack Spoofing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-57" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./57.html">
                    <div for="module-57" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 57 - Token Manipulation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-58" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./58.html">
                    <div for="module-58" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 58 - Library Proxy Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-59" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./59.html">
                    <div for="module-59" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 59 - Heap Encryption With Ekko Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-60" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./60.html">
                    <div for="module-60" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 60 - Introduction To Executing .NET Assemblies 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-61" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./61.html">
                    <div for="module-61" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 61 - Evading Microsoft Defender Via Patching 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-62" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./62.html">
                    <div for="module-62" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 62 - .NET Assemblies - Patching System.Environment.Exit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-63" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./63.html">
                    <div for="module-63" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 63 - Capturing And Saving Screenshots Into Memory
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-64" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./64.html">
                    <div for="module-64" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 64 - Cross-Architecture Injection: x86 to x64 Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-65" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./65.html">
                    <div for="module-65" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 65 - KnownDll Cache Poisoning Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-66" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./66.html">
                    <div for="module-66" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 66 - Introduction to Keylogging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-67" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./67.html">
                    <div for="module-67" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 67 - Developing a Keylogger
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-68" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./68.html">
                    <div for="module-68" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 68 - Sending Keystrokes To Remote Server
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-69" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./69.html">
                    <div for="module-69" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 69 - Manipulating VEH For Local Code Execution 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-70" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./70.html">
                    <div for="module-70" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 70 - Introduction To LSASS Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-71" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./71.html">
                    <div for="module-71" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 71 - Fetching LSASS Handle And Bypassing PPL
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-72" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./72.html">
                    <div for="module-72" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 72 - LSASS Dump Via Handle Duplication
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-73" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./73.html">
                    <div for="module-73" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 73 - LSASS Dump Via RtlReportSilentProcessExit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-74" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./74.html">
                    <div for="module-74" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 74 - LSASS Dump Via Seclogon Race Condition
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-75" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./75.html">
                    <div for="module-75" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 75 - Dumping The SAM Database
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-76" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./76.html">
                    <div for="module-76" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 76 - Dumping The SAM Remotely
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-77" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./77.html">
                    <div for="module-77" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 77 - Dumping The SAM From Disk
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-78" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./78.html">
                    <div for="module-78" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 78 - Domain Enumeration Using MS-SAMR
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-79" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./79.html">
                    <div for="module-79" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 79 - Dumping Browser Cookies: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-80" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./80.html">
                    <div for="module-80" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 80 - Dumping Saved Logins: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-81" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./81.html">
                    <div for="module-81" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 81 - Dumping Browser Cookies: Chrome
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-82" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./82.html">
                    <div for="module-82" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 82 - Dumping Saved Logins: Chrome
                    </div>
                </a>
            </div>
                </div>
    </div>
</div>          </div>
      </div>

      
      <div class="flex">
  <div class="flex flex-row flex-wrap justify-center items-center w-full bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-r border-l border-gray-600/60 pl-4 pt-2 pb-2 rounded-bl-xl rounded-br-xl shadow-inner">

          <div class="mr-2">
        <a data-target="_self" href="./8.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Previous</button>
        </a>
      </div>
    
    <div class="mr-2">
      <a data-target="_self" href="../All Modules.html">
        <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Modules</button>
      </a>
    </div>

    <div class="my-2 mr-2">
      <form id="complete-module" action="./9/complete" method="POST">
      </form>
      <form id="uncomplete-module" action="./#" method="POST">
      </form>
    </div>

          <div class="mr-2">
        <a data-target="_self" href="./10.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Next</button>
        </a>
      </div>
    
  </div>
</div>

      
      <input type="hidden" id="objectives-completed" value="20973">

      
      <div id="copyWarning" class="fixed inset-0 hidden z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">
  <div class="relative bg-gray-800 border border-gray-600 rounded-2xl shadow-2xl p-8 max-w-lg w-11/12 text-center transform transition-all scale-100">
    <p class="text-2xl font-bold text-white mb-4 tracking-wide">
      Reminder
    </p>
    <p class="text-gray-300 text-base mb-6 leading-relaxed">
      To remain compliant with the Terms of Service, avoid copying the entire module and instead copy the necessary sections.
    </p>
    <button onclick="hideCopyWarning()" class="w-full text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center transition-all duration-200 bg-blue-600/80 hover:bg-blue-500/80 border border-blue-400/40 backdrop-blur-sm backdrop-saturate-150">
      I understand
    </button>
    <span class="absolute top-3 right-3 text-gray-400 hover:text-gray-200 cursor-pointer text-xl" onclick="hideCopyWarning()"></span>
  </div>
</div>


      
        </div>

  <footer id="footer" class="text-gray-400
    bg-gradient-to-t from-[#101926] via-[#172130] to-[#1e293b] backdrop-blur-md backdrop-saturate-150 z-20 border-t border-gray-700/50 border-gray-800
     hidden body-font">
    <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
      <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-gray-800 sm:py-2 sm:mt-0 mt-4"> 2025 Maldev Academy Inc.</p>
        <a href="https://x.com/maldevacademy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 1200 1227" xmlns="http://www.w3.org/2000/svg">
            <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"></path>
          </svg>            
        </a>
        <a href="https://github.com/Maldev-Academy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-6 h-6" fill="white" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg>
        </a>
      <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
        <a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
          Terms of Service
      </a></span><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
    </a></div><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos">
  </a></footer></template>

<div id="app-root">
  
  <div class="fixed bottom-4 right-5 bg-gray-900 text-white text-sm font-bold rounded-xl px-2 py-2 shadow-lg cursor-pointer z-20" onclick="window.scrollTo({ top: 0, behavior: 'smooth' });">
      <img src="9_files/module-up.svg" width="20px" alt="">
  </div>

  <div class="bg-[#101926] p-4">
      
      <div class="flex relative z-10">
    <input type="hidden" value="20973">
    <div class="md:flex-row flex-col flex md:items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-l border-t border-gray-600/60 pl-4 pt-2 pb-2 rounded-tl-xl">
        <div>
            Module 9 - Utilizing Hardware Breakpoints For Hooking (1)
        </div>
        <div class="ml-2 w-4 h-4 rounded-full shadow-inner bg-rose-500/90 ring-1 ring-rose-400/50"></div>

    </div>
    <div class="flex justify-end items-center w-1/2 bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 pr-4 pt-2 pb-2 rounded-tr-xl border-t border-r border-gray-600/60">
        <div class="progress-container pr-4">
        <img src="9_file#.svg" onclick="toggleProgress()" id="progressToggle" width="20" alt="Progress Toggle" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="enlarge-container pr-4">
        <img src="9_files/enlarge.svg" onclick="toggleScreenWidth()" id="enlargeToggle" width="20" alt="Screen Width" class="hover:bg-gray-600 rounded-sm cursor-pointer">
        </div>

        <div class="objectives-container pr-4">
        <img src="9_files/objectives.svg" onclick="toggleObjectives()" id="objectivesToggle" width="20" alt="Objectives" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>

        <div class="toc-container pr-4">
        <img src="9_files/toc.svg" onclick="toggleToC()" id="tocToggle" width="20" alt="ToC" class="hover:bg-gray-600 rounded-sm cursor-pointer bg-gray-600">
        </div>

        <div class="terminal-container  pr-4 ">
        <img src="9_files/ide.svg" onclick="toggleIde()" id="terminalToggle" width="22" alt="Terminal" class="hover:bg-gray-600 rounded-sm cursor-pointer ">
        </div>
                                    <div class="dl-container">
                <a href="https://maldevacademy.com/new/download/file/HardwareBPsHook" target="_blank">
                    <img src="9_files/dl.svg" class="hover:bg-gray-600 rounded-full cursor-pointer" width="20" alt="Download">
                </a>
                </div>
            
                            </div>
</div>
      <div id="height-container" class="flex h-full min-h-[800px]">
          <div class="flex max-w-full min-w-full">
              <div class="flex-1 min-w-0">
                  
                  <div id="description-container" class="viewer code-description h-full w-full bg-gray-800/70 backdrop-blur-md backdrop-saturate-150 p-4 px-5 md:px-10 lg:px-20 border border-t-0 border-gray-600/60 shadow-inner"><div class="toastui-editor-contents" style="overflow-wrap: break-word;">

    
    


    
    

    
    <div id="module-content" class="transition-opacity duration-300 opacity-100">
        <h2 id="toc-heading-0">Utilizing Hardware Breakpoints For Hooking (1)</h2>
<h3 id="toc-heading-1">Introduction</h3>
<p>In previous modules, hooks were implemented using trampolines by 
patching the original execution flow with unconditional jump shellcodes.
 The unconditional jump causes the execution flow to be redirected to a 
detour function, where it executes alternate code logic instead of the 
intended code of the original function.</p>
<p>Despite this method's effectiveness and seamless functionality, it can be easily detected by searching for the <code>jmp</code>
 instruction opcode. Additionally, hooks can be detected by comparing a 
function's binary representation in memory to that on disk which can 
expose runtime patches and thus detect any installed trampolines. Using 
trampolines also requires changing the memory permissions of the hooked 
function to allow writing the trampoline shellcode, which in itself can 
be an IoC.</p>
<p>A solution would be to utilize <a href="https://stackoverflow.com/questions/8878716/what-is-the-difference-between-hardware-and-software-breakpoints" target="_blank">hardware breakpoints</a> alongside a <a href="https://learn.microsoft.com/en-us/windows/win32/debug/vectored-exception-handling" target="_blank">Vectored Exception Handler</a> (VEH), which will be the main focus of this module.</p>
<h3 id="toc-heading-2">Understanding Hardware Breakpoints</h3>
<p>To understand hardware breakpoints, one must first understand 
software breakpoints. When installing a software breakpoint on an 
address  (e.g. when debugging on Visual Studio), an <code>int 3</code> instruction is injected into that address. This instruction is equivalent to the <code>0xCC</code> opcode on both 32-bit and 64-bit systems and is often referred to as a <a href="https://en.wikipedia.org/wiki/INT_(x86_instruction)#" target="_blank">software interrupt instruction</a>. This instruction raises a specific type of exception when executed which is handled by a pre-initialized <a href="https://learn.microsoft.com/en-us/windows/win32/debug/exception-handling" target="_blank">exception handler</a> that will be responsible for handling the triggered exception, and therefore control execution at the target address.</p>
<p>Hardware breakpoints work in the same manner by setting up an 
exception handler that will handle the exception raised at the target 
address. The main difference is how this exception is raised. For 
example, when setting a hardware breakpoint at address <code>X</code>, that address will be saved into one of four debug registers, <code>Dr0</code>, <code>Dr1</code>, <code>Dr2</code> or <code>Dr3</code>.
 These registers are used to store memory addresses where hardware 
breakpoints are set. When one of these registers is populated with an 
address, an <code>EXCEPTION_SINGLE_STEP</code> exception will be raised whenever execution reaches address <code>X</code>.</p>
<h3 id="toc-heading-3">EFLAGS Register</h3>
<p>As previously explained, four debug registers are used to store the target address <code>Dr0</code>, <code>Dr1</code>, <code>Dr2</code> or <code>Dr3</code>. In addition to that, hardware breakpoints use the <code>EFLAGS</code> register and the <code>Dr7</code> debug register.</p>
<p>The <code>EFLAGS</code> register has several flags, but the main focus is the Resume Flag (<code>RF</code>) which is bit 16 of the <code>EFLAGS</code>
 register. Setting this flag to 1 resumes code execution when execution 
is paused at a breakpoint. The following image shows the <code>EFLAGS</code> register and the Resume Flag within.</p>
<p><img src="9_files/hbp1-138849875-0e788a56-f6bd-447a-b89f-3cea372986b9.png" alt="image"></p>
<h3 id="toc-heading-4">Dr7 Register</h3>
<p>The <code>Dr7</code> register, also called the <em>debug control register</em>, enables or disables breakpoints. An image of the <code>Dr7</code> register is shown below which is taken from <a href="https://www.intel.com/content/dam/support/us/en/documents/processors/pentium4/sb/253669.pdf" target="_blank">Intel's Software Developers Manual</a>. The flags of interest for this module will be <code>G0-3</code> which have been highlighted in the image below.</p>
<p><img src="9_files/hbp1-239798257-e3d28618-6602-4e9a-b4e7-7058044214ed.png" alt="image"></p>
<h3 id="toc-heading-5">The Global Breakpoint Enable Flags</h3>
<p>The <code>G0-3</code> and <code>L0-3</code> flags are meant to enable
 and disable hardware breakpoints. As previously mentioned, this module 
will exclusively focus on the Global Breakpoint Enable Flags (<code>G0-3</code>) as they provide more control over the state of the breakpoint than the local flags do (<code>L0-3</code>).</p>
<p>As per the image of the <code>Dr7</code> register, the Global Breakpoint Enable Flags are at the following bit positions:</p>
<ul>
<li>
<p><code>G0</code> - Bit 1</p>
</li>
<li>
<p><code>G1</code> - Bit 3</p>
</li>
<li>
<p><code>G2</code> - Bit 5</p>
</li>
<li>
<p><code>G3</code> - Bit 7</p>
</li>
</ul>
<p>Depending on the breakpoint's position in the <code>Dr0-3</code> registers, the <code>G0-3</code> flags will be set to 1 to enable the breakpoint. For example, to enable a hardware breakpoint that's saved in the <code>Dr0</code> register, the <code>G0</code> flag should be set to 1. The same concept applies to the other <code>Dr</code> registers where enabling the breakpoint saved in <code>Dr1</code> is done via the <code>G1</code> flag, <code>Dr2</code> is enabled through <code>G2</code>, and <code>Dr3</code> is enabled through <code>G3</code>.</p>
<p>Disabling a hardware breakpoint follows the same concept as enabling hardware breakpoints with the difference being that the <code>G0-3</code> flags are set to 0 instead of 1.</p>
<h3 id="toc-heading-6">Hardware Breakpoints Algorithm</h3>
<p>Having acquired knowledge about how hardware breakpoints are set and 
removed, the second step will be establishing the groundwork for code 
implementation. Below are several key considerations to be aware of 
regarding implementing hardware breakpoints.</p>
<ul>
<li>
<p>Hardware breakpoints are not global breakpoints among all threads, 
instead, they only work for the thread that installs them. That is a 
thread with populated <code>Dr0-3</code> and <code>Dr7</code> registers.</p>
</li>
<li>
<p>Since hardware breakpoints must be saved in one of the <code>Dr0-3</code> registers, each thread can install a maximum of 4 hardware breakpoints at the same time.</p>
</li>
<li>
<p>Installing and uninstalling breakpoints will be done using the <code>GetThreadContext</code> and <code>SetThreadContext</code> WinAPIs. Where the <code>Dr0-3</code> and <code>Dr7</code> values of the calling thread can be altered.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/sync/critical-section-objects" target="_blank">Critical section objects</a>,
 although optional, will be utilized to ensure thread safety and 
synchronization when handling hardware breakpoints. The following 
WinAPIs functions are the ones used to work with critical object 
sections:</p>
<ul>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-initializecriticalsection" target="_blank">InitializeCriticalSection</a> - Initializes a critical section object by populating a <code>CRITICAL_SECTION</code> structure.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-entercriticalsection" target="_blank">EnterCriticalSection</a>
 - Enters a critical section, indicating that the calling thread wants 
to access a shared resource protected by the critical section.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-leavecriticalsection" target="_blank">LeaveCriticalSection</a> -Releases a critical section, indicating that the calling thread has finished accessing the shared resource.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-deletecriticalsection" target="_blank">DeleteCriticalSection</a> - Deletes a critical section object, freeing the associated resources.</p>
</li>
</ul>
</li>
<li>
<p>As mentioned earlier when code execution reaches a hardware breakpoint, an <code>EXCEPTION_SINGLE_STEP</code> exception is raised. This exception will be handled using a <a href="https://learn.microsoft.com/en-us/windows/win32/debug/vectored-exception-handling" target="_blank">Vectored Exception Handler</a> which is set using the following WinAPIs:</p>
<ul>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/errhandlingapi/nf-errhandlingapi-addvectoredexceptionhandler" target="_blank">AddVectoredExceptionHandler</a>
 - Registers a Vectored Exception Handler, allowing the specified 
exception handler function to be called when an exception occurs in the 
process.</p>
</li>
<li>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/errhandlingapi/nf-errhandlingapi-removevectoredexceptionhandler" target="_blank">RemoveVectoredExceptionHandler</a>
 - Removes a previously registered Vectored Exception Handler from the 
process, preventing the associated exception handler function from being
 called for future exceptions.</p>
</li>
</ul>
</li>
</ul>
<h3 id="toc-heading-7">How Hardware Breakpoint Hooks Work</h3>
<p>If a hardware breakpoint is set at the beginning of a function and 
that function is called, it will not execute immediately. Instead, an 
exception will be triggered and intercepted by our handler which then 
executes the detour function. Therefore, rather than the detour function
 being directly called when the hardware breakpoint is hit, the handler 
will be the one calling the detour function by simulating an 
exception-handling routine, as shown the image below.</p>
<p><img src="9_files/hbp1-344846744-a281884c-67db-413d-be5a-e010ddbf682e.png" alt="image"></p>
<p>The detour function takes on the responsibility of resuming execution by setting the Resume Flag (<code>RF</code>) in the <code>EFLAGS</code> register, thereby allowing the original code of the hooked function to be executed.</p>
<h3 id="toc-heading-8">Hooking Multiple Functions</h3>
<p>The VEH function executes detour functions by using their function 
pointers. As a result, it is necessary to have a function pointer for 
each detour function with the same data types and parameters. However, 
accomplishing this requires more complex code and can potentially lead 
to performance issues. This is because the VEH function needs to execute
 each detour function based on its predefined function pointer, which is
 stored somewhere in the implementation.</p>
<p>Therefore, the current module introduces a simple, yet effective 
solution, which consists of a single universal function pointer that can
 work with all functions. The detour function in this module will be 
designed to be flexible and adaptable, allowing it to intercept multiple
 functions without the need for predetermined function pointers.</p>
<h3 id="toc-heading-9">Code Implementation</h3>
<p>This module will demonstrate the installation of hardware breakpoint 
hooks on a single thread. The goal is to provide a straightforward 
implementation for improved understanding and clarity.</p>
<h4 id="toc-heading-10">Altering The Dr7 Register Value</h4>
<p>As mentioned earlier, the <code>Dr7</code> register will be responsible for enabling the installed hardware breakpoints via the <code>G0</code> through <code>G3</code> flags. Therefore the <code>SetDr7Bits</code> function, shown below, will be used to enable or disable an installed breakpoint.</p>
<p><code>SetDr7Bits</code> takes the following parameters:</p>
<ul>
<li>
<p><code>CurrentDr7Register</code> - The current <code>Dr7</code> register value.</p>
</li>
<li>
<p><code>StartingBitPosition</code> - The starting bit position. In other words, the position at which the bit modification will start.</p>
</li>
<li>
<p><code>NmbrOfBitsToModify</code> - The number of bits in <code>CurrentDr7Register</code> starting from <code>StartingBitPosition</code> position to modify.</p>
</li>
<li>
<p><code>NewBitValue</code> - The new value of the specified bit/s to be set.</p>
</li>
</ul>
<p><code>SetDr7Bits</code> returns the new value of the <code>Dr7</code> register after the bit modification.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">SetDr7Bits</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> CurrentDr7Register<span class="token punctuation">,</span> <span class="token keyword">int</span> StartingBitPosition<span class="token punctuation">,</span> <span class="token keyword">int</span> NmbrOfBitsToModify<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> NewBitValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> mask           <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1UL</span> <span class="token operator">&lt;&lt;</span> NmbrOfBitsToModify<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1UL</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> NewDr7Register <span class="token operator">=</span> <span class="token punctuation">(</span>CurrentDr7Register <span class="token operator">&amp;</span> <span class="token operator">~</span><span class="token punctuation">(</span>mask <span class="token operator">&lt;&lt;</span> StartingBitPosition<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>NewBitValue <span class="token operator">&lt;&lt;</span> StartingBitPosition<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> NewDr7Register<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4 id="toc-heading-11">Initializing The Address of The Breakpoint</h4>
<p>To set up a breakpoint, one should initialize one of the <code>Dr0-3</code> registers with the address of the breakpoint, and populate one of the <code>G0-3</code> flags accordingly. The <code>DRX</code> enumeration will be used to determine which register or flag position is to be populated.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">enum</span> <span class="token class-name">_DRX</span><span class="token punctuation">{</span>

	Dr0<span class="token punctuation">,</span>
	Dr1<span class="token punctuation">,</span>
	Dr2<span class="token punctuation">,</span>
	Dr3

<span class="token punctuation">}</span> DRX<span class="token punctuation">,</span> <span class="token operator">*</span> PDRX<span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>The next step is to construct two functions, one that installs and 
enables the breakpoint and the other removes it. These functions are 
called <code>SetHardwareBreakingPnt</code> and <code>RemoveHardwareBreakingPnt</code> respectively.</p>
<h4 id="toc-heading-12">Installing The Breakpoint</h4>
<p>The <code>SetHardwareBreakingPnt</code> function performs the task of assigning the value of <code>pAddress</code> to one of the local thread's <code>Dr0-3</code> registers based on the provided <code>Drx</code> parameter. This is accomplished by utilizing the WinAPI functions <code>GetThreadContext</code> and <code>SetThreadContext</code> with the pseudo handle (<code>-2</code>) representing the local thread.</p>
<p>The function <code>SetHardwareBreakingPnt</code> accepts three parameters:</p>
<ul>
<li>
<p><code>PVOID pAddress</code> - A pointer where the hardware breakpoint should be set.</p>
</li>
<li>
<p><code>PVOID fnHookFunc</code> - A pointer to the detour function.</p>
</li>
<li>
<p><code>DRX Drx</code> - An enumeration of type <code>DRX</code>, this value determines what register to populate.</p>
</li>
</ul>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOL <span class="token function">SetHardwareBreakingPnt</span><span class="token punctuation">(</span>IN PVOID pAddress<span class="token punctuation">,</span> IN PVOID fnHookFunc<span class="token punctuation">,</span> IN <span class="token keyword">enum</span> <span class="token class-name">DRX</span> Drx<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>pAddress <span class="token operator">||</span> <span class="token operator">!</span>fnHookFunc<span class="token punctuation">)</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>

	CONTEXT ThreadCtx <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>ContextFlags <span class="token operator">=</span> CONTEXT_DEBUG_REGISTERS <span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">// Get local thread context</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">GetThreadContext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>HANDLE<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ThreadCtx<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token function">ReportError</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"GetThreadContext"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Sets the value of the Dr0-3 registers </span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>Drx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> Dr0<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ThreadCtx<span class="token punctuation">.</span>Dr0<span class="token punctuation">)</span>
				ThreadCtx<span class="token punctuation">.</span>Dr0 <span class="token operator">=</span> pAddress<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> Dr1<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ThreadCtx<span class="token punctuation">.</span>Dr1<span class="token punctuation">)</span>
				ThreadCtx<span class="token punctuation">.</span>Dr1 <span class="token operator">=</span> pAddress<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> Dr2<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ThreadCtx<span class="token punctuation">.</span>Dr2<span class="token punctuation">)</span>
				ThreadCtx<span class="token punctuation">.</span>Dr2 <span class="token operator">=</span> pAddress<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> Dr3<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ThreadCtx<span class="token punctuation">.</span>Dr3<span class="token punctuation">)</span>
				ThreadCtx<span class="token punctuation">.</span>Dr3 <span class="token operator">=</span> pAddress<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">default</span><span class="token operator">:</span>
			<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Set the thread context</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">SetThreadContext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>HANDLE<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ThreadCtx<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token function">ReportError</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"SetThreadContext"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4 id="toc-heading-13">Enabling The Breakpoint</h4>
<p>Remember, the <code>SetHardwareBreakingPnt</code> function simply installs the hardware breakpoint but does not enable it on the determined register. To do so, the <code>SetDr7Bits</code> will be used.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token comment">// For reference</span>
<span class="token comment">// SetDr7Bits(unsigned long long CurrentDr7Register, int StartingBitPosition, int NmbrOfBitsToModify, unsigned long long NewBitValue);</span>

ThreadCtx<span class="token punctuation">.</span>Dr7 <span class="token operator">=</span> <span class="token function">SetDr7Bits</span><span class="token punctuation">(</span>ThreadCtx<span class="token punctuation">.</span>Dr7<span class="token punctuation">,</span> <span class="token punctuation">(</span>Drx <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>The line of code above does the following:</p>
<ul>
<li>
<p>If <code>Drx</code> is <code>0</code>, the starting bit position will be <code>(0 * 2) = 0</code>. Thus, the first bit from the significant bit (bit position 1 - <code>G0</code>) of <code>DR7</code> will be modified (set to 1).</p>
</li>
<li>
<p>If <code>Drx</code> is <code>1</code>, the starting bit position will be <code>(1 * 2) = 2</code>. Thus, the third bit from the least significant bit (bit position 3 - <code>G1</code>) of <code>DR7</code> will be modified (set to 1).</p>
</li>
<li>
<p>If <code>Drx</code> is <code>2</code>, the starting bit position will be <code>(2 * 2) = 4</code>. Thus, the fifth bit from the least significant bit (bit position 5 - <code>G2</code>) of <code>DR7</code> will be modified (set to 1).</p>
</li>
<li>
<p>If <code>Drx</code> is <code>3</code>, the starting bit position will be <code>(3 * 2) = 6</code>. Thus, the seventh bit from the least significant bit (bit position 7 - <code>G3</code>) of <code>DR7</code> will be modified (set to 1).</p>
</li>
</ul>
<h4 id="toc-heading-14">Detour Function Pointer</h4>
<p>Although the detour function pointer (<code>fnHookFunc</code>) will not be executed here, <code>fnHookFunc</code> must be saved in accordance with the position of the hooked function pointer (<code>pAddress</code>) in the <code>Dr0-3</code> registers. To handle this, a global array named <code>g_DetourFuncs</code>
 will be defined. This array can accommodate a maximum of four function 
pointers, which corresponds to the highest number of hardware 
breakpoints that can be installed in a thread. These pointers will be 
retrieved from the VEH at a later stage and executed there.</p>
<p>The <code>SetHardwareBreakingPnt</code> function is now complete, and the following is its complete version</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token comment">// Array of detour function pointers</span>
PVOID		g_DetourFuncs<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>	<span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// Maximum 4 hardware breakpoints </span>


BOOL <span class="token function">SetHardwareBreakingPnt</span><span class="token punctuation">(</span>IN PVOID pAddress<span class="token punctuation">,</span> IN PVOID fnHookFunc<span class="token punctuation">,</span> IN <span class="token keyword">enum</span> <span class="token class-name">DRX</span> Drx<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>pAddress <span class="token operator">||</span> <span class="token operator">!</span>fnHookFunc<span class="token punctuation">)</span>
		<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>

	CONTEXT ThreadCtx <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>ContextFlags <span class="token operator">=</span> CONTEXT_DEBUG_REGISTERS <span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">// Get local thread context</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">GetThreadContext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>HANDLE<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ThreadCtx<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token function">ReportError</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"GetThreadContext"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Sets the value of the Dr0-3 registers </span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>Drx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> Dr0<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ThreadCtx<span class="token punctuation">.</span>Dr0<span class="token punctuation">)</span>
				ThreadCtx<span class="token punctuation">.</span>Dr0 <span class="token operator">=</span> pAddress<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> Dr1<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ThreadCtx<span class="token punctuation">.</span>Dr1<span class="token punctuation">)</span>
				ThreadCtx<span class="token punctuation">.</span>Dr1 <span class="token operator">=</span> pAddress<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> Dr2<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ThreadCtx<span class="token punctuation">.</span>Dr2<span class="token punctuation">)</span>
				ThreadCtx<span class="token punctuation">.</span>Dr2 <span class="token operator">=</span> pAddress<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> Dr3<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ThreadCtx<span class="token punctuation">.</span>Dr3<span class="token punctuation">)</span>
				ThreadCtx<span class="token punctuation">.</span>Dr3 <span class="token operator">=</span> pAddress<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">default</span><span class="token operator">:</span>
			<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Saves the address of the detour function at index 'Drx' in 'g_DetourFuncs'</span>
	g_DetourFuncs<span class="token punctuation">[</span>Drx<span class="token punctuation">]</span> <span class="token operator">=</span> fnHookFunc<span class="token punctuation">;</span>

	<span class="token comment">// Enable the breakpoint: Populate the G0-3 flags depending on the saved breakpoint position in the Dr0-3 registers</span>
	ThreadCtx<span class="token punctuation">.</span>Dr7 <span class="token operator">=</span> <span class="token function">SetDr7Bits</span><span class="token punctuation">(</span>ThreadCtx<span class="token punctuation">.</span>Dr7<span class="token punctuation">,</span> <span class="token punctuation">(</span>Drx <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Set the thread context after editing it</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">SetThreadContext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>HANDLE<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ThreadCtx<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token function">ReportError</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"SetThreadContext"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4 id="toc-heading-15">RemoveHardwareBreakingPnt Function</h4>
<p>Finally, the <code>RemoveHardwareBreakingPnt</code> function removes the specified breakpoint by eliminating it from the context of the local thread, specifically from the <code>Dr0-3</code> registers, and disabling its corresponding flag. As done previously when installing the hardware breakpoint, <code>RemoveHardwareBreakingPnt</code> uses the <code>GetThreadContext</code> and the <code>SetThreadContext</code> WinAPIs, in addition to the helper function <code>SetDr7Bits</code> to nullify the target Global Breakpoint Enable Flag.</p>
<p>The <code>RemoveHardwareBreakingPnt</code> requires one parameter which is the <code>Drx</code> enumeration which determines what register to unset.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">BOOL <span class="token function">RemoveHardwareBreakingPnt</span><span class="token punctuation">(</span>IN <span class="token keyword">enum</span> <span class="token class-name">DRX</span> Drx<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	CONTEXT ThreadCtx <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>ContextFlags <span class="token operator">=</span> CONTEXT_DEBUG_REGISTERS <span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">GetThreadContext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>HANDLE<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ThreadCtx<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token function">ReportError</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"GetThreadContext"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Remove the address of the hooked function from the thread context</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>Drx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> Dr0<span class="token operator">:</span> <span class="token punctuation">{</span>
			ThreadCtx<span class="token punctuation">.</span>Dr0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> Dr1<span class="token operator">:</span> <span class="token punctuation">{</span>
			ThreadCtx<span class="token punctuation">.</span>Dr1 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> Dr2<span class="token operator">:</span> <span class="token punctuation">{</span>
			ThreadCtx<span class="token punctuation">.</span>Dr2 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">case</span> Dr3<span class="token operator">:</span> <span class="token punctuation">{</span>
			ThreadCtx<span class="token punctuation">.</span>Dr3 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">default</span><span class="token operator">:</span>
			<span class="token keyword">return</span> FALSE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// Disabling the hardware breakpoint by setting the target G0-3 flag to zero </span>
	ThreadCtx<span class="token punctuation">.</span>Dr7 <span class="token operator">=</span> <span class="token function">SetDr7Bits</span><span class="token punctuation">(</span>ThreadCtx<span class="token punctuation">.</span>Dr7<span class="token punctuation">,</span> <span class="token punctuation">(</span>Drx <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">SetThreadContext</span><span class="token punctuation">(</span><span class="token punctuation">(</span>HANDLE<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>ThreadCtx<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token function">ReportError</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"SetThreadContext"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3 id="toc-heading-16">Setting Up The VEH Function</h3>
<p>As previously mentioned, it is necessary to construct a VEH function to handle the <code>EXCEPTION_SINGLE_STEP</code>
 exception raised and redirect execution to the detour function. 
Furthermore, to create a universal function that works with all hooked 
functions, it is possible to define a single function pointer with one 
parameter of type <code>PCONTEXT</code>. This allows the detour function
 to retrieve and manipulate the parameters of the hooked function by 
utilizing thread context registers.</p>
<h4 id="toc-heading-17">Initializing The Exception Handler</h4>
<p>Setting a hardware breakpoint using the <code>SetHardwareBreakingPnt</code>
 function without an initialized exception handler will cause the 
program to crash shortly after the execution reaches the breakpoint. 
This program would crash because an unhandled exception was raised. To 
solve this problem, one must first set up a VEH, which is registered via
 the <code>AddVectoredExceptionHandler</code> WinAPI.</p>
<p>If <code>AddVectoredExceptionHandler</code> succeeds, it returns a handle to the exception handler.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">PVOID <span class="token function">AddVectoredExceptionHandler</span><span class="token punctuation">(</span>
  ULONG                       First<span class="token punctuation">,</span>		<span class="token comment">// The order in which the handler should be called. Should be set to '1' so that the handler will be the first handler to be called.</span>
  PVECTORED_EXCEPTION_HANDLER Handler		<span class="token comment">// A pointer to the handler to be called (pointer to the handler function).</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4 id="toc-heading-18">PVECTORED_EXCEPTION_HANDLER Structure</h4>
<p>According to <a href="https://learn.microsoft.com/en-us/windows/win32/api/winnt/nc-winnt-pvectored_exception_handler" target="_blank">Microsoft's documentation</a>, the <code>Handler</code> parameter is of type <code>PVECTORED_EXCEPTION_HANDLER</code>
 which defines how the handler function will look like. The handler 
function is a callback function that will get executed whenever an 
exception is raised. Where <code>PVECTORED_EXCEPTION_HANDLER</code> is a function pointer that is shown below.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">typedef</span> <span class="token function">LONG</span> <span class="token punctuation">(</span>NTAPI <span class="token operator">*</span>PVECTORED_EXCEPTION_HANDLER<span class="token punctuation">)</span><span class="token punctuation">(</span>
    <span class="token keyword">struct</span> <span class="token class-name">_EXCEPTION_POINTERS</span> <span class="token operator">*</span>ExceptionInfo
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4 id="toc-heading-19">EXCEPTION_POINTERS Structure</h4>
<p>The VEH function will receive a pointer to an <code>EXCEPTION_POINTERS</code>
 structure. This structure is intended to assist the handler in 
evaluating the situation and taking appropriate actions to resolve the 
raised exception, allowing the program's execution to continue. The <code>EXCEPTION_POINTERS</code> structure is defined as the following</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_EXCEPTION_POINTERS</span> <span class="token punctuation">{</span>
    PEXCEPTION_RECORD ExceptionRecord<span class="token punctuation">;</span>			
    PCONTEXT ContextRecord<span class="token punctuation">;</span>			<span class="token comment">// The thread context of the thread that raised the exception</span>
<span class="token punctuation">}</span> EXCEPTION_POINTERS<span class="token punctuation">,</span> <span class="token operator">*</span>PEXCEPTION_POINTERS<span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>When the detour function is executed, it must receive the <code>PEXCEPTION_POINTERS-&gt;ContextRecord</code> element as an argument.</p>
<h4 id="toc-heading-20">EXCEPTION_RECORD Structure</h4>
<p>The <code>EXCEPTION_RECORD</code> structure located within <code>EXCEPTION_POINTERS</code> contains information about the raised exception. Inside <code>EXCEPTION_RECORD</code>, the only elements of interest are <code>ExceptionCode</code> and <code>ExceptionAddress</code> which contain the exception code raised, and the address of where the exception occurred, respectively.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_EXCEPTION_RECORD</span> <span class="token punctuation">{</span>
   DWORD       ExceptionCode<span class="token punctuation">;</span>		<span class="token comment">// Code that identifies the specific type of exception raised.</span>
   DWORD       ExceptionFlags<span class="token punctuation">;</span>
   <span class="token keyword">struct</span>      <span class="token class-name">_EXCEPTION_RECORD</span> <span class="token operator">*</span>ExceptionRecord<span class="token punctuation">;</span>
   PVOID       ExceptionAddress<span class="token punctuation">;</span>	<span class="token comment">// Address where the exception occurred</span>
   DWORD       NumberParameters<span class="token punctuation">;</span>
   ULONG_PTR   ExceptionInformation<span class="token punctuation">[</span>EXCEPTION_MAXIMUM_PARAMETERS<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> EXCEPTION_RECORD<span class="token punctuation">;</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3 id="toc-heading-21">Handling The Hardware Breakpoint Exception</h3>
<p>Upon reaching a hardware breakpoint, the exception code raised is <code>EXCEPTION_SINGLE_STEP</code>, represented as <code>0x80000004</code> in hexadecimal. In the VEH function, it is crucial to note that <code>PEXCEPTION_POINTERS-&gt;PEXCEPTION_RECORD-&gt;ExceptionCode</code> should always be <code>EXCEPTION_SINGLE_STEP</code>.
 This determination allows us to know whether the exception originated 
from our installed breakpoints, as opposed to handling other exceptions 
such as <code>EXCEPTION_DIVIDED_BY_ZERO</code> and <code>EXCEPTION_STACK_OVERFLOW</code>, that can be caused by code bugs in the program.</p>
<p>Furthermore, the <code>PEXCEPTION_POINTERS-&gt;PEXCEPTION_RECORD-&gt;ExceptionAddress</code> element should always be equal to one of the <code>Dr0-3</code> debug registers. This is because <code>ExceptionAddress</code>
 is the address where the exception occurred, and the exception will 
come from our breakpoint which was previously set to one of the <code>Dr0-3</code> registers (recall the <code>SetHardwareBreakingPnt</code> function). With all of this in mind, two checks must be done:</p>
<ol>
<li>
<p>Ensure that the exception is indeed raised from a breakpoint by checking the exception's code.</p>
</li>
<li>
<p>Ensure that the exception's address is a hardware breakpoint by checking if it's equal to one of the <code>Dr0-3</code> debug registers.</p>
</li>
</ol>
<h4 id="toc-heading-22">VectorHandler Function</h4>
<p>The <code>VectorHandler</code> function shown below, performs the necessary checks mentioned.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">LONG WINAPI <span class="token function">VectorHandler</span><span class="token punctuation">(</span>PEXCEPTION_POINTERS pExceptionInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token comment">// If the exception is 'EXCEPTION_SINGLE_STEP' then its caused by a breakpoint and we should handle it</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionCode <span class="token operator">==</span> EXCEPTION_SINGLE_STEP<span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token comment">// Verify if the breakpoint is a hardware breakpoint we installed</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr0 <span class="token operator">||</span>
			pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr1 <span class="token operator">||</span>
			pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr2 <span class="token operator">||</span>
			pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr3<span class="token punctuation">)</span> <span class="token punctuation">{</span>

			<span class="token comment">/*
				The Hook Implementation
			*/</span>
			
			<span class="token comment">// Continue the execution - The exception is handled</span>
			<span class="token keyword">return</span> EXCEPTION_CONTINUE_EXECUTION<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// The exception is not handled:                                             \
	- Not from the hardware breakpoints	!(Dr0-3)                     \
	- The exception code is not 'EXCEPTION_SINGLE_STEP'</span>

	<span class="token keyword">return</span> EXCEPTION_CONTINUE_SEARCH<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3 id="toc-heading-23">The Hook Implementation</h3>
<p>In order to create an API hooking scenario from the VEH using the populated <code>g_DetourFuncs</code> array, one can cast each pointer within the array to a function pointer definition that only accepts a <code>PCONTEXT</code>
 parameter. Subsequently, execution can proceed by invoking these 
function pointers. The challenging aspect lies in retrieving the correct
 pointer from the array.</p>
<p>Back to the <code>SetHardwareBreakingPnt</code> function, each detour function pointer was saved into the <code>g_DetourFuncs</code> array according to the <code>Drx</code> enumeration parameter. For example, if <code>Drx</code> was <code>Dr1</code>,
 which is 1, the index of where the detour function pointer will be 
saved is then 1. The same logic can be used in the VEH, if the detected 
exception address was equal to that of the <code>Dr1</code> register, then the correct function pointer to fetch from the <code>g_DetourFuncs</code> array is index 1.</p>
<h4 id="toc-heading-24">Infinite Loop &amp; Workaround</h4>
<p>An important scenario to consider is the hooked function being called
 from within its detour version. This would result in an infinite loop 
(recall the <em>API Hooking - Detours Library</em> module). This 
situation arises because the hooked function will invoke its detour 
version, and the detour function, in turn, calls the original hooked 
function, resulting in an infinite loop.</p>
<p>To avoid this issue, one can disable the hardware breakpoint before 
executing the detour function pointer and then re-enable it when the 
detour function is executed. To do so, <code>RemoveHardwareBreakingPnt</code> and <code>SetHardwareBreakingPnt</code>
 will be called respectively in the VEH, and the detour function 
execution will occur in between, as shown in the following updated 
version of the <code>VectorHandler</code> function.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">LONG WINAPI <span class="token function">VectorHandler</span><span class="token punctuation">(</span>PEXCEPTION_POINTERS pExceptionInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token comment">// If the exception is 'EXCEPTION_SINGLE_STEP'; then its caused by a breakpoint and we should handle it</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionCode <span class="token operator">==</span> EXCEPTION_SINGLE_STEP<span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token comment">// Verify if the breakpoint is a hardware breakpoint we installed</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr0 <span class="token operator">||</span>
			pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr1 <span class="token operator">||</span>
			pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr2 <span class="token operator">||</span>
			pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr3<span class="token punctuation">)</span> <span class="token punctuation">{</span>

			<span class="token keyword">enum</span> <span class="token class-name">DRX</span> dwDrx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token comment">// Defining a function pointer that accepts one parameter of type 'PCONTEXT'</span>
			<span class="token function">VOID</span> <span class="token punctuation">(</span><span class="token operator">*</span>fnHookFunc<span class="token punctuation">)</span><span class="token punctuation">(</span>PCONTEXT<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

			<span class="token comment">// Detect the hw bp register (Dr0-3)</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr0<span class="token punctuation">)</span>
				dwDrx <span class="token operator">=</span> Dr0<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr1<span class="token punctuation">)</span>
				dwDrx <span class="token operator">=</span> Dr1<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr2<span class="token punctuation">)</span>
				dwDrx <span class="token operator">=</span> Dr2<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress <span class="token operator">==</span> pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token operator">-&gt;</span>Dr3<span class="token punctuation">)</span>
				dwDrx <span class="token operator">=</span> Dr3<span class="token punctuation">;</span>

			<span class="token comment">// Disable hw breakpoint to allow execution the hooked function from the detour function </span>
			<span class="token function">RemoveHardwareBreakingPnt</span><span class="token punctuation">(</span>dwDrx<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">// Execute the callback (detour function)</span>
			fnHookFunc <span class="token operator">=</span> g_DetourFuncs<span class="token punctuation">[</span>dwDrx<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token function">fnHookFunc</span><span class="token punctuation">(</span>pExceptionInfo<span class="token operator">-&gt;</span>ContextRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">// Enable the hw breakpoint again</span>
			<span class="token function">SetHardwareBreakingPnt</span><span class="token punctuation">(</span>pExceptionInfo<span class="token operator">-&gt;</span>ExceptionRecord<span class="token operator">-&gt;</span>ExceptionAddress<span class="token punctuation">,</span> g_DetourFuncs<span class="token punctuation">[</span>dwDrx<span class="token punctuation">]</span><span class="token punctuation">,</span> dwDrx<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">// Continue the execution - The exception is handled</span>
			<span class="token keyword">return</span> EXCEPTION_CONTINUE_EXECUTION<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// The exception is not handled:					\
	- Not from the hardware breakpoints	!(Dr0-3)			\
	- The exception code is not 'EXCEPTION_SINGLE_STEP'</span>

	<span class="token keyword">return</span> EXCEPTION_CONTINUE_SEARCH<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3 id="toc-heading-25">Fetching And Modifying The Hooked Function's Parameters</h3>
<p>As mentioned earlier, all of the detour functions have the same function declaration, accepting one parameter, <code>PCONTEXT</code>, and are of type <code>VOID</code>. Using the <code>PCONTEXT</code> parameter on 64-bit systems, one can fetch and alter the first four parameters of the hooked function through the <code>Rcx</code>, <code>Rdx</code>, <code>r8</code>, and <code>r9</code> registers located in the context structure.</p>
<p>If the hooked function requires more than four parameters, the <code>Rsp</code> register can be utilized for altering the stack parameters since all additional parameters are pushed to the stack. Recall the <em>Introduction To MASM Assembly</em>
 module, where this matter was discussed in more detail. On the other 
hand, on 32-bit systems, all parameters are pushed on the stack, 
therefore utilizing the <code>Esp</code> register is enough to fetch all the hooked function's parameters.</p>
<p>Furthermore, modifying these parameters depends upon their type, 
whether they are register parameters or stack parameters (the first 
through fourth parameters are register parameters). Once the type of the
 parameter is determined, one can proceed to modify the parameter's 
value accordingly, either by editing the registers or stack.</p>
<h4 id="toc-heading-26">GetFunctionArgument Function</h4>
<p>The <code>GetFunctionArgument</code> is used to fetch a hooked function's arguments. The function takes two parameters:</p>
<ul>
<li>
<p><code>pThreadCtx</code> - The thread context pointer that's passed to the detour function from our VEH.</p>
</li>
<li>
<p><code>dwParmIndex</code> - The index of the parameter to fetch.</p>
</li>
</ul>
<p>The return value is a pointer to an argument of the hooked function.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">PBYTE <span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>IN PCONTEXT pThreadCtx<span class="token punctuation">,</span> IN DWORD dwParmIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">_WIN64</span></span>
	<span class="token comment">// the first 4 arguments in x64 are in the "RCX - RDX - R8 - R9" registers</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>dwParmIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token number">0x01</span><span class="token operator">:</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>pThreadCtx<span class="token operator">-&gt;</span>Rcx<span class="token punctuation">;</span>
	<span class="token keyword">case</span> <span class="token number">0x02</span><span class="token operator">:</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>pThreadCtx<span class="token operator">-&gt;</span>Rdx<span class="token punctuation">;</span>
	<span class="token keyword">case</span> <span class="token number">0x03</span><span class="token operator">:</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>pThreadCtx<span class="token operator">-&gt;</span>R8<span class="token punctuation">;</span>
	<span class="token keyword">case</span> <span class="token number">0x04</span><span class="token operator">:</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>pThreadCtx<span class="token operator">-&gt;</span>R9<span class="token punctuation">;</span>
	<span class="token keyword">default</span><span class="token operator">:</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// else more arguments are pushed to the stack</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span>ULONG_PTR<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pThreadCtx<span class="token operator">-&gt;</span>Rsp <span class="token operator">+</span> <span class="token punctuation">(</span>dwParmIndex <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>PVOID<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token punctuation">(</span>DWORD_PTR<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pThreadCtx<span class="token operator">-&gt;</span>Esp <span class="token operator">+</span> <span class="token punctuation">(</span>dwParmIndex <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>PVOID<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// _WIN64</span></span>

<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Retrieving the stack parameters requires multiplying <code>dwParmIndex</code> by the size of the <code>PVOID</code> data type. On 64-bit systems, the <code>PVOID</code>
 data type occupies 8 bytes, while on 32-bit systems, it occupies 4 
bytes. This multiplication helps determine the offset of the parameter 
from the stack pointer register. Subsequently, the calculated offset is 
added to the <code>Rsp</code> register (in the case of x64 systems) or the <code>Esp</code> register (in the case of x32 systems).</p>
<h4 id="toc-heading-27">SetFunctionArgument Function</h4>
<p>The <code>SetFunctionArgument</code> function is used to set the hooked function's arguments. The function <code>SetFunctionArgument</code> takes the following parameters:</p>
<ul>
<li>
<p><code>pThreadCtx</code> - Thread context pointer, that's passed to the detour function from our VEH.</p>
</li>
<li>
<p><code>uValue</code> - The new parameter value to be set.</p>
</li>
<li>
<p><code>dwParmIndex</code> - The index of the parameter to edit.</p>
</li>
</ul>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">VOID <span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>IN PCONTEXT pThreadCtx<span class="token punctuation">,</span> IN ULONG_PTR uValue<span class="token punctuation">,</span> IN DWORD dwParmIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">_WIN64</span></span>

	<span class="token comment">// the first 4 arguments in x64 are in the "RCX - RDX - R8 - R9" registers</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>dwParmIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token number">0x01</span><span class="token operator">:</span>
		<span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>pThreadCtx<span class="token operator">-&gt;</span>Rcx <span class="token operator">=</span> uValue<span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> <span class="token number">0x02</span><span class="token operator">:</span>
		<span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>pThreadCtx<span class="token operator">-&gt;</span>Rdx <span class="token operator">=</span> uValue<span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> <span class="token number">0x03</span><span class="token operator">:</span>
		<span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>pThreadCtx<span class="token operator">-&gt;</span>R8 <span class="token operator">=</span> uValue<span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> <span class="token number">0x04</span><span class="token operator">:</span>
		<span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>pThreadCtx<span class="token operator">-&gt;</span>R9 <span class="token operator">=</span> uValue<span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token keyword">default</span><span class="token operator">:</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// else more arguments are pushed to the stack</span>
	<span class="token operator">*</span><span class="token punctuation">(</span>ULONG_PTR<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pThreadCtx<span class="token operator">-&gt;</span>Rsp <span class="token operator">+</span> <span class="token punctuation">(</span>dwParmIndex <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>PVOID<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> uValue<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
	<span class="token operator">*</span><span class="token punctuation">(</span>DWORD_PTR<span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pThreadCtx<span class="token operator">-&gt;</span>Esp <span class="token operator">+</span> <span class="token punctuation">(</span>dwParmIndex <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>PVOID<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> uValue<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// _WIN64</span></span>

<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4 id="toc-heading-28">Get &amp; Set Macros</h4>
<p>The functions <code>GetFunctionArgument</code> and <code>SetFunctionArgument</code>
 will exclusively be invoked from the detour function. Therefore, in 
order to simplify the retrieval and modification of the hooked 
function's parameters, both functions will be accessed via macros that 
enhance their efficiency and ease of use.</p>
<p>The <code>GetFunctionArgument</code> function will be called through the <code>GETPARM_X</code> macros, where <code>X</code> represents the index of the parameter to fetch. <code>GETPARM_X</code> takes one parameter, <code>CTX</code>, representing a pointer to the thread's context to pass to the <code>GetFunctionArgument</code> function.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GETPARM_1</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>	</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GETPARM_2</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GETPARM_3</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GETPARM_4</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GETPARM_5</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> <span class="token number">0x5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GETPARM_6</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GETPARM_7</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GETPARM_8</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> <span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GETPARM_9</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GETPARM_A</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> <span class="token number">0xA</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">GETPARM_B</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">GetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> <span class="token number">0xB</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>On the other hand, the function <code>SetFunctionArgument</code> will be called through the macros <code>SETPARM_X</code>, where <code>X</code> represents the index of the parameter to modify. <code>SETPARM_1</code> takes two parameters, <code>CTX</code> and <code>VALUE</code>, representing a pointer to the thread's context, and the parameter's new value to set, respectively.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SETPARM_1</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SETPARM_2</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SETPARM_3</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SETPARM_4</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SETPARM_5</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> <span class="token number">0x5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SETPARM_6</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SETPARM_7</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SETPARM_8</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> <span class="token number">0x8</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SETPARM_9</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SETPARM_A</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> <span class="token number">0xA</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SETPARM_B</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">SetFunctionArgument</span><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">,</span> <span class="token number">0xB</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3 id="toc-heading-29">Critical Sections</h3>
<p>As previously mentioned, the use of critical sections is not 
mandatory but understanding this concept is important. Critical sections
 serve the purpose of preventing race conditions, which arise when 
multiple threads or processes simultaneously attempt to access and 
modify the same shared resource. In this module, the shared resource in 
question is the global array <code>g_DetourFuncs</code>. Consequently, any function that interacts with <code>g_DetourFuncs</code>
 should do so through critical sections. The following points explain 
the usage of the critical section WinAPIs. It has been broken up into 
points for simplification.</p>
<ul>
<li>
<p>The initialization of critical sections requires the usage of the <code>InitializeCriticalSection</code> WinAPI. This function is invoked once to populate the <code>CRITICAL_SECTION</code> structure, which is subsequently utilized by other WinAPIs.</p>
</li>
<li>
<p>The <code>CRITICAL_SECTION</code> structure remains unaltered after initialization and is used in the <code>EnterCriticalSection</code> and <code>LeaveCriticalSection</code> WinAPIs.</p>
</li>
<li>
<p>The purpose of the <code>EnterCriticalSection</code> function is to enter the critical section before accessing the shared resource, namely <code>g_DetourFuncs</code>. Conversely, the <code>LeaveCriticalSection</code> function is used to exit the critical section after accessing the shared resource.</p>
</li>
<li>
<p>Upon completion of using critical sections, a program can delete the initialized object by invoking the <code>DeleteCriticalSection</code> WinAPI.</p>
</li>
<li>
<p>All of the previously mentioned critical section WinAPIs accept a single parameter, <code>PCRITICAL_SECTION</code>, which represents a pointer to the previously initialized <code>CRITICAL_SECTION</code> structure.</p>
</li>
</ul>
<p>In the implementation, <code>g_DetourFuncs</code> was accessed twice, once in <code>SetHardwareBreakingPnt</code> and the other in the VEH function, <code>VectorHandler</code>. Therefore, these will be the only functions that will use the <code>EnterCriticalSection</code> and <code>LeaveCriticalSection</code> WinAPIs.</p>
<h3 id="toc-heading-30">Initialization And Cleanup</h3>
<p>In order to establish the VEH and the critical section object, it is 
necessary to create a new function that handles the creation and 
initialization of the required objects. Therefore, the <code>InitializeHardwareBPVariables</code> function, which is shown below, will be used to handle the creation and initialization of the previously mentioned objects.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">PVOID			    g_VectorHandler         <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>		<span class="token comment">// VEH exception handle</span>
CRITICAL_SECTION	    g_CriticalSection       <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>	<span class="token comment">// Crtitcal section</span>
PVOID			    g_DetourFuncs<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>        <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 	<span class="token comment">// Array of detour function pointers</span>

BOOL <span class="token function">InitializeHardwareBPVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token function">RtlSecureZeroMemory</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>g_CriticalSection<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>CRITICAL_SECTION<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">RtlSecureZeroMemory</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>g_DetourFuncs<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>g_DetourFuncs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// If 'g_CriticalSection' is not yet initialized</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>g_CriticalSection<span class="token punctuation">.</span>DebugInfo <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">InitializeCriticalSection</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>g_CriticalSection<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// If 'g_VectorHandler' is not yet initialized</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>g_VectorHandler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// Add 'VectorHandler' as the VEH function</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>g_VectorHandler <span class="token operator">=</span> <span class="token function">AddVectoredExceptionHandler</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>PVECTORED_EXCEPTION_HANDLER<span class="token punctuation">)</span><span class="token operator">&amp;</span>VectorHandler<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> 
			<span class="token keyword">return</span> <span class="token function">ReportError</span><span class="token punctuation">(</span><span class="token function">TEXT</span><span class="token punctuation">(</span><span class="token string">"AddVectoredExceptionHandler"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token punctuation">(</span>g_VectorHandler <span class="token operator">&amp;&amp;</span> g_CriticalSection<span class="token punctuation">.</span>DebugInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>On the other hand, it is recommended to have a dedicated function responsible for cleaning up the initialized objects. <code>UnintializeHardwareBPVariables</code> will invoke <code>DeleteCriticalSection</code> to delete the critical section object, and <code>RemoveVectoredExceptionHandler</code> to unregister the VEH. Additionally, the function will call <code>RemoveHardwareBreakingPnt</code> for all possible values of the <code>enum DRX</code>, to delete all installed breakpoints. The <code>UnintializeHardwareBPVariables</code> function is shown below.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">VOID <span class="token function">UnintializeHardwareBPVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token comment">// Remove breakpoints</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token function">RemoveHardwareBreakingPnt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// If the critical section is initialized, delete it</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>g_CriticalSection<span class="token punctuation">.</span>DebugInfo<span class="token punctuation">)</span>
		<span class="token function">DeleteCriticalSection</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>g_CriticalSection<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// If VEH is registered, remove it</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>g_VectorHandler<span class="token punctuation">)</span>
		<span class="token function">RemoveVectoredExceptionHandler</span><span class="token punctuation">(</span>g_VectorHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Cleanup the global variables</span>
	<span class="token function">RtlSecureZeroMemory</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>g_CriticalSection<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>CRITICAL_SECTION<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">RtlSecureZeroMemory</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>g_DetourFuncs<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>g_DetourFuncs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	g_VectorHandler <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3 id="toc-heading-31">Constructing The Detour Function</h3>
<p>As previously stated, a single detour function's definition is 
designed to handle all hooked functions. This function accepts a single 
parameter of type <code>PCONTEXT</code>, which is fetched from the <code>EXCEPTION_POINTERS</code> structure within the handler function. For example, the detour function for both <code>CreateFileA</code> and <code>MessageBoxW</code> WinAPIs will have the same definition that's shown below.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">VOID <span class="token function">DetourFunctionName</span><span class="token punctuation">(</span>IN PCONTEXT pThreadCtx<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// Detour function logic</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>The detour functions must also share the same exit routine. The 
detour function's exit routine must include common logic that can be 
used with any function. This is discussed in the upcoming sections.</p>
<h4 id="toc-heading-32">Resuming Execution</h4>
<p>After redirecting the execution flow of the hooked function to the 
VEH function, the detour function is executed, but the original 
execution path is not resumed. To address this issue, it is necessary to
 set the "Resume Flag" located at bit 16 in the <code>EFLAGS</code> register. The provided <code>CONTINUE_EXECUTION</code> macro accepts a pointer to the thread context of the detour function and performs a bitwise OR operation on the <code>EFlags</code> element with a value generated by shifting <code>1</code> 16 bits to the left. This operation effectively sets the "Resume Flag" to 1, allowing the execution to continue.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">CONTINUE_EXECUTION</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">)</span><span class="token punctuation">(</span>CTX<span class="token operator">-&gt;</span>EFlags <span class="token operator">=</span> CTX<span class="token operator">-&gt;</span>EFlags <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>The <code>CONTINUE_EXECUTION</code> macro must be called within every detour function constructed.</p>
<h4 id="toc-heading-33">Terminating The Original Function</h4>
<p>Once a detour function finishes executing, the program resumes 
execution at the hooked function. If the hooked function is called from 
within its detour version, it will be executed twice: once from the 
detour function and again upon resuming code execution, which is a 
problem that must be addressed.</p>
<p>To address this issue, one can modify the behavior by setting the <code>Rip</code> register, also known as the "next instruction pointer register" to point to a <code>ret</code> instruction. By doing so, instead of the <code>Rip</code> register pointing back to the hooked function for execution, it will be redirected to a <code>ret</code> instruction that effectively terminates the execution of the hooked function.</p>
<p>The <code>BLOCK_REAL</code> function is used when the hooked function
 is called from within its detour version. However, it can also be used 
in situations where the objective of hooking is to effectively terminate
 the execution of the hooked function, thereby preventing it from being 
executed. A more detailed explanation of this particular case will be 
provided in subsequent modules that dive into the topic of Event Tracing
 for Windows (ETW). Utilizing the <code>BLOCK_REAL</code> function will result in the following execution flow:</p>
<p><img src="9_files/hbp-1-block-exec-245032661-d65ed5ab-008d-41c5-9836-b86b1921d.png" alt="image"></p>
<p>The <code>BLOCK_REAL</code> function, shown below, takes a pointer to the thread context of the detour function and modifies the value of the <code>Rip</code> register (on 64-bit systems) or the <code>Eip</code> register (on 32-bit systems) to point to a <code>ret</code> instruction. The <code>ret</code> instruction is defined as a variable in the <code>.text</code> section of the implementation (recall the <em>Payload Placement - .text Section</em> module).</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression"><span class="token function">section</span><span class="token punctuation">(</span></span><span class="token string">".text"</span><span class="token expression"><span class="token punctuation">)</span></span></span>
<span class="token function">__declspec</span><span class="token punctuation">(</span><span class="token function">allocate</span><span class="token punctuation">(</span><span class="token string">".text"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> ucRet<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">0xC3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Called in the detour function to block the execution of the original hooked function</span>
VOID <span class="token function">BLOCK_REAL</span><span class="token punctuation">(</span>IN PCONTEXT pThreadCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">_WIN64</span></span>
	pThreadCtx<span class="token operator">-&gt;</span>Rip <span class="token operator">=</span> <span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span><span class="token operator">&amp;</span>ucRet<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">elif</span> <span class="token expression">_WIN32</span></span>
	pThreadCtx<span class="token operator">-&gt;</span>Eip <span class="token operator">=</span> <span class="token punctuation">(</span>DWORD<span class="token punctuation">)</span><span class="token operator">&amp;</span>ucRet<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// _WIN64</span></span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h4 id="toc-heading-34">Modifying The Return Value</h4>
<p>In certain hooking scenarios, there may be a requirement to modify 
the return value of the hooked function to a value different from its 
original value. This situation may occur when, for instance, hooking a 
memory scanning API and wanting to force its output to indicate a 
failure in detecting malicious code. This can be achieved by altering 
the value of the <code>Rax</code> register (on 64-bit systems) or the <code>Eax</code> register (on 32-bit systems).</p>
<p>Recall from the <em>Introduction To MASM Assembly</em> module, a function's return value is saved in the <code>Rax</code> or <code>Eax</code> register. Therefore, upon editing these registers, one can alter the return value of the hooked API. The <code>RETURN_VALUE</code> macro implements the same approach described.</p>
<p><code>RETURN_VALUE</code> takes two parameters, <code>CTX</code> and <code>VALUE</code>, representing a pointer to the thread's context, and the new return value to set, respectively.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">_WIN64</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">RETURN_VALUE</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>CTX<span class="token operator">-&gt;</span>Rax <span class="token operator">=</span> <span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>VALUE<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">elif</span> <span class="token expression">_WIN32</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">RETURN_VALUE</span><span class="token expression"><span class="token punctuation">(</span>CTX<span class="token punctuation">,</span> VALUE<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>CTX<span class="token operator">-&gt;</span>Eax <span class="token operator">=</span> <span class="token punctuation">(</span>ULONG_PTR<span class="token punctuation">)</span>VALUE<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// _WIN64</span></span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<h3 id="toc-heading-35">Hooking Example (1)</h3>
<p>Now that the hardware breakpoint implementation is finalized, let's consider an example of hooking the <code>MessageBoxA</code> WinAPI. In this case, the detour function of <code>MessageBox</code> will solely modify its original parameters utilizing the <code>SETPARM_X</code> macros. The <code>MessageBoxADetour</code> function below is <code>MessageBox</code>'s detour function.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">VOID <span class="token function">MessageBoxADetour</span><span class="token punctuation">(</span>PCONTEXT pThreadCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[i] MessageBoxA's Old Parameters: \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\t&gt; %s \n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GETPARM_2</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\t&gt; %s \n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GETPARM_3</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">SETPARM_2</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">,</span> <span class="token string">"This Is The Hook"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SETPARM_3</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">,</span> <span class="token string">"MessageBoxADetour"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SETPARM_4</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">,</span> <span class="token punctuation">(</span>MB_OK <span class="token operator">|</span> MB_ICONEXCLAMATION<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">CONTINUE_EXECUTION</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>After modifying the hooked function's parameters in the <code>MessageBoxADetour</code> function, the <code>CONTINUE_EXECUTION</code> macro is called to proceed with the execution past the breakpoint. Hooking the <code>MessageBox</code> WinAPI is done via the following main function.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token comment">// Initialize </span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">InitializeHardwareBPVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

	<span class="token comment">// [ NOT HOOKED ]</span>
	<span class="token function">MessageBoxA</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"This Is A Normal MsgBoxA Call (0)"</span><span class="token punctuation">,</span> <span class="token string">"Normal"</span><span class="token punctuation">,</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[i] Installing Hooks ... "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// Hook 'MessageBoxA' to call 'MessageBoxADetour' instead - using the Dr0 register</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">SetHardwareBreakingPnt</span><span class="token punctuation">(</span>MessageBoxA<span class="token punctuation">,</span> MessageBoxADetour<span class="token punctuation">,</span> Dr0<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] DONE \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// [ HOOKED ]</span>
	<span class="token function">MessageBoxA</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"This Wont Execute"</span><span class="token punctuation">,</span> <span class="token string">"Will it ?"</span><span class="token punctuation">,</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Unhooking the installed hook on 'Dr0'</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[i] Uninstalling Hooks ... "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">RemoveHardwareBreakingPnt</span><span class="token punctuation">(</span>Dr0<span class="token punctuation">)</span><span class="token punctuation">)</span> 
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] DONE \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// [ NOT HOOKED ]</span>
	<span class="token function">MessageBoxA</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"This Is A Normal MsgBoxA Call (1)"</span><span class="token punctuation">,</span> <span class="token string">"Normal"</span><span class="token punctuation">,</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Clean up</span>
	<span class="token function">UnintializeHardwareBPVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[#] Press &lt;Enter&gt; To Quit ... "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>Executing this example program will result in the following output:</p>
<p>1.The first <code>MessageBoxA</code> call, before installing the hook.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-441011385-4272feba-f1bd-4071-b6ab-685bd9555b3a.png">
<p>2.The second <code>MessageBoxA</code> call, where the <code>MessageBoxADetour</code> function is executed instead.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-541011482-32d80e10-37ca-4de1-8273-bdca89e5eae2.png">
<p>3.The third <code>MessageBoxA</code> call, after removing the hook.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-641011597-dcc87b89-ac64-4605-8ebc-d8c63f1e3a9c.png">
<h3 id="toc-heading-36">Hooking Example (2)</h3>
<p>In this example, an attempt will be made to hook two WinAPI functions while utilizing the <code>BLOCK_REAL</code> and <code>RETURN_VALUE</code> functions. The detour function <code>MessageBoxADetour</code> shown below serves as the detour function for <code>MessageBoxA</code>. Unlike the earlier implementation, this function does not modify the original function parameters. Instead, <code>MessageBoxADetour</code> directly invokes the <code>MessageBoxA</code> WinAPI with different parameters. The function also utilizes the <code>RETURN_VALUE</code> macro to return the value obtained from the new <code>MessageBoxA</code> call as the output of the original function. Furthermore, the <code>BLOCK_REAL</code> function is employed to terminate the execution of the original hooked <code>MessageBoxA</code> call, causing it to execute a <code>ret</code> instruction instead.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">VOID <span class="token function">MessageBoxADetour</span><span class="token punctuation">(</span>PCONTEXT pThreadCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[i] MessageBoxA's Old Parameters: \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\t&gt; %s \n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GETPARM_2</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\t&gt; %s \n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">GETPARM_3</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	
	<span class="token function">RETURN_VALUE</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">,</span> <span class="token function">MessageBoxA</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"This is the hook"</span><span class="token punctuation">,</span> <span class="token string">"MessageBoxADetour"</span><span class="token punctuation">,</span> MB_OK <span class="token operator">|</span> MB_ICONEXCLAMATION<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">BLOCK_REAL</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">CONTINUE_EXECUTION</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>This implementation will hook another function, <code>Sleep</code>, where its detour version, <code>SleepDetour</code>, is shown below. The function simply terminates the execution of the hooked <code>Sleep</code> function. As a result, the <code>Sleep</code> function will appear as if it was never called within the implementation.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c">VOID <span class="token function">SleepDetour</span><span class="token punctuation">(</span>PCONTEXT pThreadCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[i] Sleep's Old Parameters: \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\t&gt; %d \n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>DWORD<span class="token punctuation">)</span><span class="token function">GETPARM_1</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">BLOCK_REAL</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">CONTINUE_EXECUTION</span><span class="token punctuation">(</span>pThreadCtx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>The main function is shown below which incorporates both hooks, making use of the previously mentioned detour functions.</p>
<div class="code-toolbar"><pre class="language-c" tabindex="0"><code class="language-c"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token comment">// Initialize </span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">InitializeHardwareBPVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>


	<span class="token comment">// NOT HOOKED</span>
	<span class="token function">MessageBoxA</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"This Is A Normal MsgBoxA Call (0)"</span><span class="token punctuation">,</span> <span class="token string">"Normal"</span><span class="token punctuation">,</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[i] Installing Hooks ... "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// Hook 'MessageBoxA' to call 'MessageBoxADetour' instead - using the Dr0 register</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">SetHardwareBreakingPnt</span><span class="token punctuation">(</span>MessageBoxA<span class="token punctuation">,</span> MessageBoxADetour<span class="token punctuation">,</span> Dr0<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	
	<span class="token comment">// Hook 'Sleep' to call 'SleepDetour' instead - using the Dr1 register</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">SetHardwareBreakingPnt</span><span class="token punctuation">(</span>Sleep<span class="token punctuation">,</span> SleepDetour<span class="token punctuation">,</span> Dr1<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] DONE \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token comment">// HOOKED</span>
	<span class="token function">MessageBoxA</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"This Wont Execute"</span><span class="token punctuation">,</span> <span class="token string">"Will it ?"</span><span class="token punctuation">,</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// HOOKED</span>
	<span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	
	<span class="token comment">// Unhooking the installed hook on 'Dr0'</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[i] Uninstalling Hooks ... "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">RemoveHardwareBreakingPnt</span><span class="token punctuation">(</span>Dr0<span class="token punctuation">)</span><span class="token punctuation">)</span> 
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[+] DONE \n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	
	<span class="token comment">// NOT HOOKED</span>
	<span class="token function">MessageBoxA</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"This Is A Normal MsgBoxA Call (1)"</span><span class="token punctuation">,</span> <span class="token string">"Normal"</span><span class="token punctuation">,</span> MB_OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// HOOKED</span>
	<span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token comment">// Clean up</span>
	<span class="token function">UnintializeHardwareBPVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[#] Press &lt;Enter&gt; To Quit ... "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="toolbar"><div class="toolbar-item"><button class="copy-to-clipboard-button" type="button" data-copy-state="copy"><span>Copy</span></button></div></div></div>
<p>The above program will result in the following output:</p>
<p>1.The first <code>MessageBoxA</code> call, before installing the hook.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-741029845-847a6885-829e-4610-8860-000dbf3dc7ba.png">
<p>2.The second <code>MessageBoxA</code> call, where the <code>MessageBoxADetour</code> function is executed instead.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-841030064-858e6001-8fdc-4690-972f-4c568ae475c4.png">
<p>3.The hooked <code>Sleep</code> function, where the infinite sleep call is terminated. In addition to that, the <code>Dr0</code> register (<code>MessageBoxA</code>) breakpoint is removed.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-941030317-492ef77a-814a-41c4-ad32-d48718468e0f.png">
<p>4.Another infinite sleep call while being terminated.</p>
<img style="margin:auto" width="1000px" src="9_files/hbp1-141030512-10-4a41-4c90-8e89-2e959613e4c5.png">
<h3 id="toc-heading-37">Video Demo</h3>
<video style="margin:auto" width="1400" controls="controls" class="js-parse-2dd74396fb4949db9d79c16e578d6d88">
  <source src="9_files/hbp1-demo.mp4" type="video/mp4" class="js-parse-2dd74396fb4949db9d79c16e578d6d88">
  Your browser does not support the video tag.
</video>

    </div>

    
        
</div></div>              </div>
              
              <div id="accessory-container" class="flex flex-col h-full lg:min-w-[500px] w-[500px]">
    <div id="objectives" class="hidden p-4 border-r border-b bg-gray-900 border-gray-600 font-code w-full h-full">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">Objectives</div>
                                                                                    <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-0" data-objective-id="0" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Familiarize yourself with the role of the debug registers Dr0-3 and Dr7</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-1" data-objective-id="1" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Understand the VEH's role in the implementation</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-2" data-objective-id="2" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Learn how to implement a detour function</label>
                </div>
                                                                                            <div class="flex items-center mb-2 font-sans">
                    <input type="checkbox" id="objective-3" data-objective-id="3" class="flex-none w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                    <label class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Implement a detour function that calls the hooked function without using 'BLOCK_REAL', what happens?</label>
                </div>
                                              
    </div>
    <div id="toc-container" class=" p-4 border-r border-b border-gray-600 w-full h-full">
    <div class="sticky top-0 bg-gray-800 rounded-xl">
        <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg rounded-t-xl">
        Table of Contents
        </div>

        
        

        
        <div id="toc-content" class="min-h-[70vh] max-h-[70vh] overflow-y-auto rounded-b-xl pr-2">
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:40px" data-target-id="toc-heading-0">
        <span class="text-gray-300 hover:text-white text-sm">Utilizing Hardware Breakpoints For Hooking (1)</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-1">
        <span class="text-gray-300 hover:text-white text-sm">Introduction</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-2">
        <span class="text-gray-300 hover:text-white text-sm">Understanding Hardware Breakpoints</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-3">
        <span class="text-gray-300 hover:text-white text-sm">EFLAGS Register</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-4">
        <span class="text-gray-300 hover:text-white text-sm">Dr7 Register</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-5">
        <span class="text-gray-300 hover:text-white text-sm">The Global Breakpoint Enable Flags</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-6">
        <span class="text-gray-300 hover:text-white text-sm">Hardware Breakpoints Algorithm</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-7">
        <span class="text-gray-300 hover:text-white text-sm">How Hardware Breakpoint Hooks Work</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-8">
        <span class="text-gray-300 hover:text-white text-sm">Hooking Multiple Functions</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-9">
        <span class="text-gray-300 hover:text-white text-sm">Code Implementation</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-10">
        <span class="text-gray-300 hover:text-white text-sm">Altering The Dr7 Register Value</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-11">
        <span class="text-gray-300 hover:text-white text-sm">Initializing The Address of The Breakpoint</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-12">
        <span class="text-gray-300 hover:text-white text-sm">Installing The Breakpoint</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-13">
        <span class="text-gray-300 hover:text-white text-sm">Enabling The Breakpoint</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-14">
        <span class="text-gray-300 hover:text-white text-sm">Detour Function Pointer</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-15">
        <span class="text-gray-300 hover:text-white text-sm">RemoveHardwareBreakingPnt Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-16">
        <span class="text-gray-300 hover:text-white text-sm">Setting Up The VEH Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-17">
        <span class="text-gray-300 hover:text-white text-sm">Initializing The Exception Handler</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-18">
        <span class="text-gray-300 hover:text-white text-sm">PVECTORED_EXCEPTION_HANDLER Structure</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-19">
        <span class="text-gray-300 hover:text-white text-sm">EXCEPTION_POINTERS Structure</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-20">
        <span class="text-gray-300 hover:text-white text-sm">EXCEPTION_RECORD Structure</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-21">
        <span class="text-gray-300 hover:text-white text-sm">Handling The Hardware Breakpoint Exception</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-22">
        <span class="text-gray-300 hover:text-white text-sm">VectorHandler Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-23">
        <span class="text-gray-300 hover:text-white text-sm">The Hook Implementation</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-24">
        <span class="text-gray-300 hover:text-white text-sm">Infinite Loop &amp; Workaround</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-25">
        <span class="text-gray-300 hover:text-white text-sm">Fetching And Modifying The Hooked Function's Parameters</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-26">
        <span class="text-gray-300 hover:text-white text-sm">GetFunctionArgument Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-27">
        <span class="text-gray-300 hover:text-white text-sm">SetFunctionArgument Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-28">
        <span class="text-gray-300 hover:text-white text-sm">Get &amp; Set Macros</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-29">
        <span class="text-gray-300 hover:text-white text-sm">Critical Sections</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-30">
        <span class="text-gray-300 hover:text-white text-sm">Initialization And Cleanup</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-31">
        <span class="text-gray-300 hover:text-white text-sm">Constructing The Detour Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-32">
        <span class="text-gray-300 hover:text-white text-sm">Resuming Execution</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-33">
        <span class="text-gray-300 hover:text-white text-sm">Terminating The Original Function</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:80px" data-target-id="toc-heading-34">
        <span class="text-gray-300 hover:text-white text-sm">Modifying The Return Value</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-35">
        <span class="text-gray-300 hover:text-white text-sm">Hooking Example (1)</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-36">
        <span class="text-gray-300 hover:text-white text-sm">Hooking Example (2)</span>
      </div>
      <div class="py-2 px-2 hover:bg-gray-600 cursor-pointer transition-colors" style="padding-left:60px" data-target-id="toc-heading-37">
        <span class="text-gray-300 hover:text-white text-sm">Video Demo</span>
      </div></div>
    </div>
    </div>

        <script>
    // If ToC starts open, build it once the DOM is ready
    document.addEventListener('DOMContentLoaded', function () {
        var el = document.getElementById('toc-content');
        if (el && !el.innerHTML.trim() && typeof extractHeadings === 'function') {
        extractHeadings();
        }
    });
    </script>
    
    <div id="maldevDB" class="hidden p-4 border-r border-b border-gray-600 font-code w-full h-full">
        <img class="w-[500px] mb-4" src="9_files/maldev-db-logo.png">
        <form id="searchForm" class="flex flex-col items-center justify-center w-full font-mono">
            <div class="relative flex w-full border border-solid border-gray-700 rounded-3xl">
            <i class="absolute fa fa-search text-gray-400 top-[14px] left-4 z-20"></i>
            <input placeholder="Search Maldev Database" type="search" name="q" autocomplete="off" id="searchInput" maxlength="85" class="relative m-0 -mr-0.5 h-[46px] w-full rounded-l-3xl  bg-transparent px-10 py-[0.25rem] font-normal leading-[1.6] text-white outline-none focus:bg-gray-800 focus:border-r focus:border-gray-700" aria-label="Search">
                <button class=" w-[70px] bg-gray-800 flex items-center justify-center rounded-r-3xl px-6 py-2.5 text-white hover:bg-gray-700" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill="">
                    <path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z" clip-rule="evenodd"></path>
                    </svg>
                </button>
            </div>
            <div class="relative inline-block text-sm w-full md:w-fit">
                <select id="languageSelect" name="language" class="border rounded-md p-2.5 bg-gray-800 border-gray-600 placeholder-gray-400 text-white outline-none appearance-none w-full pr-8 my-4">
                    <option value="all" selected="selected">All languages</option>
                    <option value="c">C</option>
                    <option value="cpp">C++</option>
                    <option value="python">Python</option>
                    <option value="nim">Nim</option>
                    <option value="rust">Rust</option>
                    
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                    <svg class="h-4 w-4 text-gray-700" fill="#fff" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill="">
                        <path d="M5.516 7.548c.436-.446 1.045-.481 1.576 0L10 10.405l2.908-2.857c.531-.481 1.141-.446 1.576 0 .436.445.408 1.197 0 1.643l-3.564 3.642c-.214.223-.502.335-.92.335s-.707-.112-.92-.335l-3.564-3.642c-.408-.446-.436-1.198 0-1.643z"></path>
                    </svg>
                </div>
            </div>
        </form>
        <div class="resultsWrapper">
            <div id="noResults" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    No results found.
                </div>
            </div>
            <div id="rateLimited" class="flex flex-col justify-center items-center hidden">
                <div class="text-white text-sm opacity-50 w-full text-center font-mono mt-4">
                    HTTP 429 - You have been rate limited.
                </div>
            </div>

            <!-- Results here -->

            <div class="flex justify-center mt-6">
                <button id="loadMore" class="hidden bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-600 font-mono text-sm">
                    Load More
                </button>
            </div>
        </div>
    </div>
</div>
<div id="progress-container" class="hidden flex-col lg:min-w-[500px]">
    <div id="progress" class="p-4 border-r overflow-auto border-b border-gray-600 font-code w-full min-h-full">
    <div class="max-h-[300px]">
                <div class="w-full bg-gray-700 text-center mb-4 font-sans text-lg">New Modules Progress</div>
                                    <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-1" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./1.html">
                    <div for="module-1" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 1 - Binary Metadata Modification
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-2" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./2.html">
                    <div for="module-2" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 2 - Thread Enumeration - NtQuerySystemInformation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-3" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./3.html">
                    <div for="module-3" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 3 - Custom WinAPI Functions
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-4" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./4.html">
                    <div for="module-4" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 4 - Exploiting EDRs For Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-5" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./5.html">
                    <div for="module-5" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 5 - Introduction To MASM Assembly
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-6" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./6.html">
                    <div for="module-6" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 6 - Evasion With File Bloating
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-7" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" checked="checked" onclick="return false;">
                <a data-target="_self" href="./7.html">
                    <div for="module-7" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 7 - Bring Your Own Protocol Handler
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-8" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./8.html">
                    <div for="module-8" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 8 - Bring Your Own File Extension
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-9" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./9.html">
                    <div for="module-9" class="ml-2 text-sm font-medium 
                                bg-blue-700 font-bold rounded-sm">
                        Module 9 - Utilizing Hardware Breakpoints For Hooking (1)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-10" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./10.html">
                    <div for="module-10" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 10 - Utilizing Hardware Breakpoints For Hooking (2)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-11" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./11.html">
                    <div for="module-11" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 11 - Utilizing Hardware Breakpoints For Credential Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-12" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./12.html">
                    <div for="module-12" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 12 - Event Tracing For Windows - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-13" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./13.html">
                    <div for="module-13" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 13 - Event Tracing For Windows - ETW Tools
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-14" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./14.html">
                    <div for="module-14" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 14 - Event Tracing For Windows - ETW Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-15" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./15.html">
                    <div for="module-15" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 15 - Event Tracing for Windows - Improved Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-16" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./16.html">
                    <div for="module-16" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 16 - Event Tracing for Windows - Patchless ETW Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-17" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./17.html">
                    <div for="module-17" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 17 - Event Tracing For Windows - ETW Provider Session Hijacking
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-18" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./18.html">
                    <div for="module-18" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 18 - Antimalware Scan Interface - Introduction
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-19" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./19.html">
                    <div for="module-19" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 19 - Antimalware Scan Interface - AMSI Bypass Via Byte Patching
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-20" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./20.html">
                    <div for="module-20" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 20 - Antimalware Scan Interface - AMSI Bypass Via HBPs
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-21" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./21.html">
                    <div for="module-21" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 21 - Building a DRM-equipped Malware
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-22" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./22.html">
                    <div for="module-22" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 22 - Introduction to Havoc C&amp;C
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-23" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./23.html">
                    <div for="module-23" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 23 - Building An Evasive DLL Payload Loader
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-24" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./24.html">
                    <div for="module-24" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 24 - Introduction To DLL Sideloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-25" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./25.html">
                    <div for="module-25" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 25 - Practical DLL Sideloading Example
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-26" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./26.html">
                    <div for="module-26" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 26 - DLL Sideloading For EDR Evasion
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-27" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./27.html">
                    <div for="module-27" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 27 - Bring Your Own Vulnerable Driver
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-28" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./28.html">
                    <div for="module-28" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 28 - Local PE Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-29" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./29.html">
                    <div for="module-29" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 29 - Reflective DLL Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-30" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./30.html">
                    <div for="module-30" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 30 - PeFluctuation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-31" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./31.html">
                    <div for="module-31" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 31 - Building a PE Packer
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-32" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./32.html">
                    <div for="module-32" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 32 - Malware Directory Placement
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-33" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./33.html">
                    <div for="module-33" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 33 - Utilizing Fibers For Payload Execution
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-34" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./34.html">
                    <div for="module-34" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 34 - TLS Callbacks For Anti-Debugging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-35" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./35.html">
                    <div for="module-35" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 35 - Threadless Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-36" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./36.html">
                    <div for="module-36" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 36 - Module Stomping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-37" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./37.html">
                    <div for="module-37" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 37 - Module Overloading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-38" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./38.html">
                    <div for="module-38" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 38 - Process Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-39" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./39.html">
                    <div for="module-39" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 39 - Ghost Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-40" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./40.html">
                    <div for="module-40" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 40 - Ghostly Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-41" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./41.html">
                    <div for="module-41" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 41 - Herpaderping Process Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-42" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./42.html">
                    <div for="module-42" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 42 - Herpaderply Hollowing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-43" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./43.html">
                    <div for="module-43" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 43 - Shellcode Reflective DLL Injection (sRDI)
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-44" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./44.html">
                    <div for="module-44" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 44 - Patchless Threadless Injection Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-45" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./45.html">
                    <div for="module-45" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 45 - Tampered Syscalls Via Hardware BreakPoints
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-46" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./46.html">
                    <div for="module-46" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 46 - Exploiting EDRs For Evasion - Preventing EDR From Taking Action
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-47" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./47.html">
                    <div for="module-47" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 47 - Exploiting EDRs For Evasion - EDR LOLBINS
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-48" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./48.html">
                    <div for="module-48" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 48 - Process Hypnosis
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-49" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./49.html">
                    <div for="module-49" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 49 - Introduction To Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-50" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./50.html">
                    <div for="module-50" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 50 - Writing Beacon Object Files
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-51" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./51.html">
                    <div for="module-51" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 51 - Object File Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-52" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./52.html">
                    <div for="module-52" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 52 - Exploiting EDRs For Evasion - Finding Internal Exclusion List
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-53" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./53.html">
                    <div for="module-53" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 53 - Introduction To Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-54" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./54.html">
                    <div for="module-54" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 54 - Introduction to Ekko and Zilean Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-55" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./55.html">
                    <div for="module-55" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 55 - Introduction to Foliage Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-56" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./56.html">
                    <div for="module-56" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 56 - Implementing Ekko With Stack Spoofing
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-57" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./57.html">
                    <div for="module-57" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 57 - Token Manipulation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-58" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./58.html">
                    <div for="module-58" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 58 - Library Proxy Loading
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-59" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./59.html">
                    <div for="module-59" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 59 - Heap Encryption With Ekko Sleep Obfuscation
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-60" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./60.html">
                    <div for="module-60" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 60 - Introduction To Executing .NET Assemblies 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-61" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./61.html">
                    <div for="module-61" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 61 - Evading Microsoft Defender Via Patching 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-62" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./62.html">
                    <div for="module-62" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 62 - .NET Assemblies - Patching System.Environment.Exit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-63" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./63.html">
                    <div for="module-63" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 63 - Capturing And Saving Screenshots Into Memory
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-64" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./64.html">
                    <div for="module-64" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 64 - Cross-Architecture Injection: x86 to x64 Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-65" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./65.html">
                    <div for="module-65" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 65 - KnownDll Cache Poisoning Injection
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-66" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./66.html">
                    <div for="module-66" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 66 - Introduction to Keylogging
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-67" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./67.html">
                    <div for="module-67" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 67 - Developing a Keylogger
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-68" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./68.html">
                    <div for="module-68" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 68 - Sending Keystrokes To Remote Server
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-69" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./69.html">
                    <div for="module-69" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 69 - Manipulating VEH For Local Code Execution 
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-70" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./70.html">
                    <div for="module-70" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 70 - Introduction To LSASS Dumping
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-71" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./71.html">
                    <div for="module-71" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 71 - Fetching LSASS Handle And Bypassing PPL
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-72" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./72.html">
                    <div for="module-72" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 72 - LSASS Dump Via Handle Duplication
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-73" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./73.html">
                    <div for="module-73" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 73 - LSASS Dump Via RtlReportSilentProcessExit
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-74" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./74.html">
                    <div for="module-74" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 74 - LSASS Dump Via Seclogon Race Condition
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-75" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./75.html">
                    <div for="module-75" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 75 - Dumping The SAM Database
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-76" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./76.html">
                    <div for="module-76" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 76 - Dumping The SAM Remotely
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-77" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./77.html">
                    <div for="module-77" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 77 - Dumping The SAM From Disk
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-78" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./78.html">
                    <div for="module-78" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 78 - Domain Enumeration Using MS-SAMR
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-79" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./79.html">
                    <div for="module-79" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 79 - Dumping Browser Cookies: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-80" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./80.html">
                    <div for="module-80" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 80 - Dumping Saved Logins: Firefox
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-81" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./81.html">
                    <div for="module-81" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 81 - Dumping Browser Cookies: Chrome
                    </div>
                </a>
            </div>
                                <div class="flex items-center mb-2 font-sans">
                <input type="checkbox" id="module-82" class="flex-none outline-none accent-green-500 w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300" onclick="return false;">
                <a data-target="_self" href="./82.html">
                    <div for="module-82" class="ml-2 text-sm font-medium 
                                text-gray-900 dark:text-gray-300">
                        Module 82 - Dumping Saved Logins: Chrome
                    </div>
                </a>
            </div>
                </div>
    </div>
</div>          </div>
      </div>

      
      <div class="flex">
  <div class="flex flex-row flex-wrap justify-center items-center w-full bg-gray-700/70 backdrop-blur-md backdrop-saturate-150 border-r border-l border-gray-600/60 pl-4 pt-2 pb-2 rounded-bl-xl rounded-br-xl shadow-inner">

          <div class="mr-2">
        <a data-target="_self" href="./8.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Previous</button>
        </a>
      </div>
    
    <div class="mr-2">
      <a data-target="_self" href="../All Modules.html">
        <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Modules</button>
      </a>
    </div>

    <div class="my-2 mr-2">
      <form id="complete-module" action="./9/complete" method="POST">
      </form>
      <form id="uncomplete-module" action="./#" method="POST">
      </form>
    </div>

          <div class="mr-2">
        <a data-target="_self" href="./10.html">
          <button class="w-[100px] h-10 px-5 text-sm font-medium text-white
             rounded-xl backdrop-blur-xl backdrop-saturate-150
             bg-gradient-to-b from-blue-600/85 to-blue-700/85
             hover:from-blue-500/85 hover:to-blue-600/85
             border border-blue-300/30 ring-1 ring-inset ring-white/10
             shadow-[0_6px_18px_-8px_rgba(0,0,0,0.7)]
             transition-all duration-200 focus:outline-none
             focus-visible:ring-2 focus-visible:ring-white/30">Next</button>
        </a>
      </div>
    
  </div>
</div>

      
      <input type="hidden" id="objectives-completed" value="20973">

      
      <div id="copyWarning" class="fixed inset-0 hidden z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">
  <div class="relative bg-gray-800 border border-gray-600 rounded-2xl shadow-2xl p-8 max-w-lg w-11/12 text-center transform transition-all scale-100">
    <p class="text-2xl font-bold text-white mb-4 tracking-wide">
      Reminder
    </p>
    <p class="text-gray-300 text-base mb-6 leading-relaxed">
      To remain compliant with the Terms of Service, avoid copying the entire module and instead copy the necessary sections.
    </p>
    <button onclick="hideCopyWarning()" class="w-full text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center transition-all duration-200 bg-blue-600/80 hover:bg-blue-500/80 border border-blue-400/40 backdrop-blur-sm backdrop-saturate-150">
      I understand
    </button>
    <span class="absolute top-3 right-3 text-gray-400 hover:text-gray-200 cursor-pointer text-xl" onclick="hideCopyWarning()"></span>
  </div>
</div>



      
        </div>

  <footer id="footer" class="text-gray-400
    bg-gradient-to-t from-[#101926] via-[#172130] to-[#1e293b] backdrop-blur-md backdrop-saturate-150 z-20 border-t border-gray-700/50 border-gray-800
     hidden body-font">
    <div class="container px-5 py-8 mx-auto flex items-center sm:flex-row flex-col">
      <p class="text-sm text-gray-400 sm:ml-4 sm:pl-4 sm:border-gray-800 sm:py-2 sm:mt-0 mt-4"> 2025 Maldev Academy Inc.</p>
        <a href="https://x.com/maldevacademy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 1200 1227" xmlns="http://www.w3.org/2000/svg" style="--darkreader-inline-fill: currentColor;" data-darkreader-inline-fill="">
            <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill=""></path>
          </svg>            
        </a>
        <a href="https://github.com/Maldev-Academy" target="_blank" class="text-gray-500 hover:text-white ml-2 sm:mt-0 mt-4">
          <svg class="w-6 h-6" fill="white" viewBox="0 0 24 24" aria-hidden="true" style="--darkreader-inline-fill: var(--darkreader-text-ffffff, #e8e6e3);" data-darkreader-inline-fill=""><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg>
        </a>
      <span class="inline-flex sm:ml-auto sm:mt-0 mt-4 justify-center sm:justify-start">
        <a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
          Terms of Service
      </a></span><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
    </a></div><a class="text-gray-400 text-sm" href="https://maldevacademy.com/tos" target="_blank">
  </a></footer></div>
        

        <script src="9_files/jquery-3.6.0.min.js"></script>
        <script src="9_files/bootstrap.min.js"></script>
        <script src="9_files/navbar.js"></script>
        

<link rel="preload" as="style" href="9_files/app-BoiX-DPv.css"><link rel="modulepreload" href="9_files/app-D9jIIQde.js"><link rel="stylesheet" href="9_files/app-BoiX-DPv.css"><style class="darkreader darkreader--sync" media="screen"></style><script type="module" src="9_files/app-D9jIIQde.js"></script><script src="9_files/moduleviewer.js" defer="defer"></script>

    
</body></html>