<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <title>HTB Previous | Writeup</title>
  <link rel="icon" type="image/png" href="assets/tab.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="HTB Previous | Writeup">
  <meta property="og:title" content="HTB Previous | Writeup">
  <meta property="og:description" content="Hack The Box Previous Writeup - Tags: SMB, MySQL abuse, privesc">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="0x0z0n">
  <link rel="stylesheet" href="../style.css" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <style>
    :root {
      --accent: #4caf50;
      --link-color: #ffeb3b;
      --bg: #111;
      --card: #1e1e1e;
      --text: #eee;
      --tooltip-bg: #222;
    }
    body {
      background: linear-gradient(180deg, #111, #0b0b0b);
      color: var(--text);
      font-family: 'Segoe UI', sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 2rem;
      line-height: 1.7;
    }
    a { color: var(--link-color); text-decoration: none; }
    a:hover { text-decoration: underline; }
    h1, h2, h3 {
      color: var(--accent);
      margin-top: 2rem;
      border-bottom: 1px solid #333;
      padding-bottom: 0.3rem;
    }
    pre {
      background: #0d0d0d;
      padding: 1rem;
      border-left: 4px solid var(--accent);
      overflow-x: auto;
      border-radius: 6px;
      margin: 1.5rem 0;
      position: relative; /* important */
    }
    pre code { 
      background: none; 
      padding: 0; 
      border-radius: 0; 
      font-family: monospace; 
    }
    .copy-btn {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: var(--accent);
      color: #111;
      border: none;
      border-radius: 4px;
      padding: 0.2rem 0.5rem;
      cursor: pointer;
      font-size: 0.8rem;
      z-index: 1;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
      background: var(--card);
      border-radius: 6px;
      overflow: hidden;
    }
    th, td {
      padding: 0.8rem 1rem;
      text-align: left;
      border-bottom: 1px solid #333;
    }
    th { background: #222; color: var(--accent); }
    tr:hover { background: #2a2a2a; }
    #content img {
      max-width: 100%;
      border-radius: 8px;
      margin: 1rem auto;
      display: block;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }
    #content blockquote {
      border-left: 4px solid var(--accent);
      background: #1a1a1a;
      padding: 0.8rem 1rem;
      margin: 1rem 0;
      font-style: italic;
      color: #ccc;
    }
    .back-link {
      display: inline-block;
      margin-bottom: 2rem;
      font-weight: bold;
    }
    /* Tooltip for techniques */
    .tooltip {
      position: relative;
      cursor: help;
      border-bottom: 1px dotted var(--link-color);
    }
    .tooltip::after {
      content: attr(data-tip);
      position: absolute;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      background: var(--tooltip-bg);
      color: #fff;
      padding: 0.4rem 0.6rem;
      border-radius: 4px;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: 0.2s;
      font-size: 0.75rem;
    }
    .tooltip:hover::after { opacity: 1; }

    details summary {
      cursor: pointer;
      font-weight: bold;
      color: var(--accent);
      margin: 0.5rem 0;
    }

    /* Expand/Hide button styling */
    .expand-btn {
      background: var(--accent);
      color: #111;
      border: none;
      border-radius: 4px;
      padding: 0.3rem 0.7rem;
      cursor: pointer;
      font-size: 0.85rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
    }
    .expand-btn:hover {
      background: #3a9e40;
    }
    .details-content {
      display: none;
      margin-top: 0.5rem;
    }
  </style>
</head>
<body>
  <a href="../index.html" class="back-link">‚Üê Back to Home</a>
  <div id="content">Loading writeup...</div>

  <script>
fetch("Previous.md")
  .then(res => res.text())
  .then(md => {
    document.getElementById("content").innerHTML = marked.parse(md);

    // Find attack chain table
    const tables = document.querySelectorAll('#content table');
    if(tables.length) {
      const table = tables[0]; // assuming first table is attack chain
      const rows = table.querySelectorAll('tbody tr');
      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        if(cells.length >= 6) {
          const commandsCell = cells[4].innerText.split(';').map(c => `<pre><code>${c.trim()}</code></pre>`).join('');
          const screenshotsCell = cells[5].innerText.split(',').map(s => `<img src="${s.trim()}" alt="screenshot">`).join('');
          const detailsDiv = document.createElement('div');
          detailsDiv.className = 'details-content';
          detailsDiv.innerHTML = commandsCell + screenshotsCell;

          const expandBtn = document.createElement('button');
          expandBtn.className = 'expand-btn';
          expandBtn.textContent = 'Show';
          expandBtn.addEventListener('click', () => {
            if(detailsDiv.style.display === 'block') {
              detailsDiv.style.display = 'none';
              expandBtn.textContent = 'Show';
            } else {
              detailsDiv.style.display = 'block';
              expandBtn.textContent = 'Hide';
            }
          });

          cells[5].innerHTML = ''; // replace screenshots cell with button
          cells[5].appendChild(expandBtn);
          cells[5].appendChild(detailsDiv);
        }
      });
    }

    // Copy buttons for pre/code blocks
    document.querySelectorAll('pre').forEach(block => {
      const btn = document.createElement('button');
      btn.textContent = 'üìã';
      btn.className = 'copy-btn';
      block.appendChild(btn);
      btn.addEventListener('click', () => {
        const code = block.querySelector("code") ? block.querySelector("code").innerText : block.innerText;
        navigator.clipboard.writeText(code).then(() => {
          btn.textContent = '‚úî';
          setTimeout(() => btn.textContent = 'üìã', 1000);
        });
      });
    });
  });
</script>

</body>
</html>
